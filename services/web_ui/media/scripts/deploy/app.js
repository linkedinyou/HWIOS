function Buffer(a){this.segments=[];if(a&&a.length)for(var b in a)this.segments.push(a[b].copy())}function Segment(a,b){this.user=a,this.text=b}function State(a,b){a instanceof Buffer?this.buffer=a.copy():this.buffer=new Buffer,this.vector=new Vector(b),this.request_queue=[],this.log=[],this.cache={}}function Vector(a){if(typeof a=="object")for(var b in a)b.match(Vector.user_regex)&&a[b]>0&&(this[b]=a[b]);else if(typeof a=="string"){var c=Vector.timestring_regex.exec(a);while(c!=null)this[c[1]]=parseInt(c[2]),c=Vector.timestring_regex.exec(a)}}function _indexOf(a,b,c){if(a.indexOf)return a.indexOf(b,c);typeof c!="number"&&(c=0);for(var d=0;d<a.length;d++)if(a[d]===b)return d;return-1}function RedoRequest(a,b){this.user=a,this.vector=b}function UndoRequest(a,b){this.user=a,this.vector=b}function DoRequest(a,b,c){this.user=a,this.vector=b,this.operation=c}function ReconSegment(a,b){this.offset=a,this.buffer=b.copy()}function Recon(a){a?this.segments=a.segments.slice(0):this.segments=[]}function patch_obj(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}function diff_match_patch(){function a(){var a=0,b=1,c=2;while(b!=c)a++,b=c,c=c<<1;return a}this.Diff_Timeout=1,this.Diff_EditCost=4,this.Diff_DualThreshold=32,this.Match_Balance=.5,this.Match_Threshold=.5,this.Match_MinLength=100,this.Match_MaxLength=1e3,this.Patch_Margin=4,this.Match_MaxBits=a()}function decode_utf8(a){return decodeURIComponent(escape(a))}var OpenLayers={singleFile:!0};(function(){var a=typeof OpenLayers=="object"&&OpenLayers.singleFile,b;window.OpenLayers={_scriptName:a?"OpenLayers.js":"lib/OpenLayers.js",_getScriptLocation:function(){if(b!=undefined)return b;b="";var a=new RegExp("(^|(.*?\\/))("+OpenLayers._scriptName+")(\\?|$)"),c=document.getElementsByTagName("script");for(var d=0,e=c.length;d<e;d++){var f=c[d].getAttribute("src");if(f){var g=f.match(a);if(g){b=g[1];break}}}return b}};if(!a){var c=["OpenLayers/Util.js","OpenLayers/BaseTypes.js","OpenLayers/BaseTypes/Class.js","OpenLayers/BaseTypes/Bounds.js","OpenLayers/BaseTypes/Element.js","OpenLayers/BaseTypes/LonLat.js","OpenLayers/BaseTypes/Pixel.js","OpenLayers/BaseTypes/Size.js","OpenLayers/Console.js","OpenLayers/Tween.js","Rico/Corner.js","Rico/Color.js","OpenLayers/Ajax.js","OpenLayers/Events.js","OpenLayers/Request.js","OpenLayers/Request/XMLHttpRequest.js","OpenLayers/Projection.js","OpenLayers/Map.js","OpenLayers/Layer.js","OpenLayers/Icon.js","OpenLayers/Marker.js","OpenLayers/Marker/Box.js","OpenLayers/Popup.js","OpenLayers/Tile.js","OpenLayers/Tile/Image.js","OpenLayers/Tile/Image/IFrame.js","OpenLayers/Tile/WFS.js","OpenLayers/Layer/Image.js","OpenLayers/Layer/SphericalMercator.js","OpenLayers/Layer/EventPane.js","OpenLayers/Layer/FixedZoomLevels.js","OpenLayers/Layer/Google.js","OpenLayers/Layer/VirtualEarth.js","OpenLayers/Layer/Yahoo.js","OpenLayers/Layer/HTTPRequest.js","OpenLayers/Layer/Grid.js","OpenLayers/Layer/MapGuide.js","OpenLayers/Layer/MapServer.js","OpenLayers/Layer/MapServer/Untiled.js","OpenLayers/Layer/KaMap.js","OpenLayers/Layer/KaMapCache.js","OpenLayers/Layer/MultiMap.js","OpenLayers/Layer/Markers.js","OpenLayers/Layer/Text.js","OpenLayers/Layer/WorldWind.js","OpenLayers/Layer/ArcGIS93Rest.js","OpenLayers/Layer/WMS.js","OpenLayers/Layer/WMS/Untiled.js","OpenLayers/Layer/WMS/Post.js","OpenLayers/Layer/ArcIMS.js","OpenLayers/Layer/GeoRSS.js","OpenLayers/Layer/Boxes.js","OpenLayers/Layer/XYZ.js","OpenLayers/Layer/TMS.js","OpenLayers/Layer/TileCache.js","OpenLayers/Layer/Zoomify.js","OpenLayers/Popup/Anchored.js","OpenLayers/Popup/AnchoredBubble.js","OpenLayers/Popup/Framed.js","OpenLayers/Popup/FramedCloud.js","OpenLayers/Feature.js","OpenLayers/Feature/Vector.js","OpenLayers/Feature/WFS.js","OpenLayers/Handler.js","OpenLayers/Handler/Click.js","OpenLayers/Handler/Hover.js","OpenLayers/Handler/Point.js","OpenLayers/Handler/Path.js","OpenLayers/Handler/Polygon.js","OpenLayers/Handler/Feature.js","OpenLayers/Handler/Drag.js","OpenLayers/Handler/RegularPolygon.js","OpenLayers/Handler/Box.js","OpenLayers/Handler/MouseWheel.js","OpenLayers/Handler/Keyboard.js","OpenLayers/Control.js","OpenLayers/Control/Attribution.js","OpenLayers/Control/Button.js","OpenLayers/Control/ZoomBox.js","OpenLayers/Control/ZoomToMaxExtent.js","OpenLayers/Control/DragPan.js","OpenLayers/Control/Navigation.js","OpenLayers/Control/MouseDefaults.js","OpenLayers/Control/MousePosition.js","OpenLayers/Control/OverviewMap.js","OpenLayers/Control/KeyboardDefaults.js","OpenLayers/Control/PanZoom.js","OpenLayers/Control/PanZoomBar.js","OpenLayers/Control/ArgParser.js","OpenLayers/Control/Permalink.js","OpenLayers/Control/Scale.js","OpenLayers/Control/ScaleLine.js","OpenLayers/Control/Snapping.js","OpenLayers/Control/Split.js","OpenLayers/Control/LayerSwitcher.js","OpenLayers/Control/DrawFeature.js","OpenLayers/Control/DragFeature.js","OpenLayers/Control/ModifyFeature.js","OpenLayers/Control/Panel.js","OpenLayers/Control/SelectFeature.js","OpenLayers/Control/NavigationHistory.js","OpenLayers/Control/Measure.js","OpenLayers/Control/WMSGetFeatureInfo.js","OpenLayers/Control/Graticule.js","OpenLayers/Control/TransformFeature.js","OpenLayers/Geometry.js","OpenLayers/Geometry/Rectangle.js","OpenLayers/Geometry/Collection.js","OpenLayers/Geometry/Point.js","OpenLayers/Geometry/MultiPoint.js","OpenLayers/Geometry/Curve.js","OpenLayers/Geometry/LineString.js","OpenLayers/Geometry/LinearRing.js","OpenLayers/Geometry/Polygon.js","OpenLayers/Geometry/MultiLineString.js","OpenLayers/Geometry/MultiPolygon.js","OpenLayers/Geometry/Surface.js","OpenLayers/Renderer.js","OpenLayers/Renderer/Elements.js","OpenLayers/Renderer/SVG.js","OpenLayers/Renderer/Canvas.js","OpenLayers/Renderer/VML.js","OpenLayers/Layer/Vector.js","OpenLayers/Layer/Vector/RootContainer.js","OpenLayers/Strategy.js","OpenLayers/Strategy/Fixed.js","OpenLayers/Strategy/Cluster.js","OpenLayers/Strategy/Paging.js","OpenLayers/Strategy/BBOX.js","OpenLayers/Strategy/Save.js","OpenLayers/Strategy/Refresh.js","OpenLayers/Filter.js","OpenLayers/Filter/FeatureId.js","OpenLayers/Filter/Logical.js","OpenLayers/Filter/Comparison.js","OpenLayers/Filter/Spatial.js","OpenLayers/Protocol.js","OpenLayers/Protocol/HTTP.js","OpenLayers/Protocol/SQL.js","OpenLayers/Protocol/SQL/Gears.js","OpenLayers/Protocol/WFS.js","OpenLayers/Protocol/WFS/v1.js","OpenLayers/Protocol/WFS/v1_0_0.js","OpenLayers/Protocol/WFS/v1_1_0.js","OpenLayers/Protocol/SOS.js","OpenLayers/Protocol/SOS/v1_0_0.js","OpenLayers/Layer/PointTrack.js","OpenLayers/Layer/GML.js","OpenLayers/Style.js","OpenLayers/StyleMap.js","OpenLayers/Rule.js","OpenLayers/Format.js","OpenLayers/Format/XML.js","OpenLayers/Format/ArcXML.js","OpenLayers/Format/ArcXML/Features.js","OpenLayers/Format/GML.js","OpenLayers/Format/GML/Base.js","OpenLayers/Format/GML/v2.js","OpenLayers/Format/GML/v3.js","OpenLayers/Format/Atom.js","OpenLayers/Format/KML.js","OpenLayers/Format/GeoRSS.js","OpenLayers/Format/WFS.js","OpenLayers/Format/WFSCapabilities.js","OpenLayers/Format/WFSCapabilities/v1.js","OpenLayers/Format/WFSCapabilities/v1_0_0.js","OpenLayers/Format/WFSCapabilities/v1_1_0.js","OpenLayers/Format/WFSDescribeFeatureType.js","OpenLayers/Format/WMSDescribeLayer.js","OpenLayers/Format/WMSDescribeLayer/v1_1.js","OpenLayers/Format/WKT.js","OpenLayers/Format/OSM.js","OpenLayers/Format/GPX.js","OpenLayers/Format/Filter.js","OpenLayers/Format/Filter/v1.js","OpenLayers/Format/Filter/v1_0_0.js","OpenLayers/Format/Filter/v1_1_0.js","OpenLayers/Format/SLD.js","OpenLayers/Format/SLD/v1.js","OpenLayers/Format/SLD/v1_0_0.js","OpenLayers/Format/CSWGetDomain.js","OpenLayers/Format/CSWGetDomain/v2_0_2.js","OpenLayers/Format/CSWGetRecords.js","OpenLayers/Format/CSWGetRecords/v2_0_2.js","OpenLayers/Format/WFST.js","OpenLayers/Format/WFST/v1.js","OpenLayers/Format/WFST/v1_0_0.js","OpenLayers/Format/WFST/v1_1_0.js","OpenLayers/Format/Text.js","OpenLayers/Format/JSON.js","OpenLayers/Format/GeoJSON.js","OpenLayers/Format/WMC.js","OpenLayers/Format/WMC/v1.js","OpenLayers/Format/WMC/v1_0_0.js","OpenLayers/Format/WMC/v1_1_0.js","OpenLayers/Format/WMSCapabilities.js","OpenLayers/Format/WMSCapabilities/v1.js","OpenLayers/Format/WMSCapabilities/v1_1.js","OpenLayers/Format/WMSCapabilities/v1_1_0.js","OpenLayers/Format/WMSCapabilities/v1_1_1.js","OpenLayers/Format/WMSCapabilities/v1_3.js","OpenLayers/Format/WMSCapabilities/v1_3_0.js","OpenLayers/Format/WMSGetFeatureInfo.js","OpenLayers/Format/OWSCommon/v1_1_0.js","OpenLayers/Format/SOSCapabilities.js","OpenLayers/Format/SOSCapabilities/v1_0_0.js","OpenLayers/Format/SOSGetObservation.js","OpenLayers/Format/SOSGetFeatureOfInterest.js","OpenLayers/Layer/WFS.js","OpenLayers/Control/GetFeature.js","OpenLayers/Control/MouseToolbar.js","OpenLayers/Control/NavToolbar.js","OpenLayers/Control/PanPanel.js","OpenLayers/Control/Pan.js","OpenLayers/Control/ZoomIn.js","OpenLayers/Control/ZoomOut.js","OpenLayers/Control/ZoomPanel.js","OpenLayers/Control/EditingToolbar.js","OpenLayers/Lang.js","OpenLayers/Lang/en.js"],d=navigator.userAgent,e=d.match("MSIE")||d.match("Safari");if(e)var f=Array(c.length);var g=OpenLayers._getScriptLocation()+"lib/";for(var h=0,i=c.length;h<i;h++)if(e)f[h]="<script src='"+g+c[h]+"'></script>";else{var j=document.createElement("script");j.src=g+c[h];var k=document.getElementsByTagName("head").length?document.getElementsByTagName("head")[0]:document.body;k.appendChild(j)}e&&document.write(f.join(""))}})(),OpenLayers.VERSION_NUMBER="OpenLayers 2.9.1 -- $Revision: 10129 $",OpenLayers.String={startsWith:function(a,b){return a.indexOf(b)==0},contains:function(a,b){return a.indexOf(b)!=-1},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(a){var b=a.split("-"),c=b[0];for(var d=1,e=b.length;d<e;d++){var f=b[d];c+=f.charAt(0).toUpperCase()+f.substring(1)}return c},format:function(a,b,c){b||(b=window);var d=function(a,d){var e,f=d.split(/\.+/);for(var g=0;g<f.length;g++)g==0&&(e=b),e=e[f[g]];typeof e=="function"&&(e=c?e.apply(null,c):e());return typeof e=="undefined"?"undefined":e};return a.replace(OpenLayers.String.tokenRegEx,d)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(a){return OpenLayers.String.numberRegEx.test(a)},numericIf:function(a){return OpenLayers.String.isNumeric(a)?parseFloat(a):a}},String.prototype.startsWith||(String.prototype.startsWith=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.startsWith"}));return OpenLayers.String.startsWith(this,a)}),String.prototype.contains||(String.prototype.contains=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.contains"}));return OpenLayers.String.contains(this,a)}),String.prototype.trim||(String.prototype.trim=function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.trim"}));return OpenLayers.String.trim(this)}),String.prototype.camelize||(String.prototype.camelize=function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.camelize"}));return OpenLayers.String.camelize(this)}),OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(a,b){var c=0;b>0&&(c=parseFloat(a.toPrecision(b)));return c},format:function(a,b,c,d){b=typeof b!="undefined"?b:0,c=typeof c!="undefined"?c:OpenLayers.Number.thousandsSeparator,d=typeof d!="undefined"?d:OpenLayers.Number.decimalSeparator,b!=null&&(a=parseFloat(a.toFixed(b)));var e=a.toString().split(".");e.length==1&&b==null&&(b=0);var f=e[0];if(c){var g=/(-?[0-9]+)([0-9]{3})/;while(g.test(f))f=f.replace(g,"$1"+c+"$2")}var h;if(b==0)h=f;else{var i=e.length>1?e[1]:"0";b!=null&&(i=i+Array(b-i.length+1).join("0")),h=f+d+i}return h}},Number.prototype.limitSigDigs||(Number.prototype.limitSigDigs=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Number.limitSigDigs"}));return OpenLayers.Number.limitSigDigs(this,a)}),OpenLayers.Function={bind:function(a,b){var c=Array.prototype.slice.apply(arguments,[2]);return function(){var d=c.concat(Array.prototype.slice.apply(arguments,[0]));return a.apply(b,d)}},bindAsEventListener:function(a,b){return function(c){return a.call(b,c||window.event)}},False:function(){return!1},True:function(){return!0}},Function.prototype.bind||(Function.prototype.bind=function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bind"})),Array.prototype.unshift.apply(arguments,[this]);return OpenLayers.Function.bind.apply(null,arguments)}),Function.prototype.bindAsEventListener||(Function.prototype.bindAsEventListener=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bindAsEventListener"}));return OpenLayers.Function.bindAsEventListener(this,a)}),OpenLayers.Array={filter:function(a,b,c){var d=[];if(Array.prototype.filter)d=a.filter(b,c);else{var e=a.length;if(typeof b!="function")throw new TypeError;for(var f=0;f<e;f++)if(f in a){var g=a[f];b.call(c,g,f,a)&&d.push(g)}}return d}},OpenLayers.Class=function(){var a=function(){arguments&&arguments[0]!=OpenLayers.Class.isPrototype&&this.initialize.apply(this,arguments)},b={},c,d;for(var e=0,f=arguments.length;e<f;++e)typeof arguments[e]=="function"?(e==0&&f>1&&(d=arguments[e].prototype.initialize,arguments[e].prototype.initialize=function(){},b=new arguments[e],d===undefined?delete arguments[e].prototype.initialize:arguments[e].prototype.initialize=d),c=arguments[e].prototype):c=arguments[e],OpenLayers.Util.extend(b,c);a.prototype=b;return a},OpenLayers.Class.isPrototype=function(){},OpenLayers.Class.create=function(){return function(){arguments&&arguments[0]!=OpenLayers.Class.isPrototype&&this.initialize.apply(this,arguments)}},OpenLayers.Class.inherit=function(){var a=arguments[0],b=new a(OpenLayers.Class.isPrototype);for(var c=1,d=arguments.length;c<d;c++){if(typeof arguments[c]=="function"){var e=arguments[c];arguments[c]=new e(OpenLayers.Class.isPrototype)}OpenLayers.Util.extend(b,arguments[c])}return b},OpenLayers.Util={},OpenLayers.Util.getElement=function(){var a=[];for(var b=0,c=arguments.length;b<c;b++){var d=arguments[b];typeof d=="string"&&(d=document.getElementById(d));if(arguments.length==1)return d;a.push(d)}return a},OpenLayers.Util.isElement=function(a){return a&&a.nodeType===1},typeof window.$==="undefined"&&(window.$=OpenLayers.Util.getElement),OpenLayers.Util.extend=function(a,b){a=a||{};if(b){for(var c in b){var d=b[c];d!==undefined&&(a[c]=d)}var e=typeof window.Event=="function"&&b instanceof window.Event;!e&&b.hasOwnProperty&&b.hasOwnProperty("toString")&&(a.toString=b.toString)}return a},OpenLayers.Util.removeItem=function(a,b){for(var c=a.length-1;c>=0;c--)a[c]==b&&a.splice(c,1);return a},OpenLayers.Util.clearArray=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"array = []"})),a.length=0},OpenLayers.Util.indexOf=function(a,b){if(typeof a.indexOf=="function")return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return c;return-1},OpenLayers.Util.modifyDOMElement=function(a,b,c,d,e,f,g,h){b&&(a.id=b),c&&(a.style.left=c.x+"px",a.style.top=c.y+"px"),d&&(a.style.width=d.w+"px",a.style.height=d.h+"px"),e&&(a.style.position=e),f&&(a.style.border=f),g&&(a.style.overflow=g),parseFloat(h)>=0&&parseFloat(h)<1?(a.style.filter="alpha(opacity="+h*100+")",a.style.opacity=h):parseFloat(h)==1&&(a.style.filter="",a.style.opacity="")},OpenLayers.Util.createDiv=function(a,b,c,d,e,f,g,h){var i=document.createElement("div");d&&(i.style.backgroundImage="url("+d+")"),a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv")),e||(e="absolute"),OpenLayers.Util.modifyDOMElement(i,a,b,c,e,f,g,h);return i},OpenLayers.Util.createImage=function(a,b,c,d,e,f,g,h){var i=document.createElement("img");a||(a=OpenLayers.Util.createUniqueID("OpenLayersDiv")),e||(e="relative"),OpenLayers.Util.modifyDOMElement(i,a,b,c,e,f,null,g),h&&(i.style.display="none",OpenLayers.Event.observe(i,"load",OpenLayers.Function.bind(OpenLayers.Util.onImageLoad,i)),OpenLayers.Event.observe(i,"error",OpenLayers.Function.bind(OpenLayers.Util.onImageLoadError,i))),i.style.alt=a,i.galleryImg="no",d&&(i.src=d);return i},OpenLayers.Util.setOpacity=function(a,b){OpenLayers.Util.modifyDOMElement(a,null,null,null,null,null,null,b)},OpenLayers.Util.onImageLoad=function(){if(!this.viewRequestID||this.map&&this.viewRequestID==this.map.viewRequestID)this.style.display="";OpenLayers.Element.removeClass(this,"olImageLoadError")},OpenLayers.IMAGE_RELOAD_ATTEMPTS=0,OpenLayers.Util.onImageLoadError=function(){this._attempts=this._attempts?this._attempts+1:1;if(this._attempts>OpenLayers.IMAGE_RELOAD_ATTEMPTS)OpenLayers.Element.addClass(this,"olImageLoadError");else{var a=this.urls;if(a&&a instanceof Array&&a.length>1){var b=this.src.toString(),c,d;for(d=0;c=a[d];d++)if(b.indexOf(c)!=-1)break;var e=Math.floor(a.length*Math.random()),f=a[e];d=0;while(f==c&&d++<4)e=Math.floor(a.length*Math.random()),f=a[e];this.src=b.replace(c,f)}else this.src=this.src}this.style.display=""},OpenLayers.Util.alphaHackNeeded=null,OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var a=navigator.appVersion.split("MSIE"),b=parseFloat(a[1]),c=!1;try{c=!!document.body.filters}catch(d){}OpenLayers.Util.alphaHackNeeded=c&&b>=5.5&&b<7}return OpenLayers.Util.alphaHackNeeded},OpenLayers.Util.modifyAlphaImageDiv=function(a,b,c,d,e,f,g,h,i){OpenLayers.Util.modifyDOMElement(a,b,c,d,f,null,null,i);var j=a.childNodes[0];e&&(j.src=e),OpenLayers.Util.modifyDOMElement(j,a.id+"_innerImage",null,d,"relative",g),OpenLayers.Util.alphaHack()&&(a.style.display!="none"&&(a.style.display="inline-block"),h==null&&(h="scale"),a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+j.src+"', sizingMethod='"+h+"')",parseFloat(a.style.opacity)>=0&&parseFloat(a.style.opacity)<1&&(a.style.filter+=" alpha(opacity="+a.style.opacity*100+")"),j.style.filter="alpha(opacity=0)")},OpenLayers.Util.createAlphaImageDiv=function(a,b,c,d,e,f,g,h,i){var j=OpenLayers.Util.createDiv(),k=OpenLayers.Util.createImage(null,null,null,null,null,null,null,!1);j.appendChild(k),i&&(k.style.display="none",OpenLayers.Event.observe(k,"load",OpenLayers.Function.bind(OpenLayers.Util.onImageLoad,j)),OpenLayers.Event.observe(k,"error",OpenLayers.Function.bind(OpenLayers.Util.onImageLoadError,j))),OpenLayers.Util.modifyAlphaImageDiv(j,a,b,c,d,e,f,g,h);return j},OpenLayers.Util.upperCaseObject=function(a){var b={};for(var c in a)b[c.toUpperCase()]=a[c];return b},OpenLayers.Util.applyDefaults=function(a,b){a=a||{};var c=typeof window.Event=="function"&&b instanceof window.Event;for(var d in b)if(a[d]===undefined||!c&&b.hasOwnProperty&&b.hasOwnProperty(d)&&!a.hasOwnProperty(d))a[d]=b[d];!c&&b&&b.hasOwnProperty&&b.hasOwnProperty("toString")&&!a.hasOwnProperty("toString")&&(a.toString=b.toString);return a},OpenLayers.Util.getParameterString=function(a){var b=[];for(var c in a){var d=a[c];if(d!=null&&typeof d!="function"){var e;if(typeof d=="object"&&d.constructor==Array){var f=[],g;for(var h=0,i=d.length;h<i;h++)g=d[h],f.push(encodeURIComponent(g===null||g===undefined?"":g));e=f.join(",")}else e=encodeURIComponent(d);b.push(encodeURIComponent(c)+"="+e)}}return b.join("&")},OpenLayers.Util.urlAppend=function(a,b){var c=a;if(b){var d=(a+" ").split(/[?&]/);c+=d.pop()===" "?b:d.length?"&"+b:"?"+b}return c},OpenLayers.ImgPath="",OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"},OpenLayers.Util.Try=function(){var a=null;for(var b=0,c=arguments.length;b<c;b++){var d=arguments[b];try{a=d();break}catch(e){}}return a},OpenLayers.Util.getNodes=function(a,b){var c=OpenLayers.Util.Try(function(){return OpenLayers.Util._getNodes(a.documentElement.childNodes,b)},function(){return OpenLayers.Util._getNodes(a.childNodes,b)});return c},OpenLayers.Util._getNodes=function(a,b){var c=[];for(var d=0,e=a.length;d<e;d++)a[d].nodeName==b&&c.push(a[d]);return c},OpenLayers.Util.getTagText=function(a,b,c){var d=OpenLayers.Util.getNodes(a,b);if(!d||d.length<=0)return"";c||(c=0);if(d[c].childNodes.length>1)return d.childNodes[1].nodeValue;if(d[c].childNodes.length==1)return d[c].firstChild.nodeValue},OpenLayers.Util.getXmlNodeValue=function(a){var b=null;OpenLayers.Util.Try(function(){b=a.text,b||(b=a.textContent),b||(b=a.firstChild.nodeValue)},function(){b=a.textContent});return b},OpenLayers.Util.mouseLeft=function(a,b){var c=a.relatedTarget?a.relatedTarget:a.toElement;while(c!=b&&c!=null)c=c.parentNode;return c!=b},OpenLayers.Util.DEFAULT_PRECISION=14,OpenLayers.Util.toFloat=function(a,b){b==null&&(b=OpenLayers.Util.DEFAULT_PRECISION);var a;b==0?a=parseFloat(a):a=parseFloat(parseFloat(a).toPrecision(b));return a},OpenLayers.Util.rad=function(a){return a*Math.PI/180},OpenLayers.Util.distVincenty=function(a,b){var c=6378137,d=6356752.3142,e=1/298.257223563,f=OpenLayers.Util.rad(b.lon-a.lon),g=Math.atan((1-e)*Math.tan(OpenLayers.Util.rad(a.lat))),h=Math.atan((1-e)*Math.tan(OpenLayers.Util.rad(b.lat))),i=Math.sin(g),j=Math.cos(g),k=Math.sin(h),l=Math.cos(h),m=f,n=2*Math.PI,o=20;while(Math.abs(m-n)>1e-12&&--o>0){var p=Math.sin(m),q=Math.cos(m),r=Math.sqrt(l*p*(l*p)+(j*k-i*l*q)*(j*k-i*l*q));if(r==0)return 0;var s=i*k+j*l*q,t=Math.atan2(r,s),u=Math.asin(j*l*p/r),v=Math.cos(u)*Math.cos(u),w=s-2*i*k/v,x=e/16*v*(4+e*(4-3*v));n=m,m=f+(1-x)*e*Math.sin(u)*(t+x*r*(w+x*s*(-1+2*w*w)))}if(o==0)return NaN;var y=v*(c*c-d*d)/(d*d),z=1+y/16384*(4096+y*(-768+y*(320-175*y))),A=y/1024*(256+y*(-128+y*(74-47*y))),B=A*r*(w+A/4*(s*(-1+2*w*w)-A/6*w*(-3+4*r*r)*(-3+4*w*w))),C=d*z*(t-B),D=C.toFixed(3)/1e3;return D},OpenLayers.Util.getParameters=function(a){a=a||window.location.href;var b="";if(OpenLayers.String.contains(a,"?")){var c=a.indexOf("?")+1,d=OpenLayers.String.contains(a,"#")?a.indexOf("#"):a.length;b=a.substring(c,d)}var e={},f=b.split(/[&;]/);for(var g=0,h=f.length;g<h;++g){var i=f[g].split("=");if(i[0]){var j=decodeURIComponent(i[0]),k=i[1]||"";k=decodeURIComponent(k.replace(/\+/g," ")).split(","),k.length==1&&(k=k[0]),e[j]=k}}return e},OpenLayers.Util.getArgs=function(a){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Util.getParameters"}));return OpenLayers.Util.getParameters(a)},OpenLayers.Util.lastSeqID=0,OpenLayers.Util.createUniqueID=function(a){a==null&&(a="id_"),OpenLayers.Util.lastSeqID+=1;return a+OpenLayers.Util.lastSeqID},OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36},OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches,OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd,OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m,OpenLayers.METERS_PER_INCH=.0254000508001016,OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:.0254/OpenLayers.METERS_PER_INCH,MicroInch:254e-7/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:.01/OpenLayers.METERS_PER_INCH,Kilometer:1e3/OpenLayers.METERS_PER_INCH,Yard:.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:.1/OpenLayers.METERS_PER_INCH,Millimeter:.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5e4/OpenLayers.METERS_PER_INCH,"150kilometers":15e4/OpenLayers.METERS_PER_INCH}),OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1e3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:OpenLayers.INCHES_PER_UNIT.Meter*100,km:OpenLayers.INCHES_PER_UNIT.Meter*1e3,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH}),OpenLayers.DOTS_PER_INCH=72,OpenLayers.Util.normalizeScale=function(a){var b=a>1?1/a:a;return b},OpenLayers.Util.getResolutionFromScale=function(a,b){var c;if(a){b==null&&(b="degrees");var d=OpenLayers.Util.normalizeScale(a);c=1/(d*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH)}return c},OpenLayers.Util.getScaleFromResolution=function(a,b){b==null&&(b="degrees");var c=a*OpenLayers.INCHES_PER_UNIT[b]*OpenLayers.DOTS_PER_INCH;return c},OpenLayers.Util.safeStopPropagation=function(a){OpenLayers.Event.stop(a,!0)},OpenLayers.Util.pagePosition=function(a){var b=0,c=0,d=a,e=a;while(d){if(d==document.body)if(OpenLayers.Element.getStyle(e,"position")=="absolute")break;b+=d.offsetTop||0,c+=d.offsetLeft||0,e=d;try{d=d.offsetParent}catch(f){OpenLayers.Console.error(OpenLayers.i18n("pagePositionFailed",{elemId:d.id}));break}}d=a;while(d)b-=d.scrollTop||0,c-=d.scrollLeft||0,d=d.parentNode;return[c,b]},OpenLayers.Util.isEquivalentUrl=function(a,b,c){c=c||{},OpenLayers.Util.applyDefaults(c,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0});var d=OpenLayers.Util.createUrlObject(a,c),e=OpenLayers.Util.createUrlObject(b,c);for(var f in d)if(f!=="args")if(d[f]!=e[f])return!1;for(var f in d.args){if(d.args[f]!=e.args[f])return!1;delete e.args[f]}for(var f in e.args)return!1;return!0},OpenLayers.Util.createUrlObject=function(a,b){b=b||{};if(!/^\w+:\/\//.test(a)){var c=window.location,d=c.port?":"+c.port:"",e=c.protocol+"//"+c.host.split(":").shift()+d;if(a.indexOf("/")===0)a=e+a;else{var f=c.pathname.split("/");f.pop(),a=e+f.join("/")+"/"+a}}b.ignoreCase&&(a=a.toLowerCase());var g=document.createElement("a");g.href=a;var h={};h.host=g.host.split(":").shift(),h.protocol=g.protocol,b.ignorePort80?h.port=g.port=="80"||g.port=="0"?"":g.port:h.port=g.port==""||g.port=="0"?"80":g.port,h.hash=b.ignoreHash||g.hash==="#"?"":g.hash;var i=g.search;if(!i){var j=a.indexOf("?");i=j!=-1?a.substr(j):""}h.args=OpenLayers.Util.getParameters(i),h.pathname=g.pathname.charAt(0)=="/"?g.pathname:"/"+g.pathname;return h},OpenLayers.Util.removeTail=function(a){var b=null,c=a.indexOf("?"),d=a.indexOf("#");c==-1?b=d!=-1?a.substr(0,d):a:b=d!=-1?a.substr(0,Math.min(c,d)):a.substr(0,c);return b},OpenLayers.Util.getBrowserName=function(){var a="",b=navigator.userAgent.toLowerCase();b.indexOf("opera")!=-1?a="opera":b.indexOf("msie")!=-1?a="msie":b.indexOf("safari")!=-1?a="safari":b.indexOf("mozilla")!=-1&&(b.indexOf("firefox")!=-1?a="firefox":a="mozilla");return a},OpenLayers.Util.getRenderedDimensions=function(a,b,c){var d,e,f=document.createElement("div");f.style.visibility="hidden";var g=c&&c.containerElement?c.containerElement:document.body;b&&(b.w?(d=b.w,f.style.width=d+"px"):b.h&&(e=b.h,f.style.height=e+"px")),c&&c.displayClass&&(f.className=c.displayClass);var h=document.createElement("div");h.innerHTML=a,h.style.overflow="visible";if(h.childNodes)for(var i=0,j=h.childNodes.length;i<j;i++){if(!h.childNodes[i].style)continue;h.childNodes[i].style.overflow="visible"}f.appendChild(h),g.appendChild(f);var k=!1,l=f.parentNode;while(l&&l.tagName.toLowerCase()!="body"){var m=OpenLayers.Element.getStyle(l,"position");if(m=="absolute"){k=!0;break}if(m&&m!="static")break;l=l.parentNode}k||(f.style.position="absolute"),d||(d=parseInt(h.scrollWidth),f.style.width=d+"px"),e||(e=parseInt(h.scrollHeight)),f.removeChild(h),g.removeChild(f);return new OpenLayers.Size(d,e)},OpenLayers.Util.getScrollbarWidth=function(){var a=OpenLayers.Util._scrollbarWidth;if(a==null){var b=null,c=null,d=0,e=0;b=document.createElement("div"),b.style.position="absolute",b.style.top="-1000px",b.style.left="-1000px",b.style.width="100px",b.style.height="50px",b.style.overflow="hidden",c=document.createElement("div"),c.style.width="100%",c.style.height="200px",b.appendChild(c),document.body.appendChild(b),d=c.offsetWidth,b.style.overflow="scroll",e=c.offsetWidth,document.body.removeChild(document.body.lastChild),OpenLayers.Util._scrollbarWidth=d-e,a=OpenLayers.Util._scrollbarWidth}return a},OpenLayers.Util.getFormattedLonLat=function(a,b,c){c||(c="dms");var d=Math.abs(a),e=Math.floor(d),f=(d-e)/(1/60),g=f;f=Math.floor(f);var h=(g-f)/(1/60);h=Math.round(h*10),h/=10,e<10&&(e="0"+e);var i=e+" ";c.indexOf("dm")>=0&&(f<10&&(f="0"+f),i+=f+"'",c.indexOf("dms")>=0&&(h<10&&(h="0"+h),i+=h+'"')),b=="lon"?i+=a<0?OpenLayers.i18n("W"):OpenLayers.i18n("E"):i+=a<0?OpenLayers.i18n("S"):OpenLayers.i18n("N");return i},OpenLayers.Rico=new Object,OpenLayers.Rico.Corner={round:function(a,b){a=OpenLayers.Util.getElement(a),this._setOptions(b);var c=this.options.color;this.options.color=="fromElement"&&(c=this._background(a));var d=this.options.bgColor;this.options.bgColor=="fromParent"&&(d=this._background(a.offsetParent)),this._roundCornersImpl(a,c,d)},changeColor:function(a,b){a.style.backgroundColor=b;var c=a.parentNode.getElementsByTagName("span");for(var d=0;d<c.length;d++)c[d].style.backgroundColor=b},changeOpacity:function(a,b){var c=b,d="alpha(opacity="+b*100+")";a.style.opacity=c,a.style.filter=d;var e=a.parentNode.getElementsByTagName("span");for(var f=0;f<e.length;f++)e[f].style.opacity=c,e[f].style.filter=d},reRound:function(a,b){var c=a.parentNode.childNodes[0],d=a.parentNode.childNodes[2];a.parentNode.removeChild(c),a.parentNode.removeChild(d),this.round(a.parentNode,b)},_roundCornersImpl:function(a,b,c){this.options.border&&this._renderBorder(a,c),this._isTopRounded()&&this._roundTopCorners(a,b,c),this._isBottomRounded()&&this._roundBottomCorners(a,b,c)},_renderBorder:function(a,b){var c="1px solid "+this._borderColor(b),d="border-left: "+c,e="border-right: "+c,f="style='"+d+";"+e+"'";a.innerHTML="<div "+f+">"+a.innerHTML+"</div>"},_roundTopCorners:function(a,b,c){var d=this._createCorner(c);for(var e=0;e<this.options.numSlices;e++)d.appendChild(this._createCornerSlice(b,c,e,"top"));a.style.paddingTop=0,a.insertBefore(d,a.firstChild)},_roundBottomCorners:function(a,b,c){var d=this._createCorner(c);for(var e=this.options.numSlices-1;e>=0;e--)d.appendChild(this._createCornerSlice(b,c,e,"bottom"));a.style.paddingBottom=0,a.appendChild(d)},_createCorner:function(a){var b=document.createElement("div");b.style.backgroundColor=this._isTransparent()?"transparent":a;return b},_createCornerSlice:function(a,b,c,d){var e=document.createElement("span"),f=e.style;f.backgroundColor=a,f.display="block",f.height="1px",f.overflow="hidden",f.fontSize="1px";var g=this._borderColor(a,b);this.options.border&&c==0?(f.borderTopStyle="solid",f.borderTopWidth="1px",f.borderLeftWidth="0px",f.borderRightWidth="0px",f.borderBottomWidth="0px",f.height="0px",f.borderColor=g):g&&(f.borderColor=g,f.borderStyle="solid",f.borderWidth="0px 1px"),!this.options.compact&&c==this.options.numSlices-1&&(f.height="2px"),this._setMargin(e,c,d),this._setBorder(e,c,d);return e},_setOptions:function(a){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1},OpenLayers.Util.extend(this.options,a||{}),this.options.numSlices=this.options.compact?2:4,this._isTransparent()&&(this.options.blend=!1)},_whichSideTop:function(){if(this._hasString(this.options.corners,"all","top"))return"";if(this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0)return"";if(this.options.corners.indexOf("tl")>=0)return"left";if(this.options.corners.indexOf("tr")>=0)return"right";return""},_whichSideBottom:function(){if(this._hasString(this.options.corners,"all","bottom"))return"";if(this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0)return"";if(this.options.corners.indexOf("bl")>=0)return"left";if(this.options.corners.indexOf("br")>=0)return"right";return""},_borderColor:function(a,b){return a=="transparent"?b:this.options.border?this.options.border:this.options.blend?this._blend(b,a):""},_setMargin:function(a,b,c){var d=this._marginSize(b),e=c=="top"?this._whichSideTop():this._whichSideBottom();e=="left"?(a.style.marginLeft=d+"px",a.style.marginRight="0px"):e=="right"?(a.style.marginRight=d+"px",a.style.marginLeft="0px"):(a.style.marginLeft=d+"px",a.style.marginRight=d+"px")},_setBorder:function(a,b,c){var d=this._borderSize(b),e=c=="top"?this._whichSideTop():this._whichSideBottom();e=="left"?(a.style.borderLeftWidth=d+"px",a.style.borderRightWidth="0px"):e=="right"?(a.style.borderRightWidth=d+"px",a.style.borderLeftWidth="0px"):(a.style.borderLeftWidth=d+"px",a.style.borderRightWidth=d+"px"),this.options.border!=!1&&(a.style.borderLeftWidth=d+"px",a.style.borderRightWidth=d+"px")},_marginSize:function(a){if(this._isTransparent())return 0;var b=[5,3,2,1],c=[3,2,1,0],d=[2,1],e=[1,0];return this.options.compact&&this.options.blend?e[a]:this.options.compact?d[a]:this.options.blend?c[a]:b[a]},_borderSize:function(a){var b=[5,3,2,1],c=[2,1,1,1],d=[1,0],e=[0,2,0,0];if(this.options.compact&&(this.options.blend||this._isTransparent()))return 1;if(this.options.compact)return d[a];if(this.options.blend)return c[a];if(this.options.border)return e[a];if(this._isTransparent())return b[a];return 0},_hasString:function(a){for(var b=1;b<arguments.length;b++)if(a.indexOf(arguments[b])>=0)return!0;return!1},_blend:function(a,b){var c=OpenLayers.Rico.Color.createFromHex(a);c.blend(OpenLayers.Rico.Color.createFromHex(b));return c},_background:function(a){try{return OpenLayers.Rico.Color.createColorFromBackground(a).asHex()}catch(b){return"#ffffff"}},_isTransparent:function(){return this.options.color=="transparent"},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(a){return a.childNodes.length==1&&a.childNodes[0].nodeType==3}},function(){if(!window.google||!google.gears){var a=null;if(typeof GearsFactory!="undefined")a=new GearsFactory;else try{a=new ActiveXObject("Gears.Factory"),a.getBuildInfo().indexOf("ie_mobile")!=-1&&a.privateSetGlobalObject(this)}catch(b){typeof navigator.mimeTypes!="undefined"&&navigator.mimeTypes["application/x-googlegears"]&&(a=document.createElement("object"),a.style.display="none",a.width=0,a.height=0,a.type="application/x-googlegears",document.documentElement.appendChild(a))}if(!a)return;window.google||(google={}),google.gears||(google.gears={factory:a})}}(),OpenLayers.Element={visible:function(a){return OpenLayers.Util.getElement(a).style.display!="none"},toggle:function(){for(var a=0,b=arguments.length;a<b;a++){var c=OpenLayers.Util.getElement(arguments[a]),d=OpenLayers.Element.visible(c)?"hide":"show";OpenLayers.Element[d](c)}},hide:function(){for(var a=0,b=arguments.length;a<b;a++){var c=OpenLayers.Util.getElement(arguments[a]);c.style.display="none"}},show:function(){for(var a=0,b=arguments.length;a<b;a++){var c=OpenLayers.Util.getElement(arguments[a]);c.style.display=""}},remove:function(a){a=OpenLayers.Util.getElement(a),a.parentNode.removeChild(a)},getHeight:function(a){a=OpenLayers.Util.getElement(a);return a.offsetHeight},getDimensions:function(a){a=OpenLayers.Util.getElement(a);if(OpenLayers.Element.getStyle(a,"display")!="none")return{width:a.offsetWidth,height:a.offsetHeight};var b=a.style,c=b.visibility,d=b.position,e=b.display;b.visibility="hidden",b.position="absolute",b.display="";var f=a.clientWidth,g=a.clientHeight;b.display=e,b.position=d,b.visibility=c;return{width:f,height:g}},hasClass:function(a,b){var c=a.className;return!!c&&(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(c)},addClass:function(a,b){OpenLayers.Element.hasClass(a,b)||(a.className+=(a.className?" ":"")+b);return a},removeClass:function(a,b){var c=a.className;c&&(a.className=OpenLayers.String.trim(c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ")));return a},toggleClass:function(a,b){OpenLayers.Element.hasClass(a,b)?OpenLayers.Element.removeClass(a,b):OpenLayers.Element.addClass(a,b);return a},getStyle:function(a,b){a=OpenLayers.Util.getElement(a);var c=null;if(a&&a.style){c=a.style[OpenLayers.String.camelize(b)];if(!c)if(document.defaultView&&document.defaultView.getComputedStyle){var d=document.defaultView.getComputedStyle(a,null);c=d?d.getPropertyValue(b):null}else a.currentStyle&&(c=a.currentStyle[OpenLayers.String.camelize(b)]);var e=["left","top","right","bottom"];window.opera&&OpenLayers.Util.indexOf(e,b)!=-1&&OpenLayers.Element.getStyle(a,"position")=="static"&&(c="auto")}return c=="auto"?null:c}},OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(a,b){this.w=parseFloat(a),this.h=parseFloat(b)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(a){var b=!1;a!=null&&(b=this.w==a.w&&this.h==a.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(a.w)&&isNaN(a.h));return b},CLASS_NAME:"OpenLayers.Size"}),OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(a){alert(a)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"},function(){var a=document.getElementsByTagName("script");for(var b=0,c=a.length;b<c;++b)if(a[b].src.indexOf("firebug.js")!=-1)if(console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}(),OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(a,b,c,d){this.url=a,this.size=b?b:new OpenLayers.Size(20,20),this.offset=c?c:new OpenLayers.Pixel(-(this.size.w/2),-(this.size.h/2)),this.calculateOffset=d;var e=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(e)},destroy:function(){this.erase(),OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild),this.imageDiv.innerHTML="",this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(a){a!=null&&(this.size=a),this.draw()},setUrl:function(a){a!=null&&(this.url=a),this.draw()},draw:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute"),this.moveTo(a);return this.imageDiv},erase:function(){this.imageDiv!=null&&this.imageDiv.parentNode!=null&&OpenLayers.Element.remove(this.imageDiv)},setOpacity:function(a){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,a)},moveTo:function(a){a!=null&&(this.px=a);if(this.imageDiv!=null)if(this.px==null)this.display(!1);else{this.calculateOffset&&(this.offset=this.calculateOffset(this.size));var b=this.px.offset(this.offset);OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,b)}},display:function(a){this.imageDiv.style.display=a?"":"none"},isDrawn:function(){var a=this.imageDiv&&this.imageDiv.parentNode&&this.imageDiv.parentNode.nodeType!=11;return a},CLASS_NAME:"OpenLayers.Icon"}),OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){typeof this.padding=="number"&&(this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding))},panMapIfOutOfView:!1,keepInMap:!1,closeOnMove:!1,map:null,initialize:function(a,b,c,d,e,f){a==null&&(a=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")),this.id=a,this.lonlat=b,this.contentSize=c!=null?c:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT),d!=null&&(this.contentHTML=d),this.backgroundColor=OpenLayers.Popup.COLOR,this.opacity=OpenLayers.Popup.OPACITY,this.border=OpenLayers.Popup.BORDER,this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden"),this.div.className=this.displayClass;var g=this.id+"_GroupDiv";this.groupDiv=OpenLayers.Util.createDiv(g,null,null,null,"relative",null,"hidden");var a=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(a,null,this.contentSize.clone(),null,"relative"),this.contentDiv.className=this.contentDisplayClass,this.groupDiv.appendChild(this.contentDiv),this.div.appendChild(this.groupDiv),e&&this.addCloseBox(f),this.registerEvents()},destroy:function(){this.id=null,this.lonlat=null,this.size=null,this.contentHTML=null,this.backgroundColor=null,this.opacity=null,this.border=null,this.closeOnMove&&this.map&&this.map.events.unregister("movestart",this,this.hide),this.events.destroy(),this.events=null,this.closeDiv&&(OpenLayers.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv)),this.closeDiv=null,this.div.removeChild(this.groupDiv),this.groupDiv=null,this.map!=null&&this.map.removePopup(this),this.map=null,this.div=null,this.autoSize=null,this.minSize=null,this.maxSize=null,this.padding=null,this.panMapIfOutOfView=null},draw:function(a){a==null&&(this.lonlat!=null&&this.map!=null&&(a=this.map.getLayerPxFromLonLat(this.lonlat))),this.closeOnMove&&this.map.events.register("movestart",this,this.hide),!this.disableFirefoxOverflowHack&&OpenLayers.Util.getBrowserName()=="firefox"&&(this.map.events.register("movestart",this,function(){var a=document.defaultView.getComputedStyle(this.contentDiv,null),b=a.getPropertyValue("overflow");b!="hidden"&&(this.contentDiv._oldOverflow=b,this.contentDiv.style.overflow="hidden")}),this.map.events.register("moveend",this,function(){var a=this.contentDiv._oldOverflow;a&&(this.contentDiv.style.overflow=a,this.contentDiv._oldOverflow=null)})),this.moveTo(a),!this.autoSize&&!this.size&&this.setSize(this.contentSize),this.setBackgroundColor(),this.setOpacity(),this.setBorder(),this.setContentHTML(),this.panMapIfOutOfView&&this.panIntoView();return this.div},updatePosition:function(){if(this.lonlat&&this.map){var a=this.map.getLayerPxFromLonLat(this.lonlat);a&&this.moveTo(a)}},moveTo:function(a){a!=null&&this.div!=null&&(this.div.style.left=a.x+"px",this.div.style.top=a.y+"px")},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){OpenLayers.Element.show(this.div),this.panMapIfOutOfView&&this.panIntoView()},hide:function(){OpenLayers.Element.hide(this.div)},setSize:function(a){this.size=a.clone();var b=this.getContentDivPadding(),c=b.left+b.right,d=b.top+b.bottom;this.fixPadding(),c+=this.padding.left+this.padding.right,d+=this.padding.top+this.padding.bottom;if(this.closeDiv){var e=parseInt(this.closeDiv.style.width);c+=e+b.right}this.size.w+=c,this.size.h+=d,OpenLayers.Util.getBrowserName()=="msie"&&(this.contentSize.w+=b.left+b.right,this.contentSize.h+=b.bottom+b.top),this.div!=null&&(this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px"),this.contentDiv!=null&&(this.contentDiv.style.width=a.w+"px",this.contentDiv.style.height=a.h+"px")},updateSize:function(){var a="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",b=this.map?this.map.layerContainerDiv:document.body,c=OpenLayers.Util.getRenderedDimensions(a,null,{displayClass:this.displayClass,containerElement:b}),d=this.getSafeContentSize(c),e=null;if(d.equals(c))e=c;else{var f=new OpenLayers.Size;f.w=d.w<c.w?d.w:null,f.h=d.h<c.h?d.h:null;if(f.w&&f.h)e=d;else{var g=OpenLayers.Util.getRenderedDimensions(a,f,{displayClass:this.contentDisplayClass,containerElement:b}),h=OpenLayers.Element.getStyle(this.contentDiv,"overflow");if(h!="hidden"&&g.equals(d)){var i=OpenLayers.Util.getScrollbarWidth();f.w?g.h+=i:g.w+=i}e=this.getSafeContentSize(g)}}this.setSize(e)},setBackgroundColor:function(a){a!=undefined&&(this.backgroundColor=a),this.div!=null&&(this.div.style.backgroundColor=this.backgroundColor)},setOpacity:function(a){a!=undefined&&(this.opacity=a),this.div!=null&&(this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+this.opacity*100+")")},setBorder:function(a){a!=undefined&&(this.border=a),this.div!=null&&(this.div.style.border=this.border)},setContentHTML:function(a){a!=null&&(this.contentHTML=a),this.contentDiv!=null&&this.contentHTML!=null&&this.contentHTML!=this.contentDiv.innerHTML&&(this.contentDiv.innerHTML=this.contentHTML,this.autoSize&&(this.registerImageListeners(),this.updateSize()))},registerImageListeners:function(){var a=function(){this.popup.updateSize(),this.popup.visible()&&this.popup.panMapIfOutOfView&&this.popup.panIntoView(),OpenLayers.Event.stopObserving(this.img,"load",this.img._onImageLoad)},b=this.contentDiv.getElementsByTagName("img");for(var c=0,d=b.length;c<d;c++){var e=b[c];if(e.width==0||e.height==0){var f={popup:this,img:e};e._onImgLoad=OpenLayers.Function.bind(a,f),OpenLayers.Event.observe(e,"load",e._onImgLoad)}}},getSafeContentSize:function(a){var b=a.clone(),c=this.getContentDivPadding(),d=c.left+c.right,e=c.top+c.bottom;this.fixPadding(),d+=this.padding.left+this.padding.right,e+=this.padding.top+this.padding.bottom;if(this.closeDiv){var f=parseInt(this.closeDiv.style.width);d+=f+c.right}this.minSize&&(b.w=Math.max(b.w,this.minSize.w-d),b.h=Math.max(b.h,this.minSize.h-e)),this.maxSize&&(b.w=Math.min(b.w,this.maxSize.w-d),b.h=Math.min(b.h,this.maxSize.h-e));if(this.map&&this.map.size){var g=0,h=0;if(this.keepInMap&&!this.panMapIfOutOfView){var i=this.map.getPixelFromLonLat(this.lonlat);switch(this.relativePosition){case"tr":g=i.x,h=this.map.size.h-i.y;break;case"tl":g=this.map.size.w-i.x,h=this.map.size.h-i.y;break;case"bl":g=this.map.size.w-i.x,h=i.y;break;case"br":g=i.x,h=i.y;break;default:g=i.x,h=this.map.size.h-i.y}}var j=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-e-h,k=this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-d-g;b.w=Math.min(b.w,k),b.h=Math.min(b.h,j)}return b},getContentDivPadding:function(){var a=this._contentDivPadding;a||(this.div.parentNode==null&&(this.div.style.display="none",document.body.appendChild(this.div)),a=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,"padding-top")),this._contentDivPadding=a,this.div.parentNode==document.body&&(document.body.removeChild(this.div),this.div.style.display=""));return a},addCloseBox:function(a){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,new OpenLayers.Size(17,17)),this.closeDiv.className="olPopupCloseBox";var b=this.getContentDivPadding();this.closeDiv.style.right=b.right+"px",this.closeDiv.style.top=b.top+"px",this.groupDiv.appendChild(this.closeDiv);var c=a||function(a){this.hide(),OpenLayers.Event.stop(a)};OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(c,this))},panIntoView:function(){var a=this.map.getSize(),b=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),c=b.clone();b.x<this.map.paddingForPopups.left?c.x=this.map.paddingForPopups.left:b.x+this.size.w>a.w-this.map.paddingForPopups.right&&(c.x=a.w-this.map.paddingForPopups.right-this.size.w),b.y<this.map.paddingForPopups.top?c.y=this.map.paddingForPopups.top:b.y+this.size.h>a.h-this.map.paddingForPopups.bottom&&(c.y=a.h-this.map.paddingForPopups.bottom-this.size.h);var d=b.x-c.x,e=b.y-c.y;this.map.pan(d,e)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,!0),this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,scope:this})},onmousedown:function(a){this.mousedown=!0,OpenLayers.Event.stop(a,!0)},onmousemove:function(a){this.mousedown&&OpenLayers.Event.stop(a,!0)},onmouseup:function(a){this.mousedown&&(this.mousedown=!1,OpenLayers.Event.stop(a,!0))},onclick:function(a){OpenLayers.Event.stop(a,!0)},onmouseout:function(a){this.mousedown=!1},ondblclick:function(a){OpenLayers.Event.stop(a,!0)},CLASS_NAME:"OpenLayers.Popup"}),OpenLayers.Popup.WIDTH=200,OpenLayers.Popup.HEIGHT=200,OpenLayers.Popup.COLOR="white",OpenLayers.Popup.OPACITY=1,OpenLayers.Popup.BORDER="0px",OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(a){a=a||{},OpenLayers.Util.extend(this,a),this.options=a},mergeWithDefaultFilter:function(a){a?this.defaultFilter&&(a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,a]})):a=this.defaultFilter;return a},destroy:function(){this.options=null,this.format=null},read:function(a){a=a||{},a.filter=this.mergeWithDefaultFilter(a.filter)},create:function(){},update:function(){},"delete":function(){},commit:function(){},abort:function(a){},createCallback:function(a,b,c){return OpenLayers.Function.bind(function(){a.apply(this,[b,c])},this)},CLASS_NAME:"OpenLayers.Protocol"}),OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,reqFeatures:null,priv:null,initialize:function(a){OpenLayers.Util.extend(this,a)},success:function(){return this.code>0},CLASS_NAME:"OpenLayers.Protocol.Response"}),OpenLayers.Protocol.Response.SUCCESS=1,OpenLayers.Protocol.Response.FAILURE=0,OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,initialize:function(a,b){this.container=OpenLayers.Util.getElement(a)},destroy:function(){this.container=null,this.extent=null,this.size=null,this.resolution=null,this.map=null},supported:function(){return!1},setExtent:function(a,b){this.extent=a.clone(),b&&(this.resolution=null)},setSize:function(a){this.size=a.clone(),this.resolution=null},getResolution:function(){this.resolution=this.resolution||this.map.getResolution();return this.resolution},drawFeature:function(a,b){b==null&&(b=a.style);if(a.geometry){var c=a.geometry.getBounds();if(c){c.intersectsBounds(this.extent)||(b={display:"none"});var d=this.drawGeometry(a.geometry,b,a.id);if(b.display!="none"&&b.label&&d!==!1){var e=a.geometry.getCentroid();if(b.labelXOffset||b.labelYOffset){xOffset=isNaN(b.labelXOffset)?0:b.labelXOffset,yOffset=isNaN(b.labelYOffset)?0:b.labelYOffset;var f=this.getResolution();e.move(xOffset*f,yOffset*f)}this.drawText(a.id,b,e)}else this.removeText(a.id);return d}}},drawGeometry:function(a,b,c){},drawText:function(a,b,c){},removeText:function(a){},clear:function(){},getFeatureIdFromEvent:function(a){},eraseFeatures:function(a){a instanceof Array||(a=[a]);for(var b=0,c=a.length;b<c;++b)this.eraseGeometry(a[b].geometry),this.removeText(a[b].id)},eraseGeometry:function(a){},moveRoot:function(a){},getRenderLayerId:function(){return this.container.id},CLASS_NAME:"OpenLayers.Renderer"}),OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(a){OpenLayers.Util.extend(this,a),this.options=a,this.active=!1},destroy:function(){this.deactivate(),this.layer=null,this.options=null},setLayer:function(a){this.layer=a},activate:function(){if(!this.active){this.active=!0;return!0}return!1},deactivate:function(){if(this.active){this.active=!1;return!0}return!1},CLASS_NAME:"OpenLayers.Strategy"}),OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(a,b,c){this.rgb={r:a,g:b,b:c}},setRed:function(a){this.rgb.r=a},setGreen:function(a){this.rgb.g=a},setBlue:function(a){this.rgb.b=a},setHue:function(a){var b=this.asHSB();b.h=a,this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setSaturation:function(a){var b=this.asHSB();b.s=a,this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},setBrightness:function(a){var b=this.asHSB();b.b=a,this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,b.b)},darken:function(a){var b=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,Math.max(b.b-a,0))},brighten:function(a){var b=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(b.h,b.s,Math.min(b.b+a,1))},blend:function(a){this.rgb.r=Math.floor((this.rgb.r+a.rgb.r)/2),this.rgb.g=Math.floor((this.rgb.g+a.rgb.g)/2),this.rgb.b=Math.floor((this.rgb.b+a.rgb.b)/2)},isBright:function(){var a=this.asHSB();return this.asHSB().b>.5},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}}),OpenLayers.Rico.Color.createFromHex=function(a){if(a.length==4){var b=a,a="#";for(var c=1;c<4;c++)a+=b.charAt(c)+b.charAt(c)}a.indexOf("#")==0&&(a=a.substring(1));var d=a.substring(0,2),e=a.substring(2,4),f=a.substring(4,6);return new OpenLayers.Rico.Color(parseInt(d,16),parseInt(e,16),parseInt(f,16))},OpenLayers.Rico.Color.createColorFromBackground=function(a){var b=RicoUtil.getElementsComputedStyle(OpenLayers.Util.getElement(a),"backgroundColor","background-color");if(b=="transparent"&&a.parentNode)return OpenLayers.Rico.Color.createColorFromBackground(a.parentNode);if(b==null)return new OpenLayers.Rico.Color(255,255,255);if(b.indexOf("rgb(")==0){var c=b.substring(4,b.length-1),d=c.split(",");return new OpenLayers.Rico.Color(parseInt(d[0]),parseInt(d[1]),parseInt(d[2]))}return b.indexOf("#")==0?OpenLayers.Rico.Color.createFromHex(b):new OpenLayers.Rico.Color(255,255,255)},OpenLayers.Rico.Color.HSBtoRGB=function(a,b,c){var d=0,e=0,f=0;if(b==0)d=parseInt(c*255+.5),e=d,f=d;else{var g=(a-Math.floor(a))*6,h=g-Math.floor(g),i=c*(1-b),j=c*(1-b*h),k=c*(1-b*(1-h));switch(parseInt(g)){case 0:d=c*255+.5,e=k*255+.5,f=i*255+.5;break;case 1:d=j*255+.5,e=c*255+.5,f=i*255+.5;break;case 2:d=i*255+.5,e=c*255+.5,f=k*255+.5;break;case 3:d=i*255+.5,e=j*255+.5,f=c*255+.5;break;case 4:d=k*255+.5,e=i*255+.5,f=c*255+.5;break;case 5:d=c*255+.5,e=i*255+.5,f=j*255+.5}}return{r:parseInt(d),g:parseInt(e),b:parseInt(f)}},OpenLayers.Rico.Color.RGBtoHSB=function(a,b,c){var d,e,f,g=a>b?a:b;c>g&&(g=c);var h=a<b?a:b;c<h&&(h=c),f=g/255,g!=0?e=(g-h)/g:e=0;if(e==0)d=0;else{var i=(g-a)/(g-h),j=(g-b)/(g-h),k=(g-c)/(g-h);a==g?d=k-j:b==g?d=2+i-k:d=4+j-i,d=d/6,d<0&&(d=d+1)}return{h:d,s:e,b:f}},OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(a,b,c,d){a!=null&&(this.left=OpenLayers.Util.toFloat(a)),b!=null&&(this.bottom=OpenLayers.Util.toFloat(b)),c!=null&&(this.right=OpenLayers.Util.toFloat(c)),d!=null&&(this.top=OpenLayers.Util.toFloat(d))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(a){var b=!1;a!=null&&(b=this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==a.bottom);return b},toString:function(){return"left-bottom=("+this.left+","+this.bottom+") right-top=("+this.right+","+this.top+")"},toArray:function(a){return a===!0?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(a,b){a==null&&(a=6);var c=Math.pow(10,a),d=Math.round(this.left*c)/c,e=Math.round(this.bottom*c)/c,f=Math.round(this.right*c)/c,g=Math.round(this.top*c)/c;return b===!0?e+","+d+","+g+","+f:d+","+e+","+f+","+g},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2));return this.centerLonLat},scale:function(a,b){b==null&&(b=this.getCenterLonLat());var c,d;b.CLASS_NAME=="OpenLayers.LonLat"?(c=b.lon,d=b.lat):(c=b.x,d=b.y);var e=(this.left-c)*a+c,f=(this.bottom-d)*a+d,g=(this.right-c)*a+c,h=(this.top-d)*a+d;return new OpenLayers.Bounds(e,f,g,h)},add:function(a,b){if(a==null||b==null){var c=OpenLayers.i18n("boundsAddError");OpenLayers.Console.error(c);return null}return new OpenLayers.Bounds(this.left+a,this.bottom+b,this.right+a,this.top+b)},extend:function(a){var b=null;if(a){switch(a.CLASS_NAME){case"OpenLayers.LonLat":b=new OpenLayers.Bounds(a.lon,a.lat,a.lon,a.lat);break;case"OpenLayers.Geometry.Point":b=new OpenLayers.Bounds(a.x,a.y,a.x,a.y);break;case"OpenLayers.Bounds":b=a}if(b){this.centerLonLat=null;if(this.left==null||b.left<this.left)this.left=b.left;if(this.bottom==null||b.bottom<this.bottom)this.bottom=b.bottom;if(this.right==null||b.right>this.right)this.right=b.right;if(this.top==null||b.top>this.top)this.top=b.top}}},containsLonLat:function(a,b){return this.contains(a.lon,a.lat,b)},containsPixel:function(a,b){return this.contains(a.x,a.y,b)},contains:function(a,b,c){c==null&&(c=!0);if(a==null||b==null)return!1;a=OpenLayers.Util.toFloat(a),b=OpenLayers.Util.toFloat(b);var d=!1;c?d=a>=this.left&&a<=this.right&&b>=this.bottom&&b<=this.top:d=a>this.left&&a<this.right&&b>this.bottom&&b<this.top;return d},intersectsBounds:function(a,b){b==null&&(b=!0);var c=!1,d=this.left==a.right||this.right==a.left||this.top==a.bottom||this.bottom==a.top;if(b||!d){var e=a.bottom>=this.bottom&&a.bottom<=this.top||this.bottom>=a.bottom&&this.bottom<=a.top,f=a.top>=this.bottom&&a.top<=this.top||this.top>a.bottom&&this.top<a.top,g=a.left>=this.left&&a.left<=this.right||this.left>=a.left&&this.left<=a.right,h=a.right>=this.left&&a.right<=this.right||this.right>=a.left&&this.right<=a.right;c=(e||f)&&(g||h)}return c},containsBounds:function(a,b,c){b==null&&(b=!1),c==null&&(c=!0);var d=this.contains(a.left,a.bottom,c),e=this.contains(a.right,a.bottom,c),f=this.contains(a.left,a.top,c),g=this.contains(a.right,a.top,c);return b?d||e||f||g:d&&e&&f&&g},determineQuadrant:function(a){var b="",c=this.getCenterLonLat();b+=a.lat<c.lat?"b":"t",b+=a.lon<c.lon?"l":"r";return b},transform:function(a,b){this.centerLonLat=null;var c=OpenLayers.Projection.transform({x:this.left,y:this.bottom},a,b),d=OpenLayers.Projection.transform({x:this.right,y:this.bottom},a,b),e=OpenLayers.Projection.transform({x:this.left,y:this.top},a,b),f=OpenLayers.Projection.transform({x:this.right,y:this.top},a,b);this.left=Math.min(c.x,e.x),this.bottom=Math.min(c.y,d.y),this.right=Math.max(d.x,f.x),this.top=Math.max(e.y,f.y);return this},wrapDateLine:function(a,b){b=b||{};var c=b.leftTolerance||0,d=b.rightTolerance||0,e=this.clone();if(a){while(e.left<a.left&&e.right-d<=a.left)e=e.add(a.getWidth(),0);while(e.left+c>=a.right&&e.right>a.right)e=e.add(-a.getWidth(),0)}return e},CLASS_NAME:"OpenLayers.Bounds"}),OpenLayers.Bounds.fromString=function(a){var b=a.split(",");return OpenLayers.Bounds.fromArray(b)},OpenLayers.Bounds.fromArray=function(a){return new OpenLayers.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]))},OpenLayers.Bounds.fromSize=function(a){return new OpenLayers.Bounds(0,a.h,a.w,0)},OpenLayers.Bounds.oppositeQuadrant=function(a){var b="";b+=a.charAt(0)=="t"?"b":"t",b+=a.charAt(1)=="l"?"r":"l";return b},OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(a,b){this.lon=OpenLayers.Util.toFloat(a),this.lat=OpenLayers.Util.toFloat(b)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(a,b){if(a==null||b==null){var c=OpenLayers.i18n("lonlatAddError");OpenLayers.Console.error(c);return null}return new OpenLayers.LonLat(this.lon+a,this.lat+b)},equals:function(a){var b=!1;a!=null&&(b=this.lon==a.lon&&this.lat==a.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(a.lon)&&isNaN(a.lat));return b},transform:function(a,b){var c=OpenLayers.Projection.transform({x:this.lon,y:this.lat},a,b);this.lon=c.x,this.lat=c.y;return this},wrapDateLine:function(a){var b=this.clone();if(a){while(b.lon<a.left)b.lon+=a.getWidth();while(b.lon>a.right)b.lon-=a.getWidth()}return b},CLASS_NAME:"OpenLayers.LonLat"}),OpenLayers.LonLat.fromString=function(a){var b=a.split(",");return new OpenLayers.LonLat(parseFloat(b[0]),parseFloat(b[1]))},OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(a,b){this.x=parseFloat(a),this.y=parseFloat(b)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(a){var b=!1;a!=null&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},add:function(a,b){if(a==null||b==null){var c=OpenLayers.i18n("pixelAddError");OpenLayers.Console.error(c);return null}return new OpenLayers.Pixel(this.x+a,this.y+b)},offset:function(a){var b=this.clone();a&&(b=this.add(a.x,a.y));return b},CLASS_NAME:"OpenLayers.Pixel"}),OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handler:null,eventListeners:null,events:null,EVENT_TYPES:["activate","deactivate"],initialize:function(a){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,""),OpenLayers.Util.extend(this,a),this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),this.id==null&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"))},destroy:function(){this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null),this.eventListeners=null,this.handler&&(this.handler.destroy(),this.handler=null);if(this.handlers){for(var a in this.handlers)this.handlers.hasOwnProperty(a)&&typeof this.handlers[a].destroy=="function"&&this.handlers[a].destroy();this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null)},setMap:function(a){this.map=a,this.handler&&this.handler.setMap(a)},draw:function(a){this.div==null&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),this.title!=""&&(this.div.title=this.title)),a!=null&&(this.position=a.clone()),this.moveTo(this.position);return this.div},moveTo:function(a){a!=null&&this.div!=null&&(this.div.style.left=a.x+"px",this.div.style.top=a.y+"px")},activate:function(){if(this.active)return!1;this.handler&&this.handler.activate(),this.active=!0,this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("activate");return!0},deactivate:function(){if(this.active){this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate");return!0}return!1},CLASS_NAME:"OpenLayers.Control"}),OpenLayers.Control.TYPE_BUTTON=1,OpenLayers.Control.TYPE_TOGGLE=2,OpenLayers.Control.TYPE_TOOL=3,OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){OpenLayers.Lang.code||OpenLayers.Lang.setCode();return OpenLayers.Lang.code},setCode:function(a){var b;a||(a=OpenLayers.Util.getBrowserName()=="msie"?navigator.userLanguage:navigator.language);var c=a.split("-");c[0]=c[0].toLowerCase(),typeof OpenLayers.Lang[c[0]]=="object"&&(b=c[0]);if(c[1]){var d=c[0]+"-"+c[1].toUpperCase();typeof OpenLayers.Lang[d]=="object"&&(b=d)}b||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+c.join("-")+" dictionary, falling back to default language"),b=OpenLayers.Lang.defaultCode),OpenLayers.Lang.code=b},translate:function(a,b){var c=OpenLayers.Lang[OpenLayers.Lang.getCode()],d=c[a];d||(d=a),b&&(d=OpenLayers.String.format(d,b));return d}},OpenLayers.i18n=OpenLayers.Lang.translate,OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(a,b,c,d,e,f,g){var h=[a,b,c,d,f,g];OpenLayers.Popup.prototype.initialize.apply(this,h),this.anchor=e!=null?e:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.anchor=null,this.relativePosition=null,OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition(),OpenLayers.Popup.prototype.show.apply(this,arguments)},moveTo:function(a){var b=this.relativePosition;this.relativePosition=this.calculateRelativePosition(a);var c=this.calculateNewPx(a),d=Array(c);OpenLayers.Popup.prototype.moveTo.apply(this,d),this.relativePosition!=b&&this.updateRelativePosition()},setSize:function(a){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if(this.lonlat&&this.map){var b=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(b)}},calculateRelativePosition:function(a){var b=this.map.getLonLatFromLayerPx(a),c=this.map.getExtent(),d=c.determineQuadrant(b);return OpenLayers.Bounds.oppositeQuadrant(d)},updateRelativePosition:function(){},calculateNewPx:function(a){var b=a.offset(this.anchor.offset),c=this.size||this.contentSize,d=this.relativePosition.charAt(0)=="t";b.y+=d?-c.h:this.anchor.size.h;var e=this.relativePosition.charAt(1)=="l";b.x+=e?-c.w:this.anchor.size.w;return b},CLASS_NAME:"OpenLayers.Popup.Anchored"}),OpenLayers.Protocol.SOS=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.SOS.DEFAULTS);var b=OpenLayers.Protocol.SOS["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported SOS version: "+a.version;return new b(a)},OpenLayers.Protocol.SOS.DEFAULTS={version:"1.0.0"},OpenLayers.Protocol.SQL=OpenLayers.Class(OpenLayers.Protocol,{databaseName:"ol",tableName:"ol_vector_features",postReadFiltering:!0,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a])},destroy:function(){OpenLayers.Protocol.prototype.destroy.apply(this)},supported:function(){return!1},evaluateFilter:function(a,b){return b&&this.postReadFiltering?b.evaluate(a):!0},CLASS_NAME:"OpenLayers.Protocol.SQL"}),OpenLayers.Protocol.WFS=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Protocol.WFS.DEFAULTS);var b=OpenLayers.Protocol.WFS["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFS version: "+a.version;return new b(a)},OpenLayers.Protocol.WFS.fromWMSLayer=function(a,b){var c,d,e=a.params.LAYERS,f=(e instanceof Array?e[0]:e).split(":");f.length>1&&(d=f[0]),c=f.pop();var g={url:a.url,featureType:c,featurePrefix:d,srsName:a.projection&&a.projection.getCode()||a.map&&a.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(b,g))},OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"},OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{canvas:null,features:null,geometryMap:null,initialize:function(a){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.root=document.createElement("canvas"),this.container.appendChild(this.root),this.canvas=this.root.getContext("2d"),this.features={},this.geometryMap={}},eraseGeometry:function(a){this.eraseFeatures(this.features[this.geometryMap[a.id]][0])},supported:function(){var a=document.createElement("canvas");return!!a.getContext},setExtent:function(a){this.extent=a.clone(),this.resolution=null,this.redraw()},setSize:function(a){this.size=a.clone(),this.root.style.width=a.w+"px",this.root.style.height=a.h+"px",this.root.width=a.w,this.root.height=a.h,this.resolution=null},drawFeature:function(a,b){b==null&&(b=a.style),b=OpenLayers.Util.extend({fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1},b),this.features[a.id]=[a,b],a.geometry&&(this.geometryMap[a.geometry.id]=a.id),this.redraw()},drawGeometry:function(a,b){var c=a.CLASS_NAME;if(c=="OpenLayers.Geometry.Collection"||c=="OpenLayers.Geometry.MultiPoint"||c=="OpenLayers.Geometry.MultiLineString"||c=="OpenLayers.Geometry.MultiPolygon")for(var d=0;d<a.components.length;d++)this.drawGeometry(a.components[d],b);else switch(a.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(a,b);break;case"OpenLayers.Geometry.LineString":this.drawLineString(a,b);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(a,b);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(a,b);break;default:}},drawExternalGraphic:function(a,b){var c=new Image;c.src=b.externalGraphic,b.graphicTitle&&(c.title=b.graphicTitle);var d=b.graphicWidth||b.graphicHeight,e=b.graphicHeight||b.graphicWidth;d=d?d:b.pointRadius*2,e=e?e:b.pointRadius*2;var f=b.graphicXOffset!=undefined?b.graphicXOffset:-(.5*d),g=b.graphicYOffset!=undefined?b.graphicYOffset:-(.5*e),h=b.graphicOpacity||b.fillOpacity,i={img:c,x:a[0]+f,y:a[1]+g,width:d,height:e,canvas:this.canvas};c.onload=OpenLayers.Function.bind(function(){this.canvas.drawImage(this.img,this.x,this.y,this.width,this.height)},i)},setCanvasStyle:function(a,b){a=="fill"?(this.canvas.globalAlpha=b.fillOpacity,this.canvas.fillStyle=b.fillColor):a=="stroke"?(this.canvas.globalAlpha=b.strokeOpacity,this.canvas.strokeStyle=b.strokeColor,this.canvas.lineWidth=b.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},drawPoint:function(a,b){if(b.graphic!==!1){var c=this.getLocalXY(a);b.externalGraphic?this.drawExternalGraphic(c,b):(b.fill!==!1&&(this.setCanvasStyle("fill",b),this.canvas.beginPath(),this.canvas.arc(c[0],c[1],b.pointRadius,0,Math.PI*2,!0),this.canvas.fill()),b.stroke!==!1&&(this.setCanvasStyle("stroke",b),this.canvas.beginPath(),this.canvas.arc(c[0],c[1],b.pointRadius,0,Math.PI*2,!0),this.canvas.stroke(),this.setCanvasStyle("reset")))}},drawLineString:function(a,b){if(b.stroke!==!1){this.setCanvasStyle("stroke",b),this.canvas.beginPath();var c=this.getLocalXY(a.components[0]);this.canvas.moveTo(c[0],c[1]);for(var d=1;d<a.components.length;d++){var e=this.getLocalXY(a.components[d]);this.canvas.lineTo(e[0],e[1])}this.canvas.stroke()}this.setCanvasStyle("reset")},drawLinearRing:function(a,b){if(b.fill!==!1){this.setCanvasStyle("fill",b),this.canvas.beginPath();var c=this.getLocalXY(a.components[0]);this.canvas.moveTo(c[0],c[1]);for(var d=1;d<a.components.length-1;d++){var e=this.getLocalXY(a.components[d]);this.canvas.lineTo(e[0],e[1])}this.canvas.fill()}if(b.stroke!==!1){var f=this.canvas.lineWidth;this.setCanvasStyle("stroke",b),this.canvas.beginPath();var c=this.getLocalXY(a.components[0]);this.canvas.moveTo(c[0],c[1]);for(var d=1;d<a.components.length;d++){var e=this.getLocalXY(a.components[d]);this.canvas.lineTo(e[0],e[1])}this.canvas.stroke()}this.setCanvasStyle("reset")},drawPolygon:function(a,b){this.drawLinearRing(a.components[0],b);for(var c=1;c<a.components.length;c++)this.drawLinearRing(a.components[c],{fillOpacity:0,strokeWidth:0,strokeOpacity:0,strokeColor:"#000000",fillColor:"#000000"})},drawText:function(a,b){b=OpenLayers.Util.extend({fontColor:"#000000",labelAlign:"cm"},b);var c=this.getLocalXY(a);this.setCanvasStyle("reset"),this.canvas.fillStyle=b.fontColor,this.canvas.globalAlpha=b.fontOpacity||1;var d=b.fontWeight+" "+b.fontSize+" "+b.fontFamily;if(this.canvas.fillText){var e=OpenLayers.Renderer.Canvas.LABEL_ALIGN[b.labelAlign[0]]||"center";this.canvas.font=d,this.canvas.textAlign=e,this.canvas.fillText(b.label,c[0],c[1])}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=d;var f=this.canvas.mozMeasureText(b.label);switch(b.labelAlign[0]){case"l":break;case"r":c[0]-=f;break;case"c":default:c[0]-=f/2}this.canvas.translate(c[0],c[1]),this.canvas.mozDrawText(b.label),this.canvas.translate(-1*c[0],-1*c[1])}this.setCanvasStyle("reset")},getLocalXY:function(a){var b=this.getResolution(),c=this.extent,d=a.x/b+ -c.left/b,e=c.top/b-a.y/b;return[d,e]},clear:function(){this.canvas.clearRect(0,0,this.root.width,this.root.height)},getFeatureIdFromEvent:function(a){var b=this.map.getLonLatFromPixel(a.xy),c=this.getResolution(),d=new OpenLayers.Bounds(b.lon-c*5,b.lat-c*5,b.lon+c*5,b.lat+c*5),e=d.toGeometry();for(var f in this.features){if(!this.features.hasOwnProperty(f))continue;if(this.features[f][0].geometry.intersects(e))return f}return null},eraseFeatures:function(a){a instanceof Array||(a=[a]);for(var b=0;b<a.length;++b)delete this.features[a[b].id];this.redraw()},redraw:function(){if(!this.locked){this.clear();var a=[],b,c;for(var d in this.features){if(!this.features.hasOwnProperty(d))continue;b=this.features[d][0],c=this.features[d][1];if(!b.geometry)continue;this.drawGeometry(b.geometry,c),c.label&&a.push([b,c])}var e;for(var f=0;len=a.length,f<len;++f)e=a[f],this.drawText(e[0].geometry.getCentroid(),e[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"}),OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right"},OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(a){this.compare=a?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER,this.order=[],this.indices={},this.maxZIndex=0},insert:function(a){this.exists(a)&&this.remove(a);var b=a.id;this.determineZIndex(a);var c=-1,d=this.order.length,e;while(d-c>1){e=parseInt((c+d)/2);var f=this.compare(this,a,OpenLayers.Util.getElement(this.order[e]));f>0?c=e:d=e}this.order.splice(d,0,b),this.indices[b]=this.getZIndex(a);return this.getNextElement(d)},remove:function(a){var b=a.id,c=OpenLayers.Util.indexOf(this.order,b);if(c>=0){this.order.splice(c,1),delete this.indices[b];if(this.order.length>0){var d=this.order[this.order.length-1];this.maxZIndex=this.indices[d]}else this.maxZIndex=0}},clear:function(){this.order=[],this.indices={},this.maxZIndex=0},exists:function(a){return this.indices[a.id]!=null},getZIndex:function(a){return a._style.graphicZIndex},determineZIndex:function(a){var b=a._style.graphicZIndex;b==null?(b=this.maxZIndex,a._style.graphicZIndex=b):b>this.maxZIndex&&(this.maxZIndex=b)},getNextElement:function(a){var b=a+1;if(b<this.order.length){var c=OpenLayers.Util.getElement(this.order[b]);c==undefined&&(c=this.getNextElement(b));return c}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"}),OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(a,b,c){var d=a.getZIndex(b),e=0;if(c){var f=a.getZIndex(c);e=d-f}return e},Z_ORDER_DRAWING_ORDER:function(a,b,c){var d=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);c&&d==0&&(d=1);return d},Z_ORDER_Y_ORDER:function(a,b,c){var d=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(a,b,c);if(c&&d===0){var e=c._boundsBottom-b._boundsBottom;d=e===0?1:e}return d}},OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",minimumSymbolizer:{strokeLinecap:"round",strokeOpacity:1,strokeDashstyle:"solid",fillOpacity:1,pointRadius:0},initialize:function(a,b){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.rendererRoot=this.createRenderRoot(),this.root=this.createRoot("_root"),this.vectorRoot=this.createRoot("_vroot"),this.textRoot=this.createRoot("_troot"),this.root.appendChild(this.vectorRoot),this.root.appendChild(this.textRoot),this.rendererRoot.appendChild(this.root),this.container.appendChild(this.rendererRoot),b&&(b.zIndexing||b.yOrdering)&&(this.indexer=new OpenLayers.ElementsIndexer(b.yOrdering))},destroy:function(){this.clear(),this.rendererRoot=null,this.root=null,this.xmlns=null,OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){if(this.vectorRoot)while(this.vectorRoot.childNodes.length>0)this.vectorRoot.removeChild(this.vectorRoot.firstChild);if(this.textRoot)while(this.textRoot.childNodes.length>0)this.textRoot.removeChild(this.textRoot.firstChild);this.indexer&&this.indexer.clear()},getNodeType:function(a,b){},drawGeometry:function(a,b,c){var d=a.CLASS_NAME,e=!0;if(d=="OpenLayers.Geometry.Collection"||d=="OpenLayers.Geometry.MultiPoint"||d=="OpenLayers.Geometry.MultiLineString"||d=="OpenLayers.Geometry.MultiPolygon"){for(var f=0,g=a.components.length;f<g;f++)e=this.drawGeometry(a.components[f],b,c)&&e;return e}e=!1,b.display!="none"&&(b.backgroundGraphic&&this.redrawBackgroundNode(a.id,a,b,c),e=this.redrawNode(a.id,a,b,c));if(e==!1){var h=document.getElementById(a.id);h&&(h._style.backgroundGraphic&&h.parentNode.removeChild(document.getElementById(a.id+this.BACKGROUND_ID_SUFFIX)),h.parentNode.removeChild(h))}return e},redrawNode:function(a,b,c,d){var e=this.nodeFactory(a,this.getNodeType(b,c));e._featureId=d,e._boundsBottom=b.getBounds().bottom,e._geometryClass=b.CLASS_NAME,e._style=c;var f=this.drawGeometryNode(e,b,c);if(f===!1)return!1;e=f.node;if(this.indexer){var g=this.indexer.insert(e);g?this.vectorRoot.insertBefore(e,g):this.vectorRoot.appendChild(e)}else e.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(e);this.postDraw(e);return f.complete},redrawBackgroundNode:function(a,b,c,d){var e=OpenLayers.Util.extend({},c);e.externalGraphic=e.backgroundGraphic,e.graphicXOffset=e.backgroundXOffset,e.graphicYOffset=e.backgroundYOffset,e.graphicZIndex=e.backgroundGraphicZIndex,e.graphicWidth=e.backgroundWidth||e.graphicWidth,e.graphicHeight=e.backgroundHeight||e.graphicHeight,e.backgroundGraphic=null,e.backgroundXOffset=null,e.backgroundYOffset=null,e.backgroundGraphicZIndex=null;return this.redrawNode(a+this.BACKGROUND_ID_SUFFIX,b,e,null)},drawGeometryNode:function(a,b,c){c=c||a._style,OpenLayers.Util.applyDefaults(c,this.minimumSymbolizer);var d={isFilled:c.fill===undefined?!0:c.fill,isStroked:c.stroke===undefined?!!c.strokeWidth:c.stroke},e;switch(b.CLASS_NAME){case"OpenLayers.Geometry.Point":c.graphic===!1&&(d.isFilled=!1,d.isStroked=!1),e=this.drawPoint(a,b);break;case"OpenLayers.Geometry.LineString":d.isFilled=!1,e=this.drawLineString(a,b);break;case"OpenLayers.Geometry.LinearRing":e=this.drawLinearRing(a,b);break;case"OpenLayers.Geometry.Polygon":e=this.drawPolygon(a,b);break;case"OpenLayers.Geometry.Surface":e=this.drawSurface(a,b);break;case"OpenLayers.Geometry.Rectangle":e=this.drawRectangle(a,b);break;default:}a._options=d;return e!=!1?{node:this.setStyle(a,c,d,b),complete:e}:!1},postDraw:function(a){},drawPoint:function(a,b){},drawLineString:function(a,b){},drawLinearRing:function(a,b){},drawPolygon:function(a,b){},drawRectangle:function(a,b){},drawCircle:function(a,b){},drawSurface:function(a,b){},removeText:function(a){var b=document.getElementById(a+this.LABEL_ID_SUFFIX);b&&this.textRoot.removeChild(b)},getFeatureIdFromEvent:function(a){var b=a.target,c=b&&b.correspondingUseElement,d=c?c:b||a.srcElement,e=d._featureId;return e},eraseGeometry:function(a){if(a.CLASS_NAME=="OpenLayers.Geometry.MultiPoint"||a.CLASS_NAME=="OpenLayers.Geometry.MultiLineString"||a.CLASS_NAME=="OpenLayers.Geometry.MultiPolygon"||a.CLASS_NAME=="OpenLayers.Geometry.Collection")for(var b=0,c=a.components.length;b<c;b++)this.eraseGeometry(a.components[b]);else{var d=OpenLayers.Util.getElement(a.id);if(d&&d.parentNode){d.geometry&&(d.geometry.destroy(),d.geometry=null),d.parentNode.removeChild(d),this.indexer&&this.indexer.remove(d);if(d._style.backgroundGraphic){var e=a.id+this.BACKGROUND_ID_SUFFIX,f=OpenLayers.Util.getElement(e);f&&f.parentNode&&f.parentNode.removeChild(f)}}}},nodeFactory:function(a,b){var c=OpenLayers.Util.getElement(a);c?this.nodeTypeCompare(c,b)||(c.parentNode.removeChild(c),c=this.nodeFactory(a,b)):c=this.createNode(b,a);return c},nodeTypeCompare:function(a,b){},createNode:function(a,b){},moveRoot:function(a){var b=this.root;a.root.parentNode==this.rendererRoot&&(b=a.root),b.parentNode.removeChild(b),a.rendererRoot.appendChild(b)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(a){return a!="circle"&&!!a},CLASS_NAME:"OpenLayers.Renderer.Elements"}),OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]},OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:!1,resolution:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&this.layer.events.on({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this}));return a},cacheFeatures:function(a){var b=!0;this.clustering||(this.clearCache(),this.features=a.features,this.cluster(),b=!1);return b},clearCache:function(){this.features=null},cluster:function(a){if((!a||a.zoomChanged)&&this.features){var b=this.layer.map.getResolution();if(b!=this.resolution||!this.clustersExist()){this.resolution=b;var c=[],d,e,f;for(var g=0;g<this.features.length;++g){d=this.features[g];if(d.geometry){e=!1;for(var h=0;h<c.length;++h){f=c[h];if(this.shouldCluster(f,d)){this.addToCluster(f,d),e=!0;break}}e||c.push(this.createCluster(this.features[g]))}}this.layer.destroyFeatures();if(c.length>0){if(this.threshold>1){var i=c.slice();c=[];var j;for(var g=0,k=i.length;g<k;++g)j=i[g],j.attributes.count<this.threshold?Array.prototype.push.apply(c,j.cluster):c.push(j)}this.clustering=!0,this.layer.addFeatures(c),this.clustering=!1}this.clusters=c}}},clustersExist:function(){var a=!1;if(this.clusters&&this.clusters.length>0&&this.clusters.length==this.layer.features.length){a=!0;for(var b=0;b<this.clusters.length;++b)if(this.clusters[b]!=this.layer.features[b]){a=!1;break}}return a},shouldCluster:function(a,b){var c=a.geometry.getBounds().getCenterLonLat(),d=b.geometry.getBounds().getCenterLonLat(),e=Math.sqrt(Math.pow(c.lon-d.lon,2)+Math.pow(c.lat-d.lat,2))/this.resolution;return e<=this.distance},addToCluster:function(a,b){a.cluster.push(b),a.attributes.count+=1},createCluster:function(a){var b=a.geometry.getBounds().getCenterLonLat(),c=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat),{count:1});c.cluster=[a];return c},CLASS_NAME:"OpenLayers.Strategy.Cluster"}),OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},destroy:function(){OpenLayers.Strategy.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Strategy.prototype.activate.apply(this,arguments)){this.layer.events.on({refresh:this.load,scope:this}),this.layer.visibility==!0||this.preload?this.load():this.layer.events.on({visibilitychanged:this.load,scope:this});return!0}return!1},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,scope:this});return a},load:function(a){this.layer.events.triggerEvent("loadstart"),this.layer.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,filter:this.layer.filter,scope:this},a)),this.layer.events.un({visibilitychanged:this.load,scope:this})},merge:function(a){this.layer.destroyFeatures();var b=a.features;if(b&&b.length>0){var c=this.layer.projection,d=this.layer.map.getProjectionObject();if(!d.equals(c)){var e;for(var f=0,g=b.length;f<g;++f)e=b[f].geometry,e&&e.transform(c,d)}this.layer.addFeatures(b)}this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.Fixed"}),OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:!1,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this});return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this}));return a},cacheFeatures:function(a){this.paging||(this.clearCache(),this.features=a.features,this.pageNext(a))},clearCache:function(){if(this.features)for(var a=0;a<this.features.length;++a)this.features[a].destroy();this.features=null,this.num=null},pageCount:function(){var a=this.features?this.features.length:0;return Math.ceil(a/this.length)},pageNum:function(){return this.num},pageLength:function(a){a&&a>0&&(this.length=a);return this.length},pageNext:function(a){var b=!1;if(this.features){this.num===null&&(this.num=-1);var c=(this.num+1)*this.length;b=this.page(c,a)}return b},pagePrevious:function(){var a=!1;if(this.features){this.num===null&&(this.num=this.pageCount());var b=(this.num-1)*this.length;a=this.page(b)}return a},page:function(a,b){var c=!1;if(this.features)if(a>=0&&a<this.features.length){var d=Math.floor(a/this.length);if(d!=this.num){this.paging=!0;var e=this.features.slice(a,a+this.length);this.layer.removeFeatures(this.layer.features),this.num=d,b&&b.features?b.features=e:this.layer.addFeatures(e),this.paging=!1,c=!0}}return c},CLASS_NAME:"OpenLayers.Strategy.Paging"}),OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{force:!1,interval:0,timer:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&(this.layer.visibility===!0&&this.start(),this.layer.events.on({visibilitychanged:this.reset,scope:this}));return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&this.stop();return a},reset:function(){this.layer.visibility===!0?this.start():this.stop()},start:function(){this.interval&&typeof this.interval==="number"&&this.interval>0&&(this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.interval))},refresh:function(){this.layer&&this.layer.refresh&&typeof this.layer.refresh=="function"&&this.layer.refresh({force:this.force})},stop:function(){this.timer!==null&&(window.clearInterval(this.timer),this.timer=null)},CLASS_NAME:"OpenLayers.Strategy.Refresh"}),OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{EVENT_TYPES:["start","success","fail"],events:null,auto:!1,timer:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a]),this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES)},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&(this.auto&&(typeof this.auto==="number"?this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),this.auto*1e3):this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})));return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.auto&&(typeof this.auto==="number"?window.clearInterval(this.timer):this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})));return a},triggerSave:function(a){var b=a.feature;(b.state===OpenLayers.State.INSERT||b.state===OpenLayers.State.UPDATE||b.state===OpenLayers.State.DELETE)&&this.save([a.feature])},save:function(a){a||(a=this.layer.features),this.events.triggerEvent("start",{features:a});var b=this.layer.projection,c=this.layer.map.getProjectionObject();if(!c.equals(b)){var d=a.length,e=Array(d),f,g;for(var h=0;h<d;++h)f=a[h],g=f.clone(),g.fid=f.fid,g.state=f.state,f.url&&(g.url=f.url),g._original=f,g.geometry.transform(c,b),e[h]=g;a=e}this.layer.protocol.commit(a,{callback:this.onCommit,scope:this})},onCommit:function(a){var b={response:a};if(a.success()){var c=a.reqFeatures,d,e,f=[],g=a.insertIds||[],h=0;for(var i=0,j=c.length;i<j;++i)e=c[i],e=e._original||e,d=e.state,d&&(d==OpenLayers.State.DELETE?f.push(e):d==OpenLayers.State.INSERT&&(e.fid=g[h],++h),e.state=null);f.length>0&&this.layer.destroyFeatures(f),this.events.triggerEvent("success",b)}else this.events.triggerEvent("fail",b)},CLASS_NAME:"OpenLayers.Strategy.Save"}),OpenLayers.Tween=OpenLayers.Class({INTERVAL:10,easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,interval:null,playing:!1,initialize:function(a){this.easing=a?a:OpenLayers.Easing.Expo.easeOut},start:function(a,b,c,d){this.playing=!0,this.begin=a,this.finish=b,this.duration=c,this.callbacks=d.callbacks,this.time=0,this.interval&&(window.clearInterval(this.interval),this.interval=null),this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin),this.interval=window.setInterval(OpenLayers.Function.bind(this.play,this),this.INTERVAL)},stop:function(){this.playing&&(this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),window.clearInterval(this.interval),this.interval=null,this.playing=!1)},play:function(){var a={};for(var b in this.begin){var c=this.begin[b],d=this.finish[b];(c==null||d==null||isNaN(c)||isNaN(d))&&OpenLayers.Console.error("invalid value for Tween");var e=d-c;a[b]=this.easing.apply(this,[this.time,c,e,this.duration])}this.time++,this.callbacks&&this.callbacks.eachStep&&this.callbacks.eachStep.call(this,a),this.time>this.duration&&(this.callbacks&&this.callbacks.done&&(this.callbacks.done.call(this,this.finish),this.playing=!1),window.clearInterval(this.interval),this.interval=null)},CLASS_NAME:"OpenLayers.Tween"}),OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"},OpenLayers.Easing.Linear={easeIn:function(a,b,c,d){return c*a/d+b},easeOut:function(a,b,c,d){return c*a/d+b},easeInOut:function(a,b,c,d){return c*a/d+b},CLASS_NAME:"OpenLayers.Easing.Linear"},OpenLayers.Easing.Expo={easeIn:function(a,b,c,d){return a==0?b:c*Math.pow(2,10*(a/d-1))+b},easeOut:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOut:function(a,b,c,d){if(a==0)return b;if(a==d)return b+c;if((a/=d/2)<1)return c/2*Math.pow(2,10*(a-1))+b;return c/2*(-Math.pow(2,-10*--a)+2)+b},CLASS_NAME:"OpenLayers.Easing.Expo"},OpenLayers.Easing.Quad={easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOut:function(a,b,c,d){if((a/=d/2)<1)return c/2*a*a+b;return-c/2*(--a*(a-2)-1)+b},CLASS_NAME:"OpenLayers.Easing.Quad"},OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b<c;b++){var d=this.map.controls[b];if(d!=this&&d.CLASS_NAME=="OpenLayers.Control.ArgParser"){d.displayProjection!=this.displayProjection&&(this.displayProjection=d.displayProjection);break}}if(b==this.map.controls.length){var e=OpenLayers.Util.getParameters();e.layers&&(this.layers=e.layers,this.map.events.register("addlayer",this,this.configureLayers),this.configureLayers()),e.lat&&e.lon&&(this.center=new OpenLayers.LonLat(parseFloat(e.lon),parseFloat(e.lat)),e.zoom&&(this.zoom=parseInt(e.zoom)),this.map.events.register("changebaselayer",this,this.setCenter),this.setCenter())}},setCenter:function(){this.map.baseLayer&&(this.map.events.unregister("changebaselayer",this,this.setCenter),this.displayProjection&&this.center.transform(this.displayProjection,this.map.getProjectionObject()),this.map.setCenter(this.center,this.zoom))},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var a=0,b=this.layers.length;a<b;a++){var c=this.map.layers[a],d=this.layers.charAt(a);d=="B"?this.map.setBaseLayer(c):(d=="T"||d=="F")&&c.setVisibility(d=="T")}}},CLASS_NAME:"OpenLayers.Control.ArgParser"}),OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this}),this.updateAttribution();return this.div},updateAttribution:function(){var a=[];if(this.map&&this.map.layers){for(var b=0,c=this.map.layers.length;b<c;b++){var d=this.map.layers[b];d.attribution&&d.getVisibility()&&(OpenLayers.Util.indexOf(a,d.attribution)===-1&&a.push(d.attribution))}this.div.innerHTML=a.join(this.separator)}},CLASS_NAME:"OpenLayers.Control.Attribution"}),OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"}),OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{intervals:[45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],displayInLayerSwitcher:!0,visible:!0,numPoints:50,targetSize:200,layerName:"Graticule",labelled:!0,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:.5},labelSymbolizer:{},gratLayer:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]),this.labelSymbolizer.stroke=!1,this.labelSymbolizer.fill=!1,this.labelSymbolizer.label="${label}",this.labelSymbolizer.labelAlign="${labelAlign}",this.labelSymbolizer.labelXOffset="${xOffset}",this.labelSymbolizer.labelYOffset="${yOffset}"},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.gratLayer){var a=new OpenLayers.Style({},{rules:[new OpenLayers.Rule({symbolizer:{Point:this.labelSymbolizer,Line:this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":a}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher}),this.map.addLayer(this.gratLayer)}this.map.events.register("moveend",this,this.update),this.update();return this.div},update:function(){var a=this.map.getExtent();if(a){this.gratLayer.destroyFeatures();var b=new OpenLayers.Projection("EPSG:4326"),c=this.map.getProjectionObject(),d=this.map.getResolution();c.proj&&c.proj.projName=="longlat"&&(this.numPoints=1);var e=this.map.getCenter(),f=new OpenLayers.Pixel(e.lon,e.lat);OpenLayers.Projection.transform(f,c,b);var g=this.targetSize*d;g*=g;var h;for(var i=0;i<this.intervals.length;++i){h=this.intervals[i];var j=h/2,k=f.offset(new OpenLayers.Pixel(-j,-j)),l=f.offset(new OpenLayers.Pixel(j,j));OpenLayers.Projection.transform(k,b,c),OpenLayers.Projection.transform(l,b,c);var m=(k.x-l.x)*(k.x-l.x)+(k.y-l.y)*(k.y-l.y);if(m<=g)break}f.x=Math.floor(f.x/h)*h,f.y=Math.floor(f.y/h)*h;var n=0,o=[f.clone()],p=f.clone(),q;do p=p.offset(new OpenLayers.Pixel(0,h)),q=OpenLayers.Projection.transform(p.clone(),b,c),o.unshift(p);while(a.containsPixel(q)&&++n<1e3);p=f.clone();do p=p.offset(new OpenLayers.Pixel(0,-h)),q=OpenLayers.Projection.transform(p.clone(),b,c),o.push(p);while(a.containsPixel(q)&&++n<1e3);n=0;var r=[f.clone()];p=f.clone();do p=p.offset(new OpenLayers.Pixel(-h,0)),q=OpenLayers.Projection.transform(p.clone(),b,c),r.unshift(p);while(a.containsPixel(q)&&++n<1e3);p=f.clone();do p=p.offset(new OpenLayers.Pixel(h,0)),q=OpenLayers.Projection.transform(p.clone(),b,c),r.push(p);while(a.containsPixel(q)&&++n<1e3);var s=[];for(var i=0;i<r.length;++i){var t=r[i].x,u=[],v=null,w=Math.min(o[0].y,90),x=Math.max(o[o.length-1].y,-90),y=(w-x)/this.numPoints,z=x;for(var A=0;A<=this.numPoints;++A){var B=new OpenLayers.Geometry.Point(t,z);B.transform(b,c),u.push(B),z+=y,B.y>=a.bottom&&!v&&(v=B)}if(this.labelled){var C=new OpenLayers.Geometry.Point(v.x,a.bottom),D={value:t,label:this.labelled?OpenLayers.Util.getFormattedLonLat(t,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(C,D))}var E=new OpenLayers.Geometry.LineString(u);s.push(new OpenLayers.Feature.Vector(E))}for(var A=0;A<o.length;++A){z=o[A].y;if(z<-90||z>90)continue;var u=[],F=r[0].x,G=r[r.length-1].x,H=(G-F)/this.numPoints,t=F,v=null;for(var i=0;i<=this.numPoints;++i){var B=new OpenLayers.Geometry.Point(t,z);B.transform(b,c),u.push(B),t+=H,B.x<a.right&&(v=B)}if(this.labelled){var C=new OpenLayers.Geometry.Point(a.right,v.y),D={value:z,label:this.labelled?OpenLayers.Util.getFormattedLonLat(z,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(C,D))}var E=new OpenLayers.Geometry.LineString(u);s.push(new OpenLayers.Feature.Vector(E))}this.gratLayer.addFeatures(s)}},CLASS_NAME:"OpenLayers.Control.Graticule"}),OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{roundedCorner:!0,roundedCornerColor:"darkblue",layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:!0,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.layerStates=[]},destroy:function(){OpenLayers.Event.stopObservingElement(this.div),OpenLayers.Event.stopObservingElement(this.minimizeDiv),OpenLayers.Event.stopObservingElement(this.maximizeDiv),this.clearLayersArray("base"),this.clearLayersArray("data"),this.map.events.un({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this})},draw:function(){OpenLayers.Control.prototype.draw.apply(this),this.loadContents(),this.outsideViewport||this.minimizeControl(),this.redraw();return this.div},clearLayersArray:function(a){var b=this[a+"Layers"];if(b)for(var c=0,d=b.length;c<d;c++){var e=b[c];OpenLayers.Event.stopObservingElement(e.inputElem),OpenLayers.Event.stopObservingElement(e.labelSpan)}this[a+"LayersDiv"].innerHTML="",this[a+"Layers"]=[]},checkRedraw:function(){var a=!1;if(this.layerStates.length&&this.map.layers.length==this.layerStates.length)for(var b=0,c=this.layerStates.length;b<c;b++){var d=this.layerStates[b],e=this.map.layers[b];if(d.name!=e.name||d.inRange!=e.inRange||d.id!=e.id||d.visibility!=e.visibility){a=!0;break}}else a=!0;return a},redraw:function(){if(!this.checkRedraw())return this.div;this.clearLayersArray("base"),this.clearLayersArray("data");var a=!1,b=!1,c=this.map.layers.length;this.layerStates=Array(c);for(var d=0;d<c;d++){var e=this.map.layers[d];this.layerStates[d]={name:e.name,visibility:e.visibility,inRange:e.inRange,id:e.id}}var f=this.map.layers.slice();this.ascending||f.reverse();for(var d=0,c=f.length;d<c;d++){var e=f[d],g=e.isBaseLayer;if(e.displayInLayerSwitcher){g?b=!0:a=!0;var h=g?e==this.map.baseLayer:e.getVisibility(),i=document.createElement("input");i.id=this.id+"_input_"+e.name,i.name=g?this.id+"_baseLayers":e.name,i.type=g?"radio":"checkbox",i.value=e.name,i.checked=h,i.defaultChecked=h,!g&&!e.inRange&&(i.disabled=!0);var j={inputElem:i,layer:e,layerSwitcher:this};OpenLayers.Event.observe(i,"mouseup",OpenLayers.Function.bindAsEventListener(this.onInputClick,j));var k=document.createElement("span");OpenLayers.Element.addClass(k,"labelSpan"),!g&&!e.inRange&&(k.style.color="gray"),k.innerHTML=e.name,k.style.verticalAlign=g?"bottom":"baseline",OpenLayers.Event.observe(k,"click",OpenLayers.Function.bindAsEventListener(this.onInputClick,j));var l=document.createElement("br"),m=g?this.baseLayers:this.dataLayers;m.push({layer:e,inputElem:i,labelSpan:k});var n=g?this.baseLayersDiv:this.dataLayersDiv;n.appendChild(i),n.appendChild(k),n.appendChild(l)}}this.dataLbl.style.display=a?"":"none",this.baseLbl.style.display=b?"":"none";return this.div},onInputClick:function(a){this.inputElem.disabled||(this.inputElem.type=="radio"?(this.inputElem.checked=!0,this.layer.map.setBaseLayer(this.layer)):(this.inputElem.checked=!this.inputElem.checked,this.layerSwitcher.updateMap())),OpenLayers.Event.stop(a)},onLayerClick:function(a){this.updateMap()},updateMap:function(){for(var a=0,b=this.baseLayers.length;a<b;a++){var c=this.baseLayers[a];c.inputElem.checked&&this.map.setBaseLayer(c.layer,!1)}for(var a=0,b=this.dataLayers.length;a<b;a++){var c=this.dataLayers[a];c.layer.setVisibility(c.inputElem.checked)}},maximizeControl:function(a){this.div.style.width="",this.div.style.height="",this.showControls(!1),a!=null&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.div.style.width="0px",this.div.style.height="0px",this.showControls(!0),a!=null&&OpenLayers.Event.stop(a)},showControls:function(a){this.maximizeDiv.style.display=a?"":"none",this.minimizeDiv.style.display=a?"none":"",this.layersDiv.style.display=a?"none":""},loadContents:function(){OpenLayers.Event.observe(this.div,"mouseup",OpenLayers.Function.bindAsEventListener(this.mouseUp,this)),OpenLayers.Event.observe(this.div,"click",this.ignoreEvent),OpenLayers.Event.observe(this.div,"mousedown",OpenLayers.Function.bindAsEventListener(this.mouseDown,this)),OpenLayers.Event.observe(this.div,"dblclick",this.ignoreEvent),this.layersDiv=document.createElement("div"),this.layersDiv.id=this.id+"_layersDiv",OpenLayers.Element.addClass(this.layersDiv,"layersDiv"),this.baseLbl=document.createElement("div"),this.baseLbl.innerHTML=OpenLayers.i18n("baseLayer"),OpenLayers.Element.addClass(this.baseLbl,"baseLbl"),this.baseLayersDiv=document.createElement("div"),OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv"),this.dataLbl=document.createElement("div"),this.dataLbl.innerHTML=OpenLayers.i18n("overlays"),OpenLayers.Element.addClass(this.dataLbl,"dataLbl"),this.dataLayersDiv=document.createElement("div"),OpenLayers.Element.addClass(this.dataLayersDiv,"dataLayersDiv"),this.ascending?(this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv),this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv)):(this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv),this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv)),this.div.appendChild(this.layersDiv),this.roundedCorner&&(OpenLayers.Rico.Corner.round(this.div,{corners:"tl bl",bgColor:"transparent",color:this.roundedCornerColor,blend:!1}),OpenLayers.Rico.Corner.changeOpacity(this.layersDiv,.75));var a=OpenLayers.Util.getImagesLocation(),b=new OpenLayers.Size(18,18),c=a+"layer-switcher-maximize.png";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,b,c,"absolute"),OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv"),this.maximizeDiv.style.display="none",OpenLayers.Event.observe(this.maximizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.maximizeControl,this)),this.div.appendChild(this.maximizeDiv);var c=a+"layer-switcher-minimize.png",b=new OpenLayers.Size(18,18);this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,b,c,"absolute"),OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv"),this.minimizeDiv.style.display="none",OpenLayers.Event.observe(this.minimizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.minimizeControl,this)),this.div.appendChild(this.minimizeDiv)},ignoreEvent:function(a){OpenLayers.Event.stop(a)},mouseDown:function(a){this.isMouseDown=!0,this.ignoreEvent(a)},mouseUp:function(a){this.isMouseDown&&(this.isMouseDown=!1,this.ignoreEvent(a))},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"}),OpenLayers.Control.MouseDefaults=OpenLayers.Class(OpenLayers.Control,{performedDrag:!1,wheelObserver:null,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.handler&&this.handler.destroy(),this.handler=null,this.map.events.un({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this}),OpenLayers.Event.stopObserving(window,"DOMMouseScroll",this.wheelObserver),OpenLayers.Event.stopObserving(window,"mousewheel",this.wheelObserver),OpenLayers.Event.stopObserving(document,"mousewheel",this.wheelObserver),this.wheelObserver=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){this.map.events.on({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this}),this.registerWheelEvents()},registerWheelEvents:function(){this.wheelObserver=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this),OpenLayers.Event.observe(window,"DOMMouseScroll",this.wheelObserver),OpenLayers.Event.observe(window,"mousewheel",this.wheelObserver),OpenLayers.Event.observe(document,"mousewheel",this.wheelObserver)},defaultClick:function(a){if(OpenLayers.Event.isLeftClick(a)){var b=!this.performedDrag;this.performedDrag=!1;return b}},defaultDblClick:function(a){var b=this.map.getLonLatFromViewPortPx(a.xy);this.map.setCenter(b,this.map.zoom+1),OpenLayers.Event.stop(a);return!1},defaultMouseDown:function(a){OpenLayers.Event.isLeftClick(a)&&(this.mouseDragStart=a.xy.clone(),this.performedDrag=!1,a.shiftKey&&(this.map.div.style.cursor="crosshair",this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red"),this.zoomBox.style.backgroundColor="white",this.zoomBox.style.filter="alpha(opacity=50)",this.zoomBox.style.opacity="0.50",this.zoomBox.style.fontSize="1px",this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox)),document.onselectstart=OpenLayers.Function.False,OpenLayers.Event.stop(a))},defaultMouseMove:function(a){this.mousePosition=a.xy.clone();if(this.mouseDragStart!=null){if(this.zoomBox){var b=Math.abs(this.mouseDragStart.x-a.xy.x),c=Math.abs(this.mouseDragStart.y-a.xy.y);this.zoomBox.style.width=Math.max(1,b)+"px",this.zoomBox.style.height=Math.max(1,c)+"px",a.xy.x<this.mouseDragStart.x&&(this.zoomBox.style.left=a.xy.x+"px"),a.xy.y<this.mouseDragStart.y&&(this.zoomBox.style.top=a.xy.y+"px")}else{var b=this.mouseDragStart.x-a.xy.x,c=this.mouseDragStart.y-a.xy.y,d=this.map.getSize(),e=new OpenLayers.Pixel(d.w/2+b,d.h/2+c),f=this.map.getLonLatFromViewPortPx(e);this.map.setCenter(f,null,!0),this.mouseDragStart=a.xy.clone(),this.map.div.style.cursor="move"}this.performedDrag=!0}},defaultMouseUp:function(a){OpenLayers.Event.isLeftClick(a)&&(this.zoomBox?this.zoomBoxEnd(a):this.performedDrag&&this.map.setCenter(this.map.center),document.onselectstart=null,this.mouseDragStart=null,this.map.div.style.cursor="")},defaultMouseOut:function(a){this.mouseDragStart!=null&&OpenLayers.Util.mouseLeft(a,this.map.div)&&(this.zoomBox&&this.removeZoomBox(),this.mouseDragStart=null)},defaultWheelUp:function(a){this.map.getZoom()<=this.map.getNumZoomLevels()&&this.map.setCenter(this.map.getLonLatFromPixel(a.xy),this.map.getZoom()+1)},defaultWheelDown:function(a){this.map.getZoom()>0&&this.map.setCenter(this.map.getLonLatFromPixel(a.xy),this.map.getZoom()-1)},zoomBoxEnd:function(a){if(this.mouseDragStart!=null){if(Math.abs(this.mouseDragStart.x-a.xy.x)>5||Math.abs(this.mouseDragStart.y-a.xy.y)>5){var b=this.map.getLonLatFromViewPortPx(this.mouseDragStart),c=this.map.getLonLatFromViewPortPx(a.xy),d=Math.max(b.lat,c.lat),e=Math.min(b.lat,c.lat),f=Math.min(b.lon,c.lon),g=Math.max(b.lon,c.lon),h=new OpenLayers.Bounds(f,e,g,d);this.map.zoomToExtent(h)}else{var c=this.map.getLonLatFromViewPortPx(a.xy);this.map.setCenter(new OpenLayers.LonLat(c.lon,c.lat),this.map.getZoom()+1)}this.removeZoomBox()}},removeZoomBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null},onWheelEvent:function(a){var b=!1,c=OpenLayers.Event.element(a);while(c!=null){if(this.map&&c==this.map.div){b=!0;break}c=c.parentNode}if(b){var d=0;a||(a=window.event),a.wheelDelta?(d=a.wheelDelta/120,window.opera&&window.opera.version()<9.2&&(d=-d)):a.detail&&(d=-a.detail/3),d&&(a.xy=this.mousePosition,d<0?this.defaultWheelDown(a):this.defaultWheelUp(a)),OpenLayers.Event.stop(a)}},CLASS_NAME:"OpenLayers.Control.MouseDefaults"}),OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&&this.map.events.unregister("mousemove",this,this.redraw),OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.div.left="",this.div.top="",this.element=this.div),this.redraw();return this.div},redraw:function(a){var b;if(a==null)this.reset();else{if(this.lastXy==null||Math.abs(a.xy.x-this.lastXy.x)>this.granularity||Math.abs(a.xy.y-this.lastXy.y)>this.granularity){this.lastXy=a.xy;return}b=this.map.getLonLatFromPixel(a.xy);if(!b)return;this.displayProjection&&b.transform(this.map.getProjectionObject(),this.displayProjection),this.lastXy=a.xy;var c=this.formatOutput(b);c!=this.element.innerHTML&&(this.element.innerHTML=c)}},reset:function(a){this.emptyString!=null&&(this.element.innerHTML=this.emptyString)},formatOutput:function(a){var b=parseInt(this.numDigits),c=this.prefix+a.lon.toFixed(b)+this.separator+a.lat.toFixed(b)+this.suffix;return c},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.register("mousemove",this,this.redraw),this.map.events.register("mouseout",this,this.reset)},CLASS_NAME:"OpenLayers.Control.MousePosition"}),OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,direction:null,type:OpenLayers.Control.TYPE_BUTTON,initialize:function(a,b){this.direction=a,this.CLASS_NAME+=this.direction,OpenLayers.Control.prototype.initialize.apply(this,[b])},trigger:function(){switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,this.slideFactor);break;case OpenLayers.Control.Pan.WEST:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(this.slideFactor,0)}},CLASS_NAME:"OpenLayers.Control.Pan"}),OpenLayers.Control.Pan.NORTH="North",OpenLayers.Control.Pan.SOUTH="South",OpenLayers.Control.Pan.EAST="East",OpenLayers.Control.Pan.WEST="West",OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(a){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y),OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments),this.removeButtons(),this.buttons=null,this.position=null},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments),a=this.position,this.buttons=[];var b=new OpenLayers.Size(18,18),c=new OpenLayers.Pixel(a.x+b.w/2,a.y);this._addButton("panup","north-mini.png",c,b),a.y=c.y+b.h,this._addButton("panleft","west-mini.png",a,b),this._addButton("panright","east-mini.png",a.add(b.w,0),b),this._addButton("pandown","south-mini.png",c.add(0,b.h*2),b),this._addButton("zoomin","zoom-plus-mini.png",c.add(0,b.h*3+5),b),this._addButton("zoomworld","zoom-world-mini.png",c.add(0,b.h*4+5),b),this._addButton("zoomout","zoom-minus-mini.png",c.add(0,b.h*5+5),b);return this.div},_addButton:function(a,b,c,d){var e=OpenLayers.Util.getImagesLocation()+b,f=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+a,c,d,e,"absolute");this.div.appendChild(f),OpenLayers.Event.observe(f,"mousedown",OpenLayers.Function.bindAsEventListener(this.buttonDown,f)),OpenLayers.Event.observe(f,"dblclick",OpenLayers.Function.bindAsEventListener(this.doubleClick,f)),OpenLayers.Event.observe(f,"click",OpenLayers.Function.bindAsEventListener(this.doubleClick,f)),f.action=a,f.map=this.map;if(this.slideRatio)var i=this.slideRatio,h=function(a){return this.map.getSize()[a]*i};else var g=this.slideFactor,h=function(){return g};f.getSlideFactor=h,this.buttons.push(f);return f},_removeButton:function(a){OpenLayers.Event.stopObservingElement(a),a.map=null,a.getSlideFactor=null,this.div.removeChild(a),OpenLayers.Util.removeItem(this.buttons,a)},removeButtons:function(){for(var a=this.buttons.length-1;a>=0;--a)this._removeButton(this.buttons[a])},doubleClick:function(a){OpenLayers.Event.stop(a);return!1},buttonDown:function(a){if(OpenLayers.Event.isLeftClick(a)){switch(this.action){case"panup":this.map.pan(0,-this.getSlideFactor("h"));break;case"pandown":this.map.pan(0,this.getSlideFactor("h"));break;case"panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case"panright":this.map.pan(this.getSlideFactor("w"),0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent()}OpenLayers.Event.stop(a)}},CLASS_NAME:"OpenLayers.Control.PanZoom"}),OpenLayers.Control.PanZoom.X=4,OpenLayers.Control.PanZoom.Y=4,OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]),this.controls=[]},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var a=this.controls.length-1;a>=0;a--)this.controls[a].events&&this.controls[a].events.un({activate:this.redraw,deactivate:this.redraw,scope:this}),OpenLayers.Event.stopObservingElement(this.controls[a].panel_div),this.controls[a].panel_div=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var a=0,b=this.controls.length;a<b;a++)this.controls[a]==this.defaultControl&&this.controls[a].activate();this.redraw();return!0}return!1},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var a=0,b=this.controls.length;a<b;a++)this.controls[a].deactivate();return!0}return!1},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);for(var a=0,b=this.controls.length;a<b;a++)this.map.addControl(this.controls[a]),this.controls[a].deactivate(),this.controls[a].events.on({activate:this.redraw,deactivate:this.redraw,scope:this});return this.div},redraw:function(){this.div.innerHTML="";if(this.active)for(var a=0,b=this.controls.length;a<b;a++){var c=this.controls[a].panel_div;this.controls[a].active?c.className=this.controls[a].displayClass+"ItemActive":c.className=this.controls[a].displayClass+"ItemInactive",this.div.appendChild(c)}},activateControl:function(a){if(!this.active)return!1;if(a.type==OpenLayers.Control.TYPE_BUTTON)a.trigger(),this.redraw();else{if(a.type==OpenLayers.Control.TYPE_TOGGLE){a.active?a.deactivate():a.activate(),this.redraw();return}for(var b=0,c=this.controls.length;b<c;b++)this.controls[b]!=a&&(this.controls[b].type!=OpenLayers.Control.TYPE_TOGGLE&&this.controls[b].deactivate());a.activate()}},addControls:function(a){a instanceof Array||(a=[a]),this.controls=this.controls.concat(a);for(var b=0,c=a.length;b<c;b++){var d=document.createElement("div");a[b].panel_div=d,a[b].title!=""&&(a[b].panel_div.title=a[b].title),OpenLayers.Event.observe(a[b].panel_div,"click",OpenLayers.Function.bind(this.onClick,this,a[b])),OpenLayers.Event.observe(a[b].panel_div,"dblclick",OpenLayers.Function.bind(this.onDoubleClick,this,a[b])),OpenLayers.Event.observe(a[b].panel_div,"mousedown",OpenLayers.Function.bindAsEventListener(OpenLayers.Event.stop))}if(this.map){for(var b=0,c=a.length;b<c;b++)this.map.addControl(a[b]),a[b].deactivate(),a[b].events.on({activate:this.redraw,deactivate:this.redraw,scope:this});this.redraw()}},onClick:function(a,b){OpenLayers.Event.stop(b?b:window.event),this.activateControl(a)},onDoubleClick:function(a,b){OpenLayers.Event.stop(b?b:window.event)},getControlsBy:function(a,b){var c=typeof b.test=="function",d=OpenLayers.Array.filter(this.controls,function(d){return d[a]==b||c&&b.test(d[a])});return d},getControlsByName:function(a){return this.getControlsBy("name",a)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},CLASS_NAME:"OpenLayers.Control.Panel"}),OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]),this.element=OpenLayers.Util.getElement(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.element=document.createElement("div"),this.div.appendChild(this.element)),this.map.events.register("moveend",this,this.updateScale),this.updateScale();return this.div},updateScale:function(){var a=this.map.getScale();a&&(a<9500||a>95e4?a<95e4?a=Math.round(a):a=Math.round(a/1e6)+"M":a=Math.round(a/1e3)+"K",this.element.innerHTML=OpenLayers.i18n("scale",{scaleDenom:a}))},CLASS_NAME:"OpenLayers.Control.Scale"}),OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!1,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a])},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.eTop){this.eTop=document.createElement("div"),this.eTop.className=this.displayClass+"Top";var a=this.topInUnits.length;this.div.appendChild(this.eTop),this.topOutUnits==""||this.topInUnits==""?this.eTop.style.visibility="hidden":this.eTop.style.visibility="visible",this.eBottom=document.createElement("div"),this.eBottom.className=this.displayClass+"Bottom",this.div.appendChild(this.eBottom),this.bottomOutUnits==""||this.bottomInUnits==""?this.eBottom.style.visibility="hidden":this.eBottom.style.visibility="visible"}this.map.events.register("moveend",this,this.update),this.update();return this.div},getBarLen:function(a){var b=parseInt(Math.log(a)/Math.log(10)),c=Math.pow(10,b),d=parseInt(a/c),e;d>5?e=5:d>2?e=2:e=1;return e*c},update:function(){var a=this.map.getResolution();if(a){var b=this.map.getUnits(),c=OpenLayers.INCHES_PER_UNIT,d=this.maxWidth*a*c[b],e=1;if(this.geodesic===!0){var f=this.getGeodesicLength(this.maxWidth),g=d/c.km;e=f/g,d*=e}var h,i;d>1e5?(h=this.topOutUnits,i=this.bottomOutUnits):(h=this.topInUnits,i=this.bottomInUnits);var j=d/c[h],k=d/c[i],l=this.getBarLen(j),m=this.getBarLen(k);j=l/c[b]*c[h],k=m/c[b]*c[i];var n=j/a/e,o=k/a/e;this.eBottom.style.visibility=="visible"&&(this.eBottom.style.width=Math.round(o)+"px",this.eBottom.innerHTML=m+" "+i),this.eTop.style.visibility=="visible"&&(this.eTop.style.width=Math.round(n)+"px",this.eTop.innerHTML=l+" "+h)}},getGeodesicLength:function(a){var b=this.map,c=b.getPixelFromLonLat(b.getCenter()),d=b.getLonLatFromPixel(c.add(0,-a/2)),e=b.getLonLatFromPixel(c.add(0,a/2)),f=b.getProjectionObject(),g=new OpenLayers.Projection("EPSG:4326");f.equals(g)||(d.transform(f,g),e.transform(f,g));return OpenLayers.Util.distVincenty(d,e)},CLASS_NAME:"OpenLayers.Control.ScaleLine"}),OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomIn()},CLASS_NAME:"OpenLayers.Control.ZoomIn"}),OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomOut()},CLASS_NAME:"OpenLayers.Control.ZoomOut"}),OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map&&this.map.zoomToMaxExtent()},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"}),OpenLayers.Event={observers:!1,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(a){return a.target||a.srcElement},isLeftClick:function(a){return a.which&&a.which==1||a.button&&a.button==1},isRightClick:function(a){return a.which&&a.which==3||a.button&&a.button==2},stop:function(a,b){b||(a.preventDefault?a.preventDefault():a.returnValue=!1),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},findElement:function(a,b){var c=OpenLayers.Event.element(a);while(c.parentNode&&(!c.tagName||c.tagName.toUpperCase()!=b.toUpperCase()))c=c.parentNode;return c},observe:function(a,b,c,d){var e=OpenLayers.Util.getElement(a);d=d||!1,b=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||e.attachEvent)&&(b="keydown"),this.observers||(this.observers={});if(!e._eventCacheID){var f="eventCacheID_";e.id&&(f=e.id+"_"+f),e._eventCacheID=OpenLayers.Util.createUniqueID(f)}var g=e._eventCacheID;this.observers[g]||(this.observers[g]=[]),this.observers[g].push({element:e,name:b,observer:c,useCapture:d}),e.addEventListener?e.addEventListener(b,c,d):e.attachEvent&&e.attachEvent("on"+b,c)},stopObservingElement:function(a){var b=OpenLayers.Util.getElement(a),c=b._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[c])},_removeElementObservers:function(a){if(a)for(var b=a.length-1;b>=0;b--)var c=a[b],d=[c.element,c.name,c.observer,c.useCapture],e=OpenLayers.Event.stopObserving.apply(this,d)},stopObserving:function(a,b,c,d){d=d||!1;var e=OpenLayers.Util.getElement(a),f=e._eventCacheID;if(b=="keypress")if(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||e.detachEvent)b="keydown";var g=!1,h=OpenLayers.Event.observers[f];if(h){var i=0;while(!g&&i<h.length){var j=h[i];if(j.name==b&&j.observer==c&&j.useCapture==d){h.splice(i,1),h.length==0&&delete OpenLayers.Event.observers[f],g=!0;break}i++}}g&&(e.removeEventListener?e.removeEventListener(b,c,d):e&&e.detachEvent&&e.detachEvent("on"+b,c));return g},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var a in OpenLayers.Event.observers){var b=OpenLayers.Event.observers[a];OpenLayers.Event._removeElementObservers.apply(this,[b])}OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"},OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1);if(window.Event)OpenLayers.Util.applyDefaults(window.Event,OpenLayers.Event);else var Event=OpenLayers.Event;OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur"],listeners:null,object:null,element:null,eventTypes:null,eventHandler:null,fallThrough:null,includeXY:!1,clearMouseListener:null,initialize:function(a,b,c,d,e){OpenLayers.Util.extend(this,e),this.object=a,this.fallThrough=d,this.listeners={},this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this),this.eventTypes=[];if(c!=null)for(var f=0,g=c.length;f<g;f++)this.addEventType(c[f]);b!=null&&this.attachToElement(b)},destroy:function(){this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)),this.element=null,this.listeners=null,this.object=null,this.eventTypes=null,this.fallThrough=null,this.eventHandler=null},addEventType:function(a){this.listeners[a]||(this.eventTypes.push(a),this.listeners[a]=[])},attachToElement:function(a){this.element&&OpenLayers.Event.stopObservingElement(this.element),this.element=a;for(var b=0,c=this.BROWSER_EVENTS.length;b<c;b++){var d=this.BROWSER_EVENTS[b];this.addEventType(d),OpenLayers.Event.observe(a,d,this.eventHandler)}OpenLayers.Event.observe(a,"dragstart",OpenLayers.Event.stop)},on:function(a){for(var b in a)b!="scope"&&this.register(b,a.scope,a[b])},register:function(a,b,c){if(c!=null&&OpenLayers.Util.indexOf(this.eventTypes,a)!=-1){b==null&&(b=this.object);var d=this.listeners[a];d.push({obj:b,func:c})}},registerPriority:function(a,b,c){if(c!=null){b==null&&(b=this.object);var d=this.listeners[a];d!=null&&d.unshift({obj:b,func:c})}},un:function(a){for(var b in a)b!="scope"&&this.unregister(b,a.scope,a[b])},unregister:function(a,b,c){b==null&&(b=this.object);var d=this.listeners[a];if(d!=null)for(var e=0,f=d.length;e<f;e++)if(d[e].obj==b&&d[e].func==c){d.splice(e,1);break}},remove:function(a){this.listeners[a]!=null&&(this.listeners[a]=[])},triggerEvent:function(a,b){var c=this.listeners[a];if(c&&c.length!=0){b==null&&(b={}),b.object=this.object,b.element=this.element,b.type||(b.type=a);var c=c.slice(),d;for(var e=0,f=c.length;e<f;e++){var g=c[e];d=g.func.apply(g.obj,[b]);if(d!=undefined&&d==!1)break}this.fallThrough||OpenLayers.Event.stop(b,!0);return d}},handleBrowserEvent:function(a){this.includeXY&&(a.xy=this.getMousePosition(a)),this.triggerEvent(a.type,a)},clearMouseCache:function(){this.element.scrolls=null,this.element.lefttop=null,this.element.offsets=null},getMousePosition:function(a){this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache(),this.element.scrolls||(this.element.scrolls=[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop]),this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]),this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element),this.element.offsets[0]+=this.element.scrolls[0],this.element.offsets[1]+=this.element.scrolls[1]);return new OpenLayers.Pixel(a.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],a.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"}),OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(a){OpenLayers.Util.extend(this,a),this.options=a},destroy:function(){},read:function(a){OpenLayers.Console.userError(OpenLayers.i18n("readNotImplemented"))},write:function(a){OpenLayers.Console.userError(OpenLayers.i18n("writeNotImplemented"))},CLASS_NAME:"OpenLayers.Format"}),OpenLayers.Lang.ar=OpenLayers.Util.applyDefaults({permalink:" ",baseLayer:" ",readNotImplemented:"  .",writeNotImplemented:"  ",errorLoadingGML:"       ${url}",scale:" = 1 : ${scaleDenom}",W:"",E:"",N:"",S:""}),OpenLayers.Lang["be-tarask"]=OpenLayers.Util.applyDefaults({unhandledRequest:"   ${statusText}",permalink:" ",overlays:"",baseLayer:" ",sameProjection:"         ,    ",readNotImplemented:"   .",writeNotImplemented:"   .",noFID:"  ,     FID.",errorLoadingGML:"   GML ${url}",browserNotSupported:"     .    : ${renderers}",componentShouldBe:"addFeatures :    ${geomType}",getFeatureError:"getFeatureFromEvent     .   ,    ,      .",minZoomLevelError:" minZoomLevel         FixedZoomLevels. ,    wfs-   minZoomLevel   .       ,         OL .   ,  minZoomLevel     3.0.  ,     / ,   : http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS-:  ${response}",commitFailed:"WFS-:  ${response}",googleWarning:"    Google. <br><br>   ,          .<br><br>   ,   ,    Google Maps        API-   .<br><br>:  ,     ,   , <a href='http://trac.openlayers.org/wiki/Google' target='_blank'> </a>",getLayerWarning:"   ${layerType}.<br><br>   ,          .<br><br>  ,   ,    ${layerLib}    .<br><br>:  ,     ,   , <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'> </a>",scale:" = 1 : ${scaleDenom}",W:"",E:"",N:"",S:"",layerAlreadyAdded:"    ${layerName}  ,    ",reprojectDeprecated:"   'reproject'   ${layerName}.    :          ,           .     http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"        3.0.  ,    ${newMethod}.",boundsAddError:"     x  y   .",lonlatAddError:"     lon  lat   .",pixelAddError:"     x  y   .",unsupportedGeometryType:"   : ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition failed:     ${elemId}   .",filterEvaluateNotImplemented:"evaluate      ."}),OpenLayers.Lang.bg=OpenLayers.Util.applyDefaults({permalink:" ",baseLayer:" ",errorLoadingGML:"    GML  ${url}",scale:" = 1 : ${scaleDenom}",layerAlreadyAdded:"    ${layerName}  ,     ",methodDeprecated:"         3.0.    ${newMethod}."}),OpenLayers.Lang.br=OpenLayers.Util.applyDefaults({unhandledRequest:"Distro evel reked anveret ${statusText}",permalink:"Peurliamm",overlays:"Gwiskado",baseLayer:"Gwiskad diazez",sameProjection:"Ne'z ar gartenn lec'hia en-dro nemet pa vez hevel ar banndres anezhi ha hini ar gartenn benna",readNotImplemented:"N'eo ket emplementet al lenn.",writeNotImplemented:"N'eo ket emplementet ar skriva.",noFID:"N'haller ket hizivaat un elfenn ma n'eus ket a niverenn-anaout (FID) eviti.",errorLoadingGML:"Fazi e-ser karga ar restr GML ${url}",browserNotSupported:"N'eo ket skoret an daskor vektorel gant ho merdeer. Setu aze an daskorerio skoret evit ar poent :\n${renderers}",componentShouldBe:"addFeatures : bez' e tlefe ar parzh besa eus ar seurt ${geomType}",getFeatureError:"Galvet eo bet getFeatureFromEvent called war ur gwiskad hep daskorer. Kement-se a dalvez ez eus bet freuzet ur gwiskad hag hoc'h eus miret un embreger bennak stag outa.",minZoomLevelError:"Ne zleer implijout ar perzh minZoomLevel nemet evit gwiskado FixedZoomLevels-descendent. Ar fed ma wiria ar gwiskad WHS-se hag-e ez eus eus minZoomLevel zo un aspadenn gozh. Koulskoude n'omp ket evit e ziverka kuit da derri arloado diazezet war OL a c'hallfe beza stag outa. Setu perak eo dispredet -- Lamet kuit e vo ar gwiria minZoomLevel a-is er stumm 3.0. Ober gant an arventenno bihana/brasa evel deskrivet ama e plas : http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Treuzgread WFS : MAT EO ${response}",commitFailed:"Treuzgread WFS Transaction: C'HWITET ${response}",googleWarning:"N'eus ket bet gallet karga ar gwiskad Google ent reizh.<br><br>Evit en em zizober eus ar c'hemenn-ma, dibabit ur BaseLayer nevez en diuzer gwiskado er c'horn deho el laez.<br><br>Sur a-walc'h eo peogwir n'eo ket bet ensoc'het levraoueg Google Maps pe neuze ne glot ket an alc'hwez API gant ho lec'hienn.<br><br>Diorroerien : Evit reizha an dra-se, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>click here</a>",getLayerWarning:"N'haller ket karga ar gwiskad ${layerType} ent reizh.<br><br>Evit en em zizober eus ar c'hemenn-ma, dibabit ur BaseLayer nevez en diuzer gwiskado er c'horn deho el laez.<br><br>Sur a-walc'h eo peogwir n'eo ket bet ensoc'het mat al levraoueg ${layerLib}.<br><br>Diorroerien : Evit gouzout penaos reizha an dra-se, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>click here</a>",scale:"Skeul = 1 : ${scaleDenom}",W:"K",E:"R",N:"N",S:"S",layerAlreadyAdded:"Klasket hoc'h eus ouzhpenna ar gwiskad : ${layerName} d'ar gartenn, met ouzhpennet e oa bet c'hoazh",reprojectDeprecated:"Emaoc'h oc'h implijout an dibarzh 'reproject' war ar gwiskad ${layerName}. Dispredet eo an dibarzh-ma : bet eo hag e talveze da ziskwel roadenno war-c'horre kartenno diazez kenwerzhel, un dra hag a c'haller ober brema gant an arc'hwel dre skor banndres boullek Mercator. Muioc'h a ditouro a c'haller da gaout war http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Dispredet eo an daore-se ha tennet e vo kuit eus ar stumm 3.0. Grit gant ${newMethod} e plas.",boundsAddError:"Rekis eo tremen an div dalvoudenn x ha y d'an arc'hwel add.",lonlatAddError:"Rekis eo tremen an div dalvoudenn hedred ha ledred d'an arc'hwel add.",pixelAddError:"Rekis eo tremen an div dalvoudenn x ha y d'an arc'hwel add.",unsupportedGeometryType:"Seurt mentoniezh anskoret : ${geomType}",pagePositionFailed:"C'hwitet eo OpenLayers.Util.pagePosition : marteze ema lec'hiet fall an elfenn id ${elemId}.",filterEvaluateNotImplemented:"N'eo ket bet emplementet ar prizia evit seurt silo c'hoazh."}),OpenLayers.Lang.el=OpenLayers.Util.applyDefaults({scale:" ~ 1 : ${scaleDenom}"}),OpenLayers.Lang.en={unhandledRequest:"Unhandled request return ${statusText}",permalink:"Permalink",overlays:"Overlays",baseLayer:"Base Layer",sameProjection:"The overview map only works when it is in the same projection as the main map",readNotImplemented:"Read not implemented.",writeNotImplemented:"Write not implemented.",noFID:"Can't update a feature for which there is no FID.",errorLoadingGML:"Error in loading GML file ${url}",browserNotSupported:"Your browser does not support vector rendering. Currently supported renderers are:\n${renderers}",componentShouldBe:"addFeatures : component should be an ${geomType}",getFeatureError:"getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.",minZoomLevelError:"The minZoomLevel property is only intended for use with the FixedZoomLevels-descendent layers. That this wfs layer checks for minZoomLevel is a relic of thepast. We cannot, however, remove it without possibly breaking OL based applications that may depend on it. Therefore we are deprecating it -- the minZoomLevel check below will be removed at 3.0. Please instead use min/max resolution setting as described here: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS Transaction: SUCCESS ${response}",commitFailed:"WFS Transaction: FAILED ${response}",googleWarning:"The Google Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the Google Maps library script was either not included, or does not contain the correct API key for your site.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>click here</a>",getLayerWarning:"The ${layerType} Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the ${layerLib} library script was not correctly included.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>click here</a>",scale:"Scale = 1 : ${scaleDenom}",W:"W",E:"E",N:"N",S:"S",layerAlreadyAdded:"You tried to add the layer: ${layerName} to the map, but it has already been added",reprojectDeprecated:"You are using the 'reproject' option on the ${layerName} layer. This option is deprecated: its use was designed to support displaying data over commercial basemaps, but that functionality should now be achieved by using Spherical Mercator support. More information is available from http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"This method has been deprecated and will be removed in 3.0. Please use ${newMethod} instead.",boundsAddError:"You must pass both x and y values to the add function.",lonlatAddError:"You must pass both lon and lat values to the add function.",pixelAddError:"You must pass both x and y values to the add function.",unsupportedGeometryType:"Unsupported geometry type: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition failed: element with id ${elemId} may be misplaced.",end:"",filterEvaluateNotImplemented:"evaluate is not implemented for this filter type."},OpenLayers.Lang.fi=OpenLayers.Util.applyDefaults({permalink:"Ikilinkki",overlays:"Kerrokset",baseLayer:"Peruskerros",sameProjection:"Yleiskuvakarttaa voi kytt vain, kun sill on sama projektio kuin pkartalla.",W:"L",E:"I",N:"P",S:"E"}),OpenLayers.Lang.fur=OpenLayers.Util.applyDefaults({permalink:"Leam Permanent",overlays:"Livei parsore",baseLayer:"Livel di base",browserNotSupported:"Il to sgarfadr nol supuarte la renderizazion vetoril. Al moment a son supuartts:\n${renderers}",scale:"Scjale = 1 : ${scaleDenom}",W:"O",E:"E",N:"N",S:"S"}),OpenLayers.Lang.gl=OpenLayers.Util.applyDefaults({unhandledRequest:"Solicitude non xerada; a resposta foi: ${statusText}",permalink:"Ligazn permanente",overlays:"Capas superpostas",baseLayer:"Capa base",sameProjection:"A vista xeral do mapa s funciona cando est na mesma proxeccin c mapa principal",readNotImplemented:"Lectura non implementada.",writeNotImplemented:"Escritura non implementada.",noFID:"Non se pode actualizar a funcionalidade para a que non hai FID.",errorLoadingGML:"Erro ao cargar o ficheiro GML $(url)",browserNotSupported:"O seu navegador non soporta a renderizacin de vectores. Os renderizadores soportados actualmente son:\n${renderers}",componentShouldBe:"addFeatures: o compoente debera ser de tipo ${geomType}",getFeatureError:"getFeatureFromEvent ten sido chamado a unha capa sen renderizador. Isto normalmente significa que destruu unha capa, mais non o executador que est asociado con ela.",minZoomLevelError:"A propiedade minZoomLevel  s para uso conxuntamente coas capas FixedZoomLevels-descendent. O feito de que esa capa wfs verifique o minZoomLevel  unha reliquia do pasado. Non podemos, con todo, eliminala sen a posibilidade de non romper as aplicacins baseadas en OL que poidan depender dela. Por iso a estamos deixando obsoleta (a comprobacin minZoomLevel de embaixo ser eliminada na versin 3.0). Por favor, no canto diso use o axuste de resolucin mn/mx tal e como est descrito aqu: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transaccin WFS: XITO ${response}",commitFailed:"Transaccin WFS: FALLIDA ${response}",googleWarning:"A capa do Google non puido cargarse correctamente.<br><br>Para evitar esta mensaxe, escolla unha nova capa base no seleccionador de capas na marxe superior dereita.<br><br>Probablemente, isto acontece porque a escritura da librara do Google Maps ou ben non foi includa ou ben non contn a clave API correcta para o seu sitio.<br><br>Desenvolvedores: para axudar a facer funcionar isto correctamente, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>premede aqu</a>",getLayerWarning:"A capa ${layerType} foi incapaz de cargarse correctamente.<br><br>Para evitar esta mensaxe, escolla unha nova capa base no seleccionador de capas na marxe superior dereita.<br><br>Probablemente, isto acontece porque a escritura da librara ${layerLib} non foi ben includa.<br><br>Desenvolvedores: para axudar a facer funcionar isto correctamente, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>premede aqu</a>",scale:"Escala = 1 : ${scaleDenom}",W:"O",E:"L",N:"N",S:"S",layerAlreadyAdded:"Intentou engadir a capa: ${layerName} ao mapa, pero xa fora engadida",reprojectDeprecated:'Est usando a opcin "reproject" na capa ${layerName}. Esta opcin est obsoleta: o seu uso foi deseado para a visualizacin de datos sobre mapas base comerciais, pero esta funcionalidade debera agora ser obtida utilizando a proxeccin Spherical Mercator. Hai dispoible mis informacin en http://trac.openlayers.org/wiki/SphericalMercator.',methodDeprecated:"Este mtodo est obsoleto e ser eliminado na versin 3.0. Por favor, no canto deste use ${newMethod}.",boundsAddError:"Debe achegar os valores x e y  funcin add.",lonlatAddError:"Debe achegar tanto o valor lon coma o lat  funcin add.",pixelAddError:"Debe achegar os valores x e y  funcin add.",unsupportedGeometryType:"Tipo xeomtrico non soportado: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition fallou: o elemento con id ${elemId} pode non estar na sa posicin.",filterEvaluateNotImplemented:"avaliar non est implementado para este tipo de filtro."}),OpenLayers.Lang.gsw=OpenLayers.Util.applyDefaults({unhandledRequest:"Nit behandleti Aafrogsruckmldig ${statusText}",permalink:"Permalink",overlays:"Iberlagerige",baseLayer:"Grundcharte",sameProjection:"D Ibersichts-Charte funktioniert nume, wnn si di glych Projktion brucht wie d Hauptcharte",readNotImplemented:"Lse nit implementiert.",writeNotImplemented:"Schrybe nit implementiert.",noFID:"E Feature, wu s kei FID derfir git, cha nit aktualisiert wre.",errorLoadingGML:"Fhler bim Lade vu dr GML-Datei ${url}",browserNotSupported:"Dyy Browser unterstitzt kei Vektordarstellig. Aktull unterstitzti Renderer:\n${renderers}",componentShouldBe:"addFeatures : Komponnt sott dr Typ ${geomType} syy",getFeatureError:"getFeatureFromEvent isch uf eme Layer ohni Renderer ufgruefe wore. Des heisst normalerwys, ass Du e Layer kaputt gmacht hesch, aber nit dr Handler, wu derzue ghert.",minZoomLevelError:"D minZoomLevel-Eigeschaft isch nume dnk fir d Layer, wu vu dr FixedZoomLevels abstamme. Ass d wfs-Layer minZoomLevel prieft, scih e Relikt us dr Vergangeheit. Mir chenne s aber nit ndere ohni OL_basierti Aawndige villicht kaputt gehn, wu dervu abhnge.  Us dm Grund het die Funktion d Eigeschaft 'deprecated' iberchuu. D minZoomLevel-Priefig unte wird in dr Version 3.0 usegnuu. Bitte verwnd statt dm e min/max-Uflesig wie s do bschriben isch: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS-Transaktion: ERFOLGRYCH ${response}",commitFailed:"WFS-Transaktion: FHLGSCHLAA ${response}",googleWarning:"Dr Google-Layer het nit korrkt chenne glade wre.<br><br>Go die Mldig nimi z kriege, wehl e andere Hintergrundlayer us em LayerSwitcher im rchte obere Ecke.<br><br>D Fhler git s seli hyfig, wel s Skript vu dr Google-Maps-Bibliothek nit yybunde woren isch oder wel s kei giltige API-Schlissel fir Dyy URL din het.<br><br>Entwickler: Fir Hilf zum korrkte Yybinde vum Google-Layer <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>doo drucke</a>",getLayerWarning:"Dr ${layerType}-Layer het nit korrkt chenne glade wre.<br><br>Go die Mldig nimi z kriege, wehl e andere Hintergrundlayer us em LayerSwitcher im rchte obere Ecke.<br><br>D Fhler git s seli hyfig, wel s Skript vu dr '${layerLib}'-Bibliothek nit yybunde woren isch oder wel s kei giltige API-Schlissel fir Dyy URL din het.<br><br>Entwickler: Fir Hilf zum korrkte Yybinde vu Layer <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>doo drucke</a>",scale:"Mastab = 1 : ${scaleDenom}",W:"W",E:"O",N:"N",S:"S",layerAlreadyAdded:"Du hesch versuecht d Layer in d Charte yyzfiege: ${layerName}, aber r isch schoi yygfiegt",reprojectDeprecated:"Du bruchsch d 'reproject'-Option bim ${layerName}-Layer. Die Option isch nimi giltig: si isch aagleit wore go   Date iber kommerzilli Grundcharte lege, aber des sott mer jetz mache mit dr Unterstitzig vu Spherical Mercator. Meh Informatione git s uf http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Die Methode isch veraltet un wird us dr Version 3.0 usegnuu. Bitte verwbnd statt dm ${newMethod}.",boundsAddError:"Du muesch e x-Wrt un e y-Wrt yygee bi dr Zuefieg-Funktion",lonlatAddError:"Du meusch e Lengi- un e Breiti-Grad yygee bi dr Zuefieg-Funktion.",pixelAddError:"Du muesch x- un y-Wrt aagee bi dr Zuefieg-Funktion.",unsupportedGeometryType:"Nit unterstitze Geometrii-Typ: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition fhlgschlaa: Elemnt mit ID ${elemId} isch villicht falsch gsetzt.",filterEvaluateNotImplemented:"evaluiere isch nit implemntiert in dm Filtertyp."}),OpenLayers.Lang.hr=OpenLayers.Util.applyDefaults({unhandledRequest:"Nepodrani zahtjev ${statusText}",permalink:"Permalink",overlays:"Overlays",baseLayer:"Osnovna karta",sameProjection:"Pregledna karta radi jedino kao je u istoj projekciji kao i glava karta",readNotImplemented:"itanje nije implementirano.",writeNotImplemented:"Pisanje nije implementirano.",noFID:"Ne mogu aurirati znaajku za koju ne postoji FID.",errorLoadingGML:"Greka u uitavanju GML datoteke ${url}",browserNotSupported:"Va preglednik ne podrava vektorsko renderiranje. Trenutno podrani rendereri su: ${renderers}",componentShouldBe:"addFeatures : komponenta bi trebala biti ${geomType}",getFeatureError:"getFeatureFromEvent je pozvao Layer bez renderera. Ovo obino znai da ste unitiili Layer, a ne neki Handler koji je povezan s njim.",commitSuccess:"WFS Transakcija: USPJENA ${response}",commitFailed:"WFS Transakcija: NEUSPJENA ${response}",scale:"Mjerilo = 1 : ${scaleDenom}",layerAlreadyAdded:"Pokuali ste dodati layer:  ${layerName} na kartu, ali je ve dodan",methodDeprecated:"Ova metoda nije odobrena i biti e maknuta u 3.0. Koristite ${newMethod}.",boundsAddError:"Morate dati obje vrijednosti ,  x i y  da bi dodali funkciju.",lonlatAddError:"Morate dati obje vrijednosti , (lon i lat) da bi dodali funkciju.",pixelAddError:"Morate dati obje vrijednosti ,  x i y  da bi dodali funkciju.",unsupportedGeometryType:"Nepodrani tip geometrije: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition nije uspjelo: element sa id ${elemId} moe biti krivo smjeten."}),OpenLayers.Lang.hsb=OpenLayers.Util.applyDefaults({unhandledRequest:"Wotmowa njewobdaneho napraowanja ${statusText}",permalink:"Trajny wotkaz",overlays:"Nawortowanja",baseLayer:"Zakadna runina",sameProjection:"Pehladowa karta jeno funguje, hdy je w samsnej projekciji ka howna karta",readNotImplemented:"itanje njeimplementowane.",writeNotImplemented:"Pisanje njeimplementowane.",noFID:"Funkcija, za kotru FID njeje, njeda so aktualizowa.",errorLoadingGML:"Zmylk pi zaitowanju dataje ${url}",browserNotSupported:"Twj wobhladowak wektorowe rysowanje njepodpruje. Tuchwilu podprowane rysowaki su:\n${renderers}",componentShouldBe:"addFeatures: komponenta ma ${geomType} by",getFeatureError:"getFeatureFromEvent bu na wore bjez rysowak zawoany. To zwjeta woznamjenja, zo sy wortu znii, ale nic wobdak, kotry je z njej zwjazany.",minZoomLevelError:"Kajkos minZoomLevel je jeno za wuiwanje z wortami myslena, kotre wot FixedZoomLevels pochadeja. Zo tuta worta wfs za minZoomLevel pepruwuje, je relikt zadenose. Njememy wak ju wotstroni, bjeztoho zo aplikacije, kotre na OpenLayers bazruja a snano tutu kajkos wuiwaja, hio njefunguja. Tohodla smy ju jako zestarjenu woznamjenili -- pepruwowanje za minZoomLevel budu so we wersiji 3.0 wotstronje. Prou wuij msto toho nastajenje min/max, ka je tu wopisane: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS-Transakcija: WUSPNA ${response}",commitFailed:"WFS-Transakcija: NJEPORADENA ${response}",googleWarning:"Worta Google njemee so korektnje zaita.<br><br>Zo by tutu zdlenku wotby, wubjer nowy BaseLayer z wubra wortow horjeka naprawo.<br><br>Najskerje so to stawa, dokel skript biblioteki Google Maps pak njebu zapijaty pak njewobsahuje korektny klu API za twoje sydo.<br><br>Wuwiwarjo: Za pomoc ke korektnemu fungowanju wortow\n<a href='http://trac.openlayers.org/wiki/Google' target='_blank'>tu klikny</a>",getLayerWarning:"Worta ${layerType} njemee so korektnje zaita.<br><br>Zo by tutu zdlenku wotby, wubjer nowy BaseLayer z wubra wortow horjeka naprawo.<br><br>Najskerje so to stawa, dokel skript biblioteki ${layerLib} njebu korektnje zapijaty.<br><br>Wuwiwarjo: Za pomoc ke korektnemu fungowanju wortow\n<a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>tu klikny</a>",scale:"Mritko = 1 : ${scaleDenom}",W:"Z",E:"W",N:"S",S:"J",layerAlreadyAdded:"Sy spyta runinu ${layerName} kare doda, ale je so hio dodaa",reprojectDeprecated:'Wuiwa opciju "reproject" woty ${layerName}. Tuta opcija je zestarjena: jeje wuiwanje b myslene, zo by zwobraznjenje datow nad komercielnymi bazowymi kartami podprao, ale funkcionalnos ma so ntko z pomocu Sperical Mercator docp. Dale informacije steja na http://trac.openlayers.org/wiki/SphericalMercator k dispoziciji.',methodDeprecated:"Tuta metoda je so njeschwalia a bude so w 3.0 wotstronje. Prou wuij ${newMethod} msto toho.",boundsAddError:'Dyrbi hdnotu x ka te y funkciji "add" pepoda.',lonlatAddError:'Dyrbi hdnotu lon ka te lat funkciji "add" pepoda.',pixelAddError:'Dyrbi hdnotu x ka te y funkciji "add" pepoda.',unsupportedGeometryType:"Njepodprowany geometrijowy typ: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition je so njeporadi: element z id ${elemId} bu snano wopak zamstnjeny.",filterEvaluateNotImplemented:"wuhdnoenje njeje za tutn filtrowy typ implementowany."}),OpenLayers.Lang.hu=OpenLayers.Util.applyDefaults({unhandledRequest:"Nem kezelt krs visszatrse ${statusText}",permalink:"Permalink",overlays:"Rvettsek",baseLayer:"Alaprteg",sameProjection:"Az ttekint trkp csak abban az esetben mkdik, ha ugyanazon a vetleten van, mint a f trkp.",readNotImplemented:"Olvass nincs vgrehajtva.",writeNotImplemented:"rs nincs vgrehajtva.",noFID:"Nem frissthet olyan jellemz, amely nem rendelkezik FID-del.",errorLoadingGML:"Hiba GML-fjl betltsekor ${url}",browserNotSupported:"A bngszje nem tmogatja a vektoros renderelst. A jelenleg tmogatott renderelk:\n${renderers}",componentShouldBe:"addFeatures : az sszetevnek ilyen tpusnak kell lennie: ${geomType}",getFeatureError:"getFeatureFromEvent rteget hvott meg renderel nlkl. Ez rendszerint azt jelenti, hogy megsemmistett egy flit, de nhny ahhoz trstott kezelt nem.",minZoomLevelError:"A minZoomLevel tulajdonsgot csak a kvetkezvel val hasznlatra szntk: FixedZoomLevels-leszrmazott flik. Ez azt jelenti, hogy a minZoomLevel wfs flia jellngyzetei mr a mlt. Mi azonban nem tvolthatjuk el annak a veszlye nlkl, hogy az esetlegesen ettl fgg OL alap alkalmazsokat tnkretennnk. Ezrt ezt rvnytelentjk -- a minZoomLevel az alul lev jellngyzet a 3.0-s verzibl el lesz tvoltva. Krjk, helyette hasznlja a  min/max felbonts belltst, amelyrl az albbi helyen tall lerst: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS tranzakci: SIKERES ${response}",commitFailed:"WFS tranzakci: SIKERTELEN ${response}",googleWarning:"A Google flia betltse sikertelen.<br><br>Ahhoz, hogy ez az zenet eltnjn, vlasszon egy j BaseLayer flit a jobb fels sarokban tallhat fliakapcsol segtsgvel.<br><br>Nagy valsznsggel ez azrt van, mert a Google Maps knyvtr parancsfjlja nem tallhat, vagy nem tartalmazza az n oldalhoz tartoz megfelel API-kulcsot.<br><br>Fejlesztknek: A helyes mkdtetsre vonatkoz segtsg az albbi helyen rhet el, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>kattintson ide</a>",getLayerWarning:"A(z) ${layerType} flia nem tltdtt be helyesen.<br><br>Ahhoz, hogy ez az zenet eltnjn, vlasszon egy j BaseLayer flit a jobb fels sarokban tallhat fliakapcsol segtsgvel.<br><br>Nagy valsznsggel ez azrt van, mert a(z) ${layerLib} knyvtr parancsfjlja helytelen.<br><br>Fejlesztknek: A helyes mkdtetsre vonatkoz segtsg az albbi helyen rhet el, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>kattintson ide</a>",scale:"Lptk = 1 : ${scaleDenom}",W:"Ny",E:"K",N:"",S:"D",layerAlreadyAdded:"Megprblta hozzadni a(z) ${layerName} flit a trkphez, de az mr hozz van adva",reprojectDeprecated:"n a 'reproject' belltst hasznlja a(z) ${layerName} flin. Ez a bellts rvnytelen: hasznlata az zleti alaptrkpek fltti adatok megjelentsnek tmogatsra szolglt, de ezt a funkci ezentl a Gmbi Mercator hasznlatval rhet el. Tovbbi informci az albbi helyen rhet el: http://trac.openlayers.org/wiki/SphericalMercator",methodDeprecated:"Ez a mdszer rvnytelentve lett s a 3.0-s verzibl el lesz tvoltva. Hasznlja a(z) ${newMethod} mdszert helyette.",boundsAddError:"Az x s y rtkeknek egyarnt meg kell felelnie, hogy a funkcit hozzadhassa.",lonlatAddError:"A hossz. s szl. rtkeknek egyarnt meg kell felelnie, hogy a funkcit hozzadhassa.",pixelAddError:"Az x s y rtkeknek egyarnt meg kell felelnie, hogy a funkcit hozzadhassa.",unsupportedGeometryType:"Nem tmogatott geometriatpus: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition sikertelen: lehetsges, hogy a(z) ${elemId} azonostj elem tves helyre kerlt.",filterEvaluateNotImplemented:"ennl a szrtpusnl kirtkels nem hajtdik vgre."}),OpenLayers.Lang.ia=OpenLayers.Util.applyDefaults({unhandledRequest:"Le responsa a un requesta non esseva maneate: ${statusText}",permalink:"Permaligamine",overlays:"Superpositiones",baseLayer:"Strato de base",sameProjection:"Le mini-carta functiona solmente si illo es in le mesme projection que le carta principal",readNotImplemented:"Lectura non implementate.",writeNotImplemented:"Scriptura non implementate.",noFID:"Non pote actualisar un elemento sin FID.",errorLoadingGML:"Error al cargamento del file GML ${url}",browserNotSupported:"Tu navigator non supporta le rendition de vectores. Le renditores actualmente supportate es:\n${renderers}",componentShouldBe:"addFeatures: le componente debe esser del typo ${geomType}",getFeatureError:"getFeatureFromEvent ha essite appellate in un strato sin renditor. Isto significa generalmente que tu ha destruite un strato, ma lassava un gestor associate con illo.",minZoomLevelError:"Le proprietate minZoomLevel es solmente pro uso con le stratos descendente de FixedZoomLevels. Le facto que iste strato WFS verifica minZoomLevel es un reliquia del passato. Nonobstante, si nos lo remove immediatemente, nos pote rumper applicationes a base de OL que depende de illo. Ergo nos lo declara obsolete; le verification de minZoomLevel in basso essera removite in version 3.0. Per favor usa in su loco le configuration de resolutiones min/max como describite a: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transaction WFS: SUCCESSO ${response}",commitFailed:"Transaction WFS: FALLEVA ${response}",googleWarning:"Le strato Google non poteva esser cargate correctemente.<br><br>Pro disfacer te de iste message, selige un nove BaseLayer in le selector de strato in alto a dextra.<br><br>Multo probabilemente, isto es proque le script del libreria de Google Maps non esseva includite o non contine le clave API correcte pro tu sito.<br><br>Disveloppatores: Pro adjuta de corriger isto, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>clicca hic</a",getLayerWarning:"Le strato ${layerType} non poteva esser cargate correctemente.<br><br>Pro disfacer te de iste message, selige un nove BaseLayer in le selector de strato in alto a dextra.<br><br>Multo probabilemente, isto es proque le script del libreria de ${layerLib} non esseva correctemente includite.<br><br>Disveloppatores: Pro adjuta de corriger isto, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>clicca hic</a>",scale:"Scala = 1 : ${scaleDenom}",W:"W",E:"E",N:"N",S:"S",layerAlreadyAdded:"Tu tentava adder le strato: ${layerName} al carta, ma illo es ja presente",reprojectDeprecated:"Tu usa le option 'reproject' in le strato ${layerName} layer. Iste option es obsolescente: illo esseva pro poter monstrar datos super cartas de base commercial, ma iste functionalitate pote ora esser attingite con le uso de Spherical Mercator. Ulterior information es disponibile a http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Iste methodo ha essite declarate obsolescente e essera removite in version 3.0. Per favor usa ${newMethod} in su loco.",boundsAddError:"Tu debe passar le duo valores x e y al function add.",lonlatAddError:"Tu debe passar le duo valores lon e lat al function add.",pixelAddError:"Tu debe passar le duo valores x e y al function add.",unsupportedGeometryType:"Typo de geometria non supportate: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition falleva: le elemento con id ${elemId} pote esser mal placiate.",filterEvaluateNotImplemented:'"evaluate" non es implementate pro iste typo de filtro.'}),OpenLayers.Lang.id=OpenLayers.Util.applyDefaults({unhandledRequest:"Permintaan yang tak tertangani menghasilkan ${statusText}",permalink:"Pranala permanen",overlays:"Hamparan",baseLayer:"Lapisan Dasar",sameProjection:"Peta tinjauan hanya bekerja bila dalam proyeksi yang sama dengan peta utama",readNotImplemented:"Membaca tidak diterapkan.",writeNotImplemented:"Menyimpan tidak diterapkan.",noFID:"Tidak dapat memperbarui fitur yang tidak memiliki FID.",errorLoadingGML:"Kesalahan dalam memuat berkas GML ${url}",browserNotSupported:"Peramban Anda tidak mendukung penggambaran vektor. Penggambar yang didukung saat ini adalah:\n${renderers}",componentShouldBe:"addFeatures : komponen harus berupa ${geomType}",getFeatureError:"getFeatureFromEvent diterapkan pada lapisan tanpa penggambar. Ini biasanya berarti Anda menghapus sebuah lapisan, tetapi tidak menghapus penangan yang terkait dengannya.",minZoomLevelError:"Properti minZoomLevel hanya ditujukan bekerja dengan lapisan FixedZoomLevels-descendent. Pengecekan minZoomLevel oleh lapisan wfs adalah peninggalan masa lalu. Kami tidak dapat menghapusnya tanpa kemungkinan merusak aplikasi berbasis OL yang mungkin bergantung padanya. Karenanya, kami menganggapnya tidak berlaku -- Cek minZoomLevel di bawah ini akan dihapus pada 3.0. Silakan gunakan penyetelan resolusi min/maks seperti dijabarkan di sini: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS Transaksi: BERHASIL ${respon}",commitFailed:"WFS Transaksi: GAGAL ${respon}",googleWarning:"Lapisan Google tidak dapat dimuat dengan benar.<br><br>Untuk menghilangkan pesan ini, pilih suatu BaseLayer baru melalui penukar lapisan (layer switcher) di ujung kanan atas.<br><br>Kemungkinan besar ini karena pustaka skrip Google Maps tidak disertakan atau tidak mengandung kunci API yang tepat untuk situs Anda.<br><br>Pengembang: Untuk bantuan mengatasi masalah ini, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>klik di sini</a>",getLayerWarning:"Lapisan ${layerType} tidak dapat dimuat dengan benar.<br><br>Untuk menghilangkan pesan ini, pilih suatu BaseLayer baru melalui penukar lapisan (layer switcher) di ujung kanan atas.<br><br>Kemungkinan besar ini karena pustaka skrip Google Maps tidak disertakan dengan benar.<br><br>Pengembang: Untuk bantuan mengatasi masalah ini, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>klik di sini</a>",scale:"Sekala = 1 : $(sekala Denom)",W:"B",E:"T",N:"U",S:"S",layerAlreadyAdded:"Anda mencoba menambahkan lapisan: ${layerName} ke dalam peta, tapi lapisan itu telah ditambahkan",reprojectDeprecated:"Anda menggunakan opsi 'reproject' pada lapisan ${layerName}. Opsi ini telah ditinggalkan: penggunaannya dirancang untuk mendukung tampilan data melalui peta dasar komersial, tapi fungsionalitas tersebut saat ini harus dilakukan dengan menggunakan dukungan Spherical Mercator. Informasi lebih lanjut tersedia di http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Metode ini telah usang dan akan dihapus di 3.0. Sebaliknya, harap gunakan ${newMethod}.",boundsAddError:"Anda harus memberikan kedua nilai x dan y ke fungsi penambah.",lonlatAddError:"Anda harus memberikan kedua nilai lon dan lat ke fungsi penambah.",pixelAddError:"Anda harus memberikan kedua nilai x dan y ke fungsi penambah.",unsupportedGeometryType:"Tipe geometri tak didukung: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition gagal: elemen dengan id ${elemId} mungkin salah tempat.",filterEvaluateNotImplemented:"evaluasi tidak tersedia untuk tipe filter ini."}),OpenLayers.Lang.io=OpenLayers.Util.applyDefaults({scale:"Skalo = 1 : ${scaleDenom}"}),OpenLayers.Lang.is=OpenLayers.Util.applyDefaults({permalink:"Varanlegur tengill",overlays:"ekjur",baseLayer:"Grunnlag",sameProjection:"Yfirlitskorti virkar aeins ef a er  smu vrpun og aalkorti",readNotImplemented:"Skrifun er tfr.",writeNotImplemented:"Lestur er tfrur.",errorLoadingGML:"Villa kom upp vi a hlaa inn GML skrnni ${url}",scale:"Skali = 1 : ${scaleDenom}",layerAlreadyAdded:" reyndir a bta laginu ${layerName}  korti en a er egar bi a bta v vi",methodDeprecated:"etta fall hefur veri relt og verur fjarlgt  3.0. Notau ${newMethod}  stain."}),OpenLayers.Lang.ja=OpenLayers.Util.applyDefaults({unhandledRequest:" ${statusText} ",permalink:"",overlays:"",baseLayer:"",sameProjection:"",readNotImplemented:"",writeNotImplemented:"",noFID:"FID ",errorLoadingGML:"GML  ${url} ",browserNotSupported:"\n${renderers}",componentShouldBe:"addFeatures:  ${geomType} ",getFeatureError:"getFeatureFromEvent ",minZoomLevelError:"minZoomLevel  FixedZoomLevels  minZoomLevel  WFS  OpenLayers  minZoomLevel 3.0http://trac.openlayers.org/wiki/SettingZoomLevels ",commitSuccess:"WFS :  ${response}",commitFailed:"WFS :  ${response}",googleWarning:"Google <br><br><br><br> Google  API <br><br>: <a href='http://trac.openlayers.org/wiki/Google' target='_blank'></a>",getLayerWarning:"${layerType} <br><br><br><br> ${layerLib} <br><br>: <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'></a>",scale:" = 1 : ${scaleDenom}",W:"",E:"",N:"",S:"",layerAlreadyAdded:"${layerName}",reprojectDeprecated:"${layerName} reproject  Spherical Mercator  http://trac.openlayers.org/wiki/SphericalMercator ",methodDeprecated:"3.0 ${newMethod} ",boundsAddError:"x  y  add ",lonlatAddError:"lon  lat  add ",pixelAddError:"x  y  add ",unsupportedGeometryType:": ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition : id ${elemId} ",filterEvaluateNotImplemented:" evaluate "}),OpenLayers.Lang.km=OpenLayers.Util.applyDefaults({permalink:"",baseLayer:"",errorLoadingGML:" GML ${url}",scale:" =   ${scaleDenom}"}),OpenLayers.Lang.ksh=OpenLayers.Util.applyDefaults({unhandledRequest:"Met d Antwoot op en Aanfrooch ham_mer nix aanjefange: ${statusText}",permalink:"Lengk op Duuer",overlays:"Drvver jelaat",baseLayer:"Jrund-Nivoh",sameProjection:"De vverseeschs_Kaat deiht et blo, wann se de slve Projxjuhn bruche deiht, wi de Houp_Kaat",readNotImplemented:'<code lang="en">read</code> is em Projramm nit frjesinn.',writeNotImplemented:'<code lang="en">write</code> is em Projramm nit frjesinn.',noFID:'En Saach, woh kein <i lang="en">FID</i> fr doh es, lht sesch nit ndere.',errorLoadingGML:'Fhler beim <i lang="en">GML</i>-Datei-Laade vun <code>${url}</code>',browserNotSupported:"Dinge Brauser kann kein Vktore ujvve. De Zoote Ujaabe, di em Momang jon, sen:\n${renderers}",componentShouldBe:'<code lang="en">addFeatures</code>: d Aandeil sullt vun d Zoot <code lang="en">${geomType}</code> sin.',getFeatureError:'<code lang="en">getFeatureFromEvent</code> es vun enem Nivoh opjeroofe woode, woh et kei Projramm zom Ujvve jit. Dat bedgg fr jewhnlesch, dat De e Nivoh kapott jemaat hs, vver nit e Projramm fr domet mzejonn, wat domet verbonge es.',minZoomLevelError:'De Eijeschaff <code lang="en">minZoomLevel</code> es blo dofr jedaach, dat mer se met d Nivvoh bruch, di vun <code lang="en">FixedZoomLevels</code> affhange don. Dat dat <i lang="en">WFS</i>-Nivvoh vverhoup de Eijeschaff <code lang="en">minZoomLevel</code> prhfe deiht, es noch vveresch vun frhjer. Mer knne dat vver jez nit fott lohe, oohne dat mer Jevaa loufe, dat Aanwendunge vun OpenLayers nit mieh loufe, di sesch doh velleijsch noch drop am verlohe sin. Drm sare mer, dat mer et nit mieh han welle, un de <code lang="en">minZoomLevel</code>-Eijeschaff weed hee vun de Version 3.0 af nit mieh jeprf wde. Nemm dofr de Enstellung fr de hhte un de kleinte Oplhsung, esu wi et en http://trac.openlayers.org/wiki/SettingZoomLevels opjeschrevve es.',commitSuccess:'D <i lang="en">WFS</i>-Vrjang es joot jeloufe: ${response}',commitFailed:'D <i lang="en">WFS</i>-Vrjang es scheif jejange: ${response}',googleWarning:'Dat Nivvoh <code lang="en">Google</code> kunnt nit reschtesch jelaade wde.<br /><br />m hee di Nohreesch lo ze krijje, donn en ander Jrund-Nivvoh ushke, rh bovve en de k.<br /><br />Wascheinlesch es dat wiel dat <i lang="en">Google-Maps</i>-Skrepp entweeder nit reschtesch enjebonge wood, udder nit d reschtejje <i lang="en">API</i>-Schlel fr Ding Web-ait scheke deiht.<br /><br />Fr Projrammierer jidd_et Hlp do_drvver, <a href="http://trac.openlayers.org/wiki/Google" target="_blank">wi mer dat aan et Loufe brengk</a>.',getLayerWarning:'Dat Nivvoh <code>${layerType}</code> kunnt nit reschtesch jelaade wde.<br /><br />m hee di Nohreesch lo ze krijje, donn en ander Jrund-Nivvoh ushkre, rh bovve en de k.<br /><br />Wascheinlesch es dat, wiel dat Skrepp <code>${layerLib}</code> nit reschtesch enjebonge wood.<br /><br />Fr Projrammierer jidd_Et Hlp do_drvver, <a href="http://trac.openlayers.org/wiki/${layerLib}" target="_blank">wi mer dat aan et Loufe brengk</a>.',scale:"Mohshtaab = 1 : ${scaleDenom}",W:"W",E:"O",N:"N",S:"S",layerAlreadyAdded:"Do h vershk, dat Nivvoh <code>${layerName}</code> en di Kaat eren ze brnge, et wohr vver ald do dren.",reprojectDeprecated:"Do bruchs de Uwahl <code>reproject</code> op dm Nivvoh <code>${layerName}</code>. Di Uwahl es nit mieh jhn jesinn. Se wohr dofr jedaach, m Date op jeschfsmesch eru jejovve Kaate bovve drop ze moole, wat vver enzwesche besser met d ngershtzung fr de fresche Mkaator Beldscher jeiht. Doh kanns De mieh drvver fenge op d Sigg: http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Hee di Metood es nim_mih aktoll un et weed se en d Version 3.0 nit mieh jvve. Nemm <code>${newMethod}</code> dofr.",boundsAddError:"Do mo beeds vun de <code>x</code> un <code>y</code> Wte aan de Fungkjohn <code>add</code> jvve.",lonlatAddError:"Do mo beeds <code>lon</code> un <code>lat</code> aan de Fungkjohn <code>add</code> jvve.",pixelAddError:"Do mo beeds <code>x</code> un <code>y</code> aan de Fungkjohn <code>add</code> jvve.",unsupportedGeometryType:"De Zoot Jommetrii dom_mer nit ongershtze: <code>${geomType}</code>",pagePositionFailed:'<code lang="en">OpenLayers.Util.pagePosition</code> es donevve jejange: dat Denge met d Knnong <code>${elemId}</code> knnt am verkeehte Plaz sin.',filterEvaluateNotImplemented:'<code lang="en">evaluate</code> es fr di Zoot Fellter nit enjereschdt.'}),OpenLayers.Lang.nds=OpenLayers.Util.applyDefaults({unhandledRequest:"Unbehannelt Trchmellels fr de Anfraag ${statusText}",permalink:"Permalink",overlays:"Overlays",baseLayer:"Achtergrundkoort",sameProjection:"De versichtskoort geiht blot, wenn de slve Projekschoon as bi de Hftkoort bruukt warrt",readNotImplemented:"Lesen is nich inricht.",writeNotImplemented:"Schrieven is nich inricht.",noFID:"En Feature, dat keen FID hett, kann nich aktuell maakt warrn.",errorLoadingGML:"Fehler bit Laden vun de GML-Datei ${url}",browserNotSupported:"Dien Browser nnersttt keen Vektorbiller. nnersttt Renderers:\n${renderers}",componentShouldBe:"addFeatures : Kumponent schull man den Typ ${geomType} hebben",getFeatureError:"getFeatureFromEvent is von en Laag ahn Render opropen worrn. Dat beddt normalerwies, dat en Laag wegmaakt worrn is, aver nich de Handler, de dor op verwiest.",commitSuccess:"WFS-Transakschoon: hett klappt ${response}",commitFailed:"WFS-Transakschoon: hett nich klappt ${response}",scale:"Skaal = 1 : ${scaleDenom}",layerAlreadyAdded:"Du verschst de Laag ${layerName} to de Koort totofgen, man de is al tofgt",methodDeprecated:"Disse Methood is oold un schall dat in 3.0 nich mehr geven. Bruuk dor man beter ${newMethod} fr.",boundsAddError:"De Weert x un y, de mt all beid an de add-Funkschoon vergeven warrn.",lonlatAddError:"De Weert lon un lat, de mt all beid an de add-Funkschoon vergeven warrn.",pixelAddError:"De Weert x un y, de mt all beid an de add-Funkschoon vergeven warrn.",unsupportedGeometryType:"Nich nnersttt Geometrie-Typ: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition gng nich: Element mit de Id ${elemId} is villicht ann verkehrten Platz."}),OpenLayers.Lang.nn=OpenLayers.Util.applyDefaults({scale:"Skala = 1 : ${scaleDenom}",layerAlreadyAdded:"Du freista  leggja til laget ${layerName} p kartet, men det har alt vorte lagt til.",boundsAddError:"Du er nydd til  gje bde ein x- og ein y-verdi til add-funksjonen.",lonlatAddError:"Du er nydd til  gje bde lon- og lat-verdiar til add-funksjonen.",pixelAddError:"Du er nydd til  gje bde ein x- og ein y-verdi til add-funksjonen."}),OpenLayers.Lang.oc=OpenLayers.Util.applyDefaults({unhandledRequest:"Requsta pas gerida, retorna ${statusText}",permalink:"Permaligam",overlays:"Calques",baseLayer:"Calc de basa",sameProjection:"La carta de situacion fonciona pas que quora sa projeccion es la meteissa que la de la carta principala",readNotImplemented:"Lectura pas implementada.",writeNotImplemented:"Escritura pas implementada.",noFID:"Impossible de metre a jorn un objcte sens identificant (fid).",errorLoadingGML:"Error al cargament del fichir GML ${url}",browserNotSupported:"Vstre navegidor suprta pas lo rendut vectorial. Los renderers actualament suportats son : \n${renderers}",componentShouldBe:"addFeatures : lo compausant deuri sser de tipe ${geomType}",getFeatureError:"getFeatureFromEvent es estat apelat sus un calc sens renderer. Aqu significa generalament qu'avtz destruch aqueste ja, mas qu'avtz conservat un handler que li ra associat.",minZoomLevelError:"La proprietat minZoomLevel deu sser utilizada solament per de jaces FixedZoomLevels-descendent. Lo fach qu'aqueste ja WFS verifique la presncia de minZoomLevel es una relica del passat. aquel, la podm suprimir sens copar d'aplicacions que ne poirin dependre. Es per aqu que la depreciam -- la verificacion del minZoomLevel ser suprimida en version 3.0. A la plaa, mercs d'utilizar los paramtres de resolucions min/max tal coma descrich sus : http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transaccion WFS : SUCCES ${response}",commitFailed:"Transaccion WFS : FRACAS ${response}",googleWarning:"Lo ja Google es pas estat en mesura de se cargar corrctament.<br><br>Per suprimir aqueste messatge, causisstz una BaseLayer novla dins lo selector de ja en naut a drecha.<br><br>Aqu es possiblament causat par la non-inclusion de la librari Google Maps, o alara perque que la clau de l'API correspond pas a vstre site.<br><br>Desvolopaires : per saber coss corregir aqu, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>clicatz aic</a>",getLayerWarning:"Lo ja ${layerType} es pas en mesura de se cargar corrctament.<br><br>Per suprimir aqueste messatge, causisstz una  BaseLayer novla dins lo selector de ja en naut a drecha.<br><br>Aqu es possiblament causat per la non-inclusion de la librari ${layerLib}.<br><br>Desvolopaires : per saber coss corregir aqu, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>clicatz aic</a>",scale:"Escala ~ 1 : ${scaleDenom}",W:"O",E:"",N:"N",S:"S",layerAlreadyAdded:"Avtz ensajat d'apondre a la carta lo calc : ${layerName}, mas ja es present",reprojectDeprecated:"Utilizatz l'opcion 'reproject' sul ja ${layerName}. Aquesta opcion es despreciada : Son usatge permeti d'afichar de donadas al desss de jaces raster comercials. Aquesta foncionalitat ara es suportada en utilizant lo suprt de la projeccion Mercator Esferica. Mai d'informacion es disponibla sus http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Aqueste metde es despreciada, e ser suprimida a la version 3.0. Mercs d'utilizar ${newMethod} a la plaa.",boundsAddError:"Vos cal passar las doas valors x e y a la foncion add.",lonlatAddError:"Vos cal passar las doas valors lon e lat a la foncion add.",pixelAddError:"Vos cal passar las doas valors x e y a la foncion add.",unsupportedGeometryType:"Tipe de geometria pas suportat : ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition a fracassat : l'element d'id ${elemId} poiri sser mal posicionat.",filterEvaluateNotImplemented:"evaluar es pas encara estat implementat per aqueste tipe de filtre."}),OpenLayers.Lang.pt=OpenLayers.Util.applyDefaults({unhandledRequest:"Servidor devolveu erro no contemplado ${statusText}",permalink:"Ligao permanente",overlays:"Sobreposies",baseLayer:"Camada Base",sameProjection:"O mapa panormico s funciona quando est na mesma projeo que o mapa principal",readNotImplemented:"Leitura no implementada.",writeNotImplemented:"Escrita no implementada.",noFID:"No  possvel atualizar um elemento para a qual no h FID.",errorLoadingGML:"Erro ao carregar ficheiro GML ${url}",browserNotSupported:"O seu navegador no suporta renderizao vetorial. Actualmente os renderizadores suportados so:\n${renderers}",componentShouldBe:"addFeatures: componente deve ser um(a) ${geomType}",getFeatureError:"getFeatureFromEvent foi chamado numa camada sem renderizador. Isto normalmente significa que destruiu uma camada, mas no um manipulador ''(handler)'' que lhe est associado.",minZoomLevelError:"A propriedade minZoomLevel s deve ser usada com as camadas descendentes da FixedZoomLevels. A verificao da propriedade por esta camada wfs  uma relquia do passado. No entanto, no podemos remov-la sem correr o risco de afectar aplicaes OL que dependam dela. Portanto, estamos a torn-la obsoleta -- a verificao minZoomLevel ser removida na verso 3.0. Em vez dela, por favor, use as opes de resoluo min/max descritas aqui: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transaco WFS: SUCESSO ${response}",commitFailed:"Transaco WFS: FALHOU ${response}",googleWarning:"A Camada Google no foi correctamente carregada.<br><br>Para deixar de receber esta mensagem, seleccione uma nova Camada-Base no ''switcher'' de camadas no canto superior direito.<br><br>Provavelmente, isto acontece porque o ''script'' da biblioteca do Google Maps no foi includo ou no contm a chave API correcta para o seu stio.<br><br>Programadores: Para ajuda sobre como solucionar o problema <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>clique aqui</a> .",getLayerWarning:"A camada ${layerType} no foi correctamente carregada.<br><br>Para desactivar esta mensagem, seleccione uma nova Camada-Base no ''switcher'' de camadas no canto superior direito.<br><br>Provavelmente, isto acontece porque o ''script'' da biblioteca ${layerLib} no foi includo correctamente.<br><br>Programadores: Para ajuda sobre como solucionar o problema <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>clique aqui</a> .",scale:"Escala = 1 : ${scaleDenom}",W:"O",E:"E",N:"N",S:"S",layerAlreadyAdded:"Voc tentou adicionar a camada: ${layerName} ao mapa, mas ela j tinha sido adicionada antes",reprojectDeprecated:"Est usando a opo 'reproject' na camada ${layerName}. Esta opo  obsoleta: foi concebida para permitir a apresentao de dados sobre mapas-base comerciais, mas esta funcionalidade  agora suportada pelo Mercator Esfrico. Mais informao est disponvel em http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Este mtodo foi declarado obsoleto e ser removido na verso 3.0. Por favor, use ${newMethod} em vez disso.",boundsAddError:"Voc deve passar tanto o valor x como o y  funo de adio.",lonlatAddError:"Voc deve passar tanto o valor lon como o lat  funo de adio.",pixelAddError:"Voc deve passar tanto o valor x como o y  funo de adio.",unsupportedGeometryType:"Tipo de geometria no suportado: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition falhou: o elemento com o id ${elemId} poder estar mal-posicionado.",filterEvaluateNotImplemented:"avaliar no est implementado para este tipo de filtro."}),OpenLayers.Lang.ru=OpenLayers.Util.applyDefaults({unhandledRequest:"   ${statusText}",permalink:" ",overlays:"",baseLayer:" ",sameProjection:"    ,     ,   ",readNotImplemented:"  .",writeNotImplemented:"  .",noFID:"  ,    FID.",errorLoadingGML:"    GML ${url}",browserNotSupported:"     .    :\n${renderers}",componentShouldBe:"addFeatures:    ${geomType}",getFeatureError:"getFeatureFromEvent     .     ,    ,      .",minZoomLevelError:" minZoomLevel      ,   FixedZoomLevels. ,   WFS-   minZoomLevel   .       ,  , ,       OpenLayers .      minZoomLevel    3.0. ,     / ,  : http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:" WFS:  ${response}",commitFailed:" WFS:  ${response}",googleWarning:" Google    .<br><br>    ,          .<br><br> ,   ,   Google Maps        API-   .<br><br>:  ,  ,   , <a href='http://trac.openlayers.org/wiki/Google' target='_blank'> </a>",getLayerWarning:" ${layerType}    . <br><br>    ,          .<br><br> ,   ,   ${layerLib}       .<br><br>:  ,  ,   , <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'> </a>",scale:" = 1 : ${scaleDenom}",W:"",E:"",N:"",S:"",layerAlreadyAdded:"    ${layerName}  ,     ",reprojectDeprecated:"   'reproject'   ${layerName}.    :           ,          .     http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"         3.0. ,  ${newMethod}.",boundsAddError:" add    , x  y.",lonlatAddError:" add    , lon  lat.",pixelAddError:" add    , x  y.",unsupportedGeometryType:"  : ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition failed:   id ${elemId}      .",filterEvaluateNotImplemented:"evaluate      ."}),OpenLayers.Lang.sk=OpenLayers.Util.applyDefaults({unhandledRequest:"Neobslen poiadavky vracaj ${statusText}",permalink:"Trval odkaz",overlays:"Prekrytia",baseLayer:"Zkladn vrstva",sameProjection:"Prehadov mapka funguje iba vtedy, ke je v rovnakej projekcii ako hlavn mapa",readNotImplemented:"tanie nie je implementovan.",writeNotImplemented:"Zpis nie je implementovan.",noFID:"Nie je mon aktualizova vlastnos, pre ktor neexistuje FID.",errorLoadingGML:"Chyba pri natan sboru GML ${url}",browserNotSupported:"V prehliada nepodporuje vykresovanie vektorov. Momentlne podporovan vykresovae s:\n${renderers}",componentShouldBe:"addFeatures: komponent by mal by ${geomType}",getFeatureError:"getFeatureFromEvent bola zavolan na vrstve bez vykresovaa. To zvyajne znamen, e ste odstrnili vrstvu, ale nie niektor z obslh, ktor je s ou asociovan.",minZoomLevelError:"Vlastnos minZoomLevel je uren iba na pouitie s vrstvami odvodenmi od FixedZoomLevels. To, e tto wfs vrstva kontroluje minZoomLevel je pozostatok z minulosti. Nememe ho vak odstrni, aby sme sa vyhli monmu porueniu aplikci zaloench na Open Layers, ktor na tomto me zvisie. Preto ho oznaujeme ako zavrhovan - dolu uveden kontrola minZoomLevel bude odstrnen vo verzii 3.0. Pouite prosm namiesto toho kontrolu min./max. rozlenia poda tu uvedenho popisu: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transakcia WFS: SPEN ${response}",commitFailed:"Transakcia WFS: ZLYHALA ${response}",googleWarning:"Vrstvu Google nebolo mon sprvne nata.<br><br>Aby ste sa tejto sprvy zbavili vyberte nov BaseLayer v prepnai vrstiev v pravom hornom rohu.<br><br>Toto sa stalo pravdepodobne preto, e skript kninice Google Maps bu nebol natan alebo neobsahuje sprvny k API pre vau lokalitu.<br><br>Vvojri: Tu mete zska <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>pomoc so sfunknenm</a>",getLayerWarning:"Vrstvu ${layerType} nebolo mon sprvne nata.<br><br>Aby ste sa tejto sprvy zbavili vyberte nov BaseLayer v prepnai vrstiev v pravom hornom rohu.<br><br>Toto sa stalo pravdepodobne preto, e skript kninice ${layerType} bu nebol natan alebo neobsahuje sprvny k API pre vau lokalitu.<br><br>Vvojri: Tu mete zska <a href='http://trac.openlayers.org/wiki/${layerType}' target='_blank'>pomoc so sfunknenm</a>",scale:"Mierka = 1 : ${scaleDenom}",layerAlreadyAdded:"Poksili ste sa do mapy prida vrstvu ${layerName}, ale t u bola pridan",reprojectDeprecated:"Pouvate voby reproject vrstvy ${layerType}. Tto voba je zzavrhovan: jej pouitie bolo navrhnut na podporu zobrazovania dajov nad komernmi zkladovmi mapami, ale tto funkcionalitu je teraz mon dosiahnu pomocou Spherical Mercator. alie informcie zskate na strnke http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Tto metda je zavrhovan a bude odstrnen vo verzii 3.0. Pouite prosm namiesto nej metdu ${newMethod}.",boundsAddError:"Stacej funkcii muste da hodnoty x aj y.",lonlatAddError:"Stacej funkcii muste da hodnoty lon (zem. dka) aj lat (zem. rka).",pixelAddError:"Stacej funkcii muste da hodnoty x aj y.",unsupportedGeometryType:"Nepodporovan typ geometrie: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition zlyhalo: prvok s id ${elemId} me by zle umiestnen.",filterEvaluateNotImplemented:"evaluate nie je implementovan pre tento typ filtra"}),OpenLayers.Lang.te=OpenLayers.Util.applyDefaults({permalink:"",W:"",E:"",N:"",S:""}),OpenLayers.Lang.vi=OpenLayers.Util.applyDefaults({unhandledRequest:"Khng x l c phn hi ${statusText} cho yu cu",permalink:"Lin kt thng trc",overlays:"Lp bn ",baseLayer:"Lp nn",sameProjection:"Bn  ton cnh ch hot ng khi cng php chiu vi bn  chnh",readNotImplemented:"Cha h tr chc nng c.",writeNotImplemented:"Cha h tr chc nng vit.",noFID:"Khng th cp nht tnh nng thiu FID.",errorLoadingGML:"Li ti tp tin GML ti ${url}",browserNotSupported:"Trnh duyt ca bn khng h tr chc nng v bng vect. Hin h tr cc b kt xut:\n${renderers}",componentShouldBe:"addFeatures: b phn cn phi l ${geomType}",getFeatureError:"getFeatureFromEvent c gi t lp khng c b kt xut. Thng th c l lp b xa nhng mt phn x l ca n vn cn.",minZoomLevelError:"Ch nn s dng thuc tnh minZoomLevel vi cc lp FixedZoomLevels-descendent. Vic lp wfs ny tm cho minZoomLevel l di tch cn li t xa. Tuy nhin, nu chng ti di n th s v cc chng trnh OpenLayers m da trn n. Bi vy chng ti phn i s dng n&nbsp; bc tm cho minZoomLevel s c di vo phin bn 3.0. Xin s dng thit lp  phn tch ti thiu / ti a thay th, theo hng dn ny: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Giao dch WFS: THNH CNG ${response}",commitFailed:"Giao dch WFS: THT BI ${response}",googleWarning:"Khng th ti lp Google ng n.<br><br> trnh thng bo ny ln sau, hy chn BaseLayer mi dng iu khin chn lp  gc trn phi.<br><br>Chc script th vin Google Maps hoc khng c bao gm hoc khng cha kha API hp vi website ca bn.<br><br><a href='http://trac.openlayers.org/wiki/Google' target='_blank'>Tr gip v tnh nng ny</a> cho ngi pht trin.",getLayerWarning:"Khng th ti lp ${layerType} ng n.<br><br> trnh thng bo ny ln sau, hy chn BaseLayer mi dng iu khin chn lp  gc trn phi.<br><br>Chc script th vin ${layerLib} khng c bao gm ng kiu.<br><br><a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>Tr gip v tnh nng ny</a> cho ngi pht trin.",scale:"T l = 1 : ${scaleDenom}",W:"T",E:"",N:"B",S:"N",layerAlreadyAdded:"Bn mun thm lp ${layerName} vo bn , nhng lp ny  c thm",reprojectDeprecated:"Bn ang p dng ch  reproject vo lp ${layerName}. Ch  ny  b phn i: n c mc ch h tr lp d liu trn cc nn bn  thng mi; nn thc hin hiu ng  dng tnh nng Mercator Hnh cu. C sn thm chi tit ti http://trac.openlayers.org/wiki/SphericalMercator .",methodDeprecated:"Phng thc ny  b phn i v s b di vo phin bn 3.0. Xin hy s dng ${newMethod} thay th.",boundsAddError:"Cn phi cho c gi tr x v y vo hm add.",lonlatAddError:"Cn phi cho c gi tr lon v lat vo hm add.",pixelAddError:"Cn phi cho c gi tr x v y vo hm add.",unsupportedGeometryType:"Khng h tr kiu a l: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition b tht bi: nguyn t vi ID ${elemId} c th  ch sai.",filterEvaluateNotImplemented:"cha h tr evaluate cho loi b lc ny."}),OpenLayers.Popup.AnchoredBubble=OpenLayers.Class(OpenLayers.Popup.Anchored,{rounded:!1,initialize:function(a,b,c,d,e,f,g){this.padding=new OpenLayers.Bounds(0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE,0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE),OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments)},draw:function(a){OpenLayers.Popup.Anchored.prototype.draw.apply(this,arguments),this.setContentHTML(),this.setBackgroundColor(),this.setOpacity();return this.div},updateRelativePosition:function(){this.setRicoCorners()},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments),this.setRicoCorners()},setBackgroundColor:function(a){a!=undefined&&(this.backgroundColor=a),this.div!=null&&(this.contentDiv!=null&&(this.div.style.background="transparent",OpenLayers.Rico.Corner.changeColor(this.groupDiv,this.backgroundColor)))},setOpacity:function(a){OpenLayers.Popup.Anchored.prototype.setOpacity.call(this,a),this.div!=null&&(this.groupDiv!=null&&OpenLayers.Rico.Corner.changeOpacity(this.groupDiv,this.opacity))},setBorder:function(a){this.border=0},setRicoCorners:function(){var a=this.getCornersToRound(this.relativePosition),b={corners:a,color:this.backgroundColor,bgColor:"transparent",blend:!1};this.rounded?(OpenLayers.Rico.Corner.reRound(this.groupDiv,b),this.setBackgroundColor(),this.setOpacity()):(OpenLayers.Rico.Corner.round(this.div,b),this.rounded=!0)},getCornersToRound:function(){var a=["tl","tr","bl","br"],b=OpenLayers.Bounds.oppositeQuadrant(this.relativePosition);OpenLayers.Util.removeItem(a,b);return a.join(" ")},CLASS_NAME:"OpenLayers.Popup.AnchoredBubble"}),OpenLayers.Popup.AnchoredBubble.CORNER_SIZE=5,OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:!1,positionBlocks:null,blocks:null,fixedRelativePosition:!1,initialize:function(a,b,c,d,e,f,g){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments),this.fixedRelativePosition&&(this.updateRelativePosition(),this.calculateRelativePosition=function(a){return this.relativePosition}),this.contentDiv.style.position="absolute",this.contentDiv.style.zIndex=1,f&&(this.closeDiv.style.zIndex=1),this.groupDiv.style.position="absolute",this.groupDiv.style.top="0px",this.groupDiv.style.left="0px",this.groupDiv.style.height="100%",this.groupDiv.style.width="100%"},destroy:function(){this.imageSrc=null,this.imageSize=null,this.isAlphaImage=null,this.fixedRelativePosition=!1,this.positionBlocks=null;for(var a=0;a<this.blocks.length;a++){var b=this.blocks[a];b.image&&b.div.removeChild(b.image),b.image=null,b.div&&this.groupDiv.removeChild(b.div),b.div=null}this.blocks=null,OpenLayers.Popup.Anchored.prototype.destroy.apply(this,arguments)},setBackgroundColor:function(a){},setBorder:function(){},setOpacity:function(a){},setSize:function(a){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments),this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var a=this.getContentDivPadding();this.closeDiv.style.right=a.right+this.padding.right+"px",this.closeDiv.style.top=a.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(a){var b=OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);b=b.offset(this.positionBlocks[this.relativePosition].offset);return b},createBlocks:function(){this.blocks=[];var a=null;for(var b in this.positionBlocks){a=b;break}var c=this.positionBlocks[a];for(var d=0;d<c.blocks.length;d++){var e={};this.blocks.push(e);var f=this.id+"_FrameDecorationDiv_"+d;e.div=OpenLayers.Util.createDiv(f,null,null,null,"absolute",null,"hidden",null);var g=this.id+"_FrameDecorationImg_"+d,h=this.isAlphaImage?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage;e.image=h(g,null,this.imageSize,this.imageSrc,"absolute",null,null,null),e.div.appendChild(e.image),this.groupDiv.appendChild(e.div)}},updateBlocks:function(){this.blocks||this.createBlocks();if(this.size&&this.relativePosition){var a=this.positionBlocks[this.relativePosition];for(var b=0;b<a.blocks.length;b++){var c=a.blocks[b],d=this.blocks[b],e=c.anchor.left,f=c.anchor.bottom,g=c.anchor.right,h=c.anchor.top,i=isNaN(c.size.w)?this.size.w-(g+e):c.size.w,j=isNaN(c.size.h)?this.size.h-(f+h):c.size.h;d.div.style.width=(i<0?0:i)+"px",d.div.style.height=(j<0?0:j)+"px",d.div.style.left=e!=null?e+"px":"",d.div.style.bottom=f!=null?f+"px":"",d.div.style.right=g!=null?g+"px":"",d.div.style.top=h!=null?h+"px":"",d.image.style.left=c.position.x+"px",d.image.style.top=c.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px",this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"}),OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,initialize:function(a,b){OpenLayers.Util.extend(this,b),this.projCode=a,window.Proj4js&&(this.proj=new Proj4js.Proj(a))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(a){return a&&a.getCode?this.getCode()==a.getCode():!1},destroy:function(){delete this.proj,delete this.projCode},CLASS_NAME:"OpenLayers.Projection"}),OpenLayers.Projection.transforms={},OpenLayers.Projection.addTransform=function(a,b,c){OpenLayers.Projection.transforms[a]||(OpenLayers.Projection.transforms[a]={}),OpenLayers.Projection.transforms[a][b]=c},OpenLayers.Projection.transform=function(a,b,c){b.proj&&c.proj?a=Proj4js.transform(b.proj,c.proj,a):b&&c&&OpenLayers.Projection.transforms[b.getCode()]&&OpenLayers.Projection.transforms[b.getCode()][c.getCode()]&&OpenLayers.Projection.transforms[b.getCode()][c.getCode()](a);return a},OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]),a.format||(this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,srsName:this.srsName,schema:this.schema},this.formatOptions)));if(!this.featureNS&&this.featurePrefix){var b=this.format.readNode;this.format.readNode=function(a,c){!this.featureNS&&a.prefix==this.featurePrefix&&(this.featureNS=a.namespaceURI,this.setNamespace("feature",this.featureNS));return b.apply(this,arguments)}}},destroy:function(){this.options&&!this.options.format&&this.format.destroy(),this.format=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments),a=OpenLayers.Util.extend({},a),OpenLayers.Util.applyDefaults(a,this.options||{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",a)]);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),params:a.params,headers:a.headers,data:c});return b},handleRead:function(a,b){if(b.callback){var c=a.priv;c.status>=200&&c.status<300?(a.features=this.parseFeatures(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,b.callback.call(b.scope,a)}},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;if(!b||b.length<=0)return null;return this.readFormat!==null?this.readFormat.read(b):this.format.read(b)},commit:function(a,b){b=OpenLayers.Util.extend({},b),OpenLayers.Util.applyDefaults(b,this.options);var c=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:a});c.priv=OpenLayers.Request.POST({url:b.url,data:this.format.write(a,b),callback:this.createCallback(this.handleCommit,c,b)});return c},handleCommit:function(a,b){if(b.callback){var c=a.priv,d=c.responseXML;if(!d||!d.documentElement)d=c.responseText;var e=this.format.read(d)||{};a.insertIds=e.insertIds||[],a.code=e.success?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,b.callback.call(b.scope,a)}},filterDelete:function(a,b){b=OpenLayers.Util.extend({},b),OpenLayers.Util.applyDefaults(b,this.options);var c=new OpenLayers.Protocol.Response({requestType:"commit"}),d=this.format.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}}),e=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(b.featureNS?this.featurePrefix+":":"")+b.featureType}});b.featureNS&&e.setAttribute("xmlns:"+this.featurePrefix,b.featureNS);var f=this.format.writeNode("ogc:Filter",a);e.appendChild(f),d.appendChild(e);var g=OpenLayers.Format.XML.prototype.write.apply(this.format,[d]);return OpenLayers.Request.POST({url:this.url,callback:b.callback||function(){},data:g})},abort:function(a){a&&a.priv.abort()},CLASS_NAME:"OpenLayers.Protocol.WFS.v1"}),OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15e3,translationParameters:null,symbolMetrics:null,isGecko:null,supportUse:null,initialize:function(a){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.supportUse=navigator.userAgent.toLowerCase().indexOf("applewebkit/5")==-1,this.isGecko=navigator.userAgent.toLowerCase().indexOf("gecko/")!=-1,this.symbolMetrics={})},destroy:function(){OpenLayers.Renderer.Elements.prototype.destroy.apply(this,arguments)},supported:function(){var a="http://www.w3.org/TR/SVG11/feature#";return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(a+"SVG","1.1")||document.implementation.hasFeature(a+"BasicStructure","1.1"))},inValidRange:function(a,b,c){var d=a+(c?0:this.translationParameters.x),e=b+(c?0:this.translationParameters.y);return d>=-this.MAX_PIXEL&&d<=this.MAX_PIXEL&&e>=-this.MAX_PIXEL&&e<=this.MAX_PIXEL},setExtent:function(a,b){OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var c=this.getResolution(),d=-a.left/c,e=a.top/c;if(b){this.left=d,this.top=e;var f="0 0 "+this.size.w+" "+this.size.h;this.rendererRoot.setAttributeNS(null,"viewBox",f),this.translate(0,0);return!0}var g=this.translate(d-this.left,e-this.top);g||this.setExtent(a,!0);return g},translate:function(a,b){if(this.inValidRange(a,b,!0)){var c="";if(a||b)c="translate("+a+","+b+")";this.root.setAttributeNS(null,"transform",c),this.translationParameters={x:a,y:b};return!0}return!1},setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments),this.rendererRoot.setAttributeNS(null,"width",this.size.w),this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case"OpenLayers.Geometry.Point":b.externalGraphic?c="image":this.isComplexSymbol(b.graphicName)?c=this.supportUse===!1?"svg":"use":c="circle";break;case"OpenLayers.Geometry.Rectangle":c="rect";break;case"OpenLayers.Geometry.LineString":c="polyline";break;case"OpenLayers.Geometry.LinearRing":c="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":case"OpenLayers.Geometry.Surface":c="path";break;default:}return c},setStyle:function(a,b,c){b=b||a._style,c=c||a._options;var d=parseFloat(a.getAttributeNS(null,"r")),e=1,f;if(a._geometryClass=="OpenLayers.Geometry.Point"&&d){a.style.visibility="";if(b.graphic===!1)a.style.visibility="hidden";else if(b.externalGraphic){f=this.getPosition(a),b.graphicTitle&&a.setAttributeNS(null,"title",b.graphicTitle),b.graphicWidth&&b.graphicHeight&&a.setAttributeNS(null,"preserveAspectRatio","none");var g=b.graphicWidth||b.graphicHeight,h=b.graphicHeight||b.graphicWidth;g=g?g:b.pointRadius*2,h=h?h:b.pointRadius*2;var i=b.graphicXOffset!=undefined?b.graphicXOffset:-(.5*g),j=b.graphicYOffset!=undefined?b.graphicYOffset:-(.5*h),k=b.graphicOpacity||b.fillOpacity;a.setAttributeNS(null,"x",(f.x+i).toFixed()),a.setAttributeNS(null,"y",(f.y+j).toFixed()),a.setAttributeNS(null,"width",g),a.setAttributeNS(null,"height",h),a.setAttributeNS(this.xlinkns,"href",b.externalGraphic),a.setAttributeNS(null,"style","opacity: "+k)}else if(this.isComplexSymbol(b.graphicName)){var l=b.pointRadius*3,m=l*2,n=this.importSymbol(b.graphicName);f=this.getPosition(a),e=this.symbolMetrics[n][0]*3/m;var o=a.parentNode,p=a.nextSibling;o&&o.removeChild(a);if(this.supportUse===!1){var q=document.getElementById(n);a.firstChild&&a.removeChild(a.firstChild),a.appendChild(q.firstChild.cloneNode(!0)),a.setAttributeNS(null,"viewBox",q.getAttributeNS(null,"viewBox"))}else a.setAttributeNS(this.xlinkns,"href","#"+n);a.setAttributeNS(null,"width",m),a.setAttributeNS(null,"height",m),a.setAttributeNS(null,"x",f.x-l),a.setAttributeNS(null,"y",f.y-l),p?o.insertBefore(a,p):o&&o.appendChild(a)}else a.setAttributeNS(null,"r",b.pointRadius);var r=b.rotation;if((r!==undefined||a._rotation!==undefined)&&f){a._rotation=r,r|=0;if(a.nodeName!=="svg")a.setAttributeNS(null,"transform","rotate("+r+" "+f.x+" "+f.y+")");else{var s=this.symbolMetrics[n];a.firstChild.setAttributeNS(null,"transform","rotate("+b.rotation+" "+s[1]+" "+s[2]+")")}}}c.isFilled?(a.setAttributeNS(null,"fill",b.fillColor),a.setAttributeNS(null,"fill-opacity",b.fillOpacity)):a.setAttributeNS(null,"fill","none"),c.isStroked?(a.setAttributeNS(null,"stroke",b.strokeColor),a.setAttributeNS(null,"stroke-opacity",b.strokeOpacity),a.setAttributeNS(null,"stroke-width",b.strokeWidth*e),a.setAttributeNS(null,"stroke-linecap",b.strokeLinecap),a.setAttributeNS(null,"stroke-linejoin","round"),a.setAttributeNS(null,"stroke-dasharray",this.dashStyle(b,e))):a.setAttributeNS(null,"stroke","none"),b.pointerEvents&&a.setAttributeNS(null,"pointer-events",b.pointerEvents),b.cursor!=null&&a.setAttributeNS(null,"cursor",b.cursor);return a},dashStyle:function(a,b){var c=a.strokeWidth*b,d=a.strokeDashstyle;switch(d){case"solid":return"none";case"dot":return[1,4*c].join();case"dash":return[4*c,4*c].join();case"dashdot":return[4*c,4*c,1,4*c].join();case"longdash":return[8*c,4*c].join();case"longdashdot":return[8*c,4*c,1,4*c].join();default:return OpenLayers.String.trim(d).replace(/\s+/g,",")}},createNode:function(a,b){var c=document.createElementNS(this.xmlns,a);b&&c.setAttributeNS(null,"id",b);return c},nodeTypeCompare:function(a,b){return b==a.nodeName},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_svgRoot","svg")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"g")},createDefs:function(){var a=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(a);return a},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){var d=this.getResolution(),e=b.x/d+this.left,f=this.top-b.y/d;if(this.inValidRange(e,f)){a.setAttributeNS(null,"cx",e),a.setAttributeNS(null,"cy",f),a.setAttributeNS(null,"r",c);return a}return!1},drawLineString:function(a,b){var c=this.getComponentsString(b.components);if(c.path){a.setAttributeNS(null,"points",c.path);return c.complete?a:null}return!1},drawLinearRing:function(a,b){var c=this.getComponentsString(b.components);if(c.path){a.setAttributeNS(null,"points",c.path);return c.complete?a:null}return!1},drawPolygon:function(a,b){var c="",d=!0,e=!0,f,g;for(var h=0,i=b.components.length;h<i;h++)c+=" M",f=this.getComponentsString(b.components[h].components," "),g=f.path,g?(c+=" "+g,e=f.complete&&e):d=!1;c+=" z";if(d){a.setAttributeNS(null,"d",c),a.setAttributeNS(null,"fill-rule","evenodd");return e?a:null}return!1},drawRectangle:function(a,b){var c=this.getResolution(),d=b.x/c+this.left,e=this.top-b.y/c;if(this.inValidRange(d,e)){a.setAttributeNS(null,"x",d),a.setAttributeNS(null,"y",e),a.setAttributeNS(null,"width",b.width/c),a.setAttributeNS(null,"height",b.height/c);return a}return!1},drawSurface:function(a,b){var c=null,d=!0;for(var e=0,f=b.components.length;e<f;e++)if(e%3==0&&e/3==0){var g=this.getShortString(b.components[e]);g||(d=!1),c="M "+g}else if(e%3==1){var g=this.getShortString(b.components[e]);g||(d=!1),c+=" C "+g}else{var g=this.getShortString(b.components[e]);g||(d=!1),c+=" "+g}c+=" Z";if(d){a.setAttributeNS(null,"d",c);return a}return!1},drawText:function(a,b,c){var d=this.getResolution(),e=c.x/d+this.left,f=c.y/d-this.top,g=this.nodeFactory(a+this.LABEL_ID_SUFFIX,"text"),h=this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_tspan","tspan");g.setAttributeNS(null,"x",e),g.setAttributeNS(null,"y",-f),b.fontColor&&g.setAttributeNS(null,"fill",b.fontColor),b.fontOpacity&&g.setAttributeNS(null,"opacity",b.fontOpacity),b.fontFamily&&g.setAttributeNS(null,"font-family",b.fontFamily),b.fontSize&&g.setAttributeNS(null,"font-size",b.fontSize),b.fontWeight&&g.setAttributeNS(null,"font-weight",b.fontWeight),b.labelSelect===!0?(g.setAttributeNS(null,"pointer-events","visible"),g._featureId=a,h._featureId=a,h._geometry=c,h._geometryClass=c.CLASS_NAME):g.setAttributeNS(null,"pointer-events","none");var i=b.labelAlign||"cm";g.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[i[0]]||"middle"),this.isGecko?g.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[i[1]]||"central"):h.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[i[1]]||"-35%"),h.textContent=b.label,g.parentNode||(g.appendChild(h),this.textRoot.appendChild(g))},getComponentsString:function(a,b){var c=[],d=!0,e=a.length,f=[],g,h,i;for(var j=0;j<e;j++)h=a[j],c.push(h),g=this.getShortString(h),g?f.push(g):(j>0&&(this.getShortString(a[j-1])&&f.push(this.clipLine(a[j],a[j-1]))),j<e-1&&(this.getShortString(a[j+1])&&f.push(this.clipLine(a[j],a[j+1]))),d=!1);return{path:f.join(b||","),complete:d}},clipLine:function(a,b){if(b.equals(a))return"";var c=this.getResolution(),d=this.MAX_PIXEL-this.translationParameters.x,e=this.MAX_PIXEL-this.translationParameters.y,f=b.x/c+this.left,g=this.top-b.y/c,h=a.x/c+this.left,i=this.top-a.y/c,j;if(h<-d||h>d)j=(i-g)/(h-f),h=h<0?-d:d,i=g+(h-f)*j;if(i<-e||i>e)j=(h-f)/(i-g),i=i<0?-e:e,h=f+(i-g)*j;return h+","+i},getShortString:function(a){var b=this.getResolution(),c=a.x/b+this.left,d=this.top-a.y/b;return this.inValidRange(c,d)?c+","+d:!1},getPosition:function(a){return{x:parseFloat(a.getAttributeNS(null,"cx")),y:parseFloat(a.getAttributeNS(null,"cy"))}},importSymbol:function(a){this.defs||(this.defs=this.createDefs());var b=this.container.id+"-"+a;if(document.getElementById(b)!=null)return b;var c=OpenLayers.Renderer.symbol[a];if(!c)throw new Error(a+" is not a valid symbol name");var d=this.nodeFactory(b,"symbol"),e=this.nodeFactory(null,"polygon");d.appendChild(e);var f=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),g="",h,i;for(var j=0;j<c.length;j=j+2)h=c[j],i=c[j+1],f.left=Math.min(f.left,h),f.bottom=Math.min(f.bottom,i),f.right=Math.max(f.right,h),f.top=Math.max(f.top,i),g+=" "+h+","+i;e.setAttributeNS(null,"points",g);var k=f.getWidth(),l=f.getHeight(),m=[f.left-k,f.bottom-l,k*3,l*3];d.setAttributeNS(null,"viewBox",m.join(" ")),this.symbolMetrics[b]=[Math.max(k,l),f.getCenterLonLat().lon,f.getCenterLonLat().lat],this.defs.appendChild(d);return d.id},getFeatureIdFromEvent:function(a){var b=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(this.supportUse===!1&&!b){var c=a.target;b=c.parentNode&&c!=this.rendererRoot&&c.parentNode._featureId}return b},CLASS_NAME:"OpenLayers.Renderer.SVG"}),OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"},OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"},OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(a){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);var b=document.createStyleSheet(),c=["shape","rect","oval","fill","stroke","imagedata","group","textbox"];for(var d=0,e=c.length;d<e;d++)b.addRule("olv\\:"+c[d],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments)}},destroy:function(){OpenLayers.Renderer.Elements.prototype.destroy.apply(this,arguments)},supported:function(){return!!document.namespaces},setExtent:function(a,b){OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var c=this.getResolution(),d=a.left/c|0,e=a.top/c-this.size.h|0;b||!this.offset?(this.offset={x:d,y:e},d=0,e=0):(d=d-this.offset.x,e=e-this.offset.y);var f=d+" "+e;this.root.coordorigin=f;var g=[this.root,this.vectorRoot,this.textRoot],h;for(var i=0,j=g.length;i<j;++i){h=g[i];var k=this.size.w+" "+this.size.h;h.coordsize=k}this.root.style.flip="y";return!0},setSize:function(a){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);var b=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],c=this.size.w+"px",d=this.size.h+"px",e;for(var f=0,g=b.length;f<g;++f)e=b[f],e.style.width=c,e.style.height=d},getNodeType:function(a,b){var c=null;switch(a.CLASS_NAME){case"OpenLayers.Geometry.Point":b.externalGraphic?c="olv:rect":this.isComplexSymbol(b.graphicName)?c="olv:shape":c="olv:oval";break;case"OpenLayers.Geometry.Rectangle":c="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":case"OpenLayers.Geometry.Surface":c="olv:shape";break;default:}return c},setStyle:function(a,b,c,d){b=b||a._style,c=c||a._options;var e=1,f=b.fillColor;if(a._geometryClass==="OpenLayers.Geometry.Point")if(b.externalGraphic){b.graphicTitle&&(a.title=b.graphicTitle);var g=b.graphicWidth||b.graphicHeight,h=b.graphicHeight||b.graphicWidth;g=g?g:b.pointRadius*2,h=h?h:b.pointRadius*2;var i=this.getResolution(),j=b.graphicXOffset!=undefined?b.graphicXOffset:-(.5*g),k=b.graphicYOffset!=undefined?b.graphicYOffset:-(.5*h);a.style.left=(d.x/i-this.offset.x+j|0)+"px",a.style.top=(d.y/i-this.offset.y-(k+h)|0)+"px",a.style.width=g+"px",a.style.height=h+"px",a.style.flip="y",f="none",c.isStroked=!1}else if(this.isComplexSymbol(b.graphicName)){var l=this.importSymbol(b.graphicName);a.path=l.path,a.coordorigin=l.left+","+l.bottom;var m=l.size;a.coordsize=m+","+m,this.drawCircle(a,d,b.pointRadius),a.style.flip="y"}else this.drawCircle(a,d,b.pointRadius);c.isFilled?a.fillcolor=f:a.filled="false";var n=a.getElementsByTagName("fill"),o=n.length==0?null:n[0];if(c.isFilled){o||(o=this.createNode("olv:fill",a.id+"_fill")),o.opacity=b.fillOpacity;if(a._geometryClass==="OpenLayers.Geometry.Point"&&b.externalGraphic){b.graphicOpacity&&(o.opacity=b.graphicOpacity),o.src=b.externalGraphic,o.type="frame";if(!b.graphicWidth||!b.graphicHeight)o.aspect="atmost"}o.parentNode!=a&&a.appendChild(o)}else o&&a.removeChild(o);var p=b.rotation;p!==a._rotation&&(a._rotation=p,b.externalGraphic?(this.graphicRotate(a,j,k,b),o.opacity=0):a._geometryClass==="OpenLayers.Geometry.Point"&&(a.style.rotation=p||0)),c.isStroked?(a.strokecolor=b.strokeColor,a.strokeweight=b.strokeWidth+"px"):a.stroked=!1;var q=a.getElementsByTagName("stroke"),r=q.length==0?null:q[0];c.isStroked?(r||(r=this.createNode("olv:stroke",a.id+"_stroke"),a.appendChild(r)),r.opacity=b.strokeOpacity,r.endcap=!b.strokeLinecap||b.strokeLinecap=="butt"?"flat":b.strokeLinecap,r.dashstyle=this.dashStyle(b)):r&&a.removeChild(r),b.cursor!="inherit"&&b.cursor!=null&&(a.style.cursor=b.cursor);return a},graphicRotate:function(a,b,c,d){var d=d||a._style,e=a._options,f=d.rotation||0,g,h;if(d.graphicWidth&&d.graphicHeight)h=Math.max(d.graphicWidth,d.graphicHeight),g=d.graphicWidth/d.graphicHeight;else{var i=new Image;i.onreadystatechange=OpenLayers.Function.bind(function(){if(i.readyState=="complete"||i.readyState=="interactive")g=i.width/i.height,h=Math.max(d.pointRadius*2,d.graphicWidth||0,d.graphicHeight||0),b=b*g,d.graphicWidth=h*g,d.graphicHeight=h,this.graphicRotate(a,b,c,d)},this),i.src=d.externalGraphic;return}var j=Math.round(d.graphicWidth||h*g),k=Math.round(d.graphicHeight||h);a.style.width=j+"px",a.style.height=k+"px";var l=document.getElementById(a.id+"_image");l||(l=this.createNode("olv:imagedata",a.id+"_image"),a.appendChild(l)),l.style.width=j+"px",l.style.height=k+"px",l.src=d.externalGraphic,l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";var m=f*Math.PI/180,n=Math.sin(m),o=Math.cos(m),p="progid:DXImageTransform.Microsoft.Matrix(M11="+o+",M12="+ -n+",M21="+n+",M22="+o+",SizingMethod='auto expand')\n",q=d.graphicOpacity||d.fillOpacity;q&&q!=1&&(p+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+q+")\n"),a.style.filter=p;var r=new OpenLayers.Geometry.Point(-b,-c),s=(new OpenLayers.Bounds(0,0,j,k)).toGeometry();s.rotate(d.rotation,r);var t=s.getBounds();a.style.left=Math.round(parseInt(a.style.left)+t.left)+"px",a.style.top=Math.round(parseInt(a.style.top)-t.bottom)+"px"},postDraw:function(a){a.style.visibility="visible";var b=a._style.fillColor,c=a._style.strokeColor;b=="none"&&a.fillcolor!=b&&(a.fillcolor=b),c=="none"&&a.strokecolor!=c&&(a.strokecolor=c)},setNodeDimension:function(a,b){var c=b.getBounds();if(c){var d=this.getResolution(),e=new OpenLayers.Bounds(c.left/d-this.offset.x|0,c.bottom/d-this.offset.y|0,c.right/d-this.offset.x|0,c.top/d-this.offset.y|0);a.style.left=e.left+"px",a.style.top=e.top+"px",a.style.width=e.getWidth()+"px",a.style.height=e.getHeight()+"px",a.coordorigin=e.left+" "+e.top,a.coordsize=e.getWidth()+" "+e.getHeight()}},dashStyle:function(a){var b=a.strokeDashstyle;switch(b){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return b;default:var c=b.split(/[ ,]/);if(c.length==2){if(1*c[0]>=2*c[1])return"longdash";return c[0]==1||c[1]==1?"dot":"dash"}if(c.length==4)return 1*c[0]>=2*c[1]?"longdashdot":"dashdot";return"solid"}},createNode:function(a,b){var c=document.createElement(a);b&&(c.id=b),c.unselectable="on",c.onselectstart=OpenLayers.Function.False;return c},nodeTypeCompare:function(a,b){var c=b,d=c.indexOf(":");d!=-1&&(c=c.substr(d+1));var e=a.nodeName;d=e.indexOf(":"),d!=-1&&(e=e.substr(d+1));return c==e},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(a){return this.nodeFactory(this.container.id+a,"olv:group")},drawPoint:function(a,b){return this.drawCircle(a,b,1)},drawCircle:function(a,b,c){if(!isNaN(b.x)&&!isNaN(b.y)){var d=this.getResolution();a.style.left=(b.x/d-this.offset.x|0)-c+"px",a.style.top=(b.y/d-this.offset.y|0)-c+"px";var e=c*2;a.style.width=e+"px",a.style.height=e+"px";return a}return!1},drawLineString:function(a,b){return this.drawLine(a,b,!1)},drawLinearRing:function(a,b){return this.drawLine(a,b,!0)},drawLine:function(a,b,c){this.setNodeDimension(a,b);var d=this.getResolution(),e=b.components.length,f=Array(e),g,h,i;for(var j=0;j<e;j++)g=b.components[j],h=g.x/d-this.offset.x|0,i=g.y/d-this.offset.y|0,f[j]=" "+h+","+i+" l ";var k=c?" x e":" e";a.path="m"+f.join("")+k;return a},drawPolygon:function(a,b){this.setNodeDimension(a,b);var c=this.getResolution(),d=[],e,f,g,h,i,j,k,l;for(g=0,h=b.components.length;g<h;g++){e=b.components[g],d.push("m");for(f=0,i=e.components.length;f<i;f++)j=e.components[f],k=j.x/c-this.offset.x|0,l=j.y/c-this.offset.y|0,d.push(" "+k+","+l),f==0&&d.push(" l");d.push(" x ")}d.push("e"),a.path=d.join("");return a},drawRectangle:function(a,b){var c=this.getResolution();a.style.left=(b.x/c-this.offset.x|0)+"px",a.style.top=(b.y/c-this.offset.y|0)+"px",a.style.width=(b.width/c|0)+"px",a.style.height=(b.height/c|0)+"px";return a},drawText:function(a,b,c){var d=this.nodeFactory(a+this.LABEL_ID_SUFFIX,"olv:rect"),e=this.nodeFactory(a+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),f=this.getResolution();d.style.left=(c.x/f-this.offset.x|0)+"px",d.style.top=(c.y/f-this.offset.y|0)+"px",d.style.flip="y",e.innerText=b.label,b.fontColor&&(e.style.color=b.fontColor),b.fontOpacity&&(e.style.filter="alpha(opacity="+b.fontOpacity*100+")"),b.fontFamily&&(e.style.fontFamily=b.fontFamily),b.fontSize&&(e.style.fontSize=b.fontSize),b.fontWeight&&(e.style.fontWeight=b.fontWeight),b.labelSelect===!0&&(d._featureId=a,e._featureId=a,e._geometry=c,e._geometryClass=c.CLASS_NAME),e.style.whiteSpace="nowrap",e.inset="1px,0px,0px,0px",d.parentNode||(d.appendChild(e),this.textRoot.appendChild(d));var g=b.labelAlign||"cm",h=e.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[g[0]||"c"],i=e.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[g[1]||"m"];d.style.left=parseInt(d.style.left)-h-1+"px",d.style.top=parseInt(d.style.top)+i+"px"},drawSurface:function(a,b){this.setNodeDimension(a,b);var c=this.getResolution(),d=[],e,f,g;for(var h=0,i=b.components.length;h<i;h++)e=b.components[h],f=e.x/c-this.offset.x|0,g=e.y/c-this.offset.y|0,h%3==0&&h/3==0?d.push("m"):h%3==1&&d.push(" c"),d.push(" "+f+","+g);d.push(" x e"),a.path=d.join("");return a},moveRoot:function(a){var b=this.map.getLayer(a.container.id);b instanceof OpenLayers.Layer.Vector.RootContainer&&(b=this.map.getLayer(this.container.id)),b&&b.renderer.clear(),OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments),b&&b.redraw()},importSymbol:function(a){var b=this.container.id+"-"+a,c=this.symbolCache[b];if(c)return c;var d=OpenLayers.Renderer.symbol[a];if(!d)throw new Error(a+" is not a valid symbol name");var e=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),f=["m"];for(var g=0;g<d.length;g=g+2){var h=d[g],i=d[g+1];e.left=Math.min(e.left,h),e.bottom=Math.min(e.bottom,i),e.right=Math.max(e.right,h),e.top=Math.max(e.top,i),f.push(h),f.push(i),g==0&&f.push("l")}f.push("x e");var j=f.join(" "),k=(e.getWidth()-e.getHeight())/2;k>0?(e.bottom=e.bottom-k,e.top=e.top+k):(e.left=e.left+k,e.right=e.right-k),c={path:j,size:e.getWidth(),left:e.left,bottom:e.bottom},this.symbolCache[b]=c;return c},CLASS_NAME:"OpenLayers.Renderer.VML"}),OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:.5,r:1,t:0,m:.5,b:1},OpenLayers.Tile=OpenLayers.Class({EVENT_TYPES:["loadstart","loadend","reload","unload"],events:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(a,b,c,d,e){this.layer=a,this.position=b.clone(),this.bounds=c.clone(),this.url=d,this.size=e.clone(),this.id=OpenLayers.Util.createUniqueID("Tile_"),this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES)},unload:function(){this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("unload"))},destroy:function(){this.layer=null,this.bounds=null,this.size=null,this.position=null,this.events.destroy(),this.events=null},clone:function(a){a==null&&(a=new OpenLayers.Tile(this.layer,this.position,this.bounds,this.url,this.size)),OpenLayers.Util.applyDefaults(a,this);return a},draw:function(){var a=this.layer.maxExtent,b=a&&this.bounds.intersectsBounds(a,!1);this.shouldDraw=b||this.layer.displayOutsideMaxExtent,this.clear();return this.shouldDraw},moveTo:function(a,b,c){c==null&&(c=!0),this.bounds=a.clone(),this.position=b.clone(),c&&this.draw()},clear:function(){},getBoundsFromBaseLayer:function(a){var b=OpenLayers.i18n("reprojectDeprecated",{layerName:this.layer.name});OpenLayers.Console.warn(b);var c=this.layer.map.getLonLatFromLayerPx(a),d=a.clone();d.x+=this.size.w,d.y+=this.size.h;var e=this.layer.map.getLonLatFromLayerPx(d);c.lon>e.lon&&(c.lon<0?c.lon=-180-(c.lon+180):e.lon=180+e.lon+180);var f=new OpenLayers.Bounds(c.lon,e.lat,e.lon,c.lat);return f},showTile:function(){this.shouldDraw&&this.show()},show:function(){},hide:function(){},CLASS_NAME:"OpenLayers.Tile"}),OpenLayers.Control.MouseToolbar=OpenLayers.Class(OpenLayers.Control.MouseDefaults,{mode:null,buttons:null,direction:"vertical",buttonClicked:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.position=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,OpenLayers.Control.MouseToolbar.Y),a&&(this.position=a),b&&(this.direction=b),this.measureDivs=[]},destroy:function(){for(var a in this.buttons){var b=this.buttons[a];b.map=null,b.events.destroy()}OpenLayers.Control.MouseDefaults.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),OpenLayers.Control.MouseDefaults.prototype.draw.apply(this,arguments),this.buttons={};var a=new OpenLayers.Size(28,28),b=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,0);this._addButton("zoombox","drag-rectangle-off.png","drag-rectangle-on.png",b,a,"Shift->Drag to zoom to area"),b=b.add(this.direction=="vertical"?0:a.w,this.direction=="vertical"?a.h:0),this._addButton("pan","panning-hand-off.png","panning-hand-on.png",b,a,"Drag the map to pan."),b=b.add(this.direction=="vertical"?0:a.w,this.direction=="vertical"?a.h:0),this.switchModeTo("pan");return this.div},_addButton:function(a,b,c,d,e,f){var g=OpenLayers.Util.getImagesLocation()+b,h=OpenLayers.Util.getImagesLocation()+c,i=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MouseToolbar_"+a,d,e,g,"absolute");this.div.appendChild(i),i.imgLocation=g,i.activeImgLocation=h,i.events=new OpenLayers.Events(this,i,null,!0),i.events.on({mousedown:this.buttonDown,mouseup:this.buttonUp,dblclick:OpenLayers.Event.stop,scope:this}),i.action=a,i.title=f,i.alt=f,i.map=this.map,this.buttons[a]=i;return i},buttonDown:function(a){OpenLayers.Event.isLeftClick(a)&&(this.buttonClicked=a.element.action,OpenLayers.Event.stop(a))},buttonUp:function(a){OpenLayers.Event.isLeftClick(a)&&(this.buttonClicked!=null&&(this.buttonClicked==a.element.action&&this.switchModeTo(a.element.action),OpenLayers.Event.stop(a),this.buttonClicked=null))},defaultDblClick:function(a){this.switchModeTo("pan"),this.performedDrag=!1;var b=this.map.getLonLatFromViewPortPx(a.xy);this.map.setCenter(b,this.map.zoom+1),OpenLayers.Event.stop(a);return!1},defaultMouseDown:function(a){if(OpenLayers.Event.isLeftClick(a)){this.mouseDragStart=a.xy.clone(),this.performedDrag=!1,this.startViaKeyboard=!1,a.shiftKey&&this.mode!="zoombox"?(this.switchModeTo("zoombox"),this.startViaKeyboard=!0):a.altKey&&this.mode!="measure"?this.switchModeTo("measure"):this.mode||this.switchModeTo("pan");switch(this.mode){case"zoombox":this.map.div.style.cursor="crosshair",this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red"),this.zoomBox.style.backgroundColor="white",this.zoomBox.style.filter="alpha(opacity=50)",this.zoomBox.style.opacity="0.50",this.zoomBox.style.fontSize="1px",this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),this.performedDrag=!0;break;case"measure":var b="";if(this.measureStart){var c=this.map.getLonLatFromViewPortPx(this.mouseDragStart);b=OpenLayers.Util.distVincenty(this.measureStart,c),b=Math.round(b*100)/100,b=b+"km",this.measureStartBox=this.measureBox}this.measureStart=this.map.getLonLatFromViewPortPx(this.mouseDragStart),this.measureBox=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),-2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute"),this.measureBox.style.width="4px",this.measureBox.style.height="4px",this.measureBox.style.fontSize="1px",this.measureBox.style.backgroundColor="red",this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBox),b&&(this.measureBoxDistance=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute"),this.measureBoxDistance.innerHTML=b,this.measureBoxDistance.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBoxDistance),this.measureDivs.push(this.measureBoxDistance)),this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.layerContainerDiv.appendChild(this.measureBox),this.measureDivs.push(this.measureBox);break;default:this.map.div.style.cursor="move"}document.onselectstart=OpenLayers.Function.False,OpenLayers.Event.stop(a)}},switchModeTo:function(a){if(a!=this.mode){this.mode&&this.buttons[this.mode]&&OpenLayers.Util.modifyAlphaImageDiv(this.buttons[this.mode],null,null,null,this.buttons[this.mode].imgLocation);if(this.mode=="measure"&&a!="measure"){for(var b=0,c=this.measureDivs.length;b<c;b++)this.measureDivs[b]&&this.map.layerContainerDiv.removeChild(this.measureDivs[b]);this.measureDivs=[],this.measureStart=null}this.mode=a,this.buttons[a]&&OpenLayers.Util.modifyAlphaImageDiv(this.buttons[a],null,null,null,this.buttons[a].activeImgLocation);switch(this.mode){case"zoombox":this.map.div.style.cursor="crosshair";break;default:this.map.div.style.cursor=""}}},leaveMode:function(){this.switchModeTo("pan")},defaultMouseMove:function(a){if(this.mouseDragStart!=null){switch(this.mode){case"zoombox":var b=Math.abs(this.mouseDragStart.x-a.xy.x),c=Math.abs(this.mouseDragStart.y-a.xy.y);this.zoomBox.style.width=Math.max(1,b)+"px",this.zoomBox.style.height=Math.max(1,c)+"px",a.xy.x<this.mouseDragStart.x&&(this.zoomBox.style.left=a.xy.x+"px"),a.xy.y<this.mouseDragStart.y&&(this.zoomBox.style.top=a.xy.y+"px");break;default:var b=this.mouseDragStart.x-a.xy.x,c=this.mouseDragStart.y-a.xy.y,d=this.map.getSize(),e=new OpenLayers.Pixel(d.w/2+b,d.h/2+c),f=this.map.getLonLatFromViewPortPx(e);this.map.setCenter(f,null,!0),this.mouseDragStart=a.xy.clone()}this.performedDrag=!0}},defaultMouseUp:function(a){if(OpenLayers.Event.isLeftClick(a)){switch(this.mode){case"zoombox":this.zoomBoxEnd(a),this.startViaKeyboard&&this.leaveMode();break;case"pan":this.performedDrag&&this.map.setCenter(this.map.center)}document.onselectstart=null,this.mouseDragStart=null,this.map.div.style.cursor="default"}},defaultMouseOut:function(a){this.mouseDragStart!=null&&OpenLayers.Util.mouseLeft(a,this.map.div)&&(this.zoomBox&&(this.removeZoomBox(),this.startViaKeyboard&&this.leaveMode()),this.mouseDragStart=null,this.map.div.style.cursor="default")},defaultClick:function(a){if(this.performedDrag){this.performedDrag=!1;return!1}},CLASS_NAME:"OpenLayers.Control.MouseToolbar"}),OpenLayers.Control.MouseToolbar.X=6,OpenLayers.Control.MouseToolbar.Y=300,OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:!0,clearOnDeactivate:!1,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:!1,initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]),this.registry=OpenLayers.Util.extend({moveend:this.getState},this.registry);var b={trigger:OpenLayers.Function.bind(this.previousTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};OpenLayers.Util.extend(b,this.previousOptions),this.previous=new OpenLayers.Control.Button(b);var c={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(c,this.nextOptions),this.next=new OpenLayers.Control.Button(c),this.clear()},onPreviousChange:function(a,b){a&&!this.previous.active?this.previous.activate():!a&&this.previous.active&&this.previous.deactivate()},onNextChange:function(a,b){a&&!this.next.active?this.next.activate():!a&&this.next.active&&this.next.deactivate()},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this),this.previous.destroy(),this.next.destroy(),this.deactivate();for(var a in this)this[a]=null},setMap:function(a){this.map=a,this.next.setMap(a),this.previous.setMap(a)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),this.next.draw(),this.previous.draw()},previousTrigger:function(){var a=this.previousStack.shift(),b=this.previousStack.shift();b!=undefined?(this.nextStack.unshift(a),this.previousStack.unshift(b),this.restoring=!0,this.restore(b),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)):this.previousStack.unshift(a);return b},nextTrigger:function(){var a=this.nextStack.shift();a!=undefined&&(this.previousStack.unshift(a),this.restoring=!0,this.restore(a),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1));return a},clear:function(){this.previousStack=[],this.previous.deactivate(),this.nextStack=[],this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution()}},restore:function(a){var b=this.map.getZoomForResolution(a.resolution);this.map.setCenter(a.center,b)},setListeners:function(){this.listeners={};for(var a in this.registry)this.listeners[a]=OpenLayers.Function.bind(function(){if(!this.restoring){var b=this.registry[a].apply(this,arguments);this.previousStack.unshift(b),this.previousStack.length>1&&this.onPreviousChange(this.previousStack[1],this.previousStack.length-1),this.previousStack.length>this.limit+1&&this.previousStack.pop(),this.nextStack.length>0&&(this.nextStack=[],this.onNextChange(null,0))}return!0},this)},activate:function(){var a=!1;if(this.map)if(OpenLayers.Control.prototype.activate.apply(this)){this.listeners==null&&this.setListeners();for(var b in this.listeners)this.map.events.register(b,this,this.listeners[b]);a=!0,this.previousStack.length==0&&this.initStack()}return a},initStack:function(){this.map.getCenter()&&this.listeners.moveend()},deactivate:function(){var a=!1;if(this.map)if(OpenLayers.Control.prototype.deactivate.apply(this)){for(var b in this.listeners)this.map.events.unregister(b,this,this.listeners[b]);this.clearOnDeactivate&&this.clear(),a=!0}return a},CLASS_NAME:"OpenLayers.Control.NavigationHistory"}),OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{slideFactor:50,initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]),this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,{slideFactor:this.slideFactor}),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,{slideFactor:this.slideFactor}),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,{slideFactor:this.slideFactor}),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,{slideFactor:this.slideFactor})])},CLASS_NAME:"OpenLayers.Control.PanPanel"}),OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoombarDiv:null,divEvents:null,zoomWorldIcon:!1,forceFixedZoomLevel:!1,mouseDragStart:null,zoomStart:null,initialize:function(){OpenLayers.Control.PanZoom.prototype.initialize.apply(this,arguments)},destroy:function(){this._removeZoomBar(),this.map.events.un({changebaselayer:this.redraw,scope:this}),OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments),delete this.mouseDragStart,delete this.zoomStart},setMap:function(a){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,arguments),this.map.events.register("changebaselayer",this,this.redraw)},redraw:function(){this.div!=null&&(this.removeButtons(),this._removeZoomBar()),this.draw()},draw:function(a){OpenLayers.Control.prototype.draw.apply(this,arguments),a=this.position.clone(),this.buttons=[];var b=new OpenLayers.Size(18,18),c=new OpenLayers.Pixel(a.x+b.w/2,a.y),d=b.w;this.zoomWorldIcon&&(c=new OpenLayers.Pixel(a.x+b.w,a.y)),this._addButton("panup","north-mini.png",c,b),a.y=c.y+b.h,this._addButton("panleft","west-mini.png",a,b),this.zoomWorldIcon&&(this._addButton("zoomworld","zoom-world-mini.png",a.add(b.w,0),b),d*=2),this._addButton("panright","east-mini.png",a.add(d,0),b),this._addButton("pandown","south-mini.png",c.add(0,b.h*2),b),this._addButton("zoomin","zoom-plus-mini.png",c.add(0,b.h*3+5),b),c=this._addZoomBar(c.add(0,b.h*4+5)),this._addButton("zoomout","zoom-minus-mini.png",c,b);return this.div},_addZoomBar:function(a){var b=OpenLayers.Util.getImagesLocation(),c=this.id+"_"+this.map.id,d=this.map.getNumZoomLevels()-1-this.map.getZoom(),e=OpenLayers.Util.createAlphaImageDiv(c,a.add(-1,d*this.zoomStopHeight),new OpenLayers.Size(20,9),b+"slider.png","absolute");this.slider=e,this.sliderEvents=new OpenLayers.Events(this,e,null,!0,{includeXY:!0}),this.sliderEvents.on({mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp,dblclick:this.doubleClick,click:this.doubleClick});var f=new OpenLayers.Size;f.h=this.zoomStopHeight*this.map.getNumZoomLevels(),f.w=this.zoomStopWidth;var g=null;if(OpenLayers.Util.alphaHack()){var c=this.id+"_"+this.map.id;g=OpenLayers.Util.createAlphaImageDiv(c,a,new OpenLayers.Size(f.w,this.zoomStopHeight),b+"zoombar.png","absolute",null,"crop"),g.style.height=f.h+"px"}else g=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,a,f,b+"zoombar.png");this.zoombarDiv=g,this.divEvents=new OpenLayers.Events(this,g,null,!0,{includeXY:!0}),this.divEvents.on({mousedown:this.divClick,mousemove:this.passEventToSlider,dblclick:this.doubleClick,click:this.doubleClick}),this.div.appendChild(g),this.startTop=parseInt(g.style.top),this.div.appendChild(e),this.map.events.register("zoomend",this,this.moveZoomBar),a=a.add(0,this.zoomStopHeight*this.map.getNumZoomLevels());return a},_removeZoomBar:function(){this.sliderEvents.un({mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp,dblclick:this.doubleClick,click:this.doubleClick}),this.sliderEvents.destroy(),this.divEvents.un({mousedown:this.divClick,mousemove:this.passEventToSlider,dblclick:this.doubleClick,click:this.doubleClick}),this.divEvents.destroy(),this.div.removeChild(this.zoombarDiv),this.zoombarDiv=null,this.div.removeChild(this.slider),this.slider=null,this.map.events.unregister("zoomend",this,this.moveZoomBar)},passEventToSlider:function(a){this.sliderEvents.handleBrowserEvent(a)},divClick:function(a){if(OpenLayers.Event.isLeftClick(a)){var b=a.xy.y,c=OpenLayers.Util.pagePosition(a.object)[1],d=(b-c)/this.zoomStopHeight;if(this.forceFixedZoomLevel||!this.map.fractionalZoom)d=Math.floor(d);var e=this.map.getNumZoomLevels()-1-d;e=Math.min(Math.max(e,0),this.map.getNumZoomLevels()-1),this.map.zoomTo(e),OpenLayers.Event.stop(a)}},zoomBarDown:function(a){OpenLayers.Event.isLeftClick(a)&&(this.map.events.on({mousemove:this.passEventToSlider,mouseup:this.passEventToSlider,scope:this}),this.mouseDragStart=a.xy.clone(),this.zoomStart=a.xy.clone(),this.div.style.cursor="move",this.zoombarDiv.offsets=null,OpenLayers.Event.stop(a))},zoomBarDrag:function(a){if(this.mouseDragStart!=null){var b=this.mouseDragStart.y-a.xy.y,c=OpenLayers.Util.pagePosition(this.zoombarDiv);if(a.clientY-c[1]>0&&a.clientY-c[1]<parseInt(this.zoombarDiv.style.height)-2){var d=parseInt(this.slider.style.top)-b;this.slider.style.top=d+"px",this.mouseDragStart=a.xy.clone()}OpenLayers.Event.stop(a)}},zoomBarUp:function(a){if(OpenLayers.Event.isLeftClick(a))if(this.mouseDragStart){this.div.style.cursor="",this.map.events.un({mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var b=this.zoomStart.y-a.xy.y,c=this.map.zoom;!this.forceFixedZoomLevel&&this.map.fractionalZoom?(c+=b/this.zoomStopHeight,c=Math.min(Math.max(c,0),this.map.getNumZoomLevels()-1)):c+=Math.round(b/this.zoomStopHeight),this.map.zoomTo(c),this.mouseDragStart=null,this.zoomStart=null,OpenLayers.Event.stop(a)}},moveZoomBar:function(){var a=(this.map.getNumZoomLevels()-1-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.slider.style.top=a+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"}),OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,base:"",displayProjection:null,initialize:function(a,b,c){OpenLayers.Control.prototype.initialize.apply(this,[c]),this.element=OpenLayers.Util.getElement(a),this.base=b||document.location.href},destroy:function(){this.element.parentNode==this.div&&this.div.removeChild(this.element),this.element=null,this.map.events.unregister("moveend",this,this.updateLink),OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var b=0,c=this.map.controls.length;b<c;b++){var d=this.map.controls[b];if(d.CLASS_NAME==this.argParserClass.CLASS_NAME){d.displayProjection!=this.displayProjection&&(this.displayProjection=d.displayProjection);break}}b==this.map.controls.length&&this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.div.className=this.displayClass,this.element=document.createElement("a"),this.element.innerHTML=OpenLayers.i18n("permalink"),this.element.href="",this.div.appendChild(this.element)),this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,changebaselayer:this.updateLink,scope:this}),this.updateLink();return this.div},updateLink:function(){var a=this.base;a.indexOf("?")!=-1&&(a=a.substring(0,a.indexOf("?"))),a+="?"+OpenLayers.Util.getParameterString(this.createParams()),this.element.href=a},createParams:function(a,b,c){a=a||this.map.getCenter();var d=OpenLayers.Util.getParameters(this.base);if(a){d.zoom=b||this.map.getZoom();var e=a.lat,f=a.lon;if(this.displayProjection){var g=OpenLayers.Projection.transform({x:f,y:e},this.map.getProjectionObject(),this.displayProjection);f=g.x,e=g.y}d.lat=Math.round(e*1e5)/1e5,d.lon=Math.round(f*1e5)/1e5,c=c||this.map.layers,d.layers="";for(var h=0,i=c.length;h<i;h++){var j=c[h];j.isBaseLayer?d.layers+=j==this.map.baseLayer?"B":"0":d.layers+=j.getVisibility()?"T":"F"}}return d},CLASS_NAME:"OpenLayers.Control.Permalink"}),OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]),this.addControls([new OpenLayers.Control.ZoomIn,new OpenLayers.Control.ZoomToMaxExtent,new OpenLayers.Control.ZoomOut])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"}),OpenLayers.Format.CSWGetDomain=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetDomain.DEFAULTS);var b=OpenLayers.Format.CSWGetDomain["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSWGetDomain version: "+a.version;return new b(a)},OpenLayers.Format.CSWGetDomain.DEFAULTS={version:"2.0.2"},OpenLayers.Format.CSWGetRecords=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.CSWGetRecords.DEFAULTS);var b=OpenLayers.Format.CSWGetRecords["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported CSWGetRecords version: "+a.version;return new b(a)},OpenLayers.Format.CSWGetRecords.DEFAULTS={version:"2.0.2"},OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,initialize:function(a){OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(json,filter){try{if(/^[\],:{}\s]*$/.test(json.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var object=eval("("+json+")");if(typeof filter==="function"){function walk(a,b){if(b&&typeof b==="object")for(var c in b)b.hasOwnProperty(c)&&(b[c]=walk(c,b[c]));return filter(a,b)}object=walk("",object)}this.keepData&&(this.data=object);return object}}catch(e){}return null},write:function(a,b){this.pretty=!!b;var c=null,d=typeof a;if(this.serialize[d])try{c=this.serialize[d].apply(this,[a])}catch(e){OpenLayers.Console.error("Trouble serializing: "+e)}return c},writeIndent:function(){var a=[];if(this.pretty)for(var b=0;b<this.level;++b)a.push(this.indent);return a.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(a){if(a==null)return"null";if(a.constructor==Date)return this.serialize.date.apply(this,[a]);if(a.constructor==Array)return this.serialize.array.apply(this,[a]);var b=["{"];this.level+=1;var c,d,e,f=!1;for(c in a)a.hasOwnProperty(c)&&(d=OpenLayers.Format.JSON.prototype.write.apply(this,[c,this.pretty]),e=OpenLayers.Format.JSON.prototype.write.apply(this,[a[c],this.pretty]),d!=null&&e!=null&&(f&&b.push(","),b.push(this.writeNewline(),this.writeIndent(),d,":",this.writeSpace(),e),f=!0));this.level-=1,b.push(this.writeNewline(),this.writeIndent(),"}");return b.join("")},array:function(a){var b,c=["["];this.level+=1;for(var d=0,e=a.length;d<e;++d)b=OpenLayers.Format.JSON.prototype.write.apply(this,[a[d],this.pretty]),b!=null&&(d>0&&c.push(","),c.push(this.writeNewline(),this.writeIndent(),b));this.level-=1,c.push(this.writeNewline(),this.writeIndent(),"]");return c.join("")},string:function(a){var b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(/["\\\x00-\x1f]/.test(a))return'"'+a.replace(/([\x00-\x1f\\"])/g,function(a,c){var d=b[c];if(d)return d;d=c.charCodeAt();return"\\u00"+Math.floor(d/16).toString(16)+(d%16).toString(16)})+'"';return'"'+a+'"'},number:function(a){return isFinite(a)?String(a):"null"},"boolean":function(a){return String(a)},date:function(a){function b(a){return a<10?"0"+a:a}return'"'+a.getFullYear()+"-"+b(a.getMonth()+1)+"-"+b(a.getDate())+"T"+b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"}),OpenLayers.Format.WFST=function(a){a=OpenLayers.Util.applyDefaults(a,OpenLayers.Format.WFST.DEFAULTS);var b=OpenLayers.Format.WFST["v"+a.version.replace(/\./g,"_")];if(!b)throw"Unsupported WFST version: "+a.version;return new b(a)},OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"},OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(a){window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM")),OpenLayers.Format.prototype.initialize.apply(this,[a]),this.namespaces=OpenLayers.Util.extend({},this.namespaces),this.namespaceAlias={};for(var b in this.namespaces)this.namespaceAlias[this.namespaces[b]]=b},destroy:function(){this.xmldom=null,OpenLayers.Format.prototype.destroy.apply(this,arguments)},setNamespace:function(a,b){this.namespaces[a]=b,this.namespaceAlias[b]=a},read:function(a){var b=a.indexOf("<");b>0&&(a=a.substring(b));var c=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var b;window.ActiveXObject&&!this.xmldom?b=new ActiveXObject("Microsoft.XMLDOM"):b=this.xmldom,b.loadXML(a);return b},this),function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var b=new XMLHttpRequest;b.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),!1),b.overrideMimeType&&b.overrideMimeType("text/xml"),b.send(null);return b.responseXML});this.keepData&&(this.data=c);return c},write:function(a){var b;if(this.xmldom)b=a.xml;else{var c=new XMLSerializer;if(a.nodeType==1){var d=document.implementation.createDocument("","",null);d.importNode&&(a=d.importNode(a,!0)),d.appendChild(a),b=c.serializeToString(d)}else b=c.serializeToString(a)}return b},createElementNS:function(a,b){var c;this.xmldom?typeof a=="string"?c=this.xmldom.createNode(1,b,a):c=this.xmldom.createNode(1,b,""):c=document.createElementNS(a,b);return c},createTextNode:function(a){var b;this.xmldom?b=this.xmldom.createTextNode(a):b=document.createTextNode(a);return b},getElementsByTagNameNS:function(a,b,c){var d=[];if(a.getElementsByTagNameNS)d=a.getElementsByTagNameNS(b,c);else{var e=a.getElementsByTagName("*"),f,g;for(var h=0,i=e.length;h<i;++h){f=e[h],g=f.prefix?f.prefix+":"+c:c;if(c=="*"||g==f.nodeName)(b=="*"||b==f.namespaceURI)&&d.push(f)}}return d},getAttributeNodeNS:function(a,b,c){var d=null;if(a.getAttributeNodeNS)d=a.getAttributeNodeNS(b,c);else{var e=a.attributes,f,g;for(var h=0,i=e.length;h<i;++h){f=e[h];if(f.namespaceURI==b){g=f.prefix?f.prefix+":"+c:c;if(g==f.nodeName){d=f;break}}}}return d},getAttributeNS:function(a,b,c){var d="";if(a.getAttributeNS)d=a.getAttributeNS(b,c)||"";else{var e=this.getAttributeNodeNS(a,b,c);e&&(d=e.nodeValue)}return d},getChildValue:function(a,b){var c=b||"";if(a)for(var d=a.firstChild;d;d=d.nextSibling)switch(d.nodeType){case 3:case 4:c+=d.nodeValue}return c},concatChildValues:function(a,b){var c="",d=a.firstChild,e;while(d)e=d.nodeValue,e&&(c+=e),d=d.nextSibling;c==""&&b!=undefined&&(c=b);return c},isSimpleContent:function(a){var b=!0;for(var c=a.firstChild;c;c=c.nextSibling)if(c.nodeType===1){b=!1;break}return b},contentType:function(a){var b=!1,c=!1,d=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY;for(var e=a.firstChild;e;e=e.nextSibling){switch(e.nodeType){case 1:c=!0;break;case 8:break;default:b=!0}if(c&&b)break}if(c&&b)d=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(c)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(b)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return d},hasAttributeNS:function(a,b,c){var d=!1;a.hasAttributeNS?d=a.hasAttributeNS(b,c):d=!!this.getAttributeNodeNS(a,b,c);return d},setAttributeNS:function(a,b,c,d){if(a.setAttributeNS)a.setAttributeNS(b,c,d);else{if(!this.xmldom)throw"setAttributeNS not implemented";if(b){var e=a.ownerDocument.createNode(2,c,b);e.nodeValue=d,a.setAttributeNode(e)}else a.setAttribute(c,d)}},createElementNSPlus:function(a,b){b=b||{};var c=b.uri||this.namespaces[b.prefix];if(!c){var d=a.indexOf(":");c=this.namespaces[a.substring(0,d)]}c||(c=this.namespaces[this.defaultPrefix]);var e=this.createElementNS(c,a);b.attributes&&this.setAttributes(e,b.attributes);var f=b.value;f!=null&&(typeof f=="boolean"&&(f=String(f)),e.appendChild(this.createTextNode(f)));return e},setAttributes:function(a,b){var c,d;for(var e in b)b[e]!=null&&b[e].toString&&(c=b[e].toString(),d=this.namespaces[e.substring(0,e.indexOf(":"))]||null,this.setAttributeNS(a,d,e,c))},readNode:function(a,b){b||(b={});var c=this.readers[a.namespaceURI?this.namespaceAlias[a.namespaceURI]:this.defaultPrefix];if(c){var d=a.localName||a.nodeName.split(":").pop(),e=c[d]||c["*"];e&&e.apply(this,[a,b])}return b},readChildNodes:function(a,b){b||(b={});var c=a.childNodes,d;for(var e=0,f=c.length;e<f;++e)d=c[e],d.nodeType==1&&this.readNode(d,b);return b},writeNode:function(a,b,c){var d,e,f=a.indexOf(":");f>0?(d=a.substring(0,f),e=a.substring(f+1)):(c?d=this.namespaceAlias[c.namespaceURI]:d=this.defaultPrefix,e=a);var g=this.writers[d][e].apply(this,[b]);c&&c.appendChild(g);return g},getChildEl:function(a,b,c){return a&&this.getThisOrNextEl(a.firstChild,b,c)},getNextEl:function(a,b,c){return a&&this.getThisOrNextEl(a.nextSibling,b,c)},getThisOrNextEl:function(a,b,c){outer:for(var d=a;d;d=d.nextSibling)switch(d.nodeType){case 1:if((!b||b===(d.localName||d.nodeName.split(":").pop()))&&(!c||c===d.namespaceURI))break outer;d=null;break outer;case 3:if(/^\s*$/.test(d.nodeValue))break;case 4:case 6:case 12:case 10:case 11:d=null;break outer}return d||null},lookupNamespaceURI:function(a,b){var c=null;if(a)if(a.lookupNamespaceURI)c=a.lookupNamespaceURI(b);else outer:switch(a.nodeType){case 1:if(a.namespaceURI!==null&&a.prefix===b){c=a.namespaceURI;break outer}var d=a.attributes.length;if(d){var e;for(var f=0;f<d;++f){e=a.attributes[f];if(e.prefix==="xmlns"&&e.name==="xmlns:"+b){c=e.value||null;break outer}if(e.name==="xmlns"&&b===null){c=e.value||null;break outer}}}c=this.lookupNamespaceURI(a.parentNode,b);break outer;case 2:c=this.lookupNamespaceURI(a.ownerElement,b);break outer;case 9:c=this.lookupNamespaceURI(a.documentElement,b);break outer;case 6:case 12:case 10:case 11:break outer;default:c=this.lookupNamespaceURI(a.parentNode,b);break outer}return c},CLASS_NAME:"OpenLayers.Format.XML"}),OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3},OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype),OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,initialize:function(a,b,c){OpenLayers.Util.extend(this,c),this.control=a,this.callbacks=b,a.map&&this.setMap(a.map),OpenLayers.Util.extend(this,c),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(a){this.map=a},checkModifiers:function(a){if(this.keyMask==null)return!0;var b=(a.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(a.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(a.altKey?OpenLayers.Handler.MOD_ALT:0);return b==this.keyMask},activate:function(){if(this.active)return!1;var a=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var b=0,c=a.length;b<c;b++)this[a[b]]&&this.register(a[b],this[a[b]]);this.active=!0;return!0},deactivate:function(){if(!this.active)return!1;var a=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var b=0,c=a.length;b<c;b++)this[a[b]]&&this.unregister(a[b],this[a[b]]);this.active=!1;return!0},callback:function(a,b){a&&this.callbacks[a]&&this.callbacks[a].apply(this.control,b)},register:function(a,b){this.map.events.registerPriority(a,this,b),this.map.events.registerPriority(a,this,this.setEvent)},unregister:function(a,b){this.map.events.unregister(a,this,b),this.map.events.unregister(a,this,this.setEvent)},setEvent:function(a){this.evt=a;return!0},destroy:function(){this.deactivate(),this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"}),OpenLayers.Handler.MOD_NONE=0,OpenLayers.Handler.MOD_SHIFT=1,OpenLayers.Handler.MOD_CTRL=2,OpenLayers.Handler.MOD_ALT=4,OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1e3},EVENT_TYPES:["preaddlayer","addlayer","removelayer","changelayer","movestart","move","moveend","zoomend","popupopen","popupclose","addmarker","removemarker","clearmarkers","mouseover","mouseout","mousemove","dragstart","drag","dragend","changebaselayer"],id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,viewRequestID:0,tileSize:null,projection:"EPSG:4326",units:"degrees",resolutions:null,maxResolution:1.40625,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!0,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,initialize:function(a,b){arguments.length===1&&typeof a==="object"&&(b=a,a=b&&b.div),this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT),this.maxExtent=new OpenLayers.Bounds(-180,-90,180,90),this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15),this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css",OpenLayers.Util.extend(this,b),this.layers=[],this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_"),this.div=OpenLayers.Util.getElement(a),this.div||(this.div=document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px"),OpenLayers.Element.addClass(this.div,"olMap");var c=this.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(c,null,null,null,"relative",null,"hidden"),this.viewPortDiv.style.width="100%",this.viewPortDiv.style.height="100%",this.viewPortDiv.className="olMapViewport",this.div.appendChild(this.viewPortDiv),c=this.id+"_OpenLayers_Container",this.layerContainerDiv=OpenLayers.Util.createDiv(c),this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1,this.viewPortDiv.appendChild(this.layerContainerDiv),this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES,this.fallThrough,{includeXY:!0}),this.updateSize(),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),this.events.register("movestart",this,this.updateSize),OpenLayers.String.contains(navigator.appName,"Microsoft")?this.events.register("resize",this,this.updateSize):(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy));if(this.theme){var d=!0,e=document.getElementsByTagName("link");for(var f=0,g=e.length;f<g;++f)if(OpenLayers.Util.isEquivalentUrl(e.item(f).href,this.theme)){d=!1;break}if(d){var h=document.createElement("link");h.setAttribute("rel","stylesheet"),h.setAttribute("type","text/css"),h.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(h)}}this.controls==null&&(OpenLayers.Control!=null?this.controls=[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanZoom,new OpenLayers.Control.ArgParser,new OpenLayers.Control.Attribution]:this.controls=[]);for(var f=0,g=this.controls.length;f<g;f++)this.addControlToMap(this.controls[f]);this.popups=[],this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this),OpenLayers.Event.observe(window,"unload",this.unloadDestroy),b&&b.layers&&(this.addLayers(b.layers),b.center&&this.setCenter(b.center,b.zoom))},render:function(a){this.div=OpenLayers.Util.getElement(a),OpenLayers.Element.addClass(this.div,"olMap"),this.events.attachToElement(this.div),this.viewPortDiv.parentNode.removeChild(this.viewPortDiv),this.div.appendChild(this.viewPortDiv),this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;this.panTween&&this.panTween.playing&&this.panTween.stop(),OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy),this.unloadDestroy=null,this.updateSizeDestroy?OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy):this.events.unregister("resize",this,this.updateSize),this.paddingForPopups=null;if(this.controls!=null){for(var a=this.controls.length-1;a>=0;--a)this.controls[a].destroy();this.controls=null}if(this.layers!=null){for(var a=this.layers.length-1;a>=0;--a)this.layers[a].destroy(!1);this.layers=null}this.viewPortDiv&&this.div.removeChild(this.viewPortDiv),this.viewPortDiv=null,this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null),this.events.destroy(),this.events=null},setOptions:function(a){OpenLayers.Util.extend(this,a)},getTileSize:function(){return this.tileSize},getBy:function(a,b,c){var d=typeof c.test=="function",e=OpenLayers.Array.filter(this[a],function(a){return a[b]==c||d&&c.test(a[b])});return e},getLayersBy:function(a,b){return this.getBy("layers",a,b)},getLayersByName:function(a){return this.getLayersBy("name",a)},getLayersByClass:function(a){return this.getLayersBy("CLASS_NAME",a)},getControlsBy:function(a,b){return this.getBy("controls",a,b)},getControlsByClass:function(a){return this.getControlsBy("CLASS_NAME",a)},getLayer:function(a){var b=null;for(var c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];if(e.id==a){b=e;break}}return b},setLayerZIndex:function(a,b){a.setZIndex(this.Z_INDEX_BASE[a.isBaseLayer?"BaseLayer":"Overlay"]+b*5)},resetLayersZIndex:function(){for(var a=0,b=this.layers.length;a<b;a++){var c=this.layers[a];this.setLayerZIndex(c,a)}},addLayer:function(a){for(var b=0,c=this.layers.length;b<c;b++)if(this.layers[b]==a){var d=OpenLayers.i18n("layerAlreadyAdded",{layerName:a.name});OpenLayers.Console.warn(d);return!1}this.allOverlays&&(a.isBaseLayer=!1);this.events.triggerEvent("preaddlayer",{layer:a})!==!1&&(a.div.className="olLayerDiv",a.div.style.overflow="",this.setLayerZIndex(a,this.layers.length),a.isFixed?this.viewPortDiv.appendChild(a.div):this.layerContainerDiv.appendChild(a.div),this.layers.push(a),a.setMap(this),a.isBaseLayer||this.allOverlays&&!this.baseLayer?this.baseLayer==null?this.setBaseLayer(a):a.setVisibility(!1):a.redraw(),this.events.triggerEvent("addlayer",{layer:a}),a.afterAdd())},addLayers:function(a){for(var b=0,c=a.length;b<c;b++)this.addLayer(a[b])},removeLayer:function(a,b){b==null&&(b=!0),a.isFixed?this.viewPortDiv.removeChild(a.div):this.layerContainerDiv.removeChild(a.div),OpenLayers.Util.removeItem(this.layers,a),a.removeMap(this),a.map=null;if(this.baseLayer==a){this.baseLayer=null;if(b)for(var c=0,d=this.layers.length;c<d;c++){var e=this.layers[c];if(e.isBaseLayer||this.allOverlays){this.setBaseLayer(e);break}}}this.resetLayersZIndex(),this.events.triggerEvent("removelayer",{layer:a})},getNumLayers:function(){return this.layers.length},getLayerIndex:function(a){return OpenLayers.Util.indexOf(this.layers,a)},setLayerIndex:function(a,b){var c=this.getLayerIndex(a);b<0?b=0:b>this.layers.length&&(b=this.layers.length);if(c!=b){this.layers.splice(c,1),this.layers.splice(b,0,a);for(var d=0,e=this.layers.length;d<e;d++)this.setLayerZIndex(this.layers[d],d);this.events.triggerEvent("changelayer",{layer:a,property:"order"}),this.allOverlays&&(b===0?this.setBaseLayer(a):this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(a,b){var c=this.getLayerIndex(a)+b;this.setLayerIndex(a,c)},setBaseLayer:function(a){if(a!=this.baseLayer)if(OpenLayers.Util.indexOf(this.layers,a)!=-1){var b=this.getCenter(),c=OpenLayers.Util.getResolutionFromScale(this.getScale(),a.units);this.baseLayer!=null&&!this.allOverlays&&this.baseLayer.setVisibility(!1),this.baseLayer=a,this.viewRequestID++,(!this.allOverlays||this.baseLayer.visibility)&&this.baseLayer.setVisibility(!0);if(b!=null){var d=this.getZoomForResolution(c||this.resolution,!0);this.setCenter(b,d,!1,!0)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(a,b){this.controls.push(a),this.addControlToMap(a,b)},addControls:function(a,b){var c=arguments.length===1?[]:b;for(var d=0,e=a.length;d<e;d++){var f=a[d],g=c[d]?c[d]:null;this.addControl(f,g)}},addControlToMap:function(a,b){a.outsideViewport=a.div!=null,this.displayProjection&&!a.displayProjection&&(a.displayProjection=this.displayProjection),a.setMap(this);var c=a.draw(b);c&&(a.outsideViewport||(c.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(c))),a.autoActivate&&a.activate()},getControl:function(a){var b=null;for(var c=0,d=this.controls.length;c<d;c++){var e=this.controls[c];if(e.id==a){b=e;break}}return b},removeControl:function(a){a&&a==this.getControl(a.id)&&(a.div&&a.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(a.div),OpenLayers.Util.removeItem(this.controls,a))},addPopup:function(a,b){if(b)for(var c=this.popups.length-1;c>=0;--c)this.removePopup(this.popups[c]);a.map=this,this.popups.push(a);var d=a.draw();d&&(d.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(d))},removePopup:function(a){OpenLayers.Util.removeItem(this.popups,a);if(a.div)try{this.layerContainerDiv.removeChild(a.div)}catch(b){}a.map=null},getSize:function(){var a=null;this.size!=null&&(a=this.size.clone());return a},updateSize:function(){var a=this.getCurrentSize();if(a&&!isNaN(a.h)&&!isNaN(a.w)){this.events.clearMouseCache();var b=this.getSize();b==null&&(this.size=b=a);if(!a.equals(b)){this.size=a;for(var c=0,d=this.layers.length;c<d;c++)this.layers[c].onMapResize();var e=this.getCenter();if(this.baseLayer!=null&&e!=null){var f=this.getZoom();this.zoom=null,this.setCenter(e,f)}}}},getCurrentSize:function(){var a=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(a.w==0&&a.h==0||isNaN(a.w)&&isNaN(a.h))a.w=this.div.offsetWidth,a.h=this.div.offsetHeight;if(a.w==0&&a.h==0||isNaN(a.w)&&isNaN(a.h))a.w=parseInt(this.div.style.width),a.h=parseInt(this.div.style.height);return a},calculateBounds:function(a,b){var c=null;a==null&&(a=this.getCenter()),b==null&&(b=this.getResolution());if(a!=null&&b!=null){var d=this.getSize(),e=d.w*b,f=d.h*b;c=new OpenLayers.Bounds(a.lon-e/2,a.lat-f/2,a.lon+e/2,a.lat+f/2)}return c},getCenter:function(){var a=null;this.center&&(a=this.center.clone());return a},getZoom:function(){return this.zoom},pan:function(a,b,c){c=OpenLayers.Util.applyDefaults(c,{animate:!0,dragging:!1});var d=this.getViewPortPxFromLonLat(this.getCenter()),e=d.add(a,b);if(!c.dragging||!e.equals(d)){var f=this.getLonLatFromViewPortPx(e);c.animate?this.panTo(f):this.setCenter(f,null,c.dragging)}},panTo:function(a){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(a)){this.panTween||(this.panTween=new OpenLayers.Tween(this.panMethod));var b=this.getCenter();if(a.lon==b.lon&&a.lat==b.lat)return;var c={lon:b.lon,lat:b.lat},d={lon:a.lon,lat:a.lat};this.panTween.start(c,d,this.panDuration,{callbacks:{start:OpenLayers.Function.bind(function(a){this.events.triggerEvent("movestart")},this),eachStep:OpenLayers.Function.bind(function(a){a=new OpenLayers.LonLat(a.lon,a.lat),this.moveTo(a,this.zoom,{dragging:!0,noEvent:!0})},this),done:OpenLayers.Function.bind(function(a){a=new OpenLayers.LonLat(a.lon,a.lat),this.moveTo(a,this.zoom,{noEvent:!0}),this.events.triggerEvent("moveend")},this)}})}else this.setCenter(a)},setCenter:function(a,b,c,d){this.moveTo(a,b,{dragging:c,forceZoomChange:d,caller:"setCenter"})},moveTo:function(a,b,c){c||(c={}),b!=null&&(b=parseFloat(b),this.fractionalZoom||(b=Math.round(b)));var d=c.dragging,e=c.forceZoomChange,f=c.noEvent;this.panTween&&c.caller=="setCenter"&&this.panTween.stop(),!this.center&&!this.isValidLonLat(a)&&(a=this.maxExtent.getCenterLonLat());if(this.restrictedExtent!=null){a==null&&(a=this.getCenter()),b==null&&(b=this.getZoom());var g=this.getResolutionForZoom(b),h=this.calculateBounds(a,g);if(!this.restrictedExtent.containsBounds(h)){var i=this.restrictedExtent.getCenterLonLat();h.getWidth()>this.restrictedExtent.getWidth()?a=new OpenLayers.LonLat(i.lon,a.lat):h.left<this.restrictedExtent.left?a=a.add(this.restrictedExtent.left-h.left,0):h.right>this.restrictedExtent.right&&(a=a.add(this.restrictedExtent.right-h.right,0)),h.getHeight()>this.restrictedExtent.getHeight()?a=new OpenLayers.LonLat(a.lon,i.lat):h.bottom<this.restrictedExtent.bottom?a=a.add(0,this.restrictedExtent.bottom-h.bottom):h.top>this.restrictedExtent.top&&(a=a.add(0,this.restrictedExtent.top-h.top))}}var j=e||this.isValidZoomLevel(b)&&b!=this.getZoom(),k=this.isValidLonLat(a)&&!a.equals(this.center);if(j||k||!d){!this.dragging&&!f&&this.events.triggerEvent("movestart"),k&&(!j&&this.center&&this.centerLayerContainer(a),this.center=a.clone());if(j||this.layerContainerOrigin==null)this.layerContainerOrigin=this.center.clone(),this.layerContainerDiv.style.left="0px",this.layerContainerDiv.style.top="0px";j&&(this.zoom=b,this.resolution=this.getResolutionForZoom(b),this.viewRequestID++);var l=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(l,j,d),d?this.baseLayer.events.triggerEvent("move"):this.baseLayer.events.triggerEvent("moveend",{zoomChanged:j})),l=this.baseLayer.getExtent();for(var m=0,n=this.layers.length;m<n;m++){var o=this.layers[m];if(o!==this.baseLayer&&!o.isBaseLayer){var p=o.calculateInRange();o.inRange!=p&&(o.inRange=p,p||o.display(!1),this.events.triggerEvent("changelayer",{layer:o,property:"visibility"})),p&&o.visibility&&(o.moveTo(l,j,d),d?o.events.triggerEvent("move"):o.events.triggerEvent("moveend",{zoomChanged:j}))}}if(j)for(var m=0,n=this.popups.length;m<n;m++)this.popups[m].updatePosition();this.events.triggerEvent("move"),j&&this.events.triggerEvent("zoomend")}!d&&!f&&this.events.triggerEvent("moveend"),this.dragging=!!d},centerLayerContainer:function(a){var b=this.getViewPortPxFromLonLat(this.layerContainerOrigin),c=this.getViewPortPxFromLonLat(a);b!=null&&c!=null&&(this.layerContainerDiv.style.left=Math.round(b.x-c.x)+"px",this.layerContainerDiv.style.top=Math.round(b.y-c.y)+"px")},isValidZoomLevel:function(a){return a!=null&&a>=0&&a<this.getNumZoomLevels()},isValidLonLat:function(a){var b=!1;if(a!=null){var c=this.getMaxExtent();b=c.containsLonLat(a)}return b},getProjection:function(){var a=this.getProjectionObject();return a?a.getCode():null},getProjectionObject:function(){var a=null;this.baseLayer!=null&&(a=this.baseLayer.projection);return a},getMaxResolution:function(){var a=null;this.baseLayer!=null&&(a=this.baseLayer.maxResolution);return a},getMaxExtent:function(a){var b=null;a&&a.restricted&&this.restrictedExtent?b=this.restrictedExtent:this.baseLayer!=null&&(b=this.baseLayer.maxExtent);return b},getNumZoomLevels:function(){var a=null;this.baseLayer!=null&&(a=this.baseLayer.numZoomLevels);return a},getExtent:function(){var a=null;this.baseLayer!=null&&(a=this.baseLayer.getExtent());return a},getResolution:function(){var a=null;this.baseLayer!=null?a=this.baseLayer.getResolution():this.allOverlays===!0&&this.layers.length>0&&(a=this.layers[0].getResolution());return a},getUnits:function(){var a=null;this.baseLayer!=null&&(a=this.baseLayer.units);return a},getScale:function(){var a=null;if(this.baseLayer!=null){var b=this.getResolution(),c=this.baseLayer.units;a=OpenLayers.Util.getScaleFromResolution(b,c)}return a},getZoomForExtent:function(a,b){var c=null;this.baseLayer!=null&&(c=this.baseLayer.getZoomForExtent(a,b));return c},getResolutionForZoom:function(a){var b=null;this.baseLayer&&(b=this.baseLayer.getResolutionForZoom(a));return b},getZoomForResolution:function(a,b){var c=null;this.baseLayer!=null&&(c=this.baseLayer.getZoomForResolution(a,b));return c},zoomTo:function(a){this.isValidZoomLevel(a)&&this.setCenter(null,a)},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(a,b){var c=a.getCenterLonLat();if(this.baseLayer.wrapDateLine){var d=this.getMaxExtent();a=a.clone();while(a.right<a.left)a.right+=d.getWidth();c=a.getCenterLonLat().wrapDateLine(d)}this.setCenter(c,this.getZoomForExtent(a,b))},zoomToMaxExtent:function(a){var b=a?a.restricted:!0,c=this.getMaxExtent({restricted:b});this.zoomToExtent(c)},zoomToScale:function(a,b){var c=OpenLayers.Util.getResolutionFromScale(a,this.baseLayer.units),d=this.getSize(),e=d.w*c,f=d.h*c,g=this.getCenter(),h=new OpenLayers.Bounds(g.lon-e/2,g.lat-f/2,g.lon+e/2,g.lat+f/2);this.zoomToExtent(h,b)},getLonLatFromViewPortPx:function(a){var b=null;this.baseLayer!=null&&(b=this.baseLayer.getLonLatFromViewPortPx(a));return b},getViewPortPxFromLonLat:function(a){var b=null;this.baseLayer!=null&&(b=this.baseLayer.getViewPortPxFromLonLat(a));return b},getLonLatFromPixel:function(a){return this.getLonLatFromViewPortPx(a)},getPixelFromLonLat:function(a){var b=this.getViewPortPxFromLonLat(a);b.x=Math.round(b.x),b.y=Math.round(b.y);return b},getViewPortPxFromLayerPx:function(a){var b=null;if(a!=null){var c=parseInt(this.layerContainerDiv.style.left),d=parseInt(this.layerContainerDiv.style.top);b=a.add(c,d)}return b},getLayerPxFromViewPortPx:function(a){var b=null;if(a!=null){var c=-parseInt(this.layerContainerDiv.style.left),d=-parseInt(this.layerContainerDiv.style.top);b=a.add(c,d);if(isNaN(b.x)||isNaN(b.y))b=null}return b},getLonLatFromLayerPx:function(a){a=this.getViewPortPxFromLayerPx(a);return this.getLonLatFromViewPortPx(a)},getLayerPxFromLonLat:function(a){var b=this.getPixelFromLonLat(a);return this.getLayerPxFromViewPortPx(b)},CLASS_NAME:"OpenLayers.Map"}),OpenLayers.Map.TILE_WIDTH=256,OpenLayers.Map.TILE_HEIGHT=256,OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(a,b){this.lonlat=a;var c=b?b:OpenLayers.Marker.defaultIcon();this.icon==null?this.icon=c:(this.icon.url=c.url,this.icon.size=c.size,this.icon.offset=c.offset,this.icon.calculateOffset=c.calculateOffset),this.events=new OpenLayers.Events(this,this.icon.imageDiv,null)},destroy:function(){this.erase(),this.map=null,this.events.destroy(),this.events=null,this.icon!=null&&(this.icon.destroy(),this.icon=null)},draw:function(a){return this.icon.draw(a)},erase:function(){this.icon!=null&&this.icon.erase()},moveTo:function(a){a!=null&&this.icon!=null&&this.icon.moveTo(a),this.lonlat=this.map.getLonLatFromLayerPx(a)},isDrawn:function(){var a=this.icon&&this.icon.isDrawn();return a},onScreen:function(){var a=!1;if(this.map){var b=this.map.getExtent();a=b.containsLonLat(this.lonlat)}return a},inflate:function(a){if(this.icon){var b=new OpenLayers.Size(this.icon.size.w*a,this.icon.size.h*a);this.icon.setSize(b)}},setOpacity:function(a){this.icon.setOpacity(a)},setUrl:function(a){this.icon.setUrl(a)},display:function(a){this.icon.display(a)},CLASS_NAME:"OpenLayers.Marker"}),OpenLayers.Marker.defaultIcon=function(){var a=OpenLayers.Util.getImagesLocation()+"marker.png",b=new OpenLayers.Size(21,25),c=function(a){return new OpenLayers.Pixel(-(a.w/2),-a.h)};return new OpenLayers.Icon(a,b,null,c)},OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:!0,panMapIfOutOfView:!0,imageSize:new OpenLayers.Size(676,736),isAlphaImage:!1,fixedRelativePosition:!1,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-638,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-638,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-638,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-638,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(600,660),initialize:function(a,b,c,d,e,f,g){this.imageSrc=OpenLayers.Util.getImagesLocation()+"cloud-popup-relative.png",OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments),this.contentDiv.className=this.contentDisplayClass},destroy:function(){OpenLayers.Popup.Framed.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Popup.FramedCloud"}),OpenLayers.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:undefined,password:undefined,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},events:new OpenLayers.Events(this,null,["complete","success","failure"]),issue:function(a){var b=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});a=OpenLayers.Util.applyDefaults(a,b);var c=new OpenLayers.Request.XMLHttpRequest,d=a.url;if(a.params){var e=OpenLayers.Util.getParameterString(a.params);if(e.length>0){var f=d.indexOf("?")>-1?"&":"?";d+=f+e}}a.proxy&&d.indexOf("http")==0&&(typeof a.proxy=="function"?d=a.proxy(d):d=a.proxy+encodeURIComponent(d)),c.open(a.method,d,a.async,a.user,a.password);for(var g in a.headers)c.setRequestHeader(g,a.headers[g]);var h=this.events,i=this;c.onreadystatechange=function(){if(c.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var b=h.triggerEvent("complete",{request:c,config:a,requestUrl:d});b!==!1&&i.runCallbacks({request:c,config:a,requestUrl:d})}},a.async===!1?c.send(a.data):window.setTimeout(function(){c.send(a.data)},0);return c},runCallbacks:function(a){var b=a.request,c=a.config,d=c.scope?OpenLayers.Function.bind(c.callback,c.scope):c.callback,e;c.success&&(e=c.scope?OpenLayers.Function.bind(c.success,c.scope):c.success);var f;c.failure&&(f=c.scope?OpenLayers.Function.bind(c.failure,c.scope):c.failure),d(b);if(!b.status||b.status>=200&&b.status<300)this.events.triggerEvent("success",a),e&&e(b);b.status&&(b.status<200||b.status>=300)&&(this.events.triggerEvent("failure",a),f&&f(b))},GET:function(a){a=OpenLayers.Util.extend(a,{method:"GET"});return OpenLayers.Request.issue(a)},POST:function(a){a=OpenLayers.Util.extend(a,{method:"POST"}),a.headers=a.headers?a.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},PUT:function(a){a=OpenLayers.Util.extend(a,{method:"PUT"}),a.headers=a.headers?a.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(a.headers)||(a.headers["Content-Type"]="application/xml");return OpenLayers.Request.issue(a)},DELETE:function(a){a=OpenLayers.Util.extend(a,{method:"DELETE"});return OpenLayers.Request.issue(a)},HEAD:function(a){a=OpenLayers.Util.extend(a,{method:"HEAD"});return OpenLayers.Request.issue(a)},OPTIONS:function(a){a=OpenLayers.Util.extend(a,{method:"OPTIONS"});return OpenLayers.Request.issue(a)}},OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,layerAlphaHack:null,isBackBuffer:!1,lastRatio:1,isFirstDraw:!0,backBufferTile:null,initialize:function(a,b,c,d,e){OpenLayers.Tile.prototype.initialize.apply(this,arguments),this.url=d,this.frame=document.createElement("div"),this.frame.style.overflow="hidden",this.frame.style.position="absolute",this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack()},destroy:function(){this.imgDiv!=null&&(this.layerAlphaHack&&OpenLayers.Event.stopObservingElement(this.imgDiv.childNodes[0]),OpenLayers.Event.stopObservingElement(this.imgDiv),this.imgDiv.parentNode==this.frame&&(this.frame.removeChild(this.imgDiv),this.imgDiv.map=null),this.imgDiv.urls=null,this.imgDiv.src=OpenLayers.Util.getImagesLocation()+"blank.gif"),this.imgDiv=null,this.frame!=null&&this.frame.parentNode==this.layer.div&&this.layer.div.removeChild(this.frame),this.frame=null,this.backBufferTile&&(this.backBufferTile.destroy(),this.backBufferTile=null),this.layer.events.unregister("loadend",this,this.resetBackBuffer),OpenLayers.Tile.prototype.destroy.apply(this,arguments)},clone:function(a){a==null&&(a=new OpenLayers.Tile.Image(this.layer,this.position,this.bounds,this.url,this.size)),a=OpenLayers.Tile.prototype.clone.apply(this,[a]),a.imgDiv=null;return a},draw:function(){this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position));var a=OpenLayers.Tile.prototype.draw.apply(this,arguments);OpenLayers.Util.indexOf(this.layer.SUPPORTED_TRANSITIONS,this.layer.transitionEffect)!=-1?a?(this.backBufferTile||(this.backBufferTile=this.clone(),this.backBufferTile.hide(),this.backBufferTile.isBackBuffer=!0,this.events.register("loadend",this,this.resetBackBuffer),this.layer.events.register("loadend",this,this.resetBackBuffer)),this.startTransition()):this.backBufferTile&&this.backBufferTile.clear():a&&this.isFirstDraw&&(this.events.register("loadend",this,this.showTile),this.isFirstDraw=!1);if(!a)return!1;this.isLoading?this.events.triggerEvent("reload"):(this.isLoading=!0,this.events.triggerEvent("loadstart"));return this.renderTile()},resetBackBuffer:function(){this.showTile();if(this.backBufferTile&&(this.isFirstDraw||!this.layer.numLoadingTiles)){this.isFirstDraw=!1;var a=this.layer.maxExtent,b=a&&this.bounds.intersectsBounds(a,!1);b&&(this.backBufferTile.position=this.position,this.backBufferTile.bounds=this.bounds,this.backBufferTile.size=this.size,this.backBufferTile.imageSize=this.layer.getImageSize(this.bounds)||this.size,this.backBufferTile.imageOffset=this.layer.imageOffset,this.backBufferTile.resolution=this.layer.getResolution(),this.backBufferTile.renderTile()),this.backBufferTile.hide()}},renderTile:function(){this.imgDiv==null&&this.initImgDiv(),this.imgDiv.viewRequestID=this.layer.map.viewRequestID,this.layer.async?this.layer.getURLasync(this.bounds,this,"url",this.positionImage):(this.layer.url instanceof Array&&(this.imgDiv.urls=this.layer.url.slice()),this.url=this.layer.getURL(this.bounds),this.positionImage());return!0},positionImage:function(){if(this.layer!=null){OpenLayers.Util.modifyDOMElement(this.frame,null,this.position,this.size);var a=this.layer.getImageSize(this.bounds);this.layerAlphaHack?OpenLayers.Util.modifyAlphaImageDiv(this.imgDiv,null,null,a,this.url):(OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,a),this.imgDiv.src=this.url)}},clear:function(){this.imgDiv&&(this.hide(),OpenLayers.Tile.Image.useBlankTile&&(this.imgDiv.src=OpenLayers.Util.getImagesLocation()+"blank.gif"))},initImgDiv:function(){var a=this.layer.imageOffset,b=this.layer.getImageSize(this.bounds);this.layerAlphaHack?this.imgDiv=OpenLayers.Util.createAlphaImageDiv(null,a,b,null,"relative",null,null,null,!0):this.imgDiv=OpenLayers.Util.createImage(null,a,b,null,"relative",null,null,!0),this.imgDiv.className="olTileImage",this.frame.style.zIndex=this.isBackBuffer?0:1,this.frame.appendChild(this.imgDiv),this.layer.div.appendChild(this.frame),this.layer.opacity!=null&&OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity),this.imgDiv.map=this.layer.map;var c=function(){this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("loadend"))};this.layerAlphaHack?OpenLayers.Event.observe(this.imgDiv.childNodes[0],"load",OpenLayers.Function.bind(c,this)):OpenLayers.Event.observe(this.imgDiv,"load",OpenLayers.Function.bind(c,this));var d=function(){this.imgDiv._attempts>OpenLayers.IMAGE_RELOAD_ATTEMPTS&&c.call(this)};OpenLayers.Event.observe(this.imgDiv,"error",OpenLayers.Function.bind(d,this))},checkImgURL:function(){if(this.layer){var a=this.layerAlphaHack?this.imgDiv.firstChild.src:this.imgDiv.src;OpenLayers.Util.isEquivalentUrl(a,this.url)||this.hide()}},startTransition:function(){if(this.backBufferTile&&this.backBufferTile.imgDiv){var a=1;this.backBufferTile.resolution&&(a=this.backBufferTile.resolution/this.layer.getResolution());if(a!=this.lastRatio){if(this.layer.transitionEffect=="resize"){var b=new OpenLayers.LonLat(this.backBufferTile.bounds.left,this.backBufferTile.bounds.top),c=new OpenLayers.Size(this.backBufferTile.size.w*a,this.backBufferTile.size.h*a),d=this.layer.map.getLayerPxFromLonLat(b);OpenLayers.Util.modifyDOMElement(this.backBufferTile.frame,null,d,c);var e=this.backBufferTile.imageSize;e=new OpenLayers.Size(e.w*a,e.h*a);var f=this.backBufferTile.imageOffset;f&&(f=new OpenLayers.Pixel(f.x*a,f.y*a)),OpenLayers.Util.modifyDOMElement(this.backBufferTile.imgDiv,null,f,e),this.backBufferTile.show()}}else this.layer.singleTile?this.backBufferTile.show():this.backBufferTile.hide();this.lastRatio=a}},show:function(){this.frame.style.display="",OpenLayers.Util.indexOf(this.layer.SUPPORTED_TRANSITIONS,this.layer.transitionEffect)!=-1&&(navigator.userAgent.toLowerCase().indexOf("gecko")!=-1&&(this.frame.scrollLeft=this.frame.scrollLeft))},hide:function(){this.frame.style.display="none"},CLASS_NAME:"OpenLayers.Tile.Image"}),OpenLayers.Tile.Image.useBlankTile=OpenLayers.Util.getBrowserName()=="safari"||OpenLayers.Util.getBrowserName()=="opera",OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:new OpenLayers.Size(180,90),layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,initialize:function(a){this.layers=[],this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,[a])},destroy:function(){this.mapDiv&&(this.handlers.click&&this.handlers.click.destroy(),this.handlers.drag&&this.handlers.drag.destroy(),this.mapDiv.removeChild(this.extentRectangle),this.extentRectangle=null,this.rectEvents&&(this.rectEvents.destroy(),this.rectEvents=null),this.ovmap&&(this.ovmap.destroy(),this.ovmap=null),this.element.removeChild(this.mapDiv),this.mapDiv=null,this.div.removeChild(this.element),this.element=null,this.maximizeDiv&&(OpenLayers.Event.stopObservingElement(this.maximizeDiv),this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null),this.minimizeDiv&&(OpenLayers.Event.stopObservingElement(this.minimizeDiv),this.div.removeChild(this.minimizeDiv),this.minimizeDiv=null),this.map.events.un({moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments))},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(this.layers.length<=0){if(!this.map.baseLayer){this.map.events.register("changebaselayer",this,this.baseLayerDraw);return this.div}var a=this.map.baseLayer.clone();this.layers=[a]}this.element=document.createElement("div"),this.element.className=this.displayClass+"Element",this.element.style.display="none",this.mapDiv=document.createElement("div"),this.mapDiv.style.width=this.size.w+"px",this.mapDiv.style.height=this.size.h+"px",this.mapDiv.style.position="relative",this.mapDiv.style.overflow="hidden",this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap"),this.extentRectangle=document.createElement("div"),this.extentRectangle.style.position="absolute",this.extentRectangle.style.zIndex=1e3,this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.mapDiv.appendChild(this.extentRectangle),this.element.appendChild(this.mapDiv),this.div.appendChild(this.element);if(this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var b=OpenLayers.Util.getImagesLocation(),c=b+"layer-switcher-maximize.png";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,new OpenLayers.Size(18,18),c,"absolute"),this.maximizeDiv.style.display="none",this.maximizeDiv.className=this.displayClass+"MaximizeButton",OpenLayers.Event.observe(this.maximizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.maximizeControl,this)),this.div.appendChild(this.maximizeDiv);var c=b+"layer-switcher-minimize.png";this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,new OpenLayers.Size(18,18),c,"absolute"),this.minimizeDiv.style.display="none",this.minimizeDiv.className=this.displayClass+"MinimizeButton",OpenLayers.Event.observe(this.minimizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.minimizeControl,this)),this.div.appendChild(this.minimizeDiv);var d=["dblclick","mousedown"];for(var e=0,f=d.length;e<f;e++)OpenLayers.Event.observe(this.maximizeDiv,d[e],OpenLayers.Event.stop),OpenLayers.Event.observe(this.minimizeDiv,d[e],OpenLayers.Event.stop);this.minimizeControl()}this.map.getExtent()&&this.update(),this.map.events.register("moveend",this,this.update);return this.div},baseLayerDraw:function(){this.draw(),this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(a){var b=this.handlers.drag.last.x-a.x,c=this.handlers.drag.last.y-a.y;if(b!=0||c!=0){var d=this.rectPxBounds.top,e=this.rectPxBounds.left,f=Math.abs(this.rectPxBounds.getHeight()),g=this.rectPxBounds.getWidth(),h=Math.max(0,d-c);h=Math.min(h,this.ovmap.size.h-this.hComp-f);var i=Math.max(0,e-b);i=Math.min(i,this.ovmap.size.w-this.wComp-g),this.setRectPxBounds(new OpenLayers.Bounds(i,h+f,i+g,h))}},mapDivClick:function(a){var b=this.rectPxBounds.getCenterPixel(),c=a.xy.x-b.x,d=a.xy.y-b.y,e=this.rectPxBounds.top,f=this.rectPxBounds.left,g=Math.abs(this.rectPxBounds.getHeight()),h=this.rectPxBounds.getWidth(),i=Math.max(0,e+d);i=Math.min(i,this.ovmap.size.h-g);var j=Math.max(0,f+c);j=Math.min(j,this.ovmap.size.w-h),this.setRectPxBounds(new OpenLayers.Bounds(j,i+g,j+h,i)),this.updateMapToRect()},maximizeControl:function(a){this.element.style.display="",this.showToggle(!1),a!=null&&OpenLayers.Event.stop(a)},minimizeControl:function(a){this.element.style.display="none",this.showToggle(!0),a!=null&&OpenLayers.Event.stop(a)},showToggle:function(a){this.maximizeDiv.style.display=a?"":"none",this.minimizeDiv.style.display=a?"none":""},update:function(){this.ovmap==null&&this.createMap(),(this.autoPan||!this.isSuitableOverview())&&this.updateOverview(),this.updateRectToMap()},isSuitableOverview:function(){var a=this.map.getExtent(),b=this.map.maxExtent,c=new OpenLayers.Bounds(Math.max(a.left,b.left),Math.max(a.bottom,b.bottom),Math.min(a.right,b.right),Math.min(a.top,b.top));this.ovmap.getProjection()!=this.map.getProjection()&&(c=c.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));var d=this.ovmap.getResolution()/this.map.getResolution();return d>this.minRatio&&d<=this.maxRatio&&this.ovmap.getExtent().containsBounds(c)},updateOverview:function(){var a=this.map.getResolution(),b=this.ovmap.getResolution(),c=b/a;c>this.maxRatio?b=this.minRatio*a:c<=this.minRatio&&(b=this.maxRatio*a);var d;this.ovmap.getProjection()!=this.map.getProjection()?(d=this.map.center.clone(),d.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):d=this.map.center,this.ovmap.setCenter(d,this.ovmap.getZoomForResolution(b*this.resolutionFactor)),this.updateRectToMap()},createMap:function(){var a=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,a),OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy),this.ovmap.addLayers(this.layers),this.ovmap.zoomToMaxExtent(),this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")),this.wComp=this.wComp?this.wComp:2,this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")),this.hComp=this.hComp?this.hComp:2,this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap}),this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap}),this.handlers.click.activate(),this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,!0),this.rectEvents.register("mouseover",this,function(a){!this.handlers.drag.active&&!this.map.dragging&&this.handlers.drag.activate()}),this.rectEvents.register("mouseout",this,function(a){this.handlers.drag.dragging||this.handlers.drag.deactivate()});if(this.ovmap.getProjection()!=this.map.getProjection()){var b=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,c=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=b&&c?OpenLayers.INCHES_PER_UNIT[b]/OpenLayers.INCHES_PER_UNIT[c]:1}},updateRectToMap:function(){var a;this.ovmap.getProjection()!=this.map.getProjection()?a=this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):a=this.map.getExtent();var b=this.getRectBoundsFromMapBounds(a);b&&this.setRectPxBounds(b)},updateMapToRect:function(){var a=this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(a=a.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject())),this.map.panTo(a.getCenterLonLat())},setRectPxBounds:function(a){var b=Math.max(a.top,0),c=Math.max(a.left,0),d=Math.min(a.top+Math.abs(a.getHeight()),this.ovmap.size.h-this.hComp),e=Math.min(a.left+a.getWidth(),this.ovmap.size.w-this.wComp),f=Math.max(e-c,0),g=Math.max(d-b,0);if(f<this.minRectSize||g<this.minRectSize){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;var h=c+f/2-this.minRectSize/2,i=b+g/2-this.minRectSize/2;this.extentRectangle.style.top=Math.round(i)+"px",this.extentRectangle.style.left=Math.round(h)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=this.minRectSize+"px"}else this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(b)+"px",this.extentRectangle.style.left=Math.round(c)+"px",this.extentRectangle.style.height=Math.round(g)+"px",this.extentRectangle.style.width=Math.round(f)+"px";this.rectPxBounds=new OpenLayers.Bounds(Math.round(c),Math.round(d),Math.round(e),Math.round(b))},getRectBoundsFromMapBounds:function(a){var b=new OpenLayers.LonLat(a.left,a.bottom),c=new OpenLayers.LonLat(a.right,a.top),d=this.getOverviewPxFromLonLat(b),e=this.getOverviewPxFromLonLat(c),f=null;d&&e&&(f=new OpenLayers.Bounds(d.x,d.y,e.x,e.y));return f},getMapBoundsFromRectBounds:function(a){var b=new OpenLayers.Pixel(a.left,a.bottom),c=new OpenLayers.Pixel(a.right,a.top),d=this.getLonLatFromOverviewPx(b),e=this.getLonLatFromOverviewPx(c);return new OpenLayers.Bounds(d.lon,d.lat,e.lon,e.lat)},getLonLatFromOverviewPx:function(a){var b=this.ovmap.size,c=this.ovmap.getResolution(),d=this.ovmap.getExtent().getCenterLonLat(),e=a.x-b.w/2,f=a.y-b.h/2;return new OpenLayers.LonLat(d.lon+e*c,d.lat-f*c)},getOverviewPxFromLonLat:function(a){var b=this.ovmap.getResolution(),c=this.ovmap.getExtent(),d=null;c&&(d=new OpenLayers.Pixel(Math.round(1/b*(a.lon-c.left)),Math.round(1/b*(c.top-a.lat))));return d},CLASS_NAME:"OpenLayers.Control.OverviewMap"}),OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:OpenLayers.Popup.AnchoredBubble,popup:null,initialize:function(a,b,c){this.layer=a,this.lonlat=b,this.data=c!=null?c:{},this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.layer!=null&&this.layer.map!=null&&(this.popup!=null&&this.layer.map.removePopup(this.popup)),this.layer!=null&&this.marker!=null&&this.layer.removeMarker(this.marker),this.layer=null,this.id=null,this.lonlat=null,this.data=null,this.marker!=null&&(this.destroyMarker(this.marker),this.marker=null),this.popup!=null&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var a=!1;if(this.layer!=null&&this.layer.map!=null){var b=this.layer.map.getExtent();a=b.containsLonLat(this.lonlat)}return a},createMarker:function(){this.lonlat!=null&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon));return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(a){if(this.lonlat!=null){var b=this.id+"_popup",c=this.marker?this.marker.icon:null;this.popup||(this.popup=new this.popupClass(b,this.lonlat,this.data.popupSize,this.data.popupContentHTML,c,a)),this.data.overflow!=null&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this}return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"}),OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",PropertyName:null,ParameterName:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a])),a&&a.nodeType==9&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{csw:{GetDomainResponse:function(a,b){this.readChildNodes(a,b)},DomainValues:function(a,b){b.DomainValues instanceof Array||(b.DomainValues=[]);var c=a.attributes,d={};for(var e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;this.readChildNodes(a,d),b.DomainValues.push(d)},PropertyName:function(a,b){b.PropertyName=this.getChildValue(a)},ParameterName:function(a,b){b.ParameterName=this.getChildValue(a)},ListOfValues:function(a,b){b.ListOfValues instanceof Array||(b.ListOfValues=[]),this.readChildNodes(a,b.ListOfValues)},Value:function(a,b){var c=a.attributes,d={};for(var e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a),b.push({Value:d})},ConceptualScheme:function(a,b){b.ConceptualScheme={},this.readChildNodes(a,b.ConceptualScheme)},Name:function(a,b){b.Name=this.getChildValue(a)},Document:function(a,b){b.Document=this.getChildValue(a)},Authority:function(a,b){b.Authority=this.getChildValue(a)},RangeOfValues:function(a,b){b.RangeOfValues={},this.readChildNodes(a,b.RangeOfValues)},MinValue:function(a,b){var c=a.attributes,d={};for(var e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a),b.MinValue=d},MaxValue:function(a,b){var c=a.attributes,d={};for(var e=0,f=c.length;e<f;++e)d[c[e].name]=c[e].nodeValue;d.value=this.getChildValue(a),b.MaxValue=d}}},write:function(a){var b=this.writeNode("csw:GetDomain",a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},writers:{csw:{GetDomain:function(a){var b=this.createElementNSPlus("csw:GetDomain",{attributes:{service:"CSW",version:this.version}});a.PropertyName||this.PropertyName?this.writeNode("csw:PropertyName",a.PropertyName||this.PropertyName,b):(a.ParameterName||this.ParameterName)&&this.writeNode("csw:ParameterName",a.ParameterName||this.ParameterName,b),this.readChildNodes(b,a);return b},PropertyName:function(a){var b=this.createElementNSPlus("csw:PropertyName",{value:a});return b},ParameterName:function(a){var b=this.createElementNSPlus("csw:ParameterName",{value:a});return b}}},CLASS_NAME:"OpenLayers.Format.CSWGetDomain.v2_0_2"}),OpenLayers.Format.OWSCommon={},OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:{ServiceIdentification:function(a,b){b.serviceIdentification={},this.readChildNodes(a,b.serviceIdentification)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},Keywords:function(a,b){b.keywords={},this.readChildNodes(a,b.keywords)},Keyword:function(a,b){b[this.getChildValue(a)]=!0},ServiceType:function(a,b){b.serviceType={codeSpace:a.getAttribute("codeSpace"),value:this.getChildValue(a)}},ServiceTypeVersion:function(a,b){b.serviceTypeVersion=this.getChildValue(a)},Fees:function(a,b){b.fees=this.getChildValue(a)},AccessConstraints:function(a,b){b.accessConstraints=this.getChildValue(a)},ServiceProvider:function(a,b){b.serviceProvider={},this.readChildNodes(a,b.serviceProvider)},ProviderName:function(a,b){b.providerName=this.getChildValue(a)},ProviderSite:function(a,b){b.providerSite=this.getAttributeNS(a,this.namespaces.xlink,"href")},ServiceContact:function(a,b){b.serviceContact={},this.readChildNodes(a,b.serviceContact)},IndividualName:function(a,b){b.individualName=this.getChildValue(a)},PositionName:function(a,b){b.positionName=this.getChildValue(a)},ContactInfo:function(a,b){b.contactInfo={},this.readChildNodes(a,b.contactInfo)},Phone:function(a,b){b.phone={},this.readChildNodes(a,b.phone)},Voice:function(a,b){b.voice=this.getChildValue(a)},Address:function(a,b){b.address={},this.readChildNodes(a,b.address)},DeliveryPoint:function(a,b){b.deliveryPoint=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},AdministrativeArea:function(a,b){b.administrativeArea=this.getChildValue(a)},PostalCode:function(a,b){b.postalCode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ElectronicMailAddress:function(a,b){b.electronicMailAddress=this.getChildValue(a)},Role:function(a,b){b.role=this.getChildValue(a)},OperationsMetadata:function(a,b){b.operationsMetadata={},this.readChildNodes(a,b.operationsMetadata)},Operation:function(a,b){var c=a.getAttribute("name");b[c]={},this.readChildNodes(a,b[c])},DCP:function(a,b){b.dcp={},this.readChildNodes(a,b.dcp)},HTTP:function(a,b){b.http={},this.readChildNodes(a,b.http)},Get:function(a,b){b.get=this.getAttributeNS(a,this.namespaces.xlink,"href")},Post:function(a,b){b.post=this.getAttributeNS(a,this.namespaces.xlink,"href")},Parameter:function(a,b){b.parameters||(b.parameters={});var c=a.getAttribute("name");b.parameters[c]={},this.readChildNodes(a,b.parameters[c])},AllowedValues:function(a,b){b.allowedValues={},this.readChildNodes(a,b.allowedValues)},AnyValue:function(a,b){b.anyValue=!0},Value:function(a,b){b[this.getChildValue(a)]=!0},Range:function(a,b){b.range={},this.readChildNodes(a,b.range)},MinimumValue:function(a,b){b.minValue=this.getChildValue(a)},MaximumValue:function(a,b){b.maxValue=this.getChildValue(a)}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"}),OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.0.0",version:null,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]),this.options=a},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a.documentElement,c=this.version||b.getAttribute("version")||this.defaultVersion;if(!this.parser||this.parser.version!==c){var d=OpenLayers.Format.SOSCapabilities["v"+c.replace(/\./g,"_")];if(!d)throw"Can't find a SOS capabilities parser for version "+c;var e=new d(this.options)}var f=e.read(a);f.version=c;return f},CLASS_NAME:"OpenLayers.Format.SOSCapabilities"}),OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.1.0",version:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]),this.options=a},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a.documentElement,c=this.version;c||(c=b.getAttribute("version"),c||(c=this.defaultVersion));var d=OpenLayers.Format.WFSCapabilities["v"+c.replace(/\./g,"_")];if(!d)throw"Can't find a WFS capabilities parser for version "+c;var e=new d(this.options),f=e.read(a);f.version=c;return f},CLASS_NAME:"OpenLayers.Format.WFSCapabilities"}),OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},readers:{xsd:{schema:function(a,b){var c=[],d={},e={complexTypes:c,customTypes:d};this.readChildNodes(a,e);var f=a.attributes,g,h;for(var i=0,j=f.length;i<j;++i)g=f[i],h=g.name,h.indexOf("xmlns")==0?this.setNamespace(h.split(":")[1]||"",g.value):b[h]=g.value;b.featureTypes=c,b.targetPrefix=this.namespaceAlias[b.targetNamespace];var k,l;for(var i=0,j=c.length;i<j;++i)k=c[i],l=d[k.typeName],d[k.typeName]&&(k.typeName=l.name)},complexType:function(a,b){var c={typeName:a.getAttribute("name")};this.readChildNodes(a,c),b.complexTypes.push(c)},complexContent:function(a,b){this.readChildNodes(a,b)},extension:function(a,b){this.readChildNodes(a,b)},sequence:function(a,b){var c={elements:[]};this.readChildNodes(a,c),b.properties=c.elements},element:function(a,b){if(b.elements){var c={},d=a.attributes,e;for(var f=0,g=d.length;f<g;++f)e=d[f],c[e.name]=e.value;var h=c.type;h||(h={},this.readChildNodes(a,h),c.restriction=h,c.type=h.base);var i=h.base||h;c.localType=i.split(":").pop(),b.elements.push(c)}if(b.complexTypes){var h=a.getAttribute("type"),j=h.split(":").pop();b.customTypes[j]={name:a.getAttribute("name"),type:h}}},simpleType:function(a,b){this.readChildNodes(a,b)},restriction:function(a,b){b.base=a.getAttribute("base"),this.readRestriction(a,b)}}},readRestriction:function(a,b){var c=a.childNodes,d,e,f;for(var g=0,h=c.length;g<h;++g)d=c[g],d.nodeType==1&&(e=d.nodeName.split(":").pop(),f=d.getAttribute("value"),b[e]?(typeof b[e]=="string"&&(b[e]=[b[e]]),b[e].push(f)):b[e]=f)},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a])),a&&a.nodeType==9&&(a=a.documentElement);var b={};this.readNode(a,b);return b},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"}),OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(a){this.stateName={},this.stateName[OpenLayers.State.INSERT]="wfs:Insert",this.stateName[OpenLayers.State.UPDATE]="wfs:Update",this.stateName[OpenLayers.State.DELETE]="wfs:Delete",OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},getSrsName:function(a,b){var c=b&&b.srsName;c||(a&&a.layer?c=a.layer.projection.getCode():c=this.srsName);return c},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a])),a&&a.nodeType==9&&(a=a.documentElement);var b={};a&&this.readNode(a,b),b.features&&(b=b.features);return b},readers:{wfs:{FeatureCollection:function(a,b){b.features=[],this.readChildNodes(a,b)}}},write:function(a){var b=this.writeNode("wfs:Transaction",a),c=this.schemaLocationAttr();c&&this.setAttributeNS(b,this.namespaces.xsi,"xsi:schemaLocation",c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},writers:{wfs:{GetFeature:function(a){var b=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,outputFormat:a&&a.outputFormat,maxFeatures:a&&a.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(a)}});this.writeNode("Query",a,b);return b},Transaction:function(a){var b=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}});if(a){var c,d;for(var e=0,f=a.length;e<f;++e)d=a[e],c=this.stateName[d.state],c&&this.writeNode(c,d,b)}return b},Insert:function(a){var b=this.createElementNSPlus("wfs:Insert");this.srsName=this.getSrsName(a),this.writeNode("feature:_typeName",a,b);return b},Update:function(a){var b=this.createElementNSPlus("wfs:Update",{attributes:{typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS),this.geometryName!==null&&this.writeNode("Property",{name:this.geometryName,value:a},b);for(var c in a.attributes)a.attributes[c]!==undefined&&this.writeNode("Property",{name:c,value:a.attributes[c]},b);this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[a.fid]}),b);return b},Property:function(a){var b=this.createElementNSPlus("wfs:Property");this.writeNode("Name",a.name,b),a.value!==null&&this.writeNode("Value",a.value,b);return b},Name:function(a){return this.createElementNSPlus("wfs:Name",{value:a})},Value:function(a){var b;if(a instanceof OpenLayers.Feature.Vector){b=this.createElementNSPlus("wfs:Value"),this.srsName=this.getSrsName(a);var c=this.writeNode("feature:_geometry",a.geometry).firstChild;b.appendChild(c)}else b=this.createElementNSPlus("wfs:Value",{value:a});return b},Delete:function(a){var b=this.createElementNSPlus("wfs:Delete",{attributes:{typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS),this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[a.fid]}),b);return b}}},schemaLocationAttr:function(a){a=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},a);var b=OpenLayers.Util.extend({},this.schemaLocations);a.schema&&(b[a.featurePrefix]=a.schema);var c=[],d;for(var e in b)d=this.namespaces[e],d&&c.push(d+" "+b[e]);var f=c.join(" ")||undefined;return f},setFilterProperty:function(a){if(a.filters)for(var b=0,c=a.filters.length;b<c;++b)this.setFilterProperty(a.filters[b]);else a instanceof OpenLayers.Filter.Spatial&&(a.property=this.geometryName)},CLASS_NAME:"OpenLayers.Format.WFST.v1"}),OpenLayers.Format.WMC=OpenLayers.Class({defaultVersion:"1.1.0",version:null,layerOptions:null,layerParams:null,parser:null,initialize:function(a){OpenLayers.Util.extend(this,a),this.options=a},read:function(a,b){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=a.documentElement,d=this.version;d||(d=c.getAttribute("version"));var e=this.getParser(d),f=e.read(a,b),g;if(b&&b.map){this.context=f;if(b.map instanceof OpenLayers.Map)g=this.mergeContextToMap(f,b.map);else{var h=b.map;if(OpenLayers.Util.isElement(h)||typeof h=="string")h={div:h};g=this.contextToMap(f,h)}}else g=f;return g},getParser:function(a){var b=a||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=b){var c=OpenLayers.Format.WMC["v"+b.replace(/\./g,"_")];if(!c)throw"Can't find a WMC parser for version "+b;this.parser=new c(this.options)}return this.parser},getLayerFromContext:function(a){var b,c,d={queryable:a.queryable,visibility:a.visibility,maxExtent:a.maxExtent,numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,minScale:a.minScale,maxScale:a.maxScale};this.layerOptions&&OpenLayers.Util.applyDefaults(d,this.layerOptions);var e={layers:a.name,transparent:a.transparent,version:a.version};if(a.formats&&a.formats.length>0){e.format=a.formats[0].value;for(b=0,c=a.formats.length;b<c;b++){var f=a.formats[b];if(f.current==!0){e.format=f.value;break}}}if(a.styles&&a.styles.length>0)for(b=0,c=a.styles.length;b<c;b++){var g=a.styles[b];if(g.current==!0){g.href?e.sld=g.href:g.body?e.sld_body=g.body:e.styles=g.name;break}}this.layerParams&&OpenLayers.Util.applyDefaults(e,this.layerParams);var h=new OpenLayers.Layer.WMS(a.title||a.name,a.url,e,d);return h},getLayersFromContext:function(a){var b=[];for(var c=0,d=a.length;c<d;c++)b.push(this.getLayerFromContext(a[c]));return b},contextToMap:function(a,b){b=OpenLayers.Util.applyDefaults({maxExtent:a.maxExtent,projection:a.projection},b);var c=new OpenLayers.Map(b);c.addLayers(this.getLayersFromContext(a.layersContext)),c.setCenter(a.bounds.getCenterLonLat(),c.getZoomForExtent(a.bounds,!0));return c},mergeContextToMap:function(a,b){b.addLayers(this.getLayersFromContext(a.layersContext));return b},write:function(a,b){a=this.toContext(a);var c=b&&b.version,d=this.getParser(c),e=d.write(a,b);return e},layerToContext:function(a){var b=this.getParser(),c={queryable:a.queryable,visibility:a.visibility,name:a.params.LAYERS,title:a.name,metadataURL:a.metadataURL,version:a.params.VERSION,url:a.url,maxExtent:a.maxExtent,transparent:a.params.TRANSPARENT,numZoomLevels:a.numZoomLevels,units:a.units,isBaseLayer:a.isBaseLayer,opacity:a.opacity,displayInLayerSwitcher:a.displayInLayerSwitcher,singleTile:a.singleTile,minScale:a.options.resolutions||a.options.scales||a.options.maxResolution||a.options.minScale?a.minScale:undefined,maxScale:a.options.resolutions||a.options.scales||a.options.minResolution||a.options.maxScale?a.maxScale:undefined,formats:[{value:a.params.FORMAT,current:!0}],styles:[{href:a.params.SLD,body:a.params.SLD_BODY,name:a.params.STYLES||b.defaultStyleName,title:b.defaultStyleTitle,current:!0}]};return c},toContext:function(a){var b={},c=a.layers;a.CLASS_NAME=="OpenLayers.Map"?(b.bounds=a.getExtent(),b.maxExtent=a.maxExtent,b.projection=a.projection,b.size=a.getSize()):(OpenLayers.Util.applyDefaults(b,a),b.layers!=undefined&&delete b.layers),b.layersContext==undefined&&(b.layersContext=[]);if(c!=undefined&&c instanceof Array)for(var d=0,e=c.length;d<e;d++){var f=c[d];f instanceof OpenLayers.Layer.WMS&&b.layersContext.push(this.layerToContext(f))}return b},CLASS_NAME:"OpenLayers.Format.WMC"}),OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.1.1",version:null,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]),this.options=a},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a.documentElement,c=this.version||b.getAttribute("version")||this.defaultVersion;if(!this.parser||this.parser.version!==c){var d=OpenLayers.Format.WMSCapabilities["v"+c.replace(/\./g,"_")];if(!d)throw"Can't find a WMS capabilities parser for version "+c;var e=new d(this.options)}var f=e.read(a);f.version=c;return f},CLASS_NAME:"OpenLayers.Format.WMSCapabilities"}),OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.1.1",version:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]),this.options=a},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a.documentElement,c=this.version;c||(c=b.getAttribute("version"),c||(c=this.defaultVersion));if(c=="1.1.1"||c=="1.1.0")c="1.1";var d=OpenLayers.Format.WMSDescribeLayer["v"+c.replace(/\./g,"_")];if(!d)throw"Can't find a WMS DescribeLayer parser for version "+c;var e=new d(this.options),f=e.read(a);f.version=c;return f},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"}),OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},gmlFormat:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,arguments),OpenLayers.Util.extend(this,a),this.options=a},read:function(a){var b;typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=a.documentElement;if(c){var d=this,e=this["read_"+c.nodeName];e?b=e.call(this,c):b=(new OpenLayers.Format.GML(this.options?this.options:{})).read(a)}else b=a;return b},read_msGMLOutput:function(a){var b=[],c=this.getSiblingNodesByTagCriteria(a,this.layerIdentifier);if(c)for(var d=0,e=c.length;d<e;++d){var f=c[d],g=f.nodeName;f.prefix&&(g=g.split(":")[1]);var g=g.replace(this.layerIdentifier,""),h=this.getSiblingNodesByTagCriteria(f,this.featureIdentifier);if(h)for(var i=0;i<h.length;i++){var j=h[i],k=this.parseGeometry(j),l=this.parseAttributes(j),m=new OpenLayers.Feature.Vector(k.geometry,l,null);m.bounds=k.bounds,m.type=g,b.push(m)}}return b},read_FeatureInfoResponse:function(a){var b=[],c=this.getElementsByTagNameNS(a,"*","FIELDS");for(var d=0,e=c.length;d<e;d++){var f=c[d],g=null,h={};for(var i=0,j=f.attributes.length;i<j;i++){var k=f.attributes[i];h[k.nodeName]=k.nodeValue}b.push(new OpenLayers.Feature.Vector(g,h,null))}return b},getSiblingNodesByTagCriteria:function(a,b){var c=[],d,e,f,g,h;if(a&&a.hasChildNodes()){d=a.childNodes,f=d.length;for(var i=0;i<f;i++){h=d[i];while(h&&h.nodeType!=1)h=h.nextSibling,i++;e=h?h.nodeName:"",e.length>0&&e.indexOf(b)>-1?c.push(h):(g=this.getSiblingNodesByTagCriteria(h,b),g.length>0&&(c.length==0?c=g:c.push(g)))}}return c},parseAttributes:function(a){var b={};if(a.nodeType==1){var c=a.childNodes;n=c.length;for(var d=0;d<n;++d){var e=c[d];if(e.nodeType==1){var f=e.childNodes;if(f.length==1){var g=f[0];if(g.nodeType==3||g.nodeType==4){var h=e.prefix?e.nodeName.split(":")[1]:e.nodeName,i=g.nodeValue.replace(this.regExes.trimSpace,"");b[h]=i}}}}}return b},parseGeometry:function(a){this.gmlFormat||(this.gmlFormat=new OpenLayers.Format.GML);var b=this.gmlFormat.parseFeature(a),c,d=null;b&&b.geometry&&(c=b.geometry.clone(),d=b.bounds&&b.bounds.clone(),b.destroy());return{geometry:c,bounds:d}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"}),OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,stopSingle:!1,stopDouble:!1,timerId:null,down:null,rightclickTimerId:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.pixelTolerance!=null&&(this.mousedown=function(a){this.down=a.xy;return!0})},mousedown:null,mouseup:function(a){var b=!0;this.checkModifiers(a)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(a)&&(b=this.rightclick(a));return b},rightclick:function(a){if(this.passesTolerance(a)){if(this.rightclickTimerId!=null){this.clearTimer(),this.callback("dblrightclick",[a]);return!this.stopDouble}var b=this["double"]?OpenLayers.Util.extend({},a):this.callback("rightclick",[a]),c=OpenLayers.Function.bind(this.delayedRightCall,this,b);this.rightclickTimerId=window.setTimeout(c,this.delay)}return!this.stopSingle},delayedRightCall:function(a){this.rightclickTimerId=null,a&&this.callback("rightclick",[a]);return!this.stopSingle},dblclick:function(a){this.passesTolerance(a)&&(this["double"]&&this.callback("dblclick",[a]),this.clearTimer());return!this.stopDouble},click:function(a){if(this.passesTolerance(a))if(this.timerId!=null)this.clearTimer();else{var b=this.single?OpenLayers.Util.extend({},a):null;this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,b),this.delay)}return!this.stopSingle},passesTolerance:function(a){var b=!0;if(this.pixelTolerance!=null&&this.down){var c=Math.sqrt(Math.pow(this.down.x-a.xy.x,2)+Math.pow(this.down.y-a.xy.y,2));c>this.pixelTolerance&&(b=!1)}return b},clearTimer:function(){this.timerId!=null&&(window.clearTimeout(this.timerId),this.timerId=null),this.rightclickTimerId!=null&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(a){this.timerId=null,a&&this.callback("click",[a])},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.down=null,a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Click"}),OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,last:null,start:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments)},down:function(a){},move:function(a){},up:function(a){},out:function(a){},mousedown:function(a){var b=!0;this.dragging=!1,this.checkModifiers(a)&&OpenLayers.Event.isLeftClick(a)?(this.started=!0,this.start=a.xy,this.last=a.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(a),this.callback("down",[a.xy]),OpenLayers.Event.stop(a),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True,document.onselectstart=OpenLayers.Function.False),b=!this.stopDown):(this.started=!1,this.start=null,this.last=null);return b},mousemove:function(a){this.started&&!this.timeoutId&&(a.xy.x!=this.last.x||a.xy.y!=this.last.y)&&(this.documentDrag===!0&&this.documentEvents&&(a.element===document?(this.adjustXY(a),this.setEvent(a)):this.destroyDocumentEvents()),this.interval>0&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(a),this.callback("move",[a.xy]),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=this.evt.xy);return!0},removeTimeout:function(){this.timeoutId=null},mouseup:function(a){if(this.started){this.documentDrag===!0&&this.documentEvents&&(this.adjustXY(a),this.destroyDocumentEvents());var b=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.up(a),this.callback("up",[a.xy]),b&&this.callback("done",[a.xy]),document.onselectstart=this.oldOnselectstart}return!0},mouseout:function(a){if(this.started&&OpenLayers.Util.mouseLeft(a,this.map.div))if(this.documentDrag===!0)this.documentEvents=new OpenLayers.Events(this,document,null,null,{includeXY:!0}),this.documentEvents.on({mousemove:this.mousemove,mouseup:this.mouseup}),OpenLayers.Element.addClass(document.body,"olDragDown");else{var b=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.out(a),this.callback("out",[]),b&&this.callback("done",[a.xy]),document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}return!0},click:function(a){return this.start==this.last},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=!1,a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.started=!1,this.dragging=!1,this.start=null,this.last=null,a=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"));return a},adjustXY:function(a){var b=OpenLayers.Util.pagePosition(this.map.div);a.xy.x-=b[0],a.xy.y-=b[1]},destroyDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown"),this.documentEvents.destroy(),this.documentEvents=null},CLASS_NAME:"OpenLayers.Handler.Drag"}),OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(a,b,c,d){OpenLayers.Handler.prototype.initialize.apply(this,[a,c,d]),this.layer=b},mousedown:function(a){this.down=a.xy;return this.handle(a)?!this.stopDown:!0},mouseup:function(a){this.up=a.xy;return this.handle(a)?!this.stopUp:!0},click:function(a){return this.handle(a)?!this.stopClick:!0},mousemove:function(a){if(!this.callbacks.over&&!this.callbacks.out)return!0;this.handle(a);return!0},dblclick:function(a){return!this.handle(a)},geometryTypeMatches:function(a){return this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)>-1},handle:function(a){this.feature&&!this.feature.layer&&(this.feature=null);var b=a.type,c=!1,d=!!this.feature,e=b=="click"||b=="dblclick";this.feature=this.layer.getFeatureFromEvent(a),this.feature&&!this.feature.layer&&(this.feature=null),this.lastFeature&&!this.lastFeature.layer&&(this.lastFeature=null);if(this.feature){var f=this.feature!=this.lastFeature;this.geometryTypeMatches(this.feature)?(d&&f?(this.lastFeature&&this.triggerCallback(b,"out",[this.lastFeature]),this.triggerCallback(b,"in",[this.feature])):(!d||e)&&this.triggerCallback(b,"in",[this.feature]),this.lastFeature=this.feature,c=!0):(this.lastFeature&&(d&&f||e)&&this.triggerCallback(b,"out",[this.lastFeature]),this.feature=null)}else this.lastFeature&&(d||e)&&this.triggerCallback(b,"out",[this.lastFeature]);return c},triggerCallback:function(a,b,c){var d=this.EVENTMAP[a][b];if(d)if(a=="click"&&this.up&&this.down){var e=Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2));e<=this.clickTolerance&&this.callback(d,c)}else this.callback(d,c)},activate:function(){var a=!1;OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.feature=null,this.lastFeature=null,this.down=null,this.up=null,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),a=!0);return a},handleMapEvents:function(a){(!a.property||a.property=="order")&&this.moveLayerToTop()},moveLayerToTop:function(){var a=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(a)},moveLayerBack:function(){var a=this.layer.getZIndex()-1;a<this.map.Z_INDEX_BASE.Feature?this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer)):this.layer.setZIndex(a)},CLASS_NAME:"OpenLayers.Handler.Feature"}),OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments)},mousemove:function(a){this.passesTolerance(a.xy)&&(this.clearTimer(),this.callback("move",[a]),this.px=a.xy,a=OpenLayers.Util.extend({},a),this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,a),this.delay));return!this.stopMove},mouseout:function(a){OpenLayers.Util.mouseLeft(a,this.map.div)&&(this.clearTimer(),this.callback("move",[a]));return!0},passesTolerance:function(a){var b=!0;if(this.pixelTolerance&&this.px){var c=Math.sqrt(Math.pow(this.px.x-a.x,2)+Math.pow(this.px.y-a.y,2));c<this.pixelTolerance&&(b=!1)}return b},clearTimer:function(){this.timerId!=null&&(window.clearTimeout(this.timerId),this.timerId=null)},delayedCall:function(a){this.callback("pause",[a])},deactivate:function(){var a=!1;OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),a=!0);return a},CLASS_NAME:"OpenLayers.Handler.Hover"}),OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate(),this.eventListener=null,OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){for(var a=0,b=this.KEY_EVENTS.length;a<b;a++)OpenLayers.Event.observe(document,this.KEY_EVENTS[a],this.eventListener);return!0}return!1},deactivate:function(){var a=!1;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var b=0,c=this.KEY_EVENTS.length;b<c;b++)OpenLayers.Event.stopObserving(document,this.KEY_EVENTS[b],this.eventListener);a=!0}return a},handleKeyEvent:function(a){this.checkModifiers(a)&&this.callback(a.type,[a])},CLASS_NAME:"OpenLayers.Handler.Keyboard"}),OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,interval:0,delta:0,cumulative:!0,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.wheelListener=null},onWheelEvent:function(a){if(this.map&&this.checkModifiers(a)){var b=!1,c=!1,d=!1,e=OpenLayers.Event.element(a);while(e!=null&&!d&&!b){if(!b)try{if(e.currentStyle)g=e.currentStyle.overflow;else var f=document.defaultView.getComputedStyle(e,null),g=f.getPropertyValue("overflow");b=g&&g=="auto"||g=="scroll"}catch(h){}if(!c)for(var i=0,j=this.map.layers.length;i<j;i++)if(e==this.map.layers[i].div||e==this.map.layers[i].pane){c=!0;break}d=e==this.map.div,e=e.parentNode}if(!b&&d){if(c){var k=0;a||(a=window.event),a.wheelDelta?(k=a.wheelDelta/120,window.opera&&window.opera.version()<9.2&&(k=-k)):a.detail&&(k=-a.detail/3),this.delta=this.delta+k,this.interval?(window.clearTimeout(this._timeoutId),this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(a)},this),this.interval)):this.wheelZoom(a)}OpenLayers.Event.stop(a)}}},wheelZoom:function(a){var b=this.delta;this.delta=0,b&&(this.mousePosition&&(a.xy=this.mousePosition),a.xy||(a.xy=this.map.getPixelFromLonLat(this.map.getCenter())),b<0?this.callback("down",[a,this.cumulative?b:-1]):this.callback("up",[a,this.cumulative?b:1]))},mousemove:function(a){this.mousePosition=a.xy},activate:function(a){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",b),OpenLayers.Event.observe(window,"mousewheel",b),OpenLayers.Event.observe(document,"mousewheel",b);return!0}return!1},deactivate:function(a){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",b),OpenLayers.Event.stopObserving(window,"mousewheel",b),OpenLayers.Event.stopObserving(document,"mousewheel",b);return!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"}),OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:null,alwaysInRange:null,EVENT_TYPES:["loadstart","loadend","loadcancel","visibilitychanged","move","moveend"],events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,imageOffset:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,transitionEffect:null,SUPPORTED_TRANSITIONS:["resize"],initialize:function(a,b){this.addOptions(b),this.name=a,this.id==null&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES),this.eventListeners instanceof Object&&this.events.on(this.eventListeners)),this.wrapDateLine&&(this.displayOutsideMaxExtent=!0)},destroy:function(a){a==null&&(a=!0),this.map!=null&&this.map.removeLayer(this,a),this.projection=null,this.map=null,this.name=null,this.div=null,this.options=null,this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy()),this.eventListeners=null,this.events=null},clone:function(a){a==null&&(a=new OpenLayers.Layer(this.name,this.getOptions())),OpenLayers.Util.applyDefaults(a,this),a.map=null;return a},getOptions:function(){var a={};for(var b in this.options)a[b]=this[b];return a},setName:function(a){a!=this.name&&(this.name=a,this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(a){this.options==null&&(this.options={}),OpenLayers.Util.extend(this.options,a),OpenLayers.Util.extend(this,a)},onMapResize:function(){},redraw:function(){var a=!1;if(this.map){this.inRange=this.calculateInRange();var b=this.getExtent();if(b&&this.inRange&&this.visibility){var c=!0;this.moveTo(b,c,!1),this.events.triggerEvent("moveend",{zoomChanged:c}),a=!0}}return a},moveTo:function(a,b,c){var d=this.visibility;this.isBaseLayer||(d=d&&this.inRange),this.display(d)},setMap:function(a){if(this.map==null){this.map=a,this.maxExtent=this.maxExtent||this.map.maxExtent,this.projection=this.projection||this.map.projection,this.projection&&typeof this.projection=="string"&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();var b=this.visibility&&this.inRange;this.div.style.display=b?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(a){},getImageSize:function(a){return this.imageSize||this.tileSize},setTileSize:function(a){var b=a?a:this.tileSize?this.tileSize:this.map.getTileSize();this.tileSize=b,this.gutter&&(this.imageOffset=new OpenLayers.Pixel(-this.gutter,-this.gutter),this.imageSize=new OpenLayers.Size(b.w+2*this.gutter,b.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(a){a!=this.visibility&&(this.visibility=a,this.display(a),this.redraw(),this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(a){a!=(this.div.style.display!="none")&&(this.div.style.display=a&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var a=!1;if(this.alwaysInRange)a=!0;else if(this.map){var b=this.map.getResolution();a=b>=this.minResolution&&b<=this.maxResolution}return a},setIsBaseLayer:function(a){a!=this.isBaseLayer&&(this.isBaseLayer=a,this.map!=null&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var a=["projection","units","scales","resolutions","maxScale","minScale","maxResolution","minResolution","minExtent","maxExtent","numZoomLevels","maxZoomLevel"],b=["projection","units"],c=!1,d={};for(var e=0,f=a.length;e<f;e++){var g=a[e];this.options[g]&&OpenLayers.Util.indexOf(b,g)==-1&&(c=!0),d[g]=this.options[g]||this.map[g]}this.alwaysInRange==null&&(this.alwaysInRange=!c),(this.options.minScale!=null||this.options.maxScale!=null)&&this.options.scales==null&&(d.scales=null),(this.options.minResolution!=null||this.options.maxResolution!=null)&&this.options.resolutions==null&&(d.resolutions=null),!d.numZoomLevels&&d.maxZoomLevel&&(d.numZoomLevels=d.maxZoomLevel+1);if(d.scales!=null||d.resolutions!=null){if(d.scales!=null){d.resolutions=[];for(var e=0,f=d.scales.length;e<f;e++){var h=d.scales[e];d.resolutions[e]=OpenLayers.Util.getResolutionFromScale(h,d.units)}}d.numZoomLevels=d.resolutions.length}else{if(d.minScale)d.maxResolution=OpenLayers.Util.getResolutionFromScale(d.minScale,d.units);else if(d.maxResolution=="auto"){var i=this.map.getSize(),j=d.maxExtent.getWidth()/i.w,k=d.maxExtent.getHeight()/i.h;d.maxResolution=Math.max(j,k)}if(d.maxScale!=null)d.minResolution=OpenLayers.Util.getResolutionFromScale(d.maxScale,d.units);else if(d.minResolution=="auto"&&d.minExtent!=null){var i=this.map.getSize(),j=d.minExtent.getWidth()/i.w,k=d.minExtent.getHeight()/i.h;d.minResolution=Math.max(j,k)}if(d.minResolution!=null&&this.options.numZoomLevels==undefined){var l=d.maxResolution/d.minResolution;d.numZoomLevels=Math.floor(Math.log(l)/Math.log(2))+1}d.resolutions=Array(d.numZoomLevels);var m=2;typeof d.minResolution=="number"&&d.numZoomLevels>1&&(m=Math.pow(d.maxResolution/d.minResolution,1/(d.numZoomLevels-1)));for(var e=0;e<d.numZoomLevels;e++){var n=d.maxResolution/Math.pow(m,e);d.resolutions[e]=n}}d.resolutions.sort(function(a,b){return b-a}),this.resolutions=d.resolutions,this.maxResolution=d.resolutions[0];var o=d.resolutions.length-1;this.minResolution=d.resolutions[o],this.scales=[];for(var e=0,f=d.resolutions.length;e<f;e++)this.scales[e]=OpenLayers.Util.getScaleFromResolution(d.resolutions[e],d.units);this.minScale=this.scales[0],this.maxScale=this.scales[this.scales.length-1],this.numZoomLevels=d.numZoomLevels},getResolution:function(){var a=this.map.getZoom();return this.getResolutionForZoom(a)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(a,b){var c=this.map.getSize(),d=Math.max(a.getWidth()/c.w,a.getHeight()/c.h);return this.getZoomForResolution(d,b)},getDataExtent:function(){},getResolutionForZoom:function(a){a=Math.max(0,Math.min(a,this.resolutions.length-1));var b;if(this.map.fractionalZoom){var c=Math.floor(a),d=Math.ceil(a);b=this.resolutions[c]-(a-c)*(this.resolutions[c]-this.resolutions[d])}else b=this.resolutions[Math.round(a)];return b},getZoomForResolution:function(a,b){var c;if(this.map.fractionalZoom){var d=0,e=this.resolutions.length-1,f=this.resolutions[d],g=this.resolutions[e],h;for(var i=0,j=this.resolutions.length;i<j;++i){h=this.resolutions[i],h>=a&&(f=h,d=i);if(h<=a){g=h,e=i;break}}var k=f-g;k>0?c=d+(f-a)/k:c=d}else{var l,m=Number.POSITIVE_INFINITY;for(var i=0,j=this.resolutions.length;i<j;i++)if(b){l=Math.abs(this.resolutions[i]-a);if(l>m)break;m=l}else if(this.resolutions[i]<a)break;c=Math.max(0,i-1)}return c},getLonLatFromViewPortPx:function(a){var b=null;if(a!=null){var c=this.map.getSize(),d=this.map.getCenter();if(d){var e=this.map.getResolution(),f=a.x-c.w/2,g=a.y-c.h/2;b=new OpenLayers.LonLat(d.lon+f*e,d.lat-g*e),this.wrapDateLine&&(b=b.wrapDateLine(this.maxExtent))}}return b},getViewPortPxFromLonLat:function(a){var b=null;if(a!=null){var c=this.map.getResolution(),d=this.map.getExtent();b=new OpenLayers.Pixel(1/c*(a.lon-d.left),1/c*(d.top-a.lat))}return b},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var b=0,c=this.div.childNodes.length;b<c;++b){var d=this.div.childNodes[b].firstChild;OpenLayers.Util.modifyDOMElement(d,null,null,null,null,null,null,a)}this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(a){this.div.style.zIndex=a},adjustBounds:function(a){if(this.gutter){var b=this.gutter*this.map.getResolution();a=new OpenLayers.Bounds(a.left-b,a.bottom-b,a.right+b,a.top+b)}if(this.wrapDateLine){var c={rightTolerance:this.getResolution()};a=a.wrapDateLine(this.maxExtent,c)}return a},CLASS_NAME:"OpenLayers.Layer"}),OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(a,b,c){this.bounds=a,this.div=OpenLayers.Util.createDiv(),this.div.style.overflow="hidden",this.events=new OpenLayers.Events(this,this.div,null),this.setBorder(b,c)},destroy:function(){this.bounds=null,this.div=null,OpenLayers.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(a,b){a||(a="red"),b||(b=2),this.div.style.border=b+"px solid "+a},draw:function(a,b){OpenLayers.Util.modifyDOMElement(this.div,null,a,b);return this.div},onScreen:function(){var a=!1;if(this.map){var b=this.map.getExtent();a=b.containsBounds(this.bounds,!0,!0)}return a},display:function(a){this.div.style.display=a?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"}),function(){function h(a){a._object.onreadystatechange=new window.Function,delete a._headers}function g(a){try{a.responseText=a._object.responseText}catch(b){}try{a.responseXML=f(a._object)}catch(b){}try{a.status=a._object.status}catch(b){}try{a.statusText=a._object.statusText}catch(b){}}function f(a){var b=a.responseXML;c&&b&&!b.documentElement&&a.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)&&(b=new ActiveXObject("Microsoft.XMLDOM"),b.loadXML(a.responseText));if(b)if(c&&b.parseError!=0||b.documentElement&&b.documentElement.tagName=="parsererror")return null;return b}function e(a){a.onreadystatechange&&a.onreadystatechange.apply(a),d.onreadystatechange&&d.onreadystatechange.apply(a)}function d(){this._object=a?new a:new window.ActiveXObject("Microsoft.XMLHTTP")}var a=window.XMLHttpRequest,b=!!window.controllers,c=window.document.all&&!window.opera;b&&a.wrapped&&(d.wrapped=a.wrapped),d.UNSENT=0,d.OPENED=1,d.HEADERS_RECEIVED=2,d.LOADING=3,d.DONE=4,d.prototype.readyState=d.UNSENT,d.prototype.responseText="",d.prototype.responseXML=null,d.prototype.status=0,d.prototype.statusText="",d.prototype.onreadystatechange=null,d.onreadystatechange=null,d.onopen=null,d.onsend=null,d.onabort=null,d.prototype.open=function(a,f,i,j,k){this._async=i;var l=this,m=this.readyState;if(c){var n=function(){l._object.readyState!=d.DONE&&h(l)};i&&window.attachEvent("onunload",n)}this._object.onreadystatechange=function(){if(!b||i){l.readyState=l._object.readyState,g(l);if(l._aborted){l.readyState=d.UNSENT;return}l.readyState==d.DONE&&(h(l),c&&i&&window.detachEvent("onunload",n)),m!=l.readyState&&e(l),m=l.readyState}},d.onopen&&d.onopen.apply(this,arguments),this._object.open(a,f,i,j,k),!i&&b&&(this.readyState=d.OPENED,e(this))},d.prototype.send=function(a){d.onsend&&d.onsend.apply(this,arguments),a&&a.nodeType&&(a=window.XMLSerializer?(new window.XMLSerializer).serializeToString(a):a.xml,this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml")),this._object.send(a);if(b&&!this._async){this.readyState=d.OPENED,g(this);while(this.readyState<d.DONE){this.readyState++,e(this);if(this._aborted)return}}},d.prototype.abort=function(){d.onabort&&d.onabort.apply(this,arguments),this.readyState>d.UNSENT&&(this._aborted=!0),this._object.abort(),h(this)},d.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()},d.prototype.getResponseHeader=function(a){return this._object.getResponseHeader(a)},d.prototype.setRequestHeader=function(a,b){this._headers||(this._headers={}),this._headers[a]=b;return this._object.setRequestHeader(a,b)},d.prototype.toString=function(){return"[object XMLHttpRequest]"},d.toString=function(){return"[XMLHttpRequest]"},window.Function.prototype.apply||(window.Function.prototype.apply=function(a,b){b||(b=[]),a.__func=this,a.__func(b[0],b[1],b[2],b[3],b[4]),delete a.__func}),OpenLayers.Request.XMLHttpRequest=d}(),OpenLayers.Tile.Image.IFrame=OpenLayers.Class(OpenLayers.Tile.Image,{initialize:function(a,b,c,d,e){OpenLayers.Tile.Image.prototype.initialize.apply(this,arguments),this.layerAlphaHack=!1},destroy:function(){this.imgDiv!=null&&OpenLayers.Event.stopObservingElement(this.imgDiv.firstChild),OpenLayers.Tile.Image.prototype.destroy.apply(this,arguments)},clear:function(){if(this.imgDiv){var a=this.imgDiv.firstChild;OpenLayers.Event.stopObservingElement(a),this.imgDiv.removeChild(a)}},clone:function(a){a==null&&(a=new OpenLayers.Tile.Image.IFrame(this.layer,this.position,this.bounds,this.url,this.size)),a=OpenLayers.Tile.Image.prototype.clone.apply(this,[a]);return a},renderTile:function(){if(OpenLayers.Tile.Image.prototype.renderTile.apply(this,arguments)){var a=this.createRequestForm();this.imgDiv.appendChild(a),a.submit(),this.imgDiv.removeChild(a)}},initImgDiv:function(){this.imgDiv=this.createImgDiv(),OpenLayers.Util.modifyDOMElement(this.imgDiv,this.id,null,this.layer.getImageSize(),"relative"),this.imgDiv.className="olTileImage",this.frame.appendChild(this.imgDiv),this.layer.div.appendChild(this.frame),this.layer.opacity!=null&&OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity),this.imgDiv.map=this.layer.map},createImgDiv:function(){var a=document.createElement("div");OpenLayers.Util.getBrowserName()=="msie"&&(a.style.backgroundColor="#FFFFFF",a.style.filter="chroma(color=#FFFFFF)"),OpenLayers.Util.modifyDOMElement(a,null,new OpenLayers.Pixel(0,0),this.layer.getImageSize(),"absolute");var b=document.createElement("div");b.appendChild(a);return b},createIFrame:function(){var a=this.id+"_iFrame",b;OpenLayers.Util.getBrowserName()=="msie"?(b=document.createElement('<iframe name="'+a+'">'),b.style.backgroundColor="#FFFFFF",b.style.filter="chroma(color=#FFFFFF)"):(b=document.createElement("iframe"),b.style.backgroundColor="transparent",b.name=a),b.id=a,b.scrolling="no",b.marginWidth="0px",b.marginHeight="0px",b.frameBorder="0",OpenLayers.Util.modifyDOMElement(b,a,new OpenLayers.Pixel(0,0),this.layer.getImageSize(),"absolute");var c=function(){this.show(),this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("loadend"))};OpenLayers.Event.observe(b,"load",OpenLayers.Function.bind(c,this));return b},createRequestForm:function(){var a=document.createElement("form");a.method="POST";var b=this.layer.params._OLSALT;b=(b?b+"_":"")+this.bounds.toBBOX(),a.action=OpenLayers.Util.urlAppend(this.layer.url,b),this.imgDiv.insertBefore(this.createIFrame(),this.imgDiv.firstChild),a.target=this.id+"_iFrame";var c=this.layer.getImageSize(),d=OpenLayers.Util.extend({BBOX:this.encodeBBOX?this.bounds.toBBOX():this.bounds.toArray(),WIDTH:c.w,HEIGHT:c.h},this.layer.params);for(var e in d){var f=document.createElement("input");f.type="hidden",f.name=e,f.value=d[e],a.appendChild(f)}return a},CLASS_NAME:"OpenLayers.Tile.Image.IFrame"}),OpenLayers.ProxyHost="",OpenLayers.nullHandler=function(a){OpenLayers.Console.userError(OpenLayers.i18n("unhandledRequest",{statusText:a.statusText}))},OpenLayers.loadURL=function(a,b,c,d,e){typeof b=="string"&&(b=OpenLayers.Util.getParameters(b));var f=d?d:OpenLayers.nullHandler,g=e?e:OpenLayers.nullHandler;return OpenLayers.Request.GET({url:a,params:b,success:f,failure:g,scope:c})},OpenLayers.parseXMLString=function(a){var b=a.indexOf("<");b>0&&(a=a.substring(b));var c=OpenLayers.Util.Try(function(){var b=new ActiveXObject("Microsoft.XMLDOM");b.loadXML(a);return b},function(){return(new DOMParser).parseFromString(a,"text/xml")},function(){var b=new XMLHttpRequest;b.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(a),!1),b.overrideMimeType&&b.overrideMimeType("text/xml"),b.send(null);return b.responseXML});return c},OpenLayers.Ajax={emptyFunction:function(){},getTransport:function(){return OpenLayers.Util.Try(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||!1},activeRequestCount:0},OpenLayers.Ajax.Responders={responders:[],register:function(a){for(var b=0;b<this.responders.length;b++)if(a==this.responders[b])return;this.responders.push(a)},unregister:function(a){OpenLayers.Util.removeItem(this.reponders,a)},dispatch:function(a,b,c){var d;for(var e=0;e<this.responders.length;e++){d=this.responders[e];if(d[a]&&typeof d[a]=="function")try{d[a].apply(d,[b,c])}catch(f){}}}},OpenLayers.Ajax.Responders.register({onCreate:function(){OpenLayers.Ajax.activeRequestCount++},onComplete:function(){OpenLayers.Ajax.activeRequestCount--}}),OpenLayers.Ajax.Base=OpenLayers.Class({initialize:function(a){this.options={method:"post",asynchronous:!0,contentType:"application/xml",parameters:""},OpenLayers.Util.extend(this.options,a||{}),this.options.method=this.options.method.toLowerCase(),typeof this.options.parameters=="string"&&(this.options.parameters=OpenLayers.Util.getParameters(this.options.parameters))}}),OpenLayers.Ajax.Request=OpenLayers.Class(OpenLayers.Ajax.Base,{_complete:!1,initialize:function(a,b){OpenLayers.Ajax.Base.prototype.initialize.apply(this,[b]),OpenLayers.ProxyHost&&OpenLayers.String.startsWith(a,"http")&&(a=OpenLayers.ProxyHost+encodeURIComponent(a)),this.transport=OpenLayers.Ajax.getTransport(),this.request(a)},request:function(a){this.url=a,this.method=this.options.method;var b=OpenLayers.Util.extend({},this.options.parameters);this.method!="get"&&this.method!="post"&&(b._method=this.method,this.method="post"),this.parameters=b;if(b=OpenLayers.Util.getParameterString(b))this.method=="get"?this.url+=(this.url.indexOf("?")>-1?"&":"?")+b:/Konqueror|Safari|KHTML/.test(navigator.userAgent)&&(b+="&_=");try{var c=new OpenLayers.Ajax.Response(this);this.options.onCreate&&this.options.onCreate(c),OpenLayers.Ajax.Responders.dispatch("onCreate",this,c),this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous),this.options.asynchronous&&window.setTimeout(OpenLayers.Function.bind(this.respondToReadyState,this,1),10),this.transport.onreadystatechange=OpenLayers.Function.bind(this.onStateChange,this),this.setRequestHeaders(),this.body=this.method=="post"?this.options.postBody||b:null,this.transport.send(this.body),!this.options.asynchronous&&this.transport.overrideMimeType&&this.onStateChange()}catch(d){this.dispatchException(d)}},onStateChange:function(){var a=this.transport.readyState;a>1&&(a!=4||!this._complete)&&this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var a={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*",OpenLayers:!0};this.method=="post"&&(a["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:""),this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005&&(a.Connection="close"));if(typeof this.options.requestHeaders=="object"){var b=this.options.requestHeaders;if(typeof b.push=="function")for(var c=0,d=b.length;c<d;c+=2)a[b[c]]=b[c+1];else for(var c in b)a[c]=b[c]}for(var e in a)this.transport.setRequestHeader(e,a[e])},success:function(){var a=this.getStatus();return!a||a>=200&&a<300},getStatus:function(){try{return this.transport.status||0}catch(a){return 0}},respondToReadyState:function(a){var b=OpenLayers.Ajax.Request.Events[a],c=new OpenLayers.Ajax.Response(this);if(b=="Complete"){try{this._complete=!0,(this.options["on"+c.status]||this.options["on"+(this.success()?"Success":"Failure")]||OpenLayers.Ajax.emptyFunction)(c)}catch(d){this.dispatchException(d)}var e=c.getHeader("Content-type")}try{(this.options["on"+b]||OpenLayers.Ajax.emptyFunction)(c),OpenLayers.Ajax.Responders.dispatch("on"+b,this,c)}catch(d){this.dispatchException(d)}b=="Complete"&&(this.transport.onreadystatechange=OpenLayers.Ajax.emptyFunction)},getHeader:function(a){try{return this.transport.getResponseHeader(a)}catch(b){return null}},dispatchException:function(a){var b=this.options.onException;if(b)b(this,a),OpenLayers.Ajax.Responders.dispatch("onException",this,a);else{var c=!1,d=OpenLayers.Ajax.Responders.responders;for(var e=0;e<d.length;e++)if(d[e].onException){c=!0;break}if(c)OpenLayers.Ajax.Responders.dispatch("onException",this,a);else throw a}}}),OpenLayers.Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"],OpenLayers.Ajax.Response=OpenLayers.Class({status:0,statusText:"",initialize:function(a){this.request=a;var b=this.transport=a.transport,c=this.readyState=b.readyState;if(c>2&&(!window.attachEvent||window.opera)||c==4)this.status=this.getStatus(),this.statusText=this.getStatusText(),this.responseText=b.responseText==null?"":String(b.responseText);if(c==4){var d=b.responseXML;this.responseXML=d===undefined?null:d}},getStatus:OpenLayers.Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:OpenLayers.Ajax.Request.prototype.getHeader,getResponseHeader:function(a){return this.transport.getResponseHeader(a)}}),OpenLayers.Ajax.getElementsByTagNameNS=function(a,b,c,d){var e=null;a.getElementsByTagNameNS?e=a.getElementsByTagNameNS(b,d):e=a.getElementsByTagName(c+":"+d);return e},OpenLayers.Ajax.serializeXMLToString=function(a){var b=new XMLSerializer,c=b.serializeToString(a);return c},OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(a,b){},onDrag:function(a,b){},onComplete:function(a,b){},documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(a,b){OpenLayers.Control.prototype.initialize.apply(this,[b]),this.layer=a,this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},destroy:function(){this.layer=null,OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.handlers.drag.deactivate(),this.handlers.feature.deactivate(),this.feature=null,this.dragging=!1,this.lastPixel=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over");return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(a){this.handlers.drag.dragging?this.feature.id==a.id?this.over=!0:this.over=!1:(this.feature=a,this.handlers.drag.activate(),this.over=!0,OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over"))},downFeature:function(a){this.lastPixel=a,this.onStart(this.feature,a)},moveFeature:function(a){var b=this.map.getResolution();this.feature.geometry.move(b*(a.x-this.lastPixel.x),b*(this.lastPixel.y-a.y)),this.layer.drawFeature(this.feature),this.lastPixel=a,this.onDrag(this.feature,a)},upFeature:function(a){this.over||this.handlers.drag.deactivate()},doneDragging:function(a){this.onComplete(this.feature,a)},outFeature:function(a){this.handlers.drag.dragging?this.feature.id==a.id&&(this.over=!1):(this.over=!1,this.handlers.drag.deactivate(),OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),this.feature=null)},cancel:function(){this.handlers.drag.deactivate(),this.over=!1},setMap:function(a){this.handlers.drag.setMap(a),this.handlers.feature.setMap(a),OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"}),OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:25,documentDrag:!1,draw:function(){this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone},{interval:this.interval,documentDrag:this.documentDrag})},panMap:function(a){this.panned=!0,this.map.pan(this.handler.last.x-a.x,this.handler.last.y-a.y,{dragging:this.handler.dragging,animate:!1})},panMapDone:function(a){this.panned&&(this.panMap(a),this.panned=!1)},CLASS_NAME:"OpenLayers.Control.DragPan"}),OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,slideFactor:75,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.handler&&this.handler.destroy(),this.handler=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress})},defaultKeyPress:function(a){switch(a.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:var b=this.map.getSize();this.map.pan(0,-.75*b.h);break;case 34:var b=this.map.getSize();this.map.pan(0,.75*b.h);break;case 35:var b=this.map.getSize();this.map.pan(.75*b.w,0);break;case 36:var b=this.map.getSize();this.map.pan(-.75*b.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut()}},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"}),OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,drillDown:!1,maxFeatures:10,clickCallback:"click",layers:null,queryVisible:!1,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,EVENT_TYPES:["beforegetfeatureinfo","getfeatureinfo"],initialize:function(a){this.EVENT_TYPES=OpenLayers.Control.WMSGetFeatureInfo.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES),a=a||{},a.handlerOptions=a.handlerOptions||{},OpenLayers.Control.prototype.initialize.apply(this,[a]),this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(a.formatOptions)),this.drillDown===!0&&(this.hover=!1);if(this.hover)this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}));else{var b={};b[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,b,this.handlerOptions.click||{})}},activate:function(){this.active||this.handler.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},getInfoForClick:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy}),OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait"),this.request(a.xy,{})},getInfoForHover:function(a){this.events.triggerEvent("beforegetfeatureinfo",{xy:a.xy}),this.request(a.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){var a=this.layers||this.map.layers,b=[],c,d;for(var e=0,f=a.length;e<f;++e)c=a[e],c instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||c.getVisibility())&&(d=c.url instanceof Array?c.url[0]:c.url,this.drillDown===!1&&!this.url&&(this.url=d),(this.drillDown===!0||this.urlMatches(d))&&b.push(c));return b},urlMatches:function(a){var b=OpenLayers.Util.isEquivalentUrl(this.url,a);if(!b&&this.layerUrls)for(var c=0,d=this.layerUrls.length;c<d;++c)if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[c],a)){b=!0;break}return b},buildWMSOptions:function(a,b,c,d){var e=[],f=[];for(var g=0,h=b.length;g<h;g++)e=e.concat(b[g].params.LAYERS),f=f.concat(this.getStyleNames(b[g]));var i=OpenLayers.Util.extend({service:"WMS",version:b[0].params.VERSION,request:"GetFeatureInfo",layers:e,query_layers:e,styles:f,bbox:this.map.getExtent().toBBOX(null,b[0].reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:d,info_format:this.infoFormat},parseFloat(b[0].params.VERSION)>=1.3?{crs:this.map.getProjection(),i:c.x,j:c.y}:{srs:this.map.getProjection(),x:c.x,y:c.y});OpenLayers.Util.applyDefaults(i,this.vendorParams);return{url:a,params:OpenLayers.Util.upperCaseObject(i),callback:function(a){this.handleResponse(c,a)},scope:this}},getStyleNames:function(a){var b;a.params.STYLES?b=a.params.STYLES:a.params.LAYERS instanceof Array?b=Array(a.params.LAYERS.length):b=a.params.LAYERS.replace(/[^,]/g,"");return b},request:function(a,b){var c=this.findLayers();if(c.length==0)OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait");else{b=b||{};if(this.drillDown===!1){var d=this.buildWMSOptions(this.url,c,a,c[0].params.FORMAT),e=OpenLayers.Request.GET(d);b.hover===!0&&(this.hoverRequest=e.priv)}else{this._requestCount=0,this._numRequests=0,this.features=[];var f={},g;for(var h=0,i=c.length;h<i;h++){var j=c[h],k,l=!1;g=j.url instanceof Array?j.url[0]:j.url,g in f?f[g].push(j):(this._numRequests++,f[g]=[j])}var c;for(var g in f){c=f[g];var d=this.buildWMSOptions(g,c,a,c[0].params.FORMAT);OpenLayers.Request.GET(d)}}}},triggerGetFeatureInfo:function(a,b,c){this.events.triggerEvent("getfeatureinfo",{text:a.responseText,features:c,request:a,xy:b}),OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(a,b){var c=b.responseXML;if(!c||!c.documentElement)c=b.responseText;var d=this.format.read(c);this.drillDown===!1?this.triggerGetFeatureInfo(b,a,d):(this._requestCount++,this._features=(this._features||[]).concat(d),this._requestCount===this._numRequests&&(this.triggerGetFeatureInfo(b,a,this._features.concat()),delete this._features,delete this._requestCount,delete this._numRequests))},setMap:function(a){this.handler.setMap(a),OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"}),OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",initialize:function(a,b,c){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,b]),this.lonlat=null,this.geometry=a?a:null,this.state=null,this.attributes={},b&&(this.attributes=OpenLayers.Util.extend(this.attributes,b)),this.style=c?c:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(a){var b=!1;if(this.layer&&this.layer.map){var c=this.layer.map.getExtent();if(a){var d=this.geometry.getBounds();b=c.intersectsBounds(d)}else{var e=c.toGeometry();b=e.intersects(this.geometry)}}return b},getVisibility:function(){return!(this.style&&this.style.display=="none"||!this.layer||this.layer&&this.layer.styleMap&&this.layer.styleMap.createSymbolizer(this,this.renderIntent).display=="none"||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(a,b,c){var d=!1;this.geometry&&(d=this.geometry.atPoint(a,b,c));return d},destroyPopup:function(){},move:function(a){if(this.layer&&this.geometry.move){var b;a.CLASS_NAME=="OpenLayers.LonLat"?b=this.layer.getViewPortPxFromLonLat(a):b=a;var c=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),d=this.layer.map.getResolution();this.geometry.move(d*(b.x-c.x),d*(c.y-b.y)),this.layer.drawFeature(this);return c}},toState:function(a){if(a==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=a;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:}else if(a==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=a}else if(a==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=a}else a==OpenLayers.State.UNKNOWN&&(this.state=a)},CLASS_NAME:"OpenLayers.Feature.Vector"}),OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit"},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer"},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit"},"delete":{display:"none"}},OpenLayers.Feature.WFS=OpenLayers.Class(OpenLayers.Feature,{initialize:function(a,b){var c=arguments,d=this.processXMLNode(b);c=[a,d.lonlat,d],OpenLayers.Feature.prototype.initialize.apply(this,c),this.createMarker(),this.layer.addMarker(this.marker)},destroy:function(){this.marker!=null&&this.layer.removeMarker(this.marker),OpenLayers.Feature.prototype.destroy.apply(this,arguments)},processXMLNode:function(a){var b=OpenLayers.Ajax.getElementsByTagNameNS(a,"http://www.opengis.net/gml","gml","Point"),c=OpenLayers.Util.getXmlNodeValue(OpenLayers.Ajax.getElementsByTagNameNS(b[0],"http://www.opengis.net/gml","gml","coordinates")[0]),d=c.split(",");return{lonlat:new OpenLayers.LonLat(parseFloat(d[0]),parseFloat(d[1])),id:null}},CLASS_NAME:"OpenLayers.Feature.WFS"}),OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.WFSCapabilities,{initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]),this.options=a},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b={},c=a.documentElement;this.runChildNodes(b,c);return b},runChildNodes:function(a,b){var c=b.childNodes,d,e;for(var f=0;f<c.length;++f)d=c[f],d.nodeType==1&&(e=this["read_cap_"+d.nodeName],e&&e.apply(this,[a,d]))},read_cap_FeatureTypeList:function(a,b){var c={featureTypes:[]};this.runChildNodes(c,b),a.featureTypeList=c},read_cap_FeatureType:function(a,b,c){var d={};this.runChildNodes(d,b),a.featureTypes.push(d)},read_cap_Name:function(a,b){var c=this.getChildValue(b);c&&(a.name=c)},read_cap_Title:function(a,b){var c=this.getChildValue(b);c&&(a.title=c)},read_cap_Abstract:function(a,b){var c=this.getChildValue(b);c&&(a["abstract"]=c)},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"}),OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(a){var b=null;if(a==null)b=this.namespaces[this.defaultPrefix];else for(b in this.namespaces)if(this.namespaces[b]==a)break;return b},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",defaultStyleTitle:"Default",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a.documentElement;this.rootPrefix=b.prefix;var c={version:b.getAttribute("version")};this.runChildNodes(c,b);return c},runChildNodes:function(a,b){var c=b.childNodes,d,e,f,g;for(var h=0,i=c.length;h<i;++h)d=c[h],d.nodeType==1&&(f=this.getNamespacePrefix(d.namespaceURI),g=d.nodeName.split(":").pop(),e=this["read_"+f+"_"+g],e&&e.apply(this,[a,d]))},read_wmc_General:function(a,b){this.runChildNodes(a,b)},read_wmc_BoundingBox:function(a,b){a.projection=b.getAttribute("SRS"),a.bounds=new OpenLayers.Bounds(parseFloat(b.getAttribute("minx")),parseFloat(b.getAttribute("miny")),parseFloat(b.getAttribute("maxx")),parseFloat(b.getAttribute("maxy")))},read_wmc_LayerList:function(a,b){a.layersContext=[],this.runChildNodes(a,b)},read_wmc_Layer:function(a,b){var c={visibility:b.getAttribute("hidden")!="1",queryable:b.getAttribute("queryable")=="1",formats:[],styles:[]};this.runChildNodes(c,b),a.layersContext.push(c)},read_wmc_Extension:function(a,b){this.runChildNodes(a,b)},read_ol_units:function(a,b){a.units=this.getChildValue(b)},read_ol_maxExtent:function(a,b){var c=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"));a.maxExtent=c},read_ol_transparent:function(a,b){a.transparent=this.getChildValue(b)},read_ol_numZoomLevels:function(a,b){a.numZoomLevels=parseInt(this.getChildValue(b))},read_ol_opacity:function(a,b){a.opacity=parseFloat(this.getChildValue(b))},read_ol_singleTile:function(a,b){a.singleTile=this.getChildValue(b)=="true"},read_ol_isBaseLayer:function(a,b){a.isBaseLayer=this.getChildValue(b)=="true"},read_ol_displayInLayerSwitcher:function(a,b){a.displayInLayerSwitcher=this.getChildValue(b)=="true"},read_wmc_Server:function(a,b){a.version=b.getAttribute("version");var c={},d=b.getElementsByTagName("OnlineResource");d.length>0&&this.read_wmc_OnlineResource(c,d[0]),a.url=c.href},read_wmc_FormatList:function(a,b){this.runChildNodes(a,b)},read_wmc_Format:function(a,b){var c={value:this.getChildValue(b)};b.getAttribute("current")=="1"&&(c.current=!0),a.formats.push(c)},read_wmc_StyleList:function(a,b){this.runChildNodes(a,b)},read_wmc_Style:function(a,b){var c={};this.runChildNodes(c,b),b.getAttribute("current")=="1"&&(c.current=!0),a.styles.push(c)},read_wmc_SLD:function(a,b){this.runChildNodes(a,b)},read_sld_StyledLayerDescriptor:function(a,b){var c=OpenLayers.Format.XML.prototype.write.apply(this,[b]);a.body=c},read_wmc_OnlineResource:function(a,b){a.href=this.getAttributeNS(b,this.namespaces.xlink,"href")},read_wmc_Name:function(a,b){var c=this.getChildValue(b);c&&(a.name=c)},read_wmc_Title:function(a,b){var c=this.getChildValue(b);c&&(a.title=c)},read_wmc_MetadataURL:function(a,b){var c={},d=b.getElementsByTagName("OnlineResource");d.length>0&&this.read_wmc_OnlineResource(c,d[0]),a.metadataURL=c.href},read_wmc_Abstract:function(a,b){var c=this.getChildValue(b);c&&(a["abstract"]=c)},read_wmc_LegendURL:function(a,b){var c={width:b.getAttribute("width"),height:b.getAttribute("height")},d=b.getElementsByTagName("OnlineResource");d.length>0&&this.read_wmc_OnlineResource(c,d[0]),a.legend=c},write:function(a,b){var c=this.createElementDefaultNS("ViewContext");this.setAttributes(c,{version:this.VERSION,id:b&&typeof b.id=="string"?b.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")}),this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),c.appendChild(this.write_wmc_General(a)),c.appendChild(this.write_wmc_LayerList(a));return OpenLayers.Format.XML.prototype.write.apply(this,[c])},createElementDefaultNS:function(a,b,c){var d=this.createElementNS(this.namespaces[this.defaultPrefix],a);b&&d.appendChild(this.createTextNode(b)),c&&this.setAttributes(d,c);return d},setAttributes:function(a,b){var c;for(var d in b)c=b[d].toString(),c.match(/[A-Z]/)?this.setAttributeNS(a,null,d,c):a.setAttribute(d,c)},write_wmc_General:function(a){var b=this.createElementDefaultNS("General");a.size&&b.appendChild(this.createElementDefaultNS("Window",null,{width:a.size.w,height:a.size.h}));var c=a.bounds;b.appendChild(this.createElementDefaultNS("BoundingBox",null,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),maxy:c.top.toPrecision(18),SRS:a.projection})),b.appendChild(this.createElementDefaultNS("Title",a.title)),b.appendChild(this.write_ol_MapExtension(a));return b},write_ol_MapExtension:function(a){var b=this.createElementDefaultNS("Extension"),c=a.maxExtent;if(c){var d=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(d,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),maxy:c.top.toPrecision(18)}),b.appendChild(d)}return b},write_wmc_LayerList:function(a){var b=this.createElementDefaultNS("LayerList");for(var c=0,d=a.layersContext.length;c<d;++c)b.appendChild(this.write_wmc_Layer(a.layersContext[c]));return b},write_wmc_Layer:function(a){var b=this.createElementDefaultNS("Layer",null,{queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1"});b.appendChild(this.write_wmc_Server(a)),b.appendChild(this.createElementDefaultNS("Name",a.name)),b.appendChild(this.createElementDefaultNS("Title",a.title)),a.metadataURL&&b.appendChild(this.write_wmc_MetadataURL(a.metadataURL));return b},write_wmc_LayerExtension:function(a){var b=this.createElementDefaultNS("Extension"),c=a.maxExtent,d=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(d,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),maxy:c.top.toPrecision(18)}),b.appendChild(d);var e=["transparent","numZoomLevels","units","isBaseLayer","opacity","displayInLayerSwitcher","singleTile"],f;for(var g=0,h=e.length;g<h;++g)f=this.createOLPropertyNode(a,e[g]),f&&b.appendChild(f);return b},createOLPropertyNode:function(a,b){var c=null;a[b]!=null&&(c=this.createElementNS(this.namespaces.ol,"ol:"+b),c.appendChild(this.createTextNode(a[b].toString())));return c},write_wmc_Server:function(a){var b=this.createElementDefaultNS("Server");this.setAttributes(b,{service:"OGC:WMS",version:a.version}),b.appendChild(this.write_wmc_OnlineResource(a.url));return b},write_wmc_MetadataURL:function(a){var b=this.createElementDefaultNS("MetadataURL");b.appendChild(this.write_wmc_OnlineResource(a));return b},write_wmc_FormatList:function(a){var b=this.createElementDefaultNS("FormatList");for(var c=0,d=a.formats.length;c<d;c++){var e=a.formats[c];b.appendChild(this.createElementDefaultNS("Format",e.value,e.current&&e.current==!0?{current:"1"}:null))}return b},write_wmc_StyleList:function(a){var b=this.createElementDefaultNS("StyleList"),c=a.styles;if(c&&c instanceof Array){var d;for(var e=0,f=c.length;e<f;e++){var g=c[e],h=this.createElementDefaultNS("Style",null,g.current&&g.current==!0?{current:"1"}:null);if(g.href){d=this.createElementDefaultNS("SLD");var i=this.write_wmc_OnlineResource(g.href);d.appendChild(i),d.appendChild(this.createElementDefaultNS("Name",g.name)),g.title&&d.appendChild(this.createElementDefaultNS("Title",g.title)),h.appendChild(d)}else if(g.body){d=this.createElementDefaultNS("SLD");var j=OpenLayers.Format.XML.prototype.read.apply(this,[g.body]),k=j.documentElement;d.ownerDocument&&d.ownerDocument.importNode&&(k=d.ownerDocument.importNode(k,!0)),d.appendChild(k),d.appendChild(this.createElementDefaultNS("Name",g.name)),g.title&&d.appendChild(this.createElementDefaultNS("Title",g.title)),h.appendChild(d)}else h.appendChild(this.createElementDefaultNS("Name",g.name)),h.appendChild(this.createElementDefaultNS("Title",g.title)),g["abstract"]&&h.appendChild(this.createElementDefaultNS("Abstract",g["abstract"]));b.appendChild(h)}}return b},write_wmc_OnlineResource:function(a){var b=this.createElementDefaultNS("OnlineResource");this.setAttributeNS(b,this.namespaces.xlink,"xlink:type","simple"),this.setAttributeNS(b,this.namespaces.xlink,"xlink:href",a);return b},CLASS_NAME:"OpenLayers.Format.WMC.v1"}),OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a])),a&&a.nodeType==9&&(a=a.documentElement);var b={};this.readNode(a,b),this.postProcessLayers(b);return b},postProcessLayers:function(a){if(a.capability){a.capability.layers=[];var b=a.capability.nestedLayers;for(var c=0,d=b.length;c<d;++c){var e=b[c];this.processLayer(a.capability,e)}}},processLayer:function(a,b,c){b.formats===undefined&&(b.formats=a.request.getmap.formats);if(c){b.styles=b.styles.concat(c.styles);var d=["queryable","cascaded","fixedWidth","fixedHeight","opaque","noSubsets","llbbox","minScale","maxScale","attribution"],e=["srs","bbox","dimensions","authorityURLs"],f;for(var g=0;g<d.length;g++){f=d[g];if(f in c){b[f]==null&&(b[f]=c[f]);if(b[f]==null){var h=["cascaded","fixedWidth","fixedHeight"],i=["queryable","opaque","noSubsets"];OpenLayers.Util.indexOf(h,f)!=-1&&(b[f]=0),OpenLayers.Util.indexOf(i,f)!=-1&&(b[f]=!1)}}}for(var g=0;g<e.length;g++)f=e[g],b[f]=OpenLayers.Util.extend(b[f],c[f])}for(var j=0,k=b.nestedLayers.length;j<k;j++){var l=b.nestedLayers[j];this.processLayer(a,l,b)}b.name&&a.layers.push(b)},readers:{wms:{Service:function(a,b){b.service={},this.readChildNodes(a,b.service)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b["abstract"]=this.getChildValue(a)},BoundingBox:function(a,b){var c={};c.bbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))];var d={x:parseFloat(a.getAttribute("resx")),y:parseFloat(a.getAttribute("resy"))};if(!isNaN(d.x)||!isNaN(d.y))c.res=d;return c},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},ContactInformation:function(a,b){b.contactInformation={},this.readChildNodes(a,b.contactInformation)},ContactPersonPrimary:function(a,b){b.personPrimary={},this.readChildNodes(a,b.personPrimary)},ContactPerson:function(a,b){b.person=this.getChildValue(a)},ContactOrganization:function(a,b){b.organization=this.getChildValue(a)},ContactPosition:function(a,b){b.position=this.getChildValue(a)},ContactAddress:function(a,b){b.contactAddress={},this.readChildNodes(a,b.contactAddress)},AddressType:function(a,b){b.type=this.getChildValue(a)},Address:function(a,b){b.address=this.getChildValue(a)},City:function(a,b){b.city=this.getChildValue(a)},StateOrProvince:function(a,b){b.stateOrProvince=this.getChildValue(a)},PostCode:function(a,b){b.postcode=this.getChildValue(a)},Country:function(a,b){b.country=this.getChildValue(a)},ContactVoiceTelephone:function(a,b){b.phone=this.getChildValue(a)},ContactFacsimileTelephone:function(a,b){b.fax=this.getChildValue(a)},ContactElectronicMailAddress:function(a,b){b.email=this.getChildValue(a)},Fees:function(a,b){var c=this.getChildValue(a);c&&c.toLowerCase()!="none"&&(b.fees=c)},AccessConstraints:function(a,b){var c=this.getChildValue(a);c&&c.toLowerCase()!="none"&&(b.accessConstraints=c)},Capability:function(a,b){b.capability={nestedLayers:[]},this.readChildNodes(a,b.capability)},Request:function(a,b){b.request={},this.readChildNodes(a,b.request)},GetCapabilities:function(a,b){b.getcapabilities={formats:[]},this.readChildNodes(a,b.getcapabilities)},Format:function(a,b){b.formats instanceof Array?b.formats.push(this.getChildValue(a)):b.format=this.getChildValue(a)},DCPType:function(a,b){this.readChildNodes(a,b)},HTTP:function(a,b){this.readChildNodes(a,b)},Get:function(a,b){this.readChildNodes(a,b)},Post:function(a,b){this.readChildNodes(a,b)},GetMap:function(a,b){b.getmap={formats:[]},this.readChildNodes(a,b.getmap)},GetFeatureInfo:function(a,b){b.getfeatureinfo={formats:[]},this.readChildNodes(a,b.getfeatureinfo)},Exception:function(a,b){b.exception={formats:[]},this.readChildNodes(a,b.exception)},Layer:function(a,b){var c=a.getAttributeNode("queryable"),d=c&&c.specified?a.getAttribute("queryable"):null;c=a.getAttributeNode("cascaded");var e=c&&c.specified?a.getAttribute("cascaded"):null;c=a.getAttributeNode("opaque");var f=c&&c.specified?a.getAttribute("opaque"):null,g=a.getAttribute("noSubsets"),h=a.getAttribute("fixedWidth"),i=a.getAttribute("fixedHeight"),j={nestedLayers:[],styles:[],srs:{},metadataURLs:[],bbox:{},dimensions:{},authorityURLs:{},identifiers:{},keywords:[],queryable:d&&d!==""?d==="1"||d==="true":null,cascaded:e!==null?parseInt(e):null,opaque:f?f==="1"||f==="true":null,noSubsets:g!==null?g==="1"||g==="true":null,fixedWidth:h!=null?parseInt(h):null,fixedHeight:i!=null?parseInt(i):null};b.nestedLayers.push(j),this.readChildNodes(a,j);if(j.name){var k=j.name.split(":");k.length>0&&(j.prefix=k[0])}},Attribution:function(a,b){b.attribution={},this.readChildNodes(a,b.attribution)},LogoURL:function(a,b){b.logo={width:a.getAttribute("width"),height:a.getAttribute("height")},this.readChildNodes(a,b.logo)},Style:function(a,b){var c={};b.styles.push(c),this.readChildNodes(a,c)},LegendURL:function(a,b){var c={width:a.getAttribute("width"),height:a.getAttribute("height")};b.legend=c,this.readChildNodes(a,c)},MetadataURL:function(a,b){var c={type:a.getAttribute("type")};b.metadataURLs.push(c),this.readChildNodes(a,c)},DataURL:function(a,b){b.dataURL={},this.readChildNodes(a,b.dataURL)},FeatureListURL:function(a,b){b.featureListURL={},this.readChildNodes(a,b.featureListURL)},AuthorityURL:function(a,b){var c=a.getAttribute("name"),d={};this.readChildNodes(a,d),b.authorityURLs[c]=d.href},Identifier:function(a,b){var c=a.getAttribute("authority");b.identifiers[c]=this.getChildValue(a)},KeywordList:function(a,b){this.readChildNodes(a,b)},SRS:function(a,b){b.srs[this.getChildValue(a)]=!0}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"}),OpenLayers.Format.WMSDescribeLayer.v1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(a){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=a.documentElement,c=b.childNodes,d=[];for(var e=0;e<c.length;++e){childNode=c[e],nodeName=childNode.nodeName;if(nodeName=="LayerDescription"){var f=childNode.getAttribute("name"),g="",h="",i="";childNode.getAttribute("owsType")?(g=childNode.getAttribute("owsType"),h=childNode.getAttribute("owsURL")):childNode.getAttribute("wfs")!=""?(g="WFS",h=childNode.getAttribute("wfs")):childNode.getAttribute("wcs")!=""&&(g="WCS",h=childNode.getAttribute("wcs")),query=childNode.getElementsByTagName("Query"),query.length>0&&(i=query[0].getAttribute("typeName"),i||(i=query[0].getAttribute("typename"))),d.push({layerName:f,owsType:g,owsURL:h,typeName:i})}}return d},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1"}),OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxCharacteristics:null,initialize:function(a,b,c){OpenLayers.Handler.prototype.initialize.apply(this,arguments);var b={down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox};this.dragHandler=new OpenLayers.Handler.Drag(this,b,{keyMask:this.keyMask})},setMap:function(a){OpenLayers.Handler.prototype.setMap.apply(this,arguments),this.dragHandler&&this.dragHandler.setMap(a)},startBox:function(a){this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.dragHandler.start),this.zoomBox.className=this.boxDivClassName,this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(a){var b=this.dragHandler.start.x,c=this.dragHandler.start.y,d=Math.abs(b-a.x),e=Math.abs(c-a.y);this.zoomBox.style.width=Math.max(1,d)+"px",this.zoomBox.style.height=Math.max(1,e)+"px",this.zoomBox.style.left=a.x<b?a.x+"px":b+"px",this.zoomBox.style.top=a.y<c?a.y+"px":c+"px";var f=this.getBoxCharacteristics();f.newBoxModel&&(a.x>b&&(this.zoomBox.style.width=Math.max(1,d-f.xOffset)+"px"),a.y>c&&(this.zoomBox.style.height=Math.max(1,e-f.yOffset)+"px"))},endBox:function(a){var b;if(Math.abs(this.dragHandler.start.x-a.x)>5||Math.abs(this.dragHandler.start.y-a.y)>5){var c=this.dragHandler.start,d=Math.min(c.y,a.y),e=Math.max(c.y,a.y),f=Math.min(c.x,a.x),g=Math.max(c.x,a.x);b=new OpenLayers.Bounds(f,e,g,d)}else b=this.dragHandler.start.clone();this.removeBox(),this.callback("done",[b])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null,this.boxCharacteristics=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragHandler.activate();return!0}return!1},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.dragHandler.deactivate();return!0}return!1},getBoxCharacteristics:function(){if(!this.boxCharacteristics){var a=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width"))+1,b=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"))+1,c=OpenLayers.Util.getBrowserName()=="msie"?document.compatMode!="BackCompat":!0;this.boxCharacteristics={xOffset:a,yOffset:b,newBoxModel:c}}return this.boxCharacteristics},CLASS_NAME:"OpenLayers.Handler.Box"}),OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",persist:!1,irregular:!1,angle:null,fixedRadius:!1,feature:null,layer:null,origin:null,initialize:function(a,b,c){this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{}),OpenLayers.Handler.prototype.initialize.apply(this,[a,b,c]),this.options=c?c:new Object},setOptions:function(a){OpenLayers.Util.extend(this.options,a),OpenLayers.Util.extend(this,a)},activate:function(){var a=!1;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var b={displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True};this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,b),this.map.addLayer(this.layer),a=!0}return a},deactivate:function(){var a=!1;OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)&&(this.dragging&&this.cancel(),this.layer.map!=null&&(this.layer.destroy(!1),this.feature&&this.feature.destroy()),this.layer=null,this.feature=null,a=!0);return a},down:function(a){this.fixedRadius=!!this.radius;var b=this.map.getLonLatFromPixel(a.xy);this.origin=new OpenLayers.Geometry.Point(b.lon,b.lat);if(!this.fixedRadius||this.irregular)this.radius=this.map.getResolution();this.persist&&this.clear(),this.feature=new OpenLayers.Feature.Vector,this.createGeometry(),this.callback("create",[this.origin,this.feature]),this.layer.addFeatures([this.feature],{silent:!0}),this.layer.drawFeature(this.feature,this.style)},move:function(a){var b=this.map.getLonLatFromPixel(a.xy),c=new OpenLayers.Geometry.Point(b.lon,b.lat);if(this.irregular){var d=Math.sqrt(2)*Math.abs(c.y-this.origin.y)/2;this.radius=Math.max(this.map.getResolution()/2,d)}else this.fixedRadius?this.origin=c:(this.calculateAngle(c,a),this.radius=Math.max(this.map.getResolution()/2,c.distanceTo(this.origin)));this.modifyGeometry();if(this.irregular){var e=c.x-this.origin.x,f=c.y-this.origin.y,g;f==0?g=e/(this.radius*Math.sqrt(2)):g=e/f,this.feature.geometry.resize(1,this.origin,g),this.feature.geometry.move(e/2,f/2)}this.layer.drawFeature(this.feature,this.style)},up:function(a){this.finalize(),this.start==this.last&&this.callback("done",[a.xy])},out:function(a){this.finalize()},createGeometry:function(){this.angle=Math.PI*(1/this.sides-.5),this.snapAngle&&(this.angle+=this.snapAngle*(Math.PI/180)),this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var a,b,c,d,e=this.feature.geometry.components[0];e.components.length!=this.sides+1&&(this.createGeometry(),e=this.feature.geometry.components[0]);for(var f=0;f<this.sides;++f)d=e.components[f],a=this.angle+f*2*Math.PI/this.sides,d.x=this.origin.x+this.radius*Math.cos(a),d.y=this.origin.y+this.radius*Math.sin(a),d.clearBounds()},calculateAngle:function(a,b){var c=Math.atan2(a.y-this.origin.y,a.x-this.origin.x);if(this.snapAngle&&(this.snapToggle&&!b[this.snapToggle])){var d=Math.PI/180*this.snapAngle;this.angle=Math.round(c/d)*d}else this.angle=c},cancel:function(){this.callback("cancel",null),this.finalize()},finalize:function(){this.origin=null,this.radius=this.options.radius},clear:function(){this.layer.renderer.clear(),this.layer.destroyFeatures()},callback:function(a,b){this.callbacks[a]&&this.callbacks[a].apply(this.control,[this.feature.geometry.clone()]),!this.persist&&(a=="done"||a=="cancel")&&this.clear()},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"}),OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:!0,isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.pane==null&&(this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane"))},destroy:function(){this.mapObject=null,this.pane=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments),this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1,this.pane.style.display=this.div.style.display,this.pane.style.width="100%",this.pane.style.height="100%",OpenLayers.Util.getBrowserName()=="msie"&&(this.pane.style.background="url("+OpenLayers.Util.getImagesLocation()+"blank.gif)"),this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane),this.loadMapObject(),this.mapObject==null&&this.loadWarningMessage()},removeMap:function(a){this.pane&&this.pane.parentNode&&this.pane.parentNode.removeChild(this.pane),OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var a=this.map.getSize(),b=Math.min(a.w,300),c=Math.min(a.h,200),d=new OpenLayers.Size(b,c),e=new OpenLayers.Pixel(a.w/2,a.h/2),f=e.add(-d.w/2,-d.h/2),g=OpenLayers.Util.createDiv(this.name+"_warning",f,d,null,null,null,"auto");g.style.padding="7px",g.style.backgroundColor="yellow",g.innerHTML=this.getWarningHTML(),this.div.appendChild(g)},getWarningHTML:function(){return""},display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments),this.pane.style.display=this.div.style.display},setZIndex:function(a){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments),this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(this.mapObject!=null){var d=this.map.getCenter(),e=this.map.getZoom();if(d!=null){var f=this.getMapObjectCenter(),g=this.getOLLonLatFromMapObjectLonLat(f),h=this.getMapObjectZoom(),i=this.getOLZoomFromMapObjectZoom(h);if(!d.equals(g)||e!=i)if(c&&this.dragPanMapObject&&this.smoothDragPan){var j=this.map.getViewPortPxFromLonLat(g),k=this.map.getViewPortPxFromLonLat(d);this.dragPanMapObject(k.x-j.x,j.y-k.y)}else{var l=this.getMapObjectLonLatFromOLLonLat(d),m=this.getMapObjectZoomFromOLZoom(e);this.setMapObjectCenter(l,m,c)}}}},getLonLatFromViewPortPx:function(a){var b=null;if(this.mapObject!=null&&this.getMapObjectCenter()!=null){var c=this.getMapObjectPixelFromOLPixel(a),d=this.getMapObjectLonLatFromMapObjectPixel(c);b=this.getOLLonLatFromMapObjectLonLat(d)}return b},getViewPortPxFromLonLat:function(a){var b=null;if(this.mapObject!=null&&this.getMapObjectCenter()!=null){var c=this.getMapObjectLonLatFromOLLonLat(a),d=this.getMapObjectPixelFromMapObjectLonLat(c);b=this.getOLPixelFromMapObjectPixel(d)}return b},getOLLonLatFromMapObjectLonLat:function(a){var b=null;if(a!=null){var c=this.getLongitudeFromMapObjectLonLat(a),d=this.getLatitudeFromMapObjectLonLat(a);b=new OpenLayers.LonLat(c,d)}return b},getMapObjectLonLatFromOLLonLat:function(a){var b=null;a!=null&&(b=this.getMapObjectLonLatFromLonLat(a.lon,a.lat));return b},getOLPixelFromMapObjectPixel:function(a){var b=null;if(a!=null){var c=this.getXFromMapObjectPixel(a),d=this.getYFromMapObjectPixel(a);b=new OpenLayers.Pixel(c,d)}return b},getMapObjectPixelFromOLPixel:function(a){var b=null;a!=null&&(b=this.getMapObjectPixelFromXY(a.x,a.y));return b},CLASS_NAME:"OpenLayers.Layer.EventPane"}),OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){var a=["minZoomLevel","maxZoomLevel","numZoomLevels"];for(var b=0,c=a.length;b<c;b++){var d=a[b];this[d]=this.options[d]!=null?this.options[d]:this.map[d]}if(this.minZoomLevel==null||this.minZoomLevel<this.MIN_ZOOM_LEVEL)this.minZoomLevel=this.MIN_ZOOM_LEVEL;var e,f=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;this.options.numZoomLevels==null&&this.options.maxZoomLevel!=null||this.numZoomLevels==null&&this.maxZoomLevel!=null?e=this.maxZoomLevel-this.minZoomLevel+1:e=this.numZoomLevels,e!=null?this.numZoomLevels=Math.min(e,f):this.numZoomLevels=f,this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(this.RESOLUTIONS!=null){var g=0;this.resolutions=[];for(var b=this.minZoomLevel;b<=this.maxZoomLevel;b++)this.resolutions[g++]=this.RESOLUTIONS[b];this.maxResolution=this.resolutions[0],this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(this.resolutions!=null)return OpenLayers.Layer.prototype.getResolution.apply(this,arguments);var a=null,b=this.map.getSize(),c=this.getExtent();b!=null&&c!=null&&(a=Math.max(c.getWidth()/b.w,c.getHeight()/b.h));return a},getExtent:function(){var a=null,b=this.map.getSize(),c=new OpenLayers.Pixel(0,0),d=this.getLonLatFromViewPortPx(c),e=new OpenLayers.Pixel(b.w,b.h),f=this.getLonLatFromViewPortPx(e);d!=null&&f!=null&&(a=new OpenLayers.Bounds(d.lon,f.lat,f.lon,d.lat));return a},getZoomForResolution:function(a){if(this.resolutions!=null)return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments);var b=OpenLayers.Layer.prototype.getExtent.apply(this,[]);return this.getZoomForExtent(b)},getOLZoomFromMapObjectZoom:function(a){var b=null;a!=null&&(b=a-this.minZoomLevel);return b},getMapObjectZoomFromOLZoom:function(a){var b=null;a!=null&&(b=a+this.minZoomLevel);return b},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"}),OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(a,b,c,d){var e=arguments;e=[a,d],OpenLayers.Layer.prototype.initialize.apply(this,e),this.url=b,this.params=OpenLayers.Util.extend({},c)},destroy:function(){this.url=null,this.params=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){a==null&&(a=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.prototype.clone.apply(this,[a]);return a},setUrl:function(a){this.url=a},mergeNewParams:function(a){this.params=OpenLayers.Util.extend(this.params,a);var b=this.redraw();this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"});return b},redraw:function(a){return a?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(a,b){var c=1;for(var d=0,e=a.length;d<e;d++)c*=a.charCodeAt(d)*this.URL_HASH_FACTOR,c-=Math.floor(c);return b[Math.floor(c*b.length)]},getFullRequestString:function(a,b){var c=b||this.url,d=OpenLayers.Util.extend({},this.params);d=OpenLayers.Util.extend(d,a);var e=OpenLayers.Util.getParameterString(d);c instanceof Array&&(c=this.selectUrl(e,c));var f=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c));for(var g in d)g.toUpperCase()in f&&delete d[g];e=OpenLayers.Util.getParameterString(d);return OpenLayers.Util.urlAppend(c,e)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"}),OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(a,b,c,d,e){this.url=b,this.extent=c,this.maxExtent=c,this.size=d,OpenLayers.Layer.prototype.initialize.apply(this,[a,e]),this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){this.tile&&(this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null),OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){a==null&&(a=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions())),a=OpenLayers.Layer.prototype.clone.apply(this,[a]);return a},setMap:function(a){this.options.maxResolution==null&&(this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w),OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=this.tile==null;if(b||d){this.setTileSize();var e=new OpenLayers.LonLat(this.extent.left,this.extent.top),f=this.map.getLayerPxFromLonLat(e);d?(this.tile=new OpenLayers.Tile.Image(this,f,this.extent,null,this.tileSize),this.addTileMonitoringHooks(this.tile)):(this.tile.size=this.tileSize.clone(),this.tile.position=f.clone()),this.tile.draw()}},setTileSize:function(){var a=this.extent.getWidth()/this.map.getResolution(),b=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(a,b)},addTileMonitoringHooks:function(a){a.onLoadStart=function(){this.events.triggerEvent("loadstart")},a.events.register("loadstart",this,a.onLoadStart),a.onLoadEnd=function(){this.events.triggerEvent("loadend")},a.events.register("loadend",this,a.onLoadEnd),a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload(),a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},setUrl:function(a){this.url=a,this.tile.draw()},getURL:function(a){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"}),OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,markers:null,drawn:!1,initialize:function(a,b){OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.markers=[]},destroy:function(){this.clearMarkers(),this.markers=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(a){if(a!=this.opacity){this.opacity=a;for(var b=0,c=this.markers.length;b<c;b++)this.markers[b].setOpacity(this.opacity)}},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(b||!this.drawn){for(var d=0,e=this.markers.length;d<e;d++)this.drawMarker(this.markers[d]);this.drawn=!0}},addMarker:function(a){this.markers.push(a),this.opacity!=null&&a.setOpacity(this.opacity),this.map&&this.map.getExtent()&&(a.map=this.map,this.drawMarker(a))},removeMarker:function(a){this.markers&&this.markers.length&&(OpenLayers.Util.removeItem(this.markers,a),a.erase())},clearMarkers:function(){if(this.markers!=null)while(this.markers.length>0)this.removeMarker(this.markers[0])},drawMarker:function(a){var b=this.map.getLayerPxFromLonLat(a.lonlat);if(b==null)a.display(!1);else if(a.isDrawn())a.icon&&a.icon.moveTo(b);else{var c=a.draw(b);this.div.appendChild(c)}},getDataExtent:function(){var a=null;if(this.markers&&this.markers.length>0){var a=new OpenLayers.Bounds;for(var b=0,c=this.markers.length;b<c;b++){var d=this.markers[b];a.extend(d.lonlat)}}return a},CLASS_NAME:"OpenLayers.Layer.Markers"}),OpenLayers.Layer.SphericalMercator={getExtent:function(){var a=null;this.sphericalMercator?a=this.map.calculateBounds():a=OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this);return a},initMercatorParameters:function(){this.RESOLUTIONS=[];var a=156543.0339;for(var b=0;b<=this.MAX_ZOOM_LEVEL;++b)this.RESOLUTIONS[b]=a/Math.pow(2,b);this.units="m",this.projection="EPSG:900913"},forwardMercator:function(a,b){var c=a*20037508.34/180,d=Math.log(Math.tan((90+b)*Math.PI/360))/(Math.PI/180);d=d*20037508.34/180;return new OpenLayers.LonLat(c,d)},inverseMercator:function(a,b){var c=a/20037508.34*180,d=b/20037508.34*180;d=180/Math.PI*(2*Math.atan(Math.exp(d*Math.PI/180))-Math.PI/2);return new OpenLayers.LonLat(c,d)},projectForward:function(a){var b=OpenLayers.Layer.SphericalMercator.forwardMercator(a.x,a.y);a.x=b.lon,a.y=b.lat;return a},projectInverse:function(a){var b=OpenLayers.Layer.SphericalMercator.inverseMercator(a.x,a.y);a.x=b.lon,a.y=b.lat;return a}},OpenLayers.Projection.addTransform("EPSG:4326","EPSG:900913",OpenLayers.Layer.SphericalMercator.projectForward),OpenLayers.Projection.addTransform("EPSG:900913","EPSG:4326",OpenLayers.Layer.SphericalMercator.projectInverse),OpenLayers.Tile.WFS=OpenLayers.Class(OpenLayers.Tile,{features:null,url:null,request:null,initialize:function(a,b,c,d,e){OpenLayers.Tile.prototype.initialize.apply(this,arguments),this.url=d,this.features=[]},destroy:function(){OpenLayers.Tile.prototype.destroy.apply(this,arguments),this.destroyAllFeatures(),this.features=null,this.url=null,this.request&&(this.request.abort(),this.request=null)},clear:function(){this.destroyAllFeatures()},draw:function(){OpenLayers.Tile.prototype.draw.apply(this,arguments)&&(this.isLoading?this.events.triggerEvent("reload"):(this.isLoading=!0,this.events.triggerEvent("loadstart")),this.loadFeaturesForRegion(this.requestSuccess))},loadFeaturesForRegion:function(a,b){this.request&&this.request.abort(),this.request=OpenLayers.Request.GET({url:this.url,success:a,failure:b,scope:this})},requestSuccess:function(a){if(this.features){var b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;if(this.layer.vectorMode)this.layer.addFeatures(this.layer.formatObject.read(b));else{var c=new OpenLayers.Format.XML;typeof b=="string"&&(b=c.read(b));var d=c.getElementsByTagNameNS(b,"http://www.opengis.net/gml","featureMember");this.addResults(d)}}this.events&&this.events.triggerEvent("loadend"),this.request=null},addResults:function(a){for(var b=0;b<a.length;b++){var c=new this.layer.featureClass(this.layer,a[b]);this.features.push(c)}},destroyAllFeatures:function(){while(this.features.length>0){var a=this.features.shift();a.destroy()}},CLASS_NAME:"OpenLayers.Tile.WFS"}),OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,EVENT_TYPES:["featureadded"],multi:!1,featureAdded:function(){},handlerOptions:null,initialize:function(a,b,c){this.EVENT_TYPES=OpenLayers.Control.DrawFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES),OpenLayers.Control.prototype.initialize.apply(this,[c]),this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(a,b){this.layer.events.triggerEvent("sketchmodified",{vertex:a,feature:b})},create:function(a,b){this.layer.events.triggerEvent("sketchstarted",{vertex:a,feature:b})}},this.callbacks),this.layer=a,this.handlerOptions=this.handlerOptions||{},"multi"in this.handlerOptions||(this.handlerOptions.multi=this.multi);var d=this.layer.styleMap&&this.layer.styleMap.styles.temporary;d&&(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":d})})),this.handler=new b(this,this.callbacks,this.handlerOptions)},drawFeature:function(a){var b=new OpenLayers.Feature.Vector(a),c=this.layer.events.triggerEvent("sketchcomplete",{feature:b});c!==!1&&(b.state=OpenLayers.State.INSERT,this.layer.addFeatures([b]),this.featureAdded(b),this.events.triggerEvent("featureadded",{feature:b}))},CLASS_NAME:"OpenLayers.Control.DrawFeature"}),OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["measure","measurepartial"],handlerOptions:null,callbacks:null,displaySystem:"metric",geodesic:!1,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:!1,initialize:function(a,b){this.EVENT_TYPES=OpenLayers.Control.Measure.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES),OpenLayers.Control.prototype.initialize.apply(this,[b]),this.callbacks=OpenLayers.Util.extend({done:this.measureComplete,point:this.measurePartial},this.callbacks),this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions),this.handler=new a(this,this.callbacks,this.handlerOptions)},cancel:function(){this.handler.cancel()},updateHandler:function(a,b){var c=this.active;c&&this.deactivate(),this.handler=new a(this,this.callbacks,b),c&&this.activate()},measureComplete:function(a){this.delayedTrigger&&window.clearTimeout(this.delayedTrigger),this.measure(a,"measure")},measurePartial:function(a,b){this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.measure(b,"measurepartial")},this),this.partialDelay)},measure:function(a,b){var c,d;a.CLASS_NAME.indexOf("LineString")>-1?(c=this.getBestLength(a),d=1):(c=this.getBestArea(a),d=2),this.events.triggerEvent(b,{measure:c[0],units:c[1],order:d,geometry:a})},getBestArea:function(a){var b=this.displaySystemUnits[this.displaySystem],c,d;for(var e=0,f=b.length;e<f;++e){c=b[e],d=this.getArea(a,c);if(d>1)break}return[d,c]},getArea:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicArea(this.map.getProjectionObject()),d="m"):(c=a.getArea(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];if(e){var f=OpenLayers.INCHES_PER_UNIT[d];c*=Math.pow(f/e,2)}return c},getBestLength:function(a){var b=this.displaySystemUnits[this.displaySystem],c,d;for(var e=0,f=b.length;e<f;++e){c=b[e],d=this.getLength(a,c);if(d>1)break}return[d,c]},getLength:function(a,b){var c,d;this.geodesic?(c=a.getGeodesicLength(this.map.getProjectionObject()),d="m"):(c=a.getLength(),d=this.map.getUnits());var e=OpenLayers.INCHES_PER_UNIT[b];if(e){var f=OpenLayers.INCHES_PER_UNIT[d];c*=f/e}return c},CLASS_NAME:"OpenLayers.Control.Measure"}),OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,alwaysZoom:!1,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(a){if(a instanceof OpenLayers.Bounds){var b;if(this.out){var e=Math.abs(a.right-a.left),f=Math.abs(a.top-a.bottom),g=Math.min(this.map.size.h/f,this.map.size.w/e),h=this.map.getExtent(),i=this.map.getLonLatFromPixel(a.getCenterPixel()),j=i.lon-h.getWidth()/2*g,k=i.lon+h.getWidth()/2*g,l=i.lat-h.getHeight()/2*g,m=i.lat+h.getHeight()/2*g;b=new OpenLayers.Bounds(j,l,k,m)}else{var c=this.map.getLonLatFromPixel(new OpenLayers.Pixel(a.left,a.bottom)),d=this.map.getLonLatFromPixel(new OpenLayers.Pixel(a.right,a.top));b=new OpenLayers.Bounds(c.lon,c.lat,d.lon,d.lat)}var n=this.map.getZoom();this.map.zoomToExtent(b),n==this.map.getZoom()&&this.alwaysZoom==!0&&this.map.zoomTo(n+(this.out?-1:1))}else this.out?this.map.setCenter(this.map.getLonLatFromPixel(a),this.map.getZoom()-1):this.map.setCenter(this.map.getLonLatFromPixel(a),this.map.getZoom()+1)},CLASS_NAME:"OpenLayers.Control.ZoomBox"}),OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{initialize:function(a){OpenLayers.Format.WFSCapabilities.v1.prototype.initialize.apply(this,[a])},read_cap_Service:function(a,b){var c={};this.runChildNodes(c,b),a.service=c},read_cap_Fees:function(a,b){var c=this.getChildValue(b);c&&c.toLowerCase()!="none"&&(a.fees=c)},read_cap_AccessConstraints:function(a,b){var c=this.getChildValue(b);c&&c.toLowerCase()!="none"&&(a.accessConstraints=c)},read_cap_OnlineResource:function(a,b){var c=this.getChildValue(b);c&&c.toLowerCase()!="none"&&(a.onlineResource=c)},read_cap_Keywords:function(a,b){var c=this.getChildValue(b);c&&c.toLowerCase()!="none"&&(a.keywords=c.split(", "))},read_cap_Capability:function(a,b){var c={};this.runChildNodes(c,b),a.capability=c},read_cap_Request:function(a,b){var c={};this.runChildNodes(c,b),a.request=c},read_cap_GetFeature:function(a,b){var c={href:{},formats:[]};this.runChildNodes(c,b),a.getfeature=c},read_cap_ResultFormat:function(a,b){var c=b.childNodes,d;for(var e=0;e<c.length;e++)d=c[e],d.nodeType==1&&a.formats.push(d.nodeName)},read_cap_DCPType:function(a,b){this.runChildNodes(a,b)},read_cap_HTTP:function(a,b){this.runChildNodes(a.href,b)},read_cap_Get:function(a,b){a.get=b.getAttribute("onlineResource")},read_cap_Post:function(a,b){a.post=b.getAttribute("onlineResource")},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"}),OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{initialize:function(a){OpenLayers.Format.WFSCapabilities.v1.prototype.initialize.apply(this,[a])},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"}),OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(a){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){var b,c,d,e=this.regExes.typeStr.exec(a);if(e){c=e[1].toLowerCase(),d=e[2],this.parse[c]&&(b=this.parse[c].apply(this,[d]));if(this.internalProjection&&this.externalProjection)if(b&&b.CLASS_NAME=="OpenLayers.Feature.Vector")b.geometry.transform(this.externalProjection,this.internalProjection);else if(b&&c!="geometrycollection"&&typeof b=="object")for(var f=0,g=b.length;f<g;f++){var h=b[f];h.geometry.transform(this.externalProjection,this.internalProjection)}}return b},write:function(a){var b,c,d,e,f;a.constructor==Array?(b=a,f=!0):(b=[a],f=!1);var g=[];f&&g.push("GEOMETRYCOLLECTION(");for(var h=0,i=b.length;h<i;++h){f&&h>0&&g.push(","),c=b[h].geometry,d=c.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[d])return null;this.internalProjection&&this.externalProjection&&(c=c.clone(),c.transform(this.internalProjection,this.externalProjection)),e=this.extract[d].apply(this,[c]),g.push(d.toUpperCase()+"("+e+")")}f&&g.push(")");return g.join("")},extract:{point:function(a){return a.x+" "+a.y},multipoint:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b.join(",")},linestring:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b.join(",")},multilinestring:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},polygon:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.linestring.apply(this,[a.components[c]])+")");return b.join(",")},multipolygon:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push("("+this.extract.polygon.apply(this,[a.components[c]])+")");return b.join(",")}},parse:{point:function(a){var b=OpenLayers.String.trim(a).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b[0],b[1]))},multipoint:function(a){var b=OpenLayers.String.trim(a).split(","),c=[];for(var d=0,e=b.length;d<e;++d)c.push(this.parse.point.apply(this,[b[d]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(c))},linestring:function(a){var b=OpenLayers.String.trim(a).split(","),c=[];for(var d=0,e=b.length;d<e;++d)c.push(this.parse.point.apply(this,[b[d]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(c))},multilinestring:function(a){var b,c=OpenLayers.String.trim(a).split(this.regExes.parenComma),d=[];for(var e=0,f=c.length;e<f;++e)b=c[e].replace(this.regExes.trimParens,"$1"),d.push(this.parse.linestring.apply(this,[b]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(d))},polygon:function(a){var b,c,d,e=OpenLayers.String.trim(a).split(this.regExes.parenComma),f=[];for(var g=0,h=e.length;g<h;++g)b=e[g].replace(this.regExes.trimParens,"$1"),c=this.parse.linestring.apply(this,[b]).geometry,d=new OpenLayers.Geometry.LinearRing(c.components),f.push(d);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(f))},multipolygon:function(a){var b,c=OpenLayers.String.trim(a).split(this.regExes.doubleParenComma),d=[];for(var e=0,f=c.length;e<f;++e)b=c[e].replace(this.regExes.trimParens,"$1"),d.push(this.parse.polygon.apply(this,[b]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(d))},geometrycollection:function(a){a=a.replace(/,\s*([A-Za-z])/g,"|$1");var b=OpenLayers.String.trim(a).split("|"),c=[];for(var d=0,e=b.length;d<e;++d)c.push(OpenLayers.Format.WKT.prototype.read.apply(this,[b[d]]));return c}},CLASS_NAME:"OpenLayers.Format.WKT"}),OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},write_wmc_Layer:function(a){var b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[a]);b.appendChild(this.write_wmc_FormatList(a)),b.appendChild(this.write_wmc_StyleList(a)),b.appendChild(this.write_wmc_LayerExtension(a))},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"}),OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(a){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[a])},read_sld_MinScaleDenominator:function(a,b){var c=parseFloat(this.getChildValue(b));c>0&&(a.maxScale=c)},read_sld_MaxScaleDenominator:function(a,b){a.minScale=parseFloat(this.getChildValue(b))},write_wmc_Layer:function(a){var b=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[a]);if(a.maxScale){var c=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");c.appendChild(this.createTextNode(a.maxScale.toPrecision(16))),b.appendChild(c)}if(a.minScale){var d=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator");d.appendChild(this.createTextNode(a.minScale.toPrecision(16))),b.appendChild(d)}b.appendChild(this.write_wmc_FormatList(a)),b.appendChild(this.write_wmc_StyleList(a)),b.appendChild(this.write_wmc_LayerExtension(a));return b},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"}),OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMT_MS_Capabilities:function(a,b){this.readChildNodes(a,b)},Keyword:function(a,b){b.keywords&&b.keywords.push(this.getChildValue(a))},DescribeLayer:function(a,b){b.describelayer={formats:[]},this.readChildNodes(a,b.describelayer)},GetLegendGraphic:function(a,b){b.getlegendgraphic={formats:[]},this.readChildNodes(a,b.getlegendgraphic)},GetStyles:function(a,b){b.getstyles={formats:[]},this.readChildNodes(a,b.getstyles)},PutStyles:function(a,b){b.putstyles={formats:[]},this.readChildNodes(a,b.putstyles)},UserDefinedSymbolization:function(a,b){var c={supportSLD:parseInt(a.getAttribute("SupportSLD"))==1,userLayer:parseInt(a.getAttribute("UserLayer"))==1,userStyle:parseInt(a.getAttribute("UserStyle"))==1,remoteWFS:parseInt(a.getAttribute("RemoteWFS"))==1};b.userSymbols=c},LatLonBoundingBox:function(a,b){b.llbbox=[parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))]},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,b]);c.srs=a.getAttribute("SRS"),b.bbox[c.srs]=c},ScaleHint:function(a,b){var c=a.getAttribute("min"),d=a.getAttribute("max"),e=Math.pow(2,.5),f=OpenLayers.INCHES_PER_UNIT.m;b.maxScale=parseFloat((c/e*f*OpenLayers.DOTS_PER_INCH).toPrecision(13)),b.minScale=parseFloat((d/e*f*OpenLayers.DOTS_PER_INCH).toPrecision(13))},Dimension:function(a,b){var c=a.getAttribute("name").toLowerCase(),d={name:c,units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol")};b.dimensions[d.name]=d},Extent:function(a,b){var c=a.getAttribute("name").toLowerCase();if(c in b.dimensions){var d=b.dimensions[c];d.nearestVal=a.getAttribute("nearestValue")==="1",d.multipleVal=a.getAttribute("multipleValues")==="1",d.current=a.getAttribute("current")==="1",d["default"]=a.getAttribute("default")||"";var e=this.getChildValue(a);d.values=e.split(",")}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"}),OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMS_Capabilities:function(a,b){this.readChildNodes(a,b)},LayerLimit:function(a,b){b.layerLimit=parseInt(this.getChildValue(a))},MaxWidth:function(a,b){b.maxWidth=parseInt(this.getChildValue(a))},MaxHeight:function(a,b){b.maxHeight=parseInt(this.getChildValue(a))},BoundingBox:function(a,b){var c=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[a,b]);c.srs=a.getAttribute("CRS"),b.bbox[c.srs]=c},CRS:function(a,b){this.readers.wms.SRS.apply(this,[a,b])},EX_GeographicBoundingBox:function(a,b){b.llbbox=[],this.readChildNodes(a,b.llbbox)},westBoundLongitude:function(a,b){b[0]=this.getChildValue(a)},eastBoundLongitude:function(a,b){b[2]=this.getChildValue(a)},southBoundLatitude:function(a,b){b[1]=this.getChildValue(a)},northBoundLatitude:function(a,b){b[3]=this.getChildValue(a)},MinScaleDenominator:function(a,b){b.maxScale=parseFloat(this.getChildValue(a)).toPrecision(16)},MaxScaleDenominator:function(a,b){b.minScale=parseFloat(this.getChildValue(a)).toPrecision(16)},Dimension:function(a,b){var c=a.getAttribute("name").toLowerCase(),d={name:c,units:a.getAttribute("units"),unitsymbol:a.getAttribute("unitSymbol"),nearestVal:a.getAttribute("nearestValue")==="1",multipleVal:a.getAttribute("multipleValues")==="1","default":a.getAttribute("default")||"",current:a.getAttribute("current")==="1",values:this.getChildValue(a).split(",")};b.dimensions[d.name]=d},Keyword:function(a,b){var c={value:this.getChildValue(a),vocabulary:a.getAttribute("vocabulary")};b.keywords&&b.keywords.push(c)}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),sld:{UserDefinedSymbolization:function(a,b){this.readers.wms.UserDefinedSymbolization.apply(this,[a,b]),b.userSymbols.inlineFeature=parseInt(a.getAttribute("InlineFeature"))==1,b.userSymbols.remoteWCS=parseInt(a.getAttribute("RemoteWCS"))==1},DescribeLayer:function(a,b){this.readers.wms.DescribeLayer.apply(this,[a,b])},GetLegendGraphic:function(a,b){this.readers.wms.GetLegendGraphic.apply(this,[a,b])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"}),OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{initialize:function(a,b){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments)},drawMarker:function(a){var b=a.bounds,c=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(b.left,b.top)),d=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(b.right,b.bottom));if(d==null||c==null)a.display(!1);else{var e=new OpenLayers.Size(Math.max(1,d.x-c.x),Math.max(1,d.y-c.y)),f=a.draw(c,e);a.drawn||(this.div.appendChild(f),a.drawn=!0)}},removeMarker:function(a){OpenLayers.Util.removeItem(this.markers,a),a.div!=null&&a.div.parentNode==this.div&&this.div.removeChild(a.div)},CLASS_NAME:"OpenLayers.Layer.Boxes"}),OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:!0,initialize:function(a,b,c){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[a,c]),this.location=b,this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.clearFeatures(),this.features=null},loadRSS:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,success:this.parseData,scope:this}),this.loaded=!0)},moveTo:function(a,b,c){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadRSS()},parseData:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=OpenLayers.Format.XML.prototype.read(a.responseText);if(this.useFeedTitle){var c=null;try{c=b.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(d){c=b.getElementsByTagName("title")[0].firstChild.nodeValue}c&&this.setName(c)}var e={};OpenLayers.Util.extend(e,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(e.externalProjection=this.projection,e.internalProjection=this.map.getProjectionObject());var f=new OpenLayers.Format.GeoRSS(e),g=f.read(b);for(var h=0,i=g.length;h<i;h++){var j={},k=g[h];if(!k.geometry)continue;var l=k.attributes.title?k.attributes.title:"Untitled",m=k.attributes.description?k.attributes.description:"No description.",n=k.attributes.link?k.attributes.link:"",o=k.geometry.getBounds().getCenterLonLat();j.icon=this.icon==null?OpenLayers.Marker.defaultIcon():this.icon.clone(),j.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120);if(l||m){j.title=l,j.description=m;var p='<div class="olLayerGeoRSSClose">[x]</div>';p+='<div class="olLayerGeoRSSTitle">',n&&(p+='<a class="link" href="'+n+'" target="_blank">'),p+=l,n&&(p+="</a>"),p+="</div>",p+='<div style="" class="olLayerGeoRSSDescription">',p+=m,p+="</div>",j.popupContentHTML=p}var k=new OpenLayers.Feature(this,o,j);this.features.push(k);var q=k.createMarker();q.events.register("click",k,this.markerClick),this.addMarker(q)}this.events.triggerEvent("loadend")},markerClick:function(a){var b=this==this.layer.selectedFeature;this.layer.selectedFeature=b?null:this;for(var c=0,d=this.layer.map.popups.length;c<d;c++)this.layer.map.removePopup(this.layer.map.popups[c]);if(!b){var e=this.createPopup();OpenLayers.Event.observe(e.div,"click",OpenLayers.Function.bind(function(){for(var a=0,b=this.layer.map.popups.length;a<b;a++)this.layer.map.removePopup(this.layer.map.popups[a])},this)),this.layer.map.addPopup(e)}OpenLayers.Event.stop(a)},clearFeatures:function(){if(this.features!=null)while(this.features.length>0){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a),a.destroy()}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"}),OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20,536441802978515e-20,268220901489257e-20,1341104507446289e-21,6.705522537231445e-7],type:null,sphericalMercator:!1,dragObject:null,termsOfUse:null,poweredBy:null,initialize:function(a,b){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments),this.addContainerPxFunction(),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},loadMapObject:function(){this.type||(this.type=G_NORMAL_MAP);var a,b,c,d=OpenLayers.Layer.Google.cache[this.map.id];if(d)a=d.mapObject,b=d.termsOfUse,c=d.poweredBy,++d.count;else{var e=this.map.viewPortDiv,f=document.createElement("div");f.id=this.map.id+"_GMap2Container",f.style.position="absolute",f.style.width="100%",f.style.height="100%",e.appendChild(f);try{a=new GMap2(f),b=f.lastChild,e.appendChild(b),b.style.zIndex="1100",b.style.right="",b.style.bottom="",b.className="olLayerGoogleCopyright",c=f.lastChild,e.appendChild(c),c.style.zIndex="1100",c.style.right="",c.style.bottom="",c.className="olLayerGooglePoweredBy gmnoprint"}catch(g){OpenLayers.Console.error(g);return}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:a,termsOfUse:b,poweredBy:c,count:1}}this.mapObject=a,this.termsOfUse=b,this.poweredBy=c,OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)===-1&&this.mapObject.addMapType(this.type),typeof a.getDragObject=="function"?this.dragObject=a.getDragObject():this.dragPanMapObject=null,this.isBaseLayer===!1&&this.setGMapVisibility(this.div.style.display!=="none")},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded())this.mapObject.checkResize();else{if(!this._resized)var a=this,b=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(b),delete a._resized,a.mapObject.checkResize(),a.moveTo(a.map.getCenter(),a.map.getZoom())});this._resized=!0}},setVisibility:function(a){this.setGMapVisibility(a);var b=this.opacity==null?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments),this.setOpacity(b)},setGMapVisibility:function(a){var b=OpenLayers.Layer.Google.cache[this.map.id];if(b){var c=this.mapObject.getContainer();a===!0?(this.mapObject.setMapType(this.type),c.style.display="",this.termsOfUse.style.left="",this.termsOfUse.style.display="",this.poweredBy.style.display="",b.displayed=this.id):(b.displayed===this.id&&delete b.displayed,b.displayed||(c.style.display="none",this.termsOfUse.style.display="none",this.termsOfUse.style.left="-9999px",this.poweredBy.style.display="none"))}},setOpacity:function(a){a!==this.opacity&&(this.map!=null&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"}),this.opacity=a);if(this.getVisibility()){var b=this.mapObject.getContainer();OpenLayers.Util.modifyDOMElement(b,null,null,null,null,null,null,a)}},destroy:function(){if(this.map){this.setGMapVisibility(!1);var a=OpenLayers.Layer.Google.cache[this.map.id];a&&a.count<=1&&this.removeGMapElements(!1)}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var a=OpenLayers.Layer.Google.cache[this.map.id];if(a){var b=this.mapObject&&this.mapObject.getContainer();b&&b.parentNode&&b.parentNode.removeChild(b);var c=a.termsOfUse;c&&c.parentNode&&c.parentNode.removeChild(c);var d=a.poweredBy;d&&d.parentNode&&d.parentNode.removeChild(d)}},removeMap:function(a){this.visibility&&this.mapObject&&this.setGMapVisibility(!1);var b=OpenLayers.Layer.Google.cache[a.id];b&&(b.count>1?--b.count:(this.removeGMapElements(),delete OpenLayers.Layer.Google.cache[a.id])),delete this.termsOfUse,delete this.poweredBy,delete this.mapObject,delete this.dragObject,OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(a){var b=null;if(a!=null){var c=a.getSouthWest(),d=a.getNorthEast();this.sphericalMercator?(c=this.forwardMercator(c.lng(),c.lat()),d=this.forwardMercator(d.lng(),d.lat())):(c=new OpenLayers.LonLat(c.lng(),c.lat()),d=new OpenLayers.LonLat(d.lng(),d.lat())),b=new OpenLayers.Bounds(c.lon,c.lat,d.lon,d.lat)}return b},getMapObjectBoundsFromOLBounds:function(a){var b=null;if(a!=null){var c=this.sphericalMercator?this.inverseMercator(a.bottom,a.left):new OpenLayers.LonLat(a.bottom,a.left),d=this.sphericalMercator?this.inverseMercator(a.top,a.right):new OpenLayers.LonLat(a.top,a.right);b=new GLatLngBounds(new GLatLng(c.lat,c.lon),new GLatLng(d.lat,d.lon))}return b},addContainerPxFunction:function(){typeof GMap2!="undefined"&&!GMap2.prototype.fromLatLngToContainerPixel&&(GMap2.prototype.fromLatLngToContainerPixel=function(a){var b=this.fromLatLngToDivPixel(a),c=this.getContainer().firstChild.firstChild;b.x+=c.offsetLeft,b.y+=c.offsetTop;return b})},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},setMapObjectCenter:function(a,b){this.mapObject.setCenter(a,b)},dragPanMapObject:function(a,b){this.dragObject.moveBy(new GSize(-a,b))},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.fromContainerPixelToLatLng(a)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.fromLatLngToContainerPixel(a)},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lng(),a.lat()).lon:a.lng()},getLatitudeFromMapObjectLonLat:function(a){var b=this.sphericalMercator?this.forwardMercator(a.lng(),a.lat()).lat:a.lat();return b},getMapObjectLonLatFromLonLat:function(a,b){var c;if(this.sphericalMercator){var d=this.inverseMercator(a,b);c=new GLatLng(d.lat,d.lon)}else c=new GLatLng(b,a);return c},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return new GPoint(a,b)},CLASS_NAME:"OpenLayers.Layer.Google"}),OpenLayers.Layer.Google.cache={},OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,grid:null,singleTile:!1,ratio:1.5,buffer:2,numLoadingTiles:0,initialize:function(a,b,c,d){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments),this.events.addEventType("tileloaded"),this.grid=[]},destroy:function(){this.clearGrid(),this.grid=null,this.tileSize=null,OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.grid){for(var a=0,b=this.grid.length;a<b;a++){var c=this.grid[a];for(var d=0,e=c.length;d<e;d++){var f=c[d];this.removeTileMonitoringHooks(f),f.destroy()}}this.grid=[]}},clone:function(a){a==null&&(a=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[a]),this.tileSize!=null&&(a.tileSize=this.tileSize.clone()),a.grid=[];return a},moveTo:function(a,b,c){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments),a=a||this.map.getExtent();if(a!=null){var d=!this.grid.length||b,e=this.getTilesBounds();this.singleTile?(d||!c&&!e.containsBounds(a))&&this.initSingleTile(a):d||!e.containsBounds(a,!0)?this.initGriddedTiles(a):this.moveGriddedTiles(a)}},setTileSize:function(a){this.singleTile&&(a=this.map.getSize().clone(),a.h=parseInt(a.h*this.ratio),a.w=parseInt(a.w*this.ratio)),OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[a])},getGridBounds:function(){var a="The getGridBounds() function is deprecated. It will be removed in 3.0. Please use getTilesBounds() instead.";OpenLayers.Console.warn(a);return this.getTilesBounds()},getTilesBounds:function(){var a=null;if(this.grid.length){var b=this.grid.length-1,c=this.grid[b][0],d=this.grid[0].length-1,e=this.grid[0][d];a=new OpenLayers.Bounds(c.bounds.left,c.bounds.bottom,e.bounds.right,e.bounds.top)}return a},initSingleTile:function(a){var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio,d=a.getHeight()*this.ratio,e=new OpenLayers.Bounds(b.lon-c/2,b.lat-d/2,b.lon+c/2,b.lat+d/2),f=new OpenLayers.LonLat(e.left,e.top),g=this.map.getLayerPxFromLonLat(f);this.grid.length||(this.grid[0]=[]);var h=this.grid[0][0];h?h.moveTo(e,g):(h=this.addTile(e,g),this.addTileMonitoringHooks(h),h.draw(),this.grid[0][0]=h),this.removeExcessTiles(1,1)},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w,e=c*this.tileSize.h,f=a.left-b.left,g=Math.floor(f/d)-this.buffer,h=f/d-g,i=-h*this.tileSize.w,j=b.left+g*d,k=a.top-(b.bottom+e),l=Math.ceil(k/e)+this.buffer,m=l-k/e,n=-m*this.tileSize.h,o=b.bottom+l*e;return{tilelon:d,tilelat:e,tileoffsetlon:j,tileoffsetlat:o,tileoffsetx:i,tileoffsety:n}},initGriddedTiles:function(a){var b=this.map.getSize(),c=Math.ceil(b.h/this.tileSize.h)+Math.max(1,2*this.buffer),d=Math.ceil(b.w/this.tileSize.w)+Math.max(1,2*this.buffer),e=this.maxExtent,f=this.map.getResolution(),g=this.calculateGridLayout(a,e,f),h=Math.round(g.tileoffsetx),i=Math.round(g.tileoffsety),j=g.tileoffsetlon,k=g.tileoffsetlat,l=g.tilelon,m=g.tilelat;this.origin=new OpenLayers.Pixel(h,i);var n=h,o=j,p=0,q=parseInt(this.map.layerContainerDiv.style.left),r=parseInt(this.map.layerContainerDiv.style.top);do{var s=this.grid[p++];s||(s=[],this.grid.push(s)),j=o,h=n;var t=0;do{var u=new OpenLayers.Bounds(j,k,j+l,k+m),v=h;v-=q;var w=i;w-=r;var x=new OpenLayers.Pixel(v,w),y=s[t++];y?y.moveTo(u,x,!1):(y=this.addTile(u,x),this.addTileMonitoringHooks(y),s.push(y)),j+=l,h+=this.tileSize.w}while(j<=a.right+l*this.buffer||t<d);k-=m,i+=this.tileSize.h}while(k>=a.bottom-m*this.buffer||p<c);this.removeExcessTiles(p,t),this.spiralTileLoad()},spiralTileLoad:function(){var a=[],b=["right","down","left","up"],c=0,d=-1,e=OpenLayers.Util.indexOf(b,"right"),f=0;while(f<b.length){var g=c,h=d;switch(b[e]){case"right":h++;break;case"down":g++;break;case"left":h--;break;case"up":g--}var i=null;g<this.grid.length&&g>=0&&h<this.grid[0].length&&h>=0&&(i=this.grid[g][h]),i==null||i.queued?(e=(e+1)%4,f++):(a.unshift(i),i.queued=!0,f=0,c=g,d=h)}for(var j=0,k=a.length;j<k;j++){var i=a[j];i.draw(),i.queued=!1}},addTile:function(a,b){},addTileMonitoringHooks:function(a){a.onLoadStart=function(){this.numLoadingTiles==0&&this.events.triggerEvent("loadstart"),this.numLoadingTiles++},a.events.register("loadstart",this,a.onLoadStart),a.onLoadEnd=function(){this.numLoadingTiles--,this.events.triggerEvent("tileloaded"),this.numLoadingTiles==0&&this.events.triggerEvent("loadend")},a.events.register("loadend",this,a.onLoadEnd),a.events.register("unload",this,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload(),a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:this})},moveGriddedTiles:function(a){var b=this.buffer||1;while(!0){var c=this.grid[0][0].position,d=this.map.getViewPortPxFromLayerPx(c);if(d.x>-this.tileSize.w*(b-1))this.shiftColumn(!0);else if(d.x<-this.tileSize.w*b)this.shiftColumn(!1);else if(d.y>-this.tileSize.h*(b-1))this.shiftRow(!0);else if(d.y<-this.tileSize.h*b)this.shiftRow(!1);else break}},shiftRow:function(a){var b=a?0:this.grid.length-1,c=this.grid,d=c[b],e=this.map.getResolution(),f=a?-this.tileSize.h:this.tileSize.h,g=e*-f,h=a?c.pop():c.shift();for(var i=0,j=d.length;i<j;i++){var k=d[i],l=k.bounds.clone(),m=k.position.clone();l.bottom=l.bottom+g,l.top=l.top+g,m.y=m.y+f,h[i].moveTo(l,m)}a?c.unshift(h):c.push(h)},shiftColumn:function(a){var b=a?-this.tileSize.w:this.tileSize.w,c=this.map.getResolution(),d=c*b;for(var e=0,f=this.grid.length;e<f;e++){var g=this.grid[e],h=a?0:g.length-1,i=g[h],j=i.bounds.clone(),k=i.position.clone();j.left=j.left+d,j.right=j.right+d,k.x=k.x+b;var l=a?this.grid[e].pop():this.grid[e].shift();l.moveTo(j,k),a?g.unshift(l):g.push(l)}},removeExcessTiles:function(a,b){while(this.grid.length>a){var c=this.grid.pop();for(var d=0,e=c.length;d<e;d++){var f=c[d];this.removeTileMonitoringHooks(f),f.destroy()}}while(this.grid[0].length>b)for(var d=0,e=this.grid.length;d<e;d++){var c=this.grid[d],f=c.pop();this.removeTileMonitoringHooks(f),f.destroy()}},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(a){var b=this.maxExtent,c=this.getResolution(),d=c*this.tileSize.w,e=c*this.tileSize.h,f=this.getLonLatFromViewPortPx(a),g=b.left+d*Math.floor((f.lon-b.left)/d),h=b.bottom+e*Math.floor((f.lat-b.bottom)/e);return new OpenLayers.Bounds(g,h,g+d,h+e)},CLASS_NAME:"OpenLayers.Layer.Grid"}),OpenLayers.Layer.MultiMap=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[9,1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20],type:null,initialize:function(a,b){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters(),this.RESOLUTIONS.unshift(10))},loadMapObject:function(){try{this.mapObject=new MultimapViewer(this.div)}catch(a){}},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"MM",layerLib:"MultiMap"})},setMapObjectCenter:function(a,b){this.mapObject.goToPosition(a,b)},getMapObjectCenter:function(){return this.mapObject.getCurrentPosition()},getMapObjectZoom:function(){return this.mapObject.getZoomFactor()},getMapObjectLonLatFromMapObjectPixel:function(a){a.x=a.x-this.map.getSize().w/2,a.y=a.y-this.map.getSize().h/2;return this.mapObject.getMapPositionAt(a)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.geoPosToContainerPixels(a)},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lon,a.lat).lon:a.lon},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.lon,a.lat).lat:a.lat},getMapObjectLonLatFromLonLat:function(a,b){var c;if(this.sphericalMercator){var d=this.inverseMercator(a,b);c=new MMLatLon(d.lat,d.lon)}else c=new MMLatLon(b,a);return c},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return new MMPoint(a,b)},CLASS_NAME:"OpenLayers.Layer.MultiMap"}),OpenLayers.Layer.VirtualEarth=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:19,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20,536441802978515e-20],type:null,sphericalMercator:!1,animationEnabled:!0,initialize:function(a,b){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},loadMapObject:function(){var a=OpenLayers.Util.createDiv(this.name),b=this.map.getSize();a.style.width=b.w+"px",a.style.height=b.h+"px",this.div.appendChild(a);try{this.mapObject=new VEMap(this.name)}catch(c){}if(this.mapObject!=null){try{this.mapObject.LoadMap(null,null,this.type,!0),this.mapObject.AttachEvent("onmousedown",OpenLayers.Function.True)}catch(c){}this.mapObject.HideDashboard(),typeof this.mapObject.SetAnimationEnabled=="function"&&this.mapObject.SetAnimationEnabled(this.animationEnabled)}if(!this.mapObject||!this.mapObject.vemapcontrol||!this.mapObject.vemapcontrol.PanMap||typeof this.mapObject.vemapcontrol.PanMap!="function")this.dragPanMapObject=null},onMapResize:function(){this.mapObject.Resize(this.map.size.w,this.map.size.h)},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"VE",layerLib:"VirtualEarth"})},setMapObjectCenter:function(a,b){this.mapObject.SetCenterAndZoom(a,b)},getMapObjectCenter:function(){return this.mapObject.GetCenter()},dragPanMapObject:function(a,b){this.mapObject.vemapcontrol.PanMap(a,-b)},getMapObjectZoom:function(){return this.mapObject.GetZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(a){return typeof VEPixel!="undefined"?this.mapObject.PixelToLatLong(a):this.mapObject.PixelToLatLong(a.x,a.y)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.LatLongToPixel(a)},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.Longitude,a.Latitude).lon:a.Longitude},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.Longitude,a.Latitude).lat:a.Latitude},getMapObjectLonLatFromLonLat:function(a,b){var c;if(this.sphericalMercator){var d=this.inverseMercator(a,b);c=new VELatLong(d.lat,d.lon)}else c=new VELatLong(b,a);return c},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return typeof VEPixel!="undefined"?new VEPixel(a,b):new Msn.VE.Pixel(a,b)},CLASS_NAME:"OpenLayers.Layer.VirtualEarth"}),OpenLayers.Layer.Yahoo=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20],type:null,sphericalMercator:!1,initialize:function(a,b){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},loadMapObject:function(){try{var a=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject=new YMap(this.div,this.type,a),this.mapObject.disableKeyControls(),this.mapObject.disableDragMap();if(!this.mapObject.moveByXY||typeof this.mapObject.moveByXY!="function")this.dragPanMapObject=null}catch(b){}},onMapResize:function(){try{var a=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject.resizeTo(a)}catch(b){}},setMap:function(a){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments),this.map.events.register("moveend",this,this.fixYahooEventPane)},fixYahooEventPane:function(){var a=OpenLayers.Util.getElement("ygddfdiv");a!=null&&(a.parentNode!=null&&a.parentNode.removeChild(a),this.map.events.unregister("moveend",this,this.fixYahooEventPane))},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"Yahoo",layerLib:"Yahoo"})},getOLZoomFromMapObjectZoom:function(a){var b=null;a!=null&&(b=OpenLayers.Layer.FixedZoomLevels.prototype.getOLZoomFromMapObjectZoom.apply(this,[a]),b=18-b);return b},getMapObjectZoomFromOLZoom:function(a){var b=null;a!=null&&(b=OpenLayers.Layer.FixedZoomLevels.prototype.getMapObjectZoomFromOLZoom.apply(this,[a]),b=18-b);return b},setMapObjectCenter:function(a,b){this.mapObject.drawZoomAndCenter(a,b)},getMapObjectCenter:function(){return this.mapObject.getCenterLatLon()},dragPanMapObject:function(a,b){this.mapObject.moveByXY({x:-a,y:b})},getMapObjectZoom:function(){return this.mapObject.getZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(a){return this.mapObject.convertXYLatLon(a)},getMapObjectPixelFromMapObjectLonLat:function(a){return this.mapObject.convertLatLonXY(a)},getLongitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.Lon,a.Lat).lon:a.Lon},getLatitudeFromMapObjectLonLat:function(a){return this.sphericalMercator?this.forwardMercator(a.Lon,a.Lat).lat:a.Lat},getMapObjectLonLatFromLonLat:function(a,b){var c;if(this.sphericalMercator){var d=this.inverseMercator(a,b);c=new YGeoPoint(d.lat,d.lon)}else c=new YGeoPoint(b,a);return c},getXFromMapObjectPixel:function(a){return a.x},getYFromMapObjectPixel:function(a){return a.y},getMapObjectPixelFromXY:function(a,b){return new YCoordPoint(a,b)},getMapObjectSizeFromOLSize:function(a){return new YSize(a.w,a.h)},CLASS_NAME:"OpenLayers.Layer.Yahoo"}),OpenLayers.Style=OpenLayers.Class({name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(a,b){OpenLayers.Util.extend(this,b),this.rules=[],b&&b.rules&&this.addRules(b.rules),this.setDefaultStyle(a||OpenLayers.Feature.Vector.style["default"])},destroy:function(){for(var a=0,b=this.rules.length;a<b;a++)this.rules[a].destroy(),this.rules[a]=null;this.rules=null,this.defaultStyle=null},createSymbolizer:function(a){var b=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),a),c=this.rules,d,e,f=[],g=!1;for(var h=0,i=c.length;h<i;h++){d=c[h];var j=d.evaluate(a);j&&(d instanceof OpenLayers.Rule&&d.elseFilter?f.push(d):(g=!0,this.applySymbolizer(d,b,a)))}if(g==!1&&f.length>0){g=!0;for(var h=0,i=f.length;h<i;h++)this.applySymbolizer(f[h],b,a)}c.length>0&&g==!1&&(b.display="none");return b},applySymbolizer:function(a,b,c){var d=c.geometry?this.getSymbolizerPrefix(c.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],e=a.symbolizer[d]||a.symbolizer;if(this.defaultsPerSymbolizer===!0){var f=this.defaultStyle;OpenLayers.Util.applyDefaults(e,{pointRadius:f.pointRadius}),(e.stroke===!0||e.graphic===!0)&&OpenLayers.Util.applyDefaults(e,{strokeWidth:f.strokeWidth,strokeColor:f.strokeColor,strokeOpacity:f.strokeOpacity,strokeDashstyle:f.strokeDashstyle,strokeLinecap:f.strokeLinecap}),(e.fill===!0||e.graphic===!0)&&OpenLayers.Util.applyDefaults(e,{fillColor:f.fillColor,fillOpacity:f.fillOpacity}),e.graphic===!0&&OpenLayers.Util.applyDefaults(e,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}return this.createLiterals(OpenLayers.Util.extend(b,e),c)},createLiterals:function(a,b){var c=OpenLayers.Util.extend({},b.attributes||b.data);OpenLayers.Util.extend(c,this.context);for(var d in this.propertyStyles)a[d]=OpenLayers.Style.createLiteral(a[d],c,b,d);return a},findPropertyStyles:function(){var a={},b=this.defaultStyle;this.addPropertyStyles(a,b);var c=this.rules,d,e;for(var f=0,g=c.length;f<g;f++){d=c[f].symbolizer;for(var h in d){e=d[h];if(typeof e=="object")this.addPropertyStyles(a,e);else{this.addPropertyStyles(a,d);break}}}return a},addPropertyStyles:function(a,b){var c;for(var d in b)c=b[d],typeof c=="string"&&c.match(/\$\{\w+\}/)&&(a[d]=!0);return a},addRules:function(a){this.rules=this.rules.concat(a),this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(a){this.defaultStyle=a,this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(a){var b=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var c=0,d=b.length;c<d;c++)if(a.CLASS_NAME.indexOf(b[c])!=-1)return b[c]},CLASS_NAME:"OpenLayers.Style"}),OpenLayers.Style.createLiteral=function(a,b,c,d){typeof a=="string"&&a.indexOf("${")!=-1&&(a=OpenLayers.String.format(a,b,[c,d]),a=isNaN(a)||!a?a:parseFloat(a));return a},OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text"],OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(a){this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate(),this.dragPan&&this.dragPan.destroy(),this.dragPan=null,this.zoomBox&&this.zoomBox.destroy(),this.zoomBox=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate(),this.zoomWheelEnabled&&this.handlers.wheel.activate(),this.handlers.click.activate(),this.zoomBoxEnabled&&this.zoomBox.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.zoomBox.deactivate(),this.dragPan.deactivate(),this.handlers.click.deactivate(),this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);var a={dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},b={"double":!0,stopDouble:!0};this.handlers.click=new OpenLayers.Handler.Click(this,a,b),this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions)),this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask}),this.dragPan.draw(),this.zoomBox.draw(),this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},this.mouseWheelOptions)},defaultDblClick:function(a){var b=this.map.getLonLatFromViewPortPx(a.xy);this.map.setCenter(b,this.map.zoom+1)},defaultDblRightClick:function(a){var b=this.map.getLonLatFromViewPortPx(a.xy);this.map.setCenter(b,this.map.zoom-1)},wheelChange:function(a,b){var c=this.map.getZoom(),d=this.map.getZoom()+Math.round(b);d=Math.max(d,0),d=Math.min(d,this.map.getNumZoomLevels());if(d!==c){var e=this.map.getSize(),f=e.w/2-a.xy.x,g=a.xy.y-e.h/2,h=this.map.baseLayer.getResolutionForZoom(d),i=this.map.getLonLatFromPixel(a.xy),j=new OpenLayers.LonLat(i.lon+f*h,i.lat+g*h);this.map.setCenter(j,d)}},wheelUp:function(a,b){this.wheelChange(a,b||1)},wheelDown:function(a,b){this.wheelChange(a,b||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1,this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0,this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1,this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0,this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"}),OpenLayers.Filter=OpenLayers.Class({initialize:function(a){OpenLayers.Util.extend(this,a)},destroy:function(){},evaluate:function(a){return!0},clone:function(){return null},CLASS_NAME:"OpenLayers.Filter"}),OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",initialize:function(a){OpenLayers.Format.WMSCapabilities.v1_1.prototype.initialize.apply(this,[a])},readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){var c=this.getChildValue(a),d=c.split(/ +/);for(var e=0,f=d.length;e<f;e++)b.srs[d[e]]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"}),OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",initialize:function(a){OpenLayers.Format.WMSCapabilities.v1_1.prototype.initialize.apply(this,[a])},readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(a,b){b.srs[this.getChildValue(a)]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"}),OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"}),OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null,this.bounds=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(a){a&&(this.bounds=a.clone())},clearBounds:function(){this.bounds=null,this.parent&&this.parent.clearBounds()},extendBounds:function(a){var b=this.getBounds();b?this.bounds.extend(a):this.setBounds(a)},getBounds:function(){this.bounds==null&&this.calculateBounds();return this.bounds},calculateBounds:function(){},distanceTo:function(a,b){},getVertices:function(a){},atPoint:function(a,b,c){var d=!1,e=this.getBounds();if(e!=null&&a!=null){var f=b!=null?b:0,g=c!=null?c:0,h=new OpenLayers.Bounds(this.bounds.left-f,this.bounds.bottom-g,this.bounds.right+f,this.bounds.top+g);d=h.containsLonLat(a)}return d},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this))},CLASS_NAME:"OpenLayers.Geometry"}),OpenLayers.Geometry.fromWKT=function(a){var b=arguments.callee.format;b||(b=new OpenLayers.Format.WKT,arguments.callee.format=b);var c,d=b.read(a);if(d instanceof OpenLayers.Feature.Vector)c=d.geometry;else if(d instanceof Array){var e=d.length,f=Array(e);for(var g=0;g<e;++g)f[g]=d[g].geometry;c=new OpenLayers.Geometry.Collection(f)}return c},OpenLayers.Geometry.segmentsIntersect=function(a,b,c){var d=c&&c.point,e=c&&c.tolerance,f=!1,g=a.x1-b.x1,h=a.y1-b.y1,i=a.x2-a.x1,j=a.y2-a.y1,k=b.y2-b.y1,l=b.x2-b.x1,m=k*i-l*j,n=l*h-k*g,o=i*h-j*g;if(m==0)n==0&&o==0&&(f=!0);else{var p=n/m,q=o/m;if(p>=0&&p<=1&&q>=0&&q<=1)if(d){var r=a.x1+p*i,s=a.y1+p*j;f=new OpenLayers.Geometry.Point(r,s)}else f=!0}if(e){var t;if(f){if(d){var u=[a,b],v,r,s;outer:for(var w=0;w<2;++w){v=u[w];for(var x=1;x<3;++x){r=v["x"+x],s=v["y"+x],t=Math.sqrt(Math.pow(r-f.x,2)+Math.pow(s-f.y,2));if(t<e){f.x=r,f.y=s;break outer}}}}}else{var u=[a,b],y,z,r,s,A,B;outer:for(var w=0;w<2;++w){y=u[w],z=u[(w+1)%2];for(var x=1;x<3;++x){A={x:y["x"+x],y:y["y"+x]},B=OpenLayers.Geometry.distanceToSegment(A,z);if(B.distance<e){d?f=new OpenLayers.Geometry.Point(A.x,A.y):f=!0;break outer}}}}}return f},OpenLayers.Geometry.distanceToSegment=function(a,b){var c=a.x,d=a.y,e=b.x1,f=b.y1,g=b.x2,h=b.y2,i=g-e,j=h-f,k=(i*(c-e)+j*(d-f))/(Math.pow(i,2)+Math.pow(j,2)),l,m;k>0?k<1?(l=e+k*i,m=f+k*j):(l=g,m=h):(l=e,m=f);return{distance:Math.sqrt(Math.pow(l-c,2)+Math.pow(m-d,2)),x:l,y:m}},OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:"png"},isBaseLayer:!0,initialize:function(a,b,c,d){var e=[];c=OpenLayers.Util.upperCaseObject(c),e.push(a,b,c,d),OpenLayers.Layer.Grid.prototype.initialize.apply(this,e),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if(d==null||!d.isBaseLayer)this.isBaseLayer=!1;this.params.FORMAT=="jpg"&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"gif":"png")}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){a==null&&(a=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(a){a=this.adjustBounds(a);var b=this.projection.getCode().split(":"),c=b[b.length-1],d=this.getImageSize(),e={BBOX:a.toBBOX(),SIZE:d.w+","+d.h,F:"image",BBOXSR:c,IMAGESR:c};if(this.layerDefs){var f=[],g;for(g in this.layerDefs)this.layerDefs.hasOwnProperty(g)&&(this.layerDefs[g]&&(f.push(g),f.push(":"),f.push(this.layerDefs[g]),f.push(";")));f.length>0&&(e.LAYERDEFS=f.join(""))}var h=this.getFullRequestString(e);return h},setLayerFilter:function(a,b){this.layerDefs||(this.layerDefs={}),b?this.layerDefs[a]=b:delete this.layerDefs[a]},clearLayerFilter:function(a){a?delete this.layerDefs[a]:delete this.layerDefs},mergeNewParams:function(a){var b=OpenLayers.Util.upperCaseObject(a),c=[b];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,c)},addTile:function(a,b){return new OpenLayers.Tile.Image(this,b,a,null,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.ArcGIS93Rest"}),OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,units:null,resolution:OpenLayers.DOTS_PER_INCH,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(a,b,c,d){var e=[];e.push(a,b,c,d),OpenLayers.Layer.Grid.prototype.initialize.apply(this,e),this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(a){a=this.adjustBounds(a);var b=this.map.getResolution(),c=Math.round(this.map.getScale()*1e4)/1e4,d=Math.round(a.left/b),e=-Math.round(a.top/b);return this.getFullRequestString({t:e,l:d,s:c})},addTile:function(a,b){var c=this.getURL(a);return new OpenLayers.Tile.Image(this,b,a,c,this.tileSize)},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w,e=c*this.tileSize.h,f=a.left,g=Math.floor(f/d)-this.buffer,h=f/d-g,i=-h*this.tileSize.w,j=g*d,k=a.top,l=Math.ceil(k/e)+this.buffer,m=l-k/e,n=-(m+1)*this.tileSize.h,o=l*e;return{tilelon:d,tilelat:e,tileoffsetlon:j,tileoffsetlat:o,tileoffsetx:i,tileoffsety:n}},clone:function(a){a==null&&(a=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]),this.tileSize!=null&&(a.tileSize=this.tileSize.clone()),a.grid=[];return a},getTileBounds:function(a){var b=this.getResolution(),c=b*this.tileSize.w,d=b*this.tileSize.h,e=this.getLonLatFromViewPortPx(a),f=c*Math.floor(e.lon/c),g=d*Math.floor(e.lat/d);return new OpenLayers.Bounds(f,g,f+c,g+d)},CLASS_NAME:"OpenLayers.Layer.KaMap"}),OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,useHttpTile:!1,singleTile:!1,useOverlay:!1,useAsyncOverlay:!0,TILE_PARAMS:{operation:"GETTILEIMAGE",version:"1.2.0"},SINGLE_TILE_PARAMS:{operation:"GETMAPIMAGE",format:"PNG",locale:"en",clip:"1",version:"1.0.0"},OVERLAY_PARAMS:{operation:"GETDYNAMICMAPOVERLAYIMAGE",format:"PNG",locale:"en",clip:"1",version:"2.0.0"},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:"png",querystring:null},defaultSize:new OpenLayers.Size(300,300),initialize:function(a,b,c,d){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);if(d==null||d.isBaseLayer==null)this.isBaseLayer=this.transparent!="true"&&this.transparent!=!0;d&&d.useOverlay!=null&&(this.useOverlay=d.useOverlay),this.singleTile?this.useOverlay?(OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS),this.useAsyncOverlay||(this.params.version="1.0.0")):OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS):(this.useHttpTile?OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS):OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS),this.setTileSize(this.defaultSize))},clone:function(a){a==null&&(a=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},addTile:function(a,b){return new OpenLayers.Tile.Image(this,b,a,null,this.tileSize)},getURL:function(a){var b,c=a.getCenterLonLat(),d=this.map.getSize();if(this.singleTile){var e={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:d.h*this.ratio,setdisplaywidth:d.w*this.ratio,setviewcenterx:c.lon,setviewcentery:c.lat,setviewscale:this.map.getScale()};if(this.useOverlay&&!this.useAsyncOverlay){var f={};f=OpenLayers.Util.extend(f,e),f.operation="GETVISIBLEMAPEXTENT",f.version="1.0.0",f.session=this.params.session,f.mapName=this.params.mapName,f.format="text/xml",b=this.getFullRequestString(f),OpenLayers.Request.GET({url:b,async:!1})}b=this.getFullRequestString(e)}else{var g=this.map.getResolution(),h=Math.floor((a.left-this.maxExtent.left)/g);h=Math.round(h/this.tileSize.w);var i=Math.floor((this.maxExtent.top-a.top)/g);i=Math.round(i/this.tileSize.h),this.useHttpTile?b=this.getImageFilePath({tilecol:h,tilerow:i,scaleindex:this.resolutions.length-this.map.zoom-1}):b=this.getFullRequestString({tilecol:h,tilerow:i,scaleindex:this.resolutions.length-this.map.zoom-1})}return b},getFullRequestString:function(a,b){var c=b==null?this.url:b;typeof c=="object"&&(c=c[Math.floor(Math.random()*c.length)]);var d=c,e=OpenLayers.Util.extend({},this.params);e=OpenLayers.Util.extend(e,a);var f=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getArgs(c));for(var g in e)g.toUpperCase()in f&&delete e[g];var h=OpenLayers.Util.getParameterString(e);h=h.replace(/,/g,"+");if(h!=""){var i=c.charAt(c.length-1);i=="&"||i=="?"?d+=h:c.indexOf("?")==-1?d+="?"+h:d+="&"+h}return d},getImageFilePath:function(a,b){var c=b==null?this.url:b;typeof c=="object"&&(c=c[Math.floor(Math.random()*c.length)]);var d=c,e="",f="";a.tilerow<0&&(e="-"),a.tilerow==0?e+="0":e+=Math.floor(Math.abs(a.tilerow/this.params.tileRowsPerFolder))*this.params.tileRowsPerFolder,a.tilecol<0&&(f="-"),a.tilecol==0?f+="0":f+=Math.floor(Math.abs(a.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder;var g="/S"+Math.floor(a.scaleindex)+"/"+this.params.basemaplayergroupname+"/R"+e+"/C"+f+"/"+a.tilerow%this.params.tileRowsPerFolder+"_"+a.tilecol%this.params.tileColumnsPerFolder+"."+this.params.format;this.params.querystring&&(g+="?"+this.params.querystring),d+=g;return d},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w,e=c*this.tileSize.h,f=a.left-b.left,g=Math.floor(f/d)-this.buffer,h=f/d-g,i=-h*this.tileSize.w,j=b.left+g*d,k=b.top-a.top+e,l=Math.floor(k/e)-this.buffer,m=l-k/e,n=m*this.tileSize.h,o=b.top-e*l;return{tilelon:d,tilelat:e,tileoffsetlon:j,tileoffsetlat:o,tileoffsetx:i,tileoffsety:n}},CLASS_NAME:"OpenLayers.Layer.MapGuide"}),OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(a,b,c,d){var e=[];e.push(a,b,c,d),OpenLayers.Layer.Grid.prototype.initialize.apply(this,e),this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);if(d==null||d.isBaseLayer==null)this.isBaseLayer=this.params.transparent!="true"&&this.params.transparent!=!0},clone:function(a){a==null&&(a=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},addTile:function(a,b){return new OpenLayers.Tile.Image(this,b,a,null,this.tileSize)},getURL:function(a){a=this.adjustBounds(a);var b=[a.left,a.bottom,a.right,a.top],c=this.getImageSize(),d=this.getFullRequestString({mapext:b,imgext:b,map_size:[c.w,c.h],imgx:c.w/2,imgy:c.h/2,imgxy:[c.w,c.h]});return d},getFullRequestString:function(a,b){var c=b==null?this.url:b,d=OpenLayers.Util.extend({},this.params);d=OpenLayers.Util.extend(d,a);var e=OpenLayers.Util.getParameterString(d);c instanceof Array&&(c=this.selectUrl(e,c));var f=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(c));for(var g in d)g.toUpperCase()in f&&delete d[g];e=OpenLayers.Util.getParameterString(d);var h=c;e=e.replace(/,/g,"+");if(e!=""){var i=c.charAt(c.length-1);i=="&"||i=="?"?h+=e:c.indexOf("?")==-1?h+="?"+e:h+="&"+e}return h},CLASS_NAME:"OpenLayers.Layer.MapServer"}),OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",isBaseLayer:!0,tileOrigin:null,serverResolutions:null,initialize:function(a,b,c){var d=[];d.push(a,b,{},c),OpenLayers.Layer.Grid.prototype.initialize.apply(this,d)},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){a==null&&(a=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(a){a=this.adjustBounds(a);var b=this.map.getResolution(),c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w)),d=Math.round((a.bottom-this.tileOrigin.lat)/(b*this.tileSize.h)),e=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,b):this.map.getZoom(),f=this.serviceVersion+"/"+this.layername+"/"+e+"/"+c+"/"+d+"."+this.type,g=this.url;g instanceof Array&&(g=this.selectUrl(f,g));return g+f},addTile:function(a,b){return new OpenLayers.Tile.Image(this,b,a,null,this.tileSize)},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.TMS"}),OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,format:"image/png",serverResolutions:null,initialize:function(a,b,c,d){this.layername=c,OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,{},d]),this.extension=this.format.split("/")[1].toLowerCase(),this.extension=this.extension=="jpg"?"jpeg":this.extension},clone:function(a){a==null&&(a=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(a){function h(a,b){a=String(a);var c=[];for(var d=0;d<b;++d)c.push("0");return c.join("").substring(0,b-a.length)+a}var b=this.map.getResolution(),c=this.maxExtent,d=this.tileSize,e=Math.round((a.left-c.left)/(b*d.w)),f=Math.round((a.bottom-c.bottom)/(b*d.h)),g=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,b):this.map.getZoom(),i=[this.layername,h(g,2),h(parseInt(e/1e6),3),h(parseInt(e/1e3)%1e3,3),h(parseInt(e)%1e3,3),h(parseInt(f/1e6),3),h(parseInt(f/1e3)%1e3,3),h(parseInt(f)%1e3,3)+"."+this.extension],j=i.join("/"),k=this.url;k instanceof Array&&(k=this.selectUrl(j,k)),k=k.charAt(k.length-1)=="/"?k:k+"/";return k+j},addTile:function(a,b){var c=this.getURL(a);return new OpenLayers.Tile.Image(this,b,a,c,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.TileCache"}),OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",exceptions:"application/vnd.ogc.se_inimage",format:"image/jpeg"},reproject:!1,isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:["EPSG:4326"],initialize:function(a,b,c,d){var e=[];c=OpenLayers.Util.upperCaseObject(c),e.push(a,b,c,d),OpenLayers.Layer.Grid.prototype.initialize.apply(this,e),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&&this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if(d==null||!d.isBaseLayer)this.isBaseLayer=!1;this.params.FORMAT=="image/jpeg"&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png")}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){a==null&&(a=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},reverseAxisOrder:function(){return parseFloat(this.params.VERSION)>=1.3&&OpenLayers.Util.indexOf(this.yx,this.map.getProjectionObject().getCode())!==-1},getURL:function(a){a=this.adjustBounds(a);var b=this.getImageSize(),c={},d=this.reverseAxisOrder();c.BBOX=this.encodeBBOX?a.toBBOX(null,d):a.toArray(d),c.WIDTH=b.w,c.HEIGHT=b.h;var e=this.getFullRequestString(c);return e},addTile:function(a,b){return new OpenLayers.Tile.Image(this,b,a,null,this.tileSize)},mergeNewParams:function(a){var b=OpenLayers.Util.upperCaseObject(a),c=[b];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,c)},getFullRequestString:function(a,b){var c=this.map.getProjection(),d=c=="none"?null:c;parseFloat(this.params.VERSION)<1.3?this.params.SRS=d:this.params.CRS=d;return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"}),OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:!0,lzd:null,zoomLevels:null,initialize:function(a,b,c,d,e,f){this.lzd=c,this.zoomLevels=d;var g=[];g.push(a,b,e,f),OpenLayers.Layer.Grid.prototype.initialize.apply(this,g),this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},addTile:function(a,b){return new OpenLayers.Tile.Image(this,b,a,null,this.tileSize)},getZoom:function(){var a=this.map.getZoom(),b=this.map.getMaxExtent();a=a-Math.log(this.maxResolution/(this.lzd/512))/Math.log(2);return a},getURL:function(a){a=this.adjustBounds(a);var b=this.getZoom(),c=this.map.getMaxExtent(),d=this.lzd/Math.pow(2,this.getZoom()),e=Math.floor((a.left-c.left)/d),f=Math.floor((a.bottom-c.bottom)/d);return this.map.getResolution()>this.lzd/512||this.getZoom()>this.zoomLevels?OpenLayers.Util.getImagesLocation()+"blank.gif":this.getFullRequestString({L:b,X:e,Y:f})},CLASS_NAME:"OpenLayers.Layer.WorldWind"}),OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,initialize:function(a,b,c){if(c&&c.sphericalMercator||this.sphericalMercator)c=OpenLayers.Util.extend({maxExtent:new OpenLayers.Bounds(-128*156543.0339,-128*156543.0339,20037508.3392,20037508.3392),maxResolution:156543.0339,numZoomLevels:19,units:"m",projection:"EPSG:900913"},c);b=b||this.url,a=a||this.name;var d=[a,b,{},c];OpenLayers.Layer.Grid.prototype.initialize.apply(this,d)},clone:function(a){a==null&&(a=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions())),a=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[a]),this.tileSize!=null&&(a.tileSize=this.tileSize.clone()),a.grid=[];return a},getURL:function(a){var b=this.map.getResolution(),c=Math.round((a.left-this.maxExtent.left)/(b*this.tileSize.w)),d=Math.round((this.maxExtent.top-a.top)/(b*this.tileSize.h)),e=this.map.getZoom(),f=this.url,g=""+c+d+e;f instanceof Array&&(f=this.selectUrl(g,f));var h=OpenLayers.String.format(f,{x:c,y:d,z:e});return h},addTile:function(a,b){return new OpenLayers.Tile.Image(this,b,a,null,this.tileSize)},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"}),OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",attribution:"Data CC-By-SA by <a href='http://openstreetmap.org/'>OpenStreetMap</a>",sphericalMercator:!0,url:"http://tile.openstreetmap.org/${z}/${x}/${y}.png",CLASS_NAME:"OpenLayers.Layer.OSM"}),OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,{url:null,size:null,isBaseLayer:!0,standardTileSize:256,numberOfTiers:0,tileCountUpToTier:[],tierSizeInTiles:[],tierImageSize:[],initialize:function(a,b,c,d){this.initializeZoomify(c);var e=[];e.push(a,b,c,{},d),OpenLayers.Layer.Grid.prototype.initialize.apply(this,e)},initializeZoomify:function(a){var b=a.clone(),c=new OpenLayers.Size(Math.ceil(b.w/this.standardTileSize),Math.ceil(b.h/this.standardTileSize));this.tierSizeInTiles.push(c),this.tierImageSize.push(b);while(b.w>this.standardTileSize||b.h>this.standardTileSize)b=new OpenLayers.Size(Math.floor(b.w/2),Math.floor(b.h/2)),c=new OpenLayers.Size(Math.ceil(b.w/this.standardTileSize),Math.ceil(b.h/this.standardTileSize)),this.tierSizeInTiles.push(c),this.tierImageSize.push(b);this.tierSizeInTiles.reverse(),this.tierImageSize.reverse(),this.numberOfTiers=this.tierSizeInTiles.length,this.tileCountUpToTier[0]=0;for(var d=1;d<this.numberOfTiers;d++)this.tileCountUpToTier.push(this.tierSizeInTiles[d-1].w*this.tierSizeInTiles[d-1].h+this.tileCountUpToTier[d-1])},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments),this.tileCountUpToTier.length=0,this.tierSizeInTiles.length=0,this.tierImageSize.length=0},clone:function(a){a==null&&(a=new OpenLayers.Layer.Zoomify(this.name,this.url,this.size,this.options)),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(a){a=this.adjustBounds(a);var b=this.map.getResolution(),c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w)),d=Math.round((this.tileOrigin.lat-a.top)/(b*this.tileSize.h)),e=this.map.getZoom(),f=c+d*this.tierSizeInTiles[e].w+this.tileCountUpToTier[e],g="TileGroup"+Math.floor(f/256)+"/"+e+"-"+c+"-"+d+".jpg",h=this.url;h instanceof Array&&(h=this.selectUrl(g,h));return h+g},getImageSize:function(){if(arguments.length>0){bounds=this.adjustBounds(arguments[0]);var a=this.map.getResolution(),b=Math.round((bounds.left-this.tileOrigin.lon)/(a*this.tileSize.w)),c=Math.round((this.tileOrigin.lat-bounds.top)/(a*this.tileSize.h)),d=this.map.getZoom(),e=this.standardTileSize,f=this.standardTileSize;if(b==this.tierSizeInTiles[d].w-1)var e=this.tierImageSize[d].w%this.standardTileSize;if(c==this.tierSizeInTiles[d].h-1)var f=this.tierImageSize[d].h%this.standardTileSize;return new OpenLayers.Size(e,f)}return this.tileSize},addTile:function(a,b){return new OpenLayers.Tile.Image(this,b,a,null,this.tileSize)},setMap:function(a){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.top)},calculateGridLayout:function(a,b,c){var d=c*this.tileSize.w,e=c*this.tileSize.h,f=a.left-b.left,g=Math.floor(f/d)-this.buffer,h=f/d-g,i=-h*this.tileSize.w,j=b.left+g*d,k=b.top-a.top+e,l=Math.floor(k/e)-this.buffer,m=l-k/e,n=m*this.tileSize.h,o=b.top-e*l;return{tilelon:d,tilelat:e,tileoffsetlon:j,tileoffsetlat:o,tileoffsetx:i,tileoffsety:n}},CLASS_NAME:"OpenLayers.Layer.Zoomify"}),OpenLayers.Protocol.SQL.Gears=OpenLayers.Class(OpenLayers.Protocol.SQL,{FID_PREFIX:"__gears_fid__",NULL_GEOMETRY:"__gears_null_geometry__",NULL_FEATURE_STATE:"__gears_null_feature_state__",jsonParser:null,wktParser:null,fidRegExp:null,saveFeatureState:!0,typeOfFid:"string",db:null,initialize:function(a){this.supported()&&(OpenLayers.Protocol.SQL.prototype.initialize.apply(this,[a]),this.jsonParser=new OpenLayers.Format.JSON,this.wktParser=new OpenLayers.Format.WKT,this.fidRegExp=new RegExp("^"+this.FID_PREFIX),this.initializeDatabase())},initializeDatabase:function(){this.db=google.gears.factory.create("beta.database"),this.db.open(this.databaseName),this.db.execute("CREATE TABLE IF NOT EXISTS "+this.tableName+" (fid TEXT UNIQUE, geometry TEXT, properties TEXT,  state TEXT)")},destroy:function(){this.db.close(),this.db=null,this.jsonParser=null,this.wktParser=null,OpenLayers.Protocol.SQL.prototype.destroy.apply(this)},supported:function(){return window.google&&google.gears},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments),a=OpenLayers.Util.applyDefaults(a,this.options);var b,c=[],d=this.db.execute("SELECT * FROM "+this.tableName);while(d.isValidRow())b=this.unfreezeFeature(d),this.evaluateFilter(b,a.filter)&&(a.noFeatureStateReset||(b.state=null),c.push(b)),d.next();d.close();var e=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"read",features:c});a&&a.callback&&a.callback.call(a.scope,e);return e},unfreezeFeature:function(a){var b,c=a.fieldByName("geometry");c==this.NULL_GEOMETRY?b=new OpenLayers.Feature.Vector:b=this.wktParser.read(c),b.attributes=this.jsonParser.read(a.fieldByName("properties")),b.fid=this.extractFidFromField(a.fieldByName("fid"));var d=a.fieldByName("state");d==this.NULL_FEATURE_STATE&&(d=null),b.state=d;return b},extractFidFromField:function(a){!a.match(this.fidRegExp)&&this.typeOfFid=="number"&&(a=parseFloat(a));return a},create:function(a,b){b=OpenLayers.Util.applyDefaults(b,this.options);var c=this.createOrUpdate(a);c.requestType="create",b&&b.callback&&b.callback.call(b.scope,c);return c},update:function(a,b){b=OpenLayers.Util.applyDefaults(b,this.options);var c=this.createOrUpdate(a);c.requestType="update",b&&b.callback&&b.callback.call(b.scope,c);return c},createOrUpdate:function(a){a instanceof Array||(a=[a]);var b,c=a.length,d,e=Array(c);for(b=0;b<c;b++){d=a[b];var f=this.freezeFeature(d);this.db.execute("REPLACE INTO "+this.tableName+" (fid, geometry, properties, state) VALUES (?, ?, ?, ?)",f);var g=d.clone();g.fid=this.extractFidFromField(f[0]),e[b]=g}return new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,features:e,reqFeatures:a})},freezeFeature:function(a){a.fid=a.fid!=null?""+a.fid:OpenLayers.Util.createUniqueID(this.FID_PREFIX);var b=a.geometry!=null?a.geometry.toString():this.NULL_GEOMETRY,c=this.jsonParser.write(a.attributes),d=this.getFeatureStateForFreeze(a);return[a.fid,b,c,d]},getFeatureStateForFreeze:function(a){var b;this.saveFeatureState?this.createdOffline(a)?b=OpenLayers.State.INSERT:b=a.state:b=this.NULL_FEATURE_STATE;return b},"delete":function(a,b){a instanceof Array||(a=[a]),b=OpenLayers.Util.applyDefaults(b,this.options);var c,d,e;for(c=0,d=a.length;c<d;c++){e=a[c];if(this.saveFeatureState&&!this.createdOffline(e)){var f=e.clone();f.fid=e.fid,f.geometry&&(f.geometry.destroy(),f.geometry=null),f.state=e.state,this.createOrUpdate(f)}else this.db.execute("DELETE FROM "+this.tableName+" WHERE fid = ?",[e.fid])}var g=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"delete",reqFeatures:a});b&&b.callback&&b.callback.call(b.scope,g);return g},createdOffline:function(a){return typeof a.fid=="string"&&!!a.fid.match(this.fidRegExp)},commit:function(a,b){function g(a){++f<e&&(a.last=!1),this.callUserCallback(b,a)}var c,d=[],e=0,f=0,h,i=[],j=[],k=[];for(var l=a.length-1;l>=0;l--){h=a[l];switch(h.state){case OpenLayers.State.INSERT:i.push(h);break;case OpenLayers.State.UPDATE:j.push(h);break;case OpenLayers.State.DELETE:k.push(h)}}i.length>0&&(e++,c=OpenLayers.Util.applyDefaults({callback:g,scope:this},b.create),d.push(this.create(i,c))),j.length>0&&(e++,c=OpenLayers.Util.applyDefaults({callback:g,scope:this},b.update),d.push(this.update(j,c))),k.length>0&&(e++,c=OpenLayers.Util.applyDefaults({callback:g,scope:this},b["delete"]),d.push(this["delete"](k,c)));return d},clear:function(){this.db.execute("DELETE FROM "+this.tableName)},callUserCallback:function(a,b){var c=a[b.requestType];c&&c.callback&&c.callback.call(c.scope,b),b.last&&a.callback&&a.callback.call(a.scope)},CLASS_NAME:"OpenLayers.Protocol.SQL.Gears"}),OpenLayers.Rule=OpenLayers.Class({id:null,name:"default",title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(a){this.symbolizer={},OpenLayers.Util.extend(this,a),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var a in this.symbolizer)this.symbolizer[a]=null;this.symbolizer=null},evaluate:function(a){var b=this.getContext(a),c=!0;if(this.minScaleDenominator||this.maxScaleDenominator)var d=a.layer.map.getScale();this.minScaleDenominator&&(c=d>=OpenLayers.Style.createLiteral(this.minScaleDenominator,b)),c&&this.maxScaleDenominator&&(c=d<OpenLayers.Style.createLiteral(this.maxScaleDenominator,b)),c&&this.filter&&(this.filter.CLASS_NAME=="OpenLayers.Filter.FeatureId"?c=this.filter.evaluate(a):c=this.filter.evaluate(b));return c},getContext:function(a){var b=this.context;b||(b=a.attributes||a.data),typeof this.context=="function"&&(b=this.context(a));return b},clone:function(){var a=OpenLayers.Util.extend({},this);a.symbolizer={};for(var b in this.symbolizer)value=this.symbolizer[b],type=typeof value,type==="object"?a.symbolizer[b]=OpenLayers.Util.extend({},value):type==="string"&&(a.symbolizer[b]=value);a.filter=this.filter&&this.filter.clone(),a.context=this.context&&OpenLayers.Util.extend({},this.context);return new OpenLayers.Rule(a)},CLASS_NAME:"OpenLayers.Rule"}),OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(a,b){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(a instanceof OpenLayers.Style)this.styles["default"]=a,this.styles.select=a,this.styles.temporary=a,this.styles["delete"]=a;else if(typeof a=="object")for(var c in a)if(a[c]instanceof OpenLayers.Style)this.styles[c]=a[c];else if(typeof a[c]=="object")this.styles[c]=new OpenLayers.Style(a[c]);else{this.styles["default"]=new OpenLayers.Style(a),this.styles.select=new OpenLayers.Style(a),this.styles.temporary=new OpenLayers.Style(a),this.styles["delete"]=new OpenLayers.Style(a);break}OpenLayers.Util.extend(this,b)},destroy:function(){for(var a in this.styles)this.styles[a].destroy();this.styles=null},createSymbolizer:function(a,b){a||(a=new OpenLayers.Feature.Vector),this.styles[b]||(b="default"),a.renderIntent=b;var c={};this.extendDefault&&b!="default"&&(c=this.styles["default"].createSymbolizer(a));return OpenLayers.Util.extend(c,this.styles[b].createSymbolizer(a))},addUniqueValueRules:function(a,b,c,d){var e=[];for(var f in c)e.push(new OpenLayers.Rule({symbolizer:c[f],context:d,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:b,value:f})}));this.styles[a].addRules(e)},CLASS_NAME:"OpenLayers.StyleMap"}),OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a){OpenLayers.Control.Panel.prototype.initialize.apply(this,[a]),this.addControls([new OpenLayers.Control.Navigation,new OpenLayers.Control.ZoomBox])},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);this.activateControl(this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.NavToolbar"}),OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(a){OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(a){var b=!1;switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:var c=a[this.property],d=this.value;this.matchCase||typeof c!="string"||typeof d!="string"?b=c==d:b=c.toUpperCase()==d.toUpperCase();break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:var c=a[this.property],d=this.value;this.matchCase||typeof c!="string"||typeof d!="string"?b=c!=d:b=c.toUpperCase()!=d.toUpperCase();break;case OpenLayers.Filter.Comparison.LESS_THAN:b=a[this.property]<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:b=a[this.property]>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:b=a[this.property]<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:b=a[this.property]>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:b=a[this.property]>=this.lowerBoundary&&a[this.property]<=this.upperBoundary;break;case OpenLayers.Filter.Comparison.LIKE:var e=new RegExp(this.value,"gi");b=e.test(a[this.property])}return b},value2regex:function(a,b,c){if(a=="."){var d="'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison";OpenLayers.Console.error(d);return null}a=a?a:"*",b=b?b:".",c=c?c:"!",this.value=this.value.replace(new RegExp("\\"+c+"(.|$)","g"),"\\$1"),this.value=this.value.replace(new RegExp("\\"+b,"g"),"."),this.value=this.value.replace(new RegExp("\\"+a,"g"),".*"),this.value=this.value.replace(new RegExp("\\\\.\\*","g"),"\\"+a),this.value=this.value.replace(new RegExp("\\\\\\.","g"),"\\"+b);return this.value},regex2value:function(){var a=this.value;a=a.replace(/!/g,"!!"),a=a.replace(/(\\)?\\\./g,function(a,b){return b?a:"!."}),a=a.replace(/(\\)?\\\*/g,function(a,b){return b?a:"!*"}),a=a.replace(/\\\\/g,"\\"),a=a.replace(/\.\*/g,"*");return a},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison,this)},CLASS_NAME:"OpenLayers.Filter.Comparison"}),OpenLayers.Filter.Comparison.EQUAL_TO="==",OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=",OpenLayers.Filter.Comparison.LESS_THAN="<",OpenLayers.Filter.Comparison.GREATER_THAN=">",OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=",OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=",OpenLayers.Filter.Comparison.BETWEEN="..",OpenLayers.Filter.Comparison.LIKE="~",OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,initialize:function(a){this.fids=[],OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(a){for(var b=0,c=this.fids.length;b<c;b++){var d=a.fid||a.id;if(d==this.fids[b])return!0}return!1},clone:function(){var a=new OpenLayers.Filter.FeatureId;OpenLayers.Util.extend(a,this),a.fids=this.fids.slice();return a},CLASS_NAME:"OpenLayers.Filter.FeatureId"}),OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(a){this.filters=[],OpenLayers.Filter.prototype.initialize.apply(this,[a])},destroy:function(){this.filters=null,OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(a){switch(this.type){case OpenLayers.Filter.Logical.AND:for(var b=0,c=this.filters.length;b<c;b++)if(this.filters[b].evaluate(a)==!1)return!1;return!0;case OpenLayers.Filter.Logical.OR:for(var b=0,c=this.filters.length;b<c;b++)if(this.filters[b].evaluate(a)==!0)return!0;return!1;case OpenLayers.Filter.Logical.NOT:return!this.filters[0].evaluate(a)}},clone:function(){var a=[];for(var b=0,c=this.filters.length;b<c;++b)a.push(this.filters[b].clone());return new OpenLayers.Filter.Logical({type:this.type,filters:a})},CLASS_NAME:"OpenLayers.Filter.Logical"}),OpenLayers.Filter.Logical.AND="&&",OpenLayers.Filter.Logical.OR="||",OpenLayers.Filter.Logical.NOT="!",OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,initialize:function(a){OpenLayers.Filter.prototype.initialize.apply(this,[a])},evaluate:function(a){var b=!1;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(a.geometry){var c=this.value;this.value.CLASS_NAME=="OpenLayers.Bounds"&&(c=this.value.toGeometry()),a.geometry.intersects(c)&&(b=!0)}break;default:OpenLayers.Console.error(OpenLayers.i18n("filterEvaluateNotImplemented"))}return b},clone:function(){var a=OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(a)},CLASS_NAME:"OpenLayers.Filter.Spatial"}),OpenLayers.Filter.Spatial.BBOX="BBOX",OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS",OpenLayers.Filter.Spatial.DWITHIN="DWITHIN",OpenLayers.Filter.Spatial.WITHIN="WITHIN",OpenLayers.Filter.Spatial.CONTAINS="CONTAINS",OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(a){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.components=[],a!=null&&this.addComponents(a)},destroy:function(){this.components.length=0,this.components=null},clone:function(){var geometry=eval("new "+this.CLASS_NAME+"()");for(var i=0,len=this.components.length;i<len;i++)geometry.addComponent(this.components[i].clone());OpenLayers.Util.applyDefaults(geometry,this);return geometry},getComponentsString:function(){var a=[];for(var b=0,c=this.components.length;b<c;b++)a.push(this.components[b].toShortString());return a.join(",")},calculateBounds:function(){this.bounds=null;if(this.components&&this.components.length>0){this.setBounds(this.components[0].getBounds());for(var a=1,b=this.components.length;a<b;a++)this.extendBounds(this.components[a].getBounds())}},addComponents:function(a){a instanceof Array||(a=[a]);for(var b=0,c=a.length;b<c;b++)this.addComponent(a[b])},addComponent:function(a,b){var c=!1;if(a)if(this.componentTypes==null||OpenLayers.Util.indexOf(this.componentTypes,a.CLASS_NAME)>-1){if(b!=null&&b<this.components.length){var d=this.components.slice(0,b),e=this.components.slice(b,this.components.length);d.push(a),this.components=d.concat(e)}else this.components.push(a);a.parent=this,this.clearBounds(),c=!0}return c},removeComponents:function(a){a instanceof Array||(a=[a]);for(var b=a.length-1;b>=0;--b)this.removeComponent(a[b])},removeComponent:function(a){OpenLayers.Util.removeItem(this.components,a),this.clearBounds()},getLength:function(){var a=0;for(var b=0,c=this.components.length;b<c;b++)a+=this.components[b].getLength();return a},getArea:function(){var a=0;for(var b=0,c=this.components.length;b<c;b++)a+=this.components[b].getArea();return a},getGeodesicArea:function(a){var b=0;for(var c=0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicArea(a);return b},getCentroid:function(){return this.components.length&&this.components[0].getCentroid()},getGeodesicLength:function(a){var b=0;for(var c=0,d=this.components.length;c<d;c++)b+=this.components[c].getGeodesicLength(a);return b},move:function(a,b){for(var c=0,d=this.components.length;c<d;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0;d<this.components.length;++d)this.components[d].resize(a,b,c);return this},distanceTo:function(a,b){var c=!b||b.edge!==!1,d=c&&b&&b.details,e,f,g,h=Number.POSITIVE_INFINITY;for(var i=0,j=this.components.length;i<j;++i){e=this.components[i].distanceTo(a,b),g=d?e.distance:e;if(g<h){h=g,f=e;if(h==0)break}}return f},equals:function(a){var b=!0;if(a&&a.CLASS_NAME&&this.CLASS_NAME==a.CLASS_NAME)if(a.components instanceof Array&&a.components.length==this.components.length){for(var c=0,d=this.components.length;c<d;++c)if(!this.components[c].equals(a.components[c])){b=!1;break}}else b=!1;else b=!1;return b},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d;c++){var e=this.components[c];e.transform(a,b)}this.bounds=null}return this},intersects:function(a){var b=!1;for(var c=0,d=this.components.length;c<d;++c){b=a.intersects(this.components[c]);if(b)break}return b},getVertices:function(a){var b=[];for(var c=0,d=this.components.length;c<d;++c)Array.prototype.push.apply(b,this.components[c].getVertices(a));return b},CLASS_NAME:"OpenLayers.Geometry.Collection"}),OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(a,b){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.x=parseFloat(a),this.y=parseFloat(b)},clone:function(a){a==null&&(a=new OpenLayers.Geometry.Point(this.x,this.y)),OpenLayers.Util.applyDefaults(a,this);return a},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(a,b){var c=!b||b.edge!==!1,d=c&&b&&b.details,e,f,g,h,i,j;a instanceof OpenLayers.Geometry.Point?(f=this.x,g=this.y,h=a.x,i=a.y,e=Math.sqrt(Math.pow(f-h,2)+Math.pow(g-i,2)),j=d?{x0:f,y0:g,x1:h,y1:i,distance:e}:e):(j=a.distanceTo(this,b),d&&(j={x0:j.x1,y0:j.y1,x1:j.x0,y1:j.y0,distance:j.distance}));return j},equals:function(a){var b=!1;a!=null&&(b=this.x==a.x&&this.y==a.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.x)&&isNaN(a.y));return b},toShortString:function(){return this.x+", "+this.y},move:function(a,b){this.x=this.x+a,this.y=this.y+b,this.clearBounds()},rotate:function(a,b){a*=Math.PI/180;var c=this.distanceTo(b),d=a+Math.atan2(this.y-b.y,this.x-b.x);this.x=b.x+c*Math.cos(d),this.y=b.y+c*Math.sin(d),this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(a,b,c){c=c==undefined?1:c,this.x=b.x+a*c*(this.x-b.x),this.y=b.y+a*(this.y-b.y),this.clearBounds();return this},intersects:function(a){var b=!1;a.CLASS_NAME=="OpenLayers.Geometry.Point"?b=this.equals(a):b=a.intersects(this);return b},transform:function(a,b){a&&b&&(OpenLayers.Projection.transform(this,a,b),this.bounds=null);return this},getVertices:function(a){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"}),OpenLayers.Geometry.Rectangle=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,width:null,height:null,initialize:function(a,b,c,d){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.x=a,this.y=b,this.width=c,this.height=d},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x+this.width,this.y+this.height)},getLength:function(){var a=2*this.width+2*this.height;return a},getArea:function(){var a=this.width*this.height;return a},CLASS_NAME:"OpenLayers.Geometry.Rectangle"}),OpenLayers.Geometry.Surface=OpenLayers.Class(OpenLayers.Geometry,{initialize:function(){OpenLayers.Geometry.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Geometry.Surface"}),OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{jpeg:"jpg",gif:"gif",png:"png",png8:"png",png24:"png",dithered:"png"},DEFAULT_FORMAT:"jpeg",initialize:function(a,b,c,d){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments),this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||DEFAULT_FORMAT]},getURL:function(a){a=this.adjustBounds(a);var b=this.map.getResolution(),c=Math.round(this.map.getScale()*1e4)/1e4,d=Math.round(a.left/b),e=-Math.round(a.top/b),f=Math.floor(d/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w,g=Math.floor(e/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h,h=this.url;h instanceof Array&&(h=this.selectUrl(paramsString,h));var i=[h,"/",this.params.map,"/",c,"/",this.params.g.replace(/\s/g,"_"),"/def/t",g,"/l",f,"/t",e,"l",d,".",this.extension];return i.join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"}),OpenLayers.Layer.MapServer.Untiled=OpenLayers.Class(OpenLayers.Layer.MapServer,{singleTile:!0,initialize:function(a,b,c,d){OpenLayers.Layer.MapServer.prototype.initialize.apply(this,arguments);var e="The OpenLayers.Layer.MapServer.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.MapServer class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(e)},clone:function(a){a==null&&(a=new OpenLayers.Layer.MapServer.Untiled(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.MapServer.prototype.clone.apply(this,[a]);return a},CLASS_NAME:"OpenLayers.Layer.MapServer.Untiled"}),OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{EVENT_TYPES:["beforefeatureadded","beforefeaturesadded","featureadded","featuresadded","beforefeatureremoved","featureremoved","featuresremoved","beforefeatureselected","featureselected","featureunselected","beforefeaturemodified","featuremodified","afterfeaturemodified","vertexmodified","sketchstarted","sketchmodified","sketchcomplete","refresh"],isBaseLayer:!1,isFixed:!1,isVector:!0,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,initialize:function(a,b){this.EVENT_TYPES=OpenLayers.Layer.Vector.prototype.EVENT_TYPES.concat(OpenLayers.Layer.prototype.EVENT_TYPES),OpenLayers.Layer.prototype.initialize.apply(this,arguments),(!this.renderer||!this.renderer.supported())&&this.assignRenderer();if(!this.renderer||!this.renderer.supported())this.renderer=null,this.displayError();this.styleMap||(this.styleMap=new OpenLayers.StyleMap),this.features=[],this.selectedFeatures=[],this.unrenderedFeatures={};if(this.strategies)for(var c=0,d=this.strategies.length;c<d;c++)this.strategies[c].setLayer(this)},destroy:function(){if(this.strategies){var a,b,c;for(b=0,c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoDestroy&&a.destroy();this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),this.protocol=null),this.destroyFeatures(),this.features=null,this.selectedFeatures=null,this.unrenderedFeatures=null,this.renderer&&this.renderer.destroy(),this.renderer=null,this.geometryType=null,this.drawn=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(a){a==null&&(a=new OpenLayers.Layer.Vector(this.name,this.getOptions())),a=OpenLayers.Layer.prototype.clone.apply(this,[a]);var b=this.features,c=b.length,d=Array(c);for(var e=0;e<c;++e)d[e]=b[e].clone();a.features=d;return a},refresh:function(a){this.calculateInRange()&&this.visibility&&this.events.triggerEvent("refresh",a)},assignRenderer:function(){for(var a=0,b=this.renderers.length;a<b;a++){var c=OpenLayers.Renderer[this.renderers[a]];if(c&&c.prototype.supported()){this.renderer=new c(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(a){OpenLayers.Layer.prototype.setMap.apply(this,arguments),this.renderer?(this.renderer.map=this.map,this.renderer.setSize(this.map.getSize())):this.map.removeLayer(this)},afterAdd:function(){if(this.strategies){var a,b,c;for(b=0,c=this.strategies.length;b<c;b++)a=this.strategies[b],a.autoActivate&&a.activate()}},removeMap:function(a){if(this.strategies){var b,c,d;for(c=0,d=this.strategies.length;c<d;c++)b=this.strategies[c],b.autoActivate&&b.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments),this.renderer.setSize(this.map.getSize())},moveTo:function(a,b,c){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var d=!0;if(!c){this.renderer.root.style.visibility="hidden",this.div.style.left=-parseInt(this.map.layerContainerDiv.style.left)+"px",this.div.style.top=-parseInt(this.map.layerContainerDiv.style.top)+"px";var e=this.map.getExtent();d=this.renderer.setExtent(e,b),this.renderer.root.style.visibility="visible",navigator.userAgent.toLowerCase().indexOf("gecko")!=-1&&(this.div.scrollLeft=this.div.scrollLeft);if(!b&&d)for(var f in this.unrenderedFeatures){var g=this.unrenderedFeatures[f];this.drawFeature(g)}}if(!this.drawn||b||!d){this.drawn=!0;var g;for(var f=0,h=this.features.length;f<h;f++)this.renderer.locked=f!==h-1,g=this.features[f],this.drawFeature(g)}},display:function(a){OpenLayers.Layer.prototype.display.apply(this,arguments);var b=this.div.style.display;b!=this.renderer.root.style.display&&(this.renderer.root.style.display=b)},addFeatures:function(a,b){a instanceof Array||(a=[a]);var c=!b||!b.silent;if(c){var d={features:a},e=this.events.triggerEvent("beforefeaturesadded",d);if(e===!1)return;a=d.features}for(var f=0,g=a.length;f<g;f++){f!=a.length-1?this.renderer.locked=!0:this.renderer.locked=!1;var h=a[f];if(this.geometryType&&!(h.geometry instanceof this.geometryType)){var i=OpenLayers.i18n("componentShouldBe",{geomType:this.geometryType.prototype.CLASS_NAME});throw i}this.features.push(h),h.layer=this,!h.style&&this.style&&(h.style=OpenLayers.Util.extend({},this.style));if(c){if(this.events.triggerEvent("beforefeatureadded",{feature:h})===!1)continue;this.preFeatureInsert(h)}this.drawFeature(h),c&&(this.events.triggerEvent("featureadded",{feature:h}),this.onFeatureInsert(h))}c&&this.events.triggerEvent("featuresadded",{features:a})},removeFeatures:function(a,b){if(a&&a.length!==0){a instanceof Array||(a=[a]);if(a===this.features||a===this.selectedFeatures)a=a.slice();var c=!b||!b.silent;for(var d=a.length-1;d>=0;d--){d!=0&&a[d-1].geometry?this.renderer.locked=!0:this.renderer.locked=!1;var e=a[d];delete this.unrenderedFeatures[e.id],c&&this.events.triggerEvent("beforefeatureremoved",{feature:e}),this.features=OpenLayers.Util.removeItem(this.features,e),e.layer=null,e.geometry&&this.renderer.eraseFeatures(e),OpenLayers.Util.indexOf(this.selectedFeatures,e)!=-1&&OpenLayers.Util.removeItem(this.selectedFeatures,e),c&&this.events.triggerEvent("featureremoved",{feature:e})}c&&this.events.triggerEvent("featuresremoved",{features:a})}},destroyFeatures:function(a,b){var c=a==undefined;c&&(a=this.features);if(a){this.removeFeatures(a,b);for(var d=a.length-1;d>=0;d--)a[d].destroy()}},drawFeature:function(a,b){if(this.drawn){if(typeof b!="object"){!b&&a.state===OpenLayers.State.DELETE&&(b="delete");var c=b||a.renderIntent;b=a.style||this.style,b||(b=this.styleMap.createSymbolizer(a,c))}this.renderer.drawFeature(a,b)?delete this.unrenderedFeatures[a.id]:this.unrenderedFeatures[a.id]=a}},eraseFeatures:function(a){this.renderer.eraseFeatures(a)},getFeatureFromEvent:function(a){if(!this.renderer){OpenLayers.Console.error(OpenLayers.i18n("getFeatureError"));return null}var b=this.renderer.getFeatureIdFromEvent(a);return this.getFeatureById(b)},getFeatureById:function(a){var b=null;for(var c=0,d=this.features.length;c<d;++c)if(this.features[c].id==a){b=this.features[c];break}return b},onFeatureInsert:function(a){},preFeatureInsert:function(a){},getDataExtent:function(){var a=null,b=this.features;if(b&&b.length>0){a=new OpenLayers.Bounds;var c=null;for(var d=0,e=b.length;d<e;d++)c=b[d].geometry,c&&a.extend(c.getBounds())}return a},CLASS_NAME:"OpenLayers.Layer.Vector"}),OpenLayers.Layer.WMS.Post=OpenLayers.Class(OpenLayers.Layer.WMS,{tileClass:null,unsupportedBrowsers:["mozilla","firefox","opera"],SUPPORTED_TRANSITIONS:[],initialize:function(a,b,c,d){var e=[];e.push(a,b,c,d),OpenLayers.Layer.WMS.prototype.initialize.apply(this,e),this.tileClass=OpenLayers.Util.indexOf(this.unsupportedBrowsers,OpenLayers.Util.getBrowserName())!=-1?OpenLayers.Tile.Image:OpenLayers.Tile.Image.IFrame},addTile:function(a,b){return new this.tileClass(this,b,a,null,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.WMS.Post"}),OpenLayers.Layer.WMS.Untiled=OpenLayers.Class(OpenLayers.Layer.WMS,{singleTile:!0,initialize:function(a,b,c,d){OpenLayers.Layer.WMS.prototype.initialize.apply(this,arguments);var e="The OpenLayers.Layer.WMS.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.WMS class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(e)},clone:function(a){a==null&&(a=new OpenLayers.Layer.WMS.Untiled(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.WMS.prototype.clone.apply(this,[a]);return a},CLASS_NAME:"OpenLayers.Layer.WMS.Untiled"}),OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:!1,click:!0,clickout:!0,toggle:!1,clickTolerance:5,hover:!1,box:!1,maxFeatures:10,features:null,hoverFeature:null,handlerOptions:null,handlers:null,hoverResponse:null,filterType:OpenLayers.Filter.Spatial.BBOX,EVENT_TYPES:["featureselected","featuresselected","featureunselected","clickout","beforefeatureselected","beforefeaturesselected","hoverfeature","outfeature"],initialize:function(a){this.EVENT_TYPES=OpenLayers.Control.GetFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES),a.handlerOptions=a.handlerOptions||{},OpenLayers.Control.prototype.initialize.apply(this,[a]),this.features={},this.handlers={},this.click&&(this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.selectSingle},this.handlerOptions.click||{})),this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"}))),this.hover&&(this.handlers.hover=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{delay:250})))},activate:function(){if(!this.active)for(var a in this.handlers)this.handlers[a].activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active)for(var a in this.handlers)this.handlers[a].deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},selectSingle:function(a){OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");var b=this.pixelToBounds(a.xy);this.setModifiers(a),this.request(b,{single:!0})},selectBox:function(a){var b;if(a instanceof OpenLayers.Bounds){var c=this.map.getLonLatFromPixel(new OpenLayers.Pixel(a.left,a.bottom)),d=this.map.getLonLatFromPixel(new OpenLayers.Pixel(a.right,a.top));b=new OpenLayers.Bounds(c.lon,c.lat,d.lon,d.lat)}else{if(this.click)return;b=this.pixelToBounds(a)}this.setModifiers(this.handlers.box.dragHandler.evt),this.request(b)},selectHover:function(a){var b=this.pixelToBounds(a.xy);this.request(b,{single:!0,hover:!0})},cancelHover:function(){this.hoverResponse&&(this.protocol.abort(this.hoverResponse),this.hoverResponse=null)},request:function(a,b){b=b||{};var c=new OpenLayers.Filter.Spatial({type:this.filterType,value:a}),d=this.protocol.read({maxFeatures:b.single==!0?this.maxFeatures:undefined,filter:c,callback:function(c){c.success()&&(c.features.length?b.single==!0?this.selectBestFeature(c.features,a.getCenterLonLat(),b):this.select(c.features):b.hover?this.hoverSelect():(this.events.triggerEvent("clickout"),this.clickout&&this.unselectAll())),OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});b.hover==!0&&(this.hoverResponse=d)},selectBestFeature:function(a,b,c){c=c||{};if(a.length){var d=new OpenLayers.Geometry.Point(b.lon,b.lat),e,f,g,h=Number.MAX_VALUE;for(var i=0;i<a.length;++i){e=a[i];if(e.geometry){g=d.distanceTo(e.geometry,{edge:!1});if(g<h){h=g,f=e;if(h==0)break}}}c.hover==!0?this.hoverSelect(f):this.select(f||a)}},setModifiers:function(a){this.modifiers={multiple:this.multiple||this.multipleKey&&a[this.multipleKey],toggle:this.toggle||this.toggleKey&&a[this.toggleKey]}},select:function(a){!this.modifiers.multiple&&!this.modifiers.toggle&&this.unselectAll(),a instanceof Array||(a=[a]);var b=this.events.triggerEvent("beforefeaturesselected",{features:a});if(b!==!1){var c=[],d;for(var e=0,f=a.length;e<f;++e)d=a[e],this.features[d.fid||d.id]?this.modifiers.toggle&&this.unselect(this.features[d.fid||d.id]):(b=this.events.triggerEvent("beforefeatureselected",{feature:d}),b!==!1&&(this.features[d.fid||d.id]=d,c.push(d),this.events.triggerEvent("featureselected",{feature:d})));this.events.triggerEvent("featuresselected",{features:c})}},hoverSelect:function(a){var b=a?a.fid||a.id:null,c=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;c&&c!=b&&(this.events.triggerEvent("outfeature",{feature:this.hoverFeature}),this.hoverFeature=null),b&&b!=c&&(this.events.triggerEvent("hoverfeature",{feature:a}),this.hoverFeature=a)},unselect:function(a){delete this.features[a.fid||a.id],this.events.triggerEvent("featureunselected",{feature:a})},unselectAll:function(){for(var a in this.features)this.unselect(this.features[a])},setMap:function(a){for(var b in this.handlers)this.handlers[b].setMap(a);OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(a){var b=a.add(-this.clickTolerance/2,this.clickTolerance/2),c=a.add(this.clickTolerance/2,-this.clickTolerance/2),d=this.map.getLonLatFromPixel(b),e=this.map.getLonLatFromPixel(c);return new OpenLayers.Bounds(d.lon,d.lat,e.lon,e.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"}),OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforesnap","snap","unsnap"],DEFAULTS:{tolerance:10,node:!0,edge:!0,vertex:!0},greedy:!0,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(a){Array.prototype.push.apply(this.EVENT_TYPES,OpenLayers.Control.prototype.EVENT_TYPES),OpenLayers.Control.prototype.initialize.apply(this,[a]),this.options=a||{},this.options.layer&&this.setLayer(this.options.layer);var b=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(b,this.DEFAULTS),this.setTargets(this.options.targets),this.targets.length===0&&this.layer&&this.addTargetLayer(this.layer),this.geoToleranceCache={}},setLayer:function(a){this.active?(this.deactivate(),this.layer=a,this.activate()):this.layer=a},setTargets:function(a){this.targets=[];if(a&&a.length){var b;for(var c=0,d=a.length;c<d;++c)b=a[c],b instanceof OpenLayers.Layer.Vector?this.addTargetLayer(b):this.addTarget(b)}},addTargetLayer:function(a){this.addTarget({layer:a})},addTarget:function(a){a=OpenLayers.Util.applyDefaults(a,this.defaults),a.nodeTolerance=a.nodeTolerance||a.tolerance,a.vertexTolerance=a.vertexTolerance||a.tolerance,a.edgeTolerance=a.edgeTolerance||a.tolerance,this.targets.push(a)},removeTargetLayer:function(a){var b;for(var c=this.targets.length-1;c>=0;--c)b=this.targets[c],b.layer===a&&this.removeTarget(b)},removeTarget:function(a){return OpenLayers.Util.removeItem(this.targets,a)},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);a&&(this.layer&&this.layer.events&&this.layer.events.on({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this}));return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);a&&(this.layer&&this.layer.events&&this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this})),this.feature=null,this.point=null;return a},onSketchModified:function(a){this.feature=a.feature,this.considerSnapping(a.vertex,a.vertex)},onVertexModified:function(a){this.feature=a.feature;var b=this.layer.map.getLonLatFromViewPortPx(a.pixel);this.considerSnapping(a.vertex,new OpenLayers.Geometry.Point(b.lon,b.lat))},considerSnapping:function(a,b){var c={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null},d=!1,e,f;for(var g=0,h=this.targets.length;g<h;++g){f=this.targets[g],e=this.testTarget(f,b);if(e){if(this.greedy){c=e,c.target=f,d=!0;break}if(e.rank<c.rank||e.rank===c.rank&&e.dist<c.dist)c=e,c.target=f,d=!0}}if(d){var i=this.events.triggerEvent("beforesnap",{point:a,x:c.x,y:c.y,distance:c.dist,layer:c.target.layer,snapType:this.precedence[c.rank]});i!==!1?(a.x=c.x,a.y=c.y,this.point=a,this.events.triggerEvent("snap",{point:a,snapType:this.precedence[c.rank],layer:c.target.layer,distance:c.dist})):d=!1}this.point&&!d&&(a.x=b.x,a.y=b.y,this.point=null,this.events.triggerEvent("unsnap",{point:a}))},testTarget:function(a,b){var c={node:this.getGeoTolerance(a.nodeTolerance),vertex:this.getGeoTolerance(a.vertexTolerance),edge:this.getGeoTolerance(a.edgeTolerance)},d=Math.max(c.node,c.vertex,c.edge),e={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY},f=!1,g=a.layer.features,h,i,j,k,l,m,n,o=this.precedence.length,p=new OpenLayers.LonLat(b.x,b.y);for(var q=0,r=g.length;q<r;++q){h=g[q];if(h!==this.feature&&!h._sketch&&h.state!==OpenLayers.State.DELETE&&(!a.filter||a.filter.evaluate(h.attributes)))if(h.atPoint(p,d,d))for(var s=0,t=Math.min(e.rank+1,o);s<t;++s){i=this.precedence[s];if(a[i])if(i==="edge"){l=h.geometry.distanceTo(b,{details:!0}),m=l.distance;if(m<=c[i]&&m<e.dist){e={rank:s,dist:m,x:l.x0,y:l.y0},f=!0;break}}else{j=h.geometry.getVertices(i==="node"),n=!1;for(var u=0,v=j.length;u<v;++u)k=j[u],m=k.distanceTo(b),m<=c[i]&&(s<e.rank||s===e.rank&&m<e.dist)&&(e={rank:s,dist:m,x:k.x,y:k.y},f=!0,n=!0);if(n)break}}}return f?e:null},getGeoTolerance:function(a){var b=this.layer.map.getResolution();b!==this.resolution&&(this.resolution=b,this.geoToleranceCache={});var c=this.geoToleranceCache[a];c===undefined&&(c=a*b,this.geoToleranceCache[a]=c);return c},destroy:function(){this.active&&this.deactivate(),delete this.layer,delete this.targets,OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Snapping"}),OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.0.0",version:null,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},write:function(a,b){var c=b&&b.version||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=c){var d=OpenLayers.Format.Filter["v"+c.replace(/\./g,"_")];if(!d)throw"Can't find a Filter parser for version "+c;this.parser=new d(this.options)}return this.parser.write(a)},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=this.version;b||(b=this.defaultVersion);if(!this.parser||this.parser.VERSION!=b){var c=OpenLayers.Format.Filter["v"+b.replace(/\./g,"_")];if(!c)throw"Can't find a Filter parser for version "+b;this.parser=new c(this.options)}var d=this.parser.read(a);return d},CLASS_NAME:"OpenLayers.Format.Filter"}),OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.0.0",version:null,namedLayersAsArray:!1,parser:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},write:function(a,b){var c=b&&b.version||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=c){var d=OpenLayers.Format.SLD["v"+c.replace(/\./g,"_")];if(!d)throw"Can't find a SLD parser for version "+c;this.parser=new d(this.options)}var e=this.parser.write(a);return OpenLayers.Format.XML.prototype.write.apply(this,[e])},read:function(a,b){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=a.documentElement,d=this.version;d||(d=c.getAttribute("version"),d||(d=this.defaultVersion));if(!this.parser||this.parser.VERSION!=d){var e=OpenLayers.Format.SLD["v"+d.replace(/\./g,"_")];if(!e)throw"Can't find a SLD parser for version "+d;this.parser=new e(this.options)}var f=this.parser.read(a,b);return f},CLASS_NAME:"OpenLayers.Format.SLD"}),OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:!0,initialize:function(a){a=a||{},a.extractStyles!==!1&&(a.defaultStyle={externalGraphic:OpenLayers.Util.getImagesLocation()+"marker.png",graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5}),OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(a){var b=a.split("\n"),c,d=[];for(var e=0;e<b.length-1;e++){var f=b[e].replace(/^\s*/,"").replace(/\s*$/,"");if(f.charAt(0)!="#")if(c){var g=f.split("\t"),h=new OpenLayers.Geometry.Point(0,0),i={},j=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null,k,l,m,n,o=!1;for(var p=0;p<g.length;p++)if(g[p])if(c[p]=="point"){var q=g[p].split(",");h.y=parseFloat(q[0]),h.x=parseFloat(q[1]),o=!0}else if(c[p]=="lat")h.y=parseFloat(g[p]),o=!0;else if(c[p]=="lon")h.x=parseFloat(g[p]),o=!0;else if(c[p]=="title")i.title=g[p];else if(c[p]=="image"||c[p]=="icon"&&j)j.externalGraphic=g[p];else if(c[p]=="iconSize"&&j){var r=g[p].split(",");j.graphicWidth=parseFloat(r[0]),j.graphicHeight=parseFloat(r[1])}else if(c[p]=="iconOffset"&&j){var s=g[p].split(",");j.graphicXOffset=parseFloat(s[0]),j.graphicYOffset=parseFloat(s[1])}else c[p]=="description"?i.description=g[p]:c[p]=="overflow"?i.overflow=g[p]:i[c[p]]=g[p];if(o){this.internalProjection&&this.externalProjection&&h.transform(this.externalProjection,this.internalProjection);var t=new OpenLayers.Feature.Vector(h,i,j);d.push(t)}}else c=f.split("\t")}return d},CLASS_NAME:"OpenLayers.Format.Text"}),OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],initialize:function(a){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},addPoint:function(a,b){this.addComponent(a,b)},removePoint:function(a){this.removeComponent(a)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"}),OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,drawing:!1,mouseDown:!1,lastDown:null,lastUp:null,persist:!1,layerOptions:null,initialize:function(a,b,c){c&&c.layerOptions&&c.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})),OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments))return!1;var a=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,a),this.map.addLayer(this.layer);return!0},createFeature:function(a){var b=this.map.getLonLatFromPixel(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat)),this.callback("create",[this.point.geometry,this.point]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.point],{silent:!0})},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments))return!1;this.drawing&&this.cancel(),this.destroyFeature(),this.layer.map!=null&&this.layer.destroy(!1),this.layer=null;return!0},destroyFeature:function(){this.layer&&this.layer.destroyFeatures(),this.point=null},finalize:function(a){var b=a?"cancel":"done";this.drawing=!1,this.mouseDown=!1,this.lastDown=null,this.lastUp=null,this.callback(b,[this.geometryClone()]),(a||!this.persist)&&this.destroyFeature()},cancel:function(){this.finalize(!0)},click:function(a){OpenLayers.Event.stop(a);return!1},dblclick:function(a){OpenLayers.Event.stop(a);return!1},modifyFeature:function(a){var b=this.map.getLonLatFromPixel(a);this.point.geometry.x=b.lon,this.point.geometry.y=b.lat,this.callback("modify",[this.point.geometry,this.point]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var a=this.point&&this.point.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPoint([a]));return a},geometryClone:function(){var a=this.getGeometry();return a&&a.clone()},mousedown:function(a){if(!this.checkModifiers(a))return!0;if(this.lastDown&&this.lastDown.equals(a.xy))return!0;this.drawing=!0,this.lastDown==null?(this.persist&&this.destroyFeature(),this.createFeature(a.xy)):this.modifyFeature(a.xy),this.lastDown=a.xy;return!1},mousemove:function(a){this.drawing&&this.modifyFeature(a.xy);return!0},mouseup:function(a){if(this.drawing){this.finalize();return!1}return!0},CLASS_NAME:"OpenLayers.Handler.Point"}),OpenLayers.Layer.GML=OpenLayers.Class(OpenLayers.Layer.Vector,{loaded:!1,format:null,formatOptions:null,initialize:function(a,b,c){var d=[];d.push(a,c),OpenLayers.Layer.Vector.prototype.initialize.apply(this,d),this.url=b},setVisibility:function(a,b){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments),this.visibility&&!this.loaded&&this.loadGML()},moveTo:function(a,b,c){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadGML()},loadGML:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.url,success:this.requestSuccess,failure:this.requestFailure,scope:this}),this.loaded=!0)},setUrl:function(a){this.url=a,this.destroyFeatures(),this.loaded=!1,this.loadGML()},requestSuccess:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;var c={};OpenLayers.Util.extend(c,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(c.externalProjection=this.projection,c.internalProjection=this.map.getProjectionObject());var d=this.format?new this.format(c):new OpenLayers.Format.GML(c);this.addFeatures(d.read(b)),this.events.triggerEvent("loadend")},requestFailure:function(a){OpenLayers.Console.userError(OpenLayers.i18n("errorLoadingGML",{url:this.url})),this.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Layer.GML"}),OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,initialize:function(a,b){OpenLayers.Layer.Vector.prototype.initialize.apply(this,arguments)},addNodes:function(a){if(a.length<2)OpenLayers.Console.error("At least two point features have to be added to createa line from");else{var b=Array(a.length-1),c,d,e;for(var f=0,g=a.length;f<g;f++){c=a[f],e=c.geometry;if(e){if(e.CLASS_NAME!="OpenLayers.Geometry.Point"){OpenLayers.Console.error("Only features with point geometries are supported.");return}}else{var h=c.lonlat;e=new OpenLayers.Geometry.Point(h.lon,h.lat)}if(f>0){var i=this.dataFrom!=null?a[f+this.dataFrom].data||a[f+this.dataFrom].attributes:null,j=new OpenLayers.Geometry.LineString([d,e]);b[f-1]=new OpenLayers.Feature.Vector(j,i)}d=e}this.addFeatures(b)}},CLASS_NAME:"OpenLayers.Layer.PointTrack"}),OpenLayers.Layer.PointTrack.dataFrom={SOURCE_NODE:-1,TARGET_NODE:0},OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,initialize:function(a,b){OpenLayers.Layer.Vector.prototype.initialize.apply(this,arguments)},display:function(){},getFeatureFromEvent:function(a){var b=this.layers,c;for(var d=0;d<b.length;d++){c=b[d].getFeatureFromEvent(a);if(c)return c}},setMap:function(a){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments),this.collectRoots(),a.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(a){a.events.unregister("changelayer",this,this.handleChangeLayer),this.resetRoots(),OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){var a;for(var b=0;b<this.map.layers.length;++b)a=this.map.layers[b],OpenLayers.Util.indexOf(this.layers,a)!=-1&&a.renderer.moveRoot(this.renderer)},resetRoots:function(){var a;for(var b=0;b<this.layers.length;++b)a=this.layers[b],this.renderer&&a.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(a.renderer)},handleChangeLayer:function(a){var b=a.layer;a.property=="order"&&OpenLayers.Util.indexOf(this.layers,b)!=-1&&(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"}),OpenLayers.Layer.WFS=OpenLayers.Class(OpenLayers.Layer.Vector,OpenLayers.Layer.Markers,{isBaseLayer:!1,tile:null,ratio:2,DEFAULT_PARAMS:{service:"WFS",version:"1.0.0",request:"GetFeature"},featureClass:null,format:null,formatObject:null,formatOptions:null,vectorMode:!0,encodeBBOX:!1,extractAttributes:!1,initialize:function(a,b,c,d){d==undefined&&(d={});if(d.featureClass||!OpenLayers.Layer.Vector||!OpenLayers.Feature.Vector)this.vectorMode=!1;c=OpenLayers.Util.upperCaseObject(c),OpenLayers.Util.extend(d,{reportError:!1});var e=[];e.push(a,d),OpenLayers.Layer.Vector.prototype.initialize.apply(this,e);if(!this.renderer||!this.vectorMode)this.vectorMode=!1,d.featureClass||(d.featureClass=OpenLayers.Feature.WFS),OpenLayers.Layer.Markers.prototype.initialize.apply(this,e);this.params&&this.params.typename&&!this.options.typename&&(this.options.typename=this.params.typename),this.options.geometry_column||(this.options.geometry_column="the_geom"),this.params=OpenLayers.Util.applyDefaults(c,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)),this.url=b},destroy:function(){this.vectorMode?OpenLayers.Layer.Vector.prototype.destroy.apply(this,arguments):OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.tile&&this.tile.destroy(),this.tile=null,this.ratio=null,this.featureClass=null,this.format=null,this.formatObject&&this.formatObject.destroy&&this.formatObject.destroy(),this.formatObject=null,this.formatOptions=null,this.vectorMode=null,this.encodeBBOX=null,this.extractAttributes=null},setMap:function(a){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);var b={extractAttributes:this.extractAttributes};OpenLayers.Util.extend(b,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(b.externalProjection=this.projection,b.internalProjection=this.map.getProjectionObject()),this.formatObject=this.format?new this.format(b):new OpenLayers.Format.GML(b)}else OpenLayers.Layer.Markers.prototype.setMap.apply(this,arguments)},moveTo:function(a,b,c){this.vectorMode?OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments):OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);if(c)return!1;b&&(this.vectorMode&&this.renderer.clear());if(this.options.minZoomLevel){OpenLayers.Console.warn(OpenLayers.i18n("minZoomLevelError"));if(this.map.getZoom()<this.options.minZoomLevel)return null}a==null&&(a=this.map.getExtent());var d=this.tile==null,e=!d&&!this.tile.bounds.containsBounds(a);if(b||d||!c&&e){var f=a.getCenterLonLat(),g=a.getWidth()*this.ratio,h=a.getHeight()*this.ratio,i=new OpenLayers.Bounds(f.lon-g/2,f.lat-h/2,f.lon+g/2,f.lat+h/2),j=this.map.getSize();j.w=j.w*this.ratio,j.h=j.h*this.ratio;var k=new OpenLayers.LonLat(i.left,i.top),l=this.map.getLayerPxFromLonLat(k),m=this.getFullRequestString(),n=null,o=this.params.filter||this.params.FILTER;o?n={FILTER:o}:n={BBOX:this.encodeBBOX?i.toBBOX():i.toArray()};if(this.map&&!this.projection.equals(this.map.getProjectionObject())){var p=i.clone();p.transform(this.map.getProjectionObject(),this.projection),o||(n.BBOX=this.encodeBBOX?p.toBBOX():p.toArray())}m+="&"+OpenLayers.Util.getParameterString(n),this.tile?(this.vectorMode?(this.destroyFeatures(),this.renderer.clear()):this.clearMarkers(),this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null,this.tile=new OpenLayers.Tile.WFS(this,l,i,m,j),this.addTileMonitoringHooks(this.tile),this.tile.draw()):(this.tile=new OpenLayers.Tile.WFS(this,l,i,m,j),this.addTileMonitoringHooks(this.tile),this.tile.draw())}},addTileMonitoringHooks:function(a){a.onLoadStart=function(){this==this.layer.tile&&this.layer.events.triggerEvent("loadstart")},a.events.register("loadstart",a,a.onLoadStart),a.onLoadEnd=function(){this==this.layer.tile&&(this.layer.events.triggerEvent("tileloaded"),this.layer.events.triggerEvent("loadend"))},a.events.register("loadend",a,a.onLoadEnd),a.events.register("unload",a,a.onLoadEnd)},removeTileMonitoringHooks:function(a){a.unload(),a.events.un({loadstart:a.onLoadStart,loadend:a.onLoadEnd,unload:a.onLoadEnd,scope:a})},onMapResize:function(){this.vectorMode?OpenLayers.Layer.Vector.prototype.onMapResize.apply(this,arguments):OpenLayers.Layer.Markers.prototype.onMapResize.apply(this,arguments)},display:function(){this.vectorMode?OpenLayers.Layer.Vector.prototype.display.apply(this,arguments):OpenLayers.Layer.Markers.prototype.display.apply(this,arguments)},mergeNewParams:function(a){var b=OpenLayers.Util.upperCaseObject(a),c=[b];return OpenLayers.Layer.HTTPRequest.prototype.mergeNewParams.apply(this,c)},clone:function(a){a==null&&(a=new OpenLayers.Layer.WFS(this.name,this.url,this.params,this.getOptions())),this.vectorMode?a=OpenLayers.Layer.Vector.prototype.clone.apply(this,[a]):a=OpenLayers.Layer.Markers.prototype.clone.apply(this,[a]);return a},getFullRequestString:function(a,b){var c=this.projection.getCode()||this.map.getProjection();this.params.SRS=c=="none"?null:c;return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},commit:function(){if(!this.writer){var a={};this.map&&!this.projection.equals(this.map.getProjectionObject())&&(a.externalProjection=this.projection,a.internalProjection=this.map.getProjectionObject()),this.writer=new OpenLayers.Format.WFS(a,this)}var b=this.writer.write(this.features);OpenLayers.Request.POST({url:this.url,data:b,success:this.commitSuccess,failure:this.commitFailure,scope:this})},commitSuccess:function(a){var b=a.responseText;if(b.indexOf("SUCCESS")!=-1){this.commitReport(OpenLayers.i18n("commitSuccess",{response:b}));for(var c=0;c<this.features.length;c++)this.features[c].state=null}else(b.indexOf("FAILED")!=-1||b.indexOf("Exception")!=-1)&&this.commitReport(OpenLayers.i18n("commitFailed",{response:b}))},commitFailure:function(a){},commitReport:function(a,b){OpenLayers.Console.userError(a)},refresh:function(){this.tile&&(this.vectorMode?(this.renderer.clear(),this.features.length=0):(this.clearMarkers(),this.markers.length=0),this.tile.draw())},getDataExtent:function(){var a;this.vectorMode?a=OpenLayers.Layer.Vector.prototype.getDataExtent.apply(this):a=OpenLayers.Layer.Markers.prototype.getDataExtent.apply(this);return a},setOpacity:function(a){this.vectorMode?OpenLayers.Layer.Vector.prototype.setOpacity.apply(this,[a]):OpenLayers.Layer.Markers.prototype.setOpacity.apply(this,[a])},CLASS_NAME:"OpenLayers.Layer.WFS"}),OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,wildcarded:!1,initialize:function(a){a=a||{},this.params={},this.headers={},OpenLayers.Protocol.prototype.initialize.apply(this,arguments)},destroy:function(){this.params=null,this.headers=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){OpenLayers.Protocol.prototype.read.apply(this,arguments),a=OpenLayers.Util.applyDefaults(a,this.options),a.params=OpenLayers.Util.applyDefaults(a.params,this.options.params),a.filter&&(a.params=this.filterToParams(a.filter,a.params));var b=a.readWithPOST!==undefined?a.readWithPOST:this.readWithPOST,c=new OpenLayers.Protocol.Response({requestType:"read"});b?c.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,c,a),data:OpenLayers.Util.getParameterString(a.params),headers:{"Content-Type":"application/x-www-form-urlencoded"}}):c.priv=OpenLayers.Request.GET({url:a.url,callback:this.createCallback(this.handleRead,c,a),params:a.params,headers:a.headers});return c},handleRead:function(a,b){this.handleResponse(a,b)},filterToParams:function(a,b){b=b||{};var c=a.CLASS_NAME,d=c.substring(c.lastIndexOf(".")+1);switch(d){case"Spatial":switch(a.type){case OpenLayers.Filter.Spatial.BBOX:b.bbox=a.value.toArray();break;case OpenLayers.Filter.Spatial.DWITHIN:b.tolerance=a.distance;case OpenLayers.Filter.Spatial.WITHIN:b.lon=a.value.x,b.lat=a.value.y;break;default:OpenLayers.Console.warn("Unknown spatial filter type "+a.type)}break;case"Comparison":var e=OpenLayers.Protocol.HTTP.COMP_TYPE_TO_OP_STR[a.type];if(e!==undefined){var f=a.value;a.type==OpenLayers.Filter.Comparison.LIKE&&(f=this.regex2value(f),this.wildcarded&&(f="%"+f+"%")),b[a.property+"__"+e]=f,b.queryable=b.queryable||[],b.queryable.push(a.property)}else OpenLayers.Console.warn("Unknown comparison filter type "+a.type);break;case"Logical":if(a.type===OpenLayers.Filter.Logical.AND)for(var g=0,h=a.filters.length;g<h;g++)b=this.filterToParams(a.filters[g],b);else OpenLayers.Console.warn("Unsupported logical filter type "+a.type);break;default:OpenLayers.Console.warn("Unknown filter type "+d)}return b},regex2value:function(a){a=a.replace(/%/g,"\\%"),a=a.replace(/\\\\\.(\*)?/g,function(a,b){return b?a:"\\\\_"}),a=a.replace(/\\\\\.\*/g,"\\\\%"),a=a.replace(/(\\)?\.(\*)?/g,function(a,b,c){return b||c?a:"_"}),a=a.replace(/(\\)?\.\*/g,function(a,b){return b?a:"%"}),a=a.replace(/\\\./g,"."),a=a.replace(/(\\)?\\\*/g,function(a,b){return b?a:"*"});return a},create:function(a,b){b=OpenLayers.Util.applyDefaults(b,this.options);var c=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"create"});c.priv=OpenLayers.Request.POST({url:b.url,callback:this.createCallback(this.handleCreate,c,b),headers:b.headers,data:this.format.write(a)});return c},handleCreate:function(a,b){this.handleResponse(a,b)},update:function(a,b){b=b||{};var c=b.url||a.url||this.options.url+"/"+a.fid;b=OpenLayers.Util.applyDefaults(b,this.options);var d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"update"});d.priv=OpenLayers.Request.PUT({url:c,callback:this.createCallback(this.handleUpdate,d,b),headers:b.headers,data:this.format.write(a)});return d},handleUpdate:function(a,b){this.handleResponse(a,b)},"delete":function(a,b){b=b||{};var c=b.url||a.url||this.options.url+"/"+a.fid;b=OpenLayers.Util.applyDefaults(b,this.options);var d=new OpenLayers.Protocol.Response({reqFeatures:a,requestType:"delete"});d.priv=OpenLayers.Request.DELETE({url:c,callback:this.createCallback(this.handleDelete,d,b),headers:b.headers});return d},handleDelete:function(a,b){this.handleResponse(a,b)},handleResponse:function(a,b){var c=a.priv;b.callback&&(c.status>=200&&c.status<300?(a.requestType!="delete"&&(a.features=this.parseFeatures(c)),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,b.callback.call(b.scope,a))},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;if(!b||b.length<=0)return null;return this.format.read(b)},commit:function(a,b){function o(a){this.callUserCallback(a,b),l=l&&a.success(),d++,d>=k&&(b.callback&&(m.code=l?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,b.callback.apply(b.scope,[m])))}function n(a){var b=a.features?a.features.length:0,c=Array(b);for(var d=0;d<b;++d)c[d]=a.features[d].fid;m.insertIds=c,o.apply(this,[a])}b=OpenLayers.Util.applyDefaults(b,this.options);var c=[],d=0,e={};e[OpenLayers.State.INSERT]=[],e[OpenLayers.State.UPDATE]=[],e[OpenLayers.State.DELETE]=[];var f,g,h=[];for(var i=0,j=a.length;i<j;++i)f=a[i],g=e[f.state],g&&(g.push(f),h.push(f));var k=(e[OpenLayers.State.INSERT].length>0?1:0)+e[OpenLayers.State.UPDATE].length+e[OpenLayers.State.DELETE].length,l=!0,m=new OpenLayers.Protocol.Response({reqFeatures:h}),p=e[OpenLayers.State.INSERT];p.length>0&&c.push(this.create(p,OpenLayers.Util.applyDefaults({callback:n,scope:this},b.create))),p=e[OpenLayers.State.UPDATE];for(var i=p.length-1;i>=0;--i)c.push(this.update(p[i],OpenLayers.Util.applyDefaults({callback:o,scope:this},b.update)));p=e[OpenLayers.State.DELETE];for(var i=p.length-1;i>=0;--i)c.push(this["delete"](p[i],OpenLayers.Util.applyDefaults({callback:o,scope:this},b["delete"])));return c},abort:function(a){a&&a.priv.abort()},callUserCallback:function(a,b){var c=b[a.requestType];c&&c.callback&&c.callback.call(c.scope,a)},CLASS_NAME:"OpenLayers.Protocol.HTTP"}),function(){var a=OpenLayers.Protocol.HTTP.COMP_TYPE_TO_OP_STR={};a[OpenLayers.Filter.Comparison.EQUAL_TO]="eq",a[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]="ne",a[OpenLayers.Filter.Comparison.LESS_THAN]="lt",a[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte",a[OpenLayers.Filter.Comparison.GREATER_THAN]="gt",a[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte",a[OpenLayers.Filter.Comparison.LIKE]="ilike"}(),OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,initialize:function(a){OpenLayers.Strategy.prototype.initialize.apply(this,[a])},activate:function(){var a=OpenLayers.Strategy.prototype.activate.call(this);a&&(this.layer.events.on({moveend:this.update,scope:this}),this.layer.events.on({refresh:this.update,scope:this}));return a},deactivate:function(){var a=OpenLayers.Strategy.prototype.deactivate.call(this);a&&(this.layer.events.un({moveend:this.update,scope:this}),this.layer.events.un({refresh:this.update,scope:this}));return a},update:function(a){var b=this.getMapBounds();if(a&&a.force||this.invalidBounds(b))this.calculateBounds(b),this.resolution=this.layer.map.getResolution(),this.triggerRead()},getMapBounds:function(){var a=this.layer.map.getExtent();this.layer.projection.equals(this.layer.map.getProjectionObject())||(a=a.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection));return a},invalidBounds:function(a){a||(a=this.getMapBounds());var b=!this.bounds||!this.bounds.containsBounds(a);if(!b&&this.resFactor){var c=this.resolution/this.layer.map.getResolution();b=c>=this.resFactor||c<=1/this.resFactor}return b},calculateBounds:function(a){a||(a=this.getMapBounds());var b=a.getCenterLonLat(),c=a.getWidth()*this.ratio,d=a.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(b.lon-c/2,b.lat-d/2,b.lon+c/2,b.lat+d/2)},triggerRead:function(){this.response&&(this.layer.protocol.abort(this.response),this.layer.events.triggerEvent("loadend")),this.layer.events.triggerEvent("loadstart"),this.response=this.layer.protocol.read({filter:this.createFilter(),callback:this.merge,scope:this})},createFilter:function(){var a=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});this.layer.filter&&(a=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.layer.filter,a]}));return a},merge:function(a){this.layer.destroyFeatures();var b=a.features;if(b&&b.length>0){var c=this.layer.projection,d=this.layer.map.getProjectionObject();if(!d.equals(c)){var e;for(var f=0,g=b.length;f<g;++f)e=b[f].geometry,e&&e.transform(c,d)}this.layer.addFeatures(b)}this.response=null,this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.BBOX"}),OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforefeaturehighlighted","featurehighlighted","featureunhighlighted"],multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(a,b){this.EVENT_TYPES=OpenLayers.Control.SelectFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES),OpenLayers.Control.prototype.initialize.apply(this,[b]),this.scope===null&&(this.scope=this),this.initLayer(a);var c={click:this.clickFeature,clickout:this.clickoutFeature};this.hover&&(c.over=this.overFeature,c.out=this.outFeature),this.callbacks=OpenLayers.Util.extend(c,this.callbacks),this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})},this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(a){a instanceof Array?(this.layers=a,this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:a})):this.layer=a},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer),OpenLayers.Control.prototype.destroy.apply(this,arguments),this.layers&&this.layer.destroy()},activate:function(){this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate());return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.active&&(this.handlers.feature.deactivate(),this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer));return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(a){var b=this.layers||[this.layer],c,d;for(var e=0;e<b.length;++e){c=b[e];for(var f=c.selectedFeatures.length-1;f>=0;--f)d=c.selectedFeatures[f],(!a||a.except!=d)&&this.unselect(d)}},clickFeature:function(a){if(!this.hover){var b=OpenLayers.Util.indexOf(a.layer.selectedFeatures,a)>-1;b?this.toggleSelect()?this.unselect(a):this.multipleSelect()||this.unselectAll({except:a}):(this.multipleSelect()||this.unselectAll({except:a}),this.select(a))}},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(a){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(a){var b=a.layer;this.hover&&(this.highlightOnly?this.highlight(a):OpenLayers.Util.indexOf(b.selectedFeatures,a)==-1&&this.select(a))},outFeature:function(a){if(this.hover)if(this.highlightOnly){if(a._lastHighlighter==this.id)if(a._prevHighlighter&&a._prevHighlighter!=this.id){delete a._lastHighlighter;var b=this.map.getControl(a._prevHighlighter);b&&b.highlight(a)}else this.unhighlight(a)}else this.unselect(a)},highlight:function(a){var b=a.layer,c=this.events.triggerEvent("beforefeaturehighlighted",{feature:a});if(c!==!1){a._prevHighlighter=a._lastHighlighter,a._lastHighlighter=this.id;var d=this.selectStyle||this.renderIntent;b.drawFeature(a,d),this.events.triggerEvent("featurehighlighted",{feature:a})}},unhighlight:function(a){var b=a.layer;a._lastHighlighter=a._prevHighlighter,delete a._prevHighlighter,b.drawFeature(a,a.style||a.layer.style||"default"),this.events.triggerEvent("featureunhighlighted",{feature:a})},select:function(a){var b=this.onBeforeSelect.call(this.scope,a),c=a.layer;b!==!1&&(b=c.events.triggerEvent("beforefeatureselected",{feature:a}),b!==!1&&(c.selectedFeatures.push(a),this.highlight(a),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=c.selectedFeatures[0]),c.events.triggerEvent("featureselected",{feature:a}),this.onSelect.call(this.scope,a)))},unselect:function(a){var b=a.layer;this.unhighlight(a),OpenLayers.Util.removeItem(b.selectedFeatures,a),b.events.triggerEvent("featureunselected",{feature:a}),this.onUnselect.call(this.scope,a)},selectBox:function(a){if(a instanceof OpenLayers.Bounds){var b=this.map.getLonLatFromPixel(new OpenLayers.Pixel(a.left,a.bottom)),c=this.map.getLonLatFromPixel(new OpenLayers.Pixel(a.right,a.top)),d=new OpenLayers.Bounds(b.lon,b.lat,c.lon,c.lat);this.multipleSelect()||this.unselectAll();var e=this.multiple;this.multiple=!0;var f=this.layers||[this.layer],g;for(var h=0;h<f.length;++h){g=f[h];for(var i=0,j=g.features.length;i<j;++i){var k=g.features[i];if(!k.getVisibility())continue;if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,k.geometry.CLASS_NAME)>-1)d.toGeometry().intersects(k.geometry)&&(OpenLayers.Util.indexOf(g.selectedFeatures,k)==-1&&this.select(k))}}this.multiple=e}},setMap:function(a){this.handlers.feature.setMap(a),this.box&&this.handlers.box.setMap(a),OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(a){var b=this.active;this.unselectAll(),this.deactivate(),this.layers&&(this.layer.destroy(),this.layers=null),this.initLayer(a),this.handlers.feature.layer=this.layer,b&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"}),OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){var b={};this.readers.ogc.Filter.apply(this,[a,b]);return b.filter},readers:{ogc:{Filter:function(a,b){var c={fids:[],filters:[]};this.readChildNodes(a,c),c.fids.length>0?b.filter=new OpenLayers.Filter.FeatureId({fids:c.fids}):c.filters.length>0&&(b.filter=c.filters[0])},FeatureId:function(a,b){var c=a.getAttribute("fid");c&&b.fids.push(c)},And:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});this.readChildNodes(a,c),b.filters.push(c)},Or:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(a,c),b.filters.push(c)},Not:function(a,b){var c=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(a,c),b.filters.push(c)},PropertyIsLessThan:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(a,c),b.filters.push(c)},PropertyIsGreaterThan:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(a,c),b.filters.push(c)},PropertyIsLessThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(a,c),b.filters.push(c)},PropertyIsGreaterThanOrEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(a,c),b.filters.push(c)},PropertyIsBetween:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(a,c),b.filters.push(c)},Literal:function(a,b){b.value=OpenLayers.String.numericIf(this.getChildValue(a))},PropertyName:function(a,b){b.property=this.getChildValue(a)},LowerBoundary:function(a,b){b.lowerBoundary=OpenLayers.String.numericIf(this.readOgcExpression(a))},UpperBoundary:function(a,b){b.upperBoundary=OpenLayers.String.numericIf(this.readOgcExpression(a))},Intersects:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(a,b){this.readSpatial(a,b,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(a,b){b.distance=parseInt(this.getChildValue(a)),b.distanceUnits=a.getAttribute("units")}}},readSpatial:function(a,b,c){var d=new OpenLayers.Filter.Spatial({type:c});this.readChildNodes(a,d),d.value=d.components[0],delete d.components,b.filters.push(d)},readOgcExpression:function(a){var b={};this.readChildNodes(a,b);var c=b.value;c||(c=this.getChildValue(a));return c},write:function(a){return this.writers.ogc.Filter.apply(this,[a])},writers:{ogc:{Filter:function(a){var b=this.createElementNSPlus("ogc:Filter"),c=a.CLASS_NAME.split(".").pop();if(c=="FeatureId")for(var d=0;d<a.fids.length;++d)this.writeNode("FeatureId",a.fids[d],b);else this.writeNode(this.getFilterType(a),a,b);return b},FeatureId:function(a){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:a}})},And:function(a){var b=this.createElementNSPlus("ogc:And"),c;for(var d=0;d<a.filters.length;++d)c=a.filters[d],this.writeNode(this.getFilterType(c),c,b);return b},Or:function(a){var b=this.createElementNSPlus("ogc:Or"),c;for(var d=0;d<a.filters.length;++d)c=a.filters[d],this.writeNode(this.getFilterType(c),c,b);return b},Not:function(a){var b=this.createElementNSPlus("ogc:Not"),c=a.filters[0];this.writeNode(this.getFilterType(c),c,b);return b},PropertyIsLessThan:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThan");this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.value,b);return b},PropertyIsGreaterThan:function(a){var b=this.createElementNSPlus("ogc:PropertyIsGreaterThan");this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.value,b);return b},PropertyIsLessThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.value,b);return b},PropertyIsGreaterThanOrEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.value,b);return b},PropertyIsBetween:function(a){var b=this.createElementNSPlus("ogc:PropertyIsBetween");this.writeNode("PropertyName",a,b),this.writeNode("LowerBoundary",a,b),this.writeNode("UpperBoundary",a,b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})},Literal:function(a){return this.createElementNSPlus("ogc:Literal",{value:a})},LowerBoundary:function(a){var b=this.createElementNSPlus("ogc:LowerBoundary");this.writeNode("Literal",a.lowerBoundary,b);return b},UpperBoundary:function(a){var b=this.createElementNSPlus("ogc:UpperBoundary");this.writeNode("Literal",a.upperBoundary,b);return b},INTERSECTS:function(a){return this.writeSpatial(a,"Intersects")},WITHIN:function(a){return this.writeSpatial(a,"Within")},CONTAINS:function(a){return this.writeSpatial(a,"Contains")},DWITHIN:function(a){var b=this.writeSpatial(a,"DWithin");this.writeNode("Distance",a,b);return b},Distance:function(a){return this.createElementNSPlus("ogc:Distance",{attributes:{units:a.distanceUnits},value:a.distance})}}},getFilterType:function(a){var b=this.filterMap[a.type];if(!b)throw"Filter writing not supported for rule type: "+a.type;return b},filterMap:{"&&":"And","||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan","<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS"},CLASS_NAME:"OpenLayers.Format.Filter.v1"}),OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],initialize:function(a){OpenLayers.Geometry.MultiPoint.prototype.initialize.apply(this,arguments)},getLength:function(){var a=0;if(this.components&&this.components.length>1)for(var b=1,c=this.components.length;b<c;b++)a+=this.components[b-1].distanceTo(this.components[b]);return a},getGeodesicLength:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}var d=0;if(b.components&&b.components.length>1){var e,f;for(var g=1,h=b.components.length;g<h;g++)e=b.components[g-1],f=b.components[g],d+=OpenLayers.Util.distVincenty({lon:e.x,lat:e.y},{lon:f.x,lat:f.y})}return d*1e3},CLASS_NAME:"OpenLayers.Geometry.Curve"}),OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(a,b){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments),this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.clearFeatures(),this.features=null},loadText:function(){if(!this.loaded)if(this.location!=null){var a=function(a){this.events.triggerEvent("loadend")};this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,success:this.parseData,failure:a,scope:this}),this.loaded=!0}},moveTo:function(a,b,c){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadText()},parseData:function(a){var b=a.responseText,c={};OpenLayers.Util.extend(c,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(c.externalProjection=this.projection,c.internalProjection=this.map.getProjectionObject());var d=new OpenLayers.Format.Text(c),e=d.read(b);for(var f=0,g=e.length;f<g;f++){var h={},i=e[f],j,k,l;j=new OpenLayers.LonLat(i.geometry.x,i.geometry.y),i.style.graphicWidth&&i.style.graphicHeight&&(k=new OpenLayers.Size(i.style.graphicWidth,i.style.graphicHeight)),i.style.graphicXOffset!==undefined&&i.style.graphicYOffset!==undefined&&(l=new OpenLayers.Pixel(i.style.graphicXOffset,i.style.graphicYOffset)),i.style.externalGraphic!=null?h.icon=new OpenLayers.Icon(i.style.externalGraphic,k,l):(h.icon=OpenLayers.Marker.defaultIcon(),k!=null&&h.icon.setSize(k)),i.attributes.title!=null&&i.attributes.description!=null&&(h.popupContentHTML="<h2>"+i.attributes.title+"</h2><p>"+i.attributes.description+"</p>"),h.overflow=i.attributes.overflow||"auto";var m=new OpenLayers.Feature(this,j,h);this.features.push(m);var n=m.createMarker();i.attributes.title!=null&&i.attributes.description!=null&&n.events.register("click",m,this.markerClick),this.addMarker(n)}this.events.triggerEvent("loadend")},markerClick:function(a){var b=this==this.layer.selectedFeature;this.layer.selectedFeature=b?null:this;for(var c=0,d=this.layer.map.popups.length;c<d;c++)this.layer.map.removePopup(this.layer.map.popups[c]);b||this.layer.map.addPopup(this.createPopup()),OpenLayers.Event.stop(a)},clearFeatures:function(){if(this.features!=null)while(this.features.length>0){var a=this.features[0];OpenLayers.Util.removeItem(this.features,a),a.destroy()}},CLASS_NAME:"OpenLayers.Layer.Text"}),OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertices:null,virtualVertices:null,selectControl:null,dragControl:null,handlers:null,deleteCodes:null,virtualStyle:null,mode:null,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(a,b){this.layer=a,this.vertices=[],this.virtualVertices=[],this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer()),this.virtualStyle.fillOpacity=.3,this.virtualStyle.strokeOpacity=.3,this.deleteCodes=[46,68],this.mode=OpenLayers.Control.ModifyFeature.RESHAPE,OpenLayers.Control.prototype.initialize.apply(this,[b]),this.deleteCodes instanceof Array||(this.deleteCodes=[this.deleteCodes]);var c=this,d={geometryTypes:this.geometryTypes,clickout:this.clickout,toggle:this.toggle,onBeforeSelect:this.beforeSelectFeature,onSelect:this.selectFeature,onUnselect:this.unselectFeature,scope:this};this.standalone===!1&&(this.selectControl=new OpenLayers.Control.SelectFeature(a,d));var e={geometryTypes:["OpenLayers.Geometry.Point"],snappingOptions:this.snappingOptions,onStart:function(a,b){c.dragStart.apply(c,[a,b])},onDrag:function(a,b){c.dragVertex.apply(c,[a,b])},onComplete:function(a){c.dragComplete.apply(c,[a])},featureCallbacks:{over:function(a){(c.standalone!==!0||a._sketch||c.feature===a)&&c.dragControl.overFeature.apply(c.dragControl,[a])}}};this.dragControl=new OpenLayers.Control.DragFeature(a,e);var f={keydown:this.handleKeypress};this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,f)}},destroy:function(){this.layer=null,this.standalone||this.selectControl.destroy(),this.dragControl.destroy(),OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.standalone||this.selectControl.activate())&&this.handlers.keyboard.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){var a=!1;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.vertices,{silent:!0}),this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.vertices=[],this.dragControl.deactivate();var b=this.feature,c=b&&b.geometry&&b.layer;this.standalone===!1?(c&&this.selectControl.unselect.apply(this.selectControl,[b]),this.selectControl.deactivate()):c&&this.unselectFeature(b),this.handlers.keyboard.deactivate(),a=!0}return a},beforeSelectFeature:function(a){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:a})},selectFeature:function(a){this.feature=a,this.modified=!1,this.resetVertices(),this.dragControl.activate(),this.onModificationStart(this.feature)},unselectFeature:function(a){this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[],this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle),this.feature=null,this.dragControl.deactivate(),this.onModificationEnd(a),this.layer.events.triggerEvent("afterfeaturemodified",{feature:a,modified:this.modified}),this.modified=!1},dragStart:function(a,b){if(a!=this.feature&&!a.geometry.parent&&a!=this.dragHandle&&a!=this.radiusHandle){this.standalone===!1&&this.feature&&this.selectControl.clickFeature.apply(this.selectControl,[this.feature]);if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,a.geometry.CLASS_NAME)!=-1)this.standalone||this.selectControl.clickFeature.apply(this.selectControl,[a]),this.dragControl.overFeature.apply(this.dragControl,[a]),this.dragControl.lastPixel=b,this.dragControl.handlers.drag.started=!0,this.dragControl.handlers.drag.start=b,this.dragControl.handlers.drag.last=b}},dragVertex:function(a,b){this.modified=!0,this.feature.geometry.CLASS_NAME=="OpenLayers.Geometry.Point"?(this.feature!=a&&(this.feature=a),this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:b})):(a._index?(a.geometry.parent.addComponent(a.geometry,a._index),delete a._index,OpenLayers.Util.removeItem(this.virtualVertices,a),this.vertices.push(a)):a==this.dragHandle?(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null)):a!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",{vertex:a.geometry,feature:this.feature,pixel:b}),this.virtualVertices.length>0&&(this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.layer.drawFeature(this.feature,this.standalone?undefined:this.selectControl.renderIntent)),this.layer.drawFeature(a)},dragComplete:function(a){this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE&&(this.feature.state=OpenLayers.State.UPDATE)},resetVertices:function(){this.dragControl.feature&&this.dragControl.outFeature(this.dragControl.feature),this.vertices.length>0&&(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[]),this.virtualVertices.length>0&&(this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null),this.feature&&this.feature.geometry.CLASS_NAME!="OpenLayers.Geometry.Point"&&(this.mode&OpenLayers.Control.ModifyFeature.DRAG&&this.collectDragHandle(),this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle(),this.mode&OpenLayers.Control.ModifyFeature.RESHAPE&&(this.mode&OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(a){var b=a.keyCode;if(this.feature&&OpenLayers.Util.indexOf(this.deleteCodes,b)!=-1){var c=this.dragControl.feature;c&&OpenLayers.Util.indexOf(this.vertices,c)!=-1&&!this.dragControl.handlers.drag.dragging&&c.geometry.parent&&(c.geometry.parent.removeComponent(c.geometry),this.layer.drawFeature(this.feature,this.standalone?undefined:this.selectControl.renderIntent),this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature}))}},collectVertices:function(){function b(c){var d,e,f,g;if(c.CLASS_NAME=="OpenLayers.Geometry.Point")e=new OpenLayers.Feature.Vector(c),e._sketch=!0,a.vertices.push(e);else{var h=c.components.length;c.CLASS_NAME=="OpenLayers.Geometry.LinearRing"&&(h-=1);for(d=0;d<h;++d)f=c.components[d],f.CLASS_NAME=="OpenLayers.Geometry.Point"?(e=new OpenLayers.Feature.Vector(f),e._sketch=!0,a.vertices.push(e)):b(f);if(c.CLASS_NAME!="OpenLayers.Geometry.MultiPoint")for(d=0,g=c.components.length;d<g-1;++d){var i=c.components[d],j=c.components[d+1];if(i.CLASS_NAME=="OpenLayers.Geometry.Point"&&j.CLASS_NAME=="OpenLayers.Geometry.Point"){var k=(i.x+j.x)/2,l=(i.y+j.y)/2,m=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(k,l),null,a.virtualStyle);m.geometry.parent=c,m._index=d+1,m._sketch=!0,a.virtualVertices.push(m)}}}}this.vertices=[],this.virtualVertices=[];var a=this;b.call(this,this.feature.geometry),this.layer.addFeatures(this.virtualVertices,{silent:!0}),this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var a=this.feature.geometry,b=a.getBounds().getCenterLonLat(),c=new OpenLayers.Geometry.Point(b.lon,b.lat),d=new OpenLayers.Feature.Vector(c);c.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this,b,c),a.move(b,c)},d._sketch=!0,this.dragHandle=d,this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var a=this.feature.geometry,b=a.getBounds(),c=b.getCenterLonLat(),d=new OpenLayers.Geometry.Point(c.lon,c.lat),e=new OpenLayers.Geometry.Point(b.right,b.bottom),f=new OpenLayers.Feature.Vector(e),g=this.mode&OpenLayers.Control.ModifyFeature.RESIZE,h=this.mode&OpenLayers.Control.ModifyFeature.RESHAPE,i=this.mode&OpenLayers.Control.ModifyFeature.ROTATE;e.move=function(b,c){OpenLayers.Geometry.Point.prototype.move.call(this,b,c);var e=this.x-d.x,f=this.y-d.y,j=e-b,k=f-c;if(i){var l=Math.atan2(k,j),m=Math.atan2(f,e),n=m-l;n*=180/Math.PI,a.rotate(n,d)}if(g){var o,p;if(h)o=f/k,p=e/j/o;else{var q=Math.sqrt(j*j+k*k),r=Math.sqrt(e*e+f*f);o=r/q}a.resize(o,d,p)}},f._sketch=!0,this.radiusHandle=f,this.layer.addFeatures([this.radiusHandle],{silent:!0})},setMap:function(a){this.standalone||this.selectControl.setMap(a),this.dragControl.setMap(a),OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.ModifyFeature"}),OpenLayers.Control.ModifyFeature.RESHAPE=1,OpenLayers.Control.ModifyFeature.RESIZE=2,OpenLayers.Control.ModifyFeature.ROTATE=4,OpenLayers.Control.ModifyFeature.DRAG=8,OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{initialize:function(a){OpenLayers.Geometry.Curve.prototype.initialize.apply(this,arguments)},removeComponent:function(a){this.components&&this.components.length>2&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments)},intersects:function(a){var b=!1,c=a.CLASS_NAME;if(c=="OpenLayers.Geometry.LineString"||c=="OpenLayers.Geometry.LinearRing"||c=="OpenLayers.Geometry.Point"){var d=this.getSortedSegments(),e;c=="OpenLayers.Geometry.Point"?e=[{x1:a.x,y1:a.y,x2:a.x,y2:a.y}]:e=a.getSortedSegments();var f,g,h,i,j,k,l,m;outer:for(var n=0,o=d.length;n<o;++n){f=d[n],g=f.x1,h=f.x2,i=f.y1,j=f.y2;inner:for(var p=0,q=e.length;p<q;++p){k=e[p];if(k.x1>h)break;if(k.x2<g)continue;l=k.y1,m=k.y2;if(Math.min(l,m)>Math.max(i,j))continue;if(Math.max(l,m)<Math.min(i,j))continue;if(OpenLayers.Geometry.segmentsIntersect(f,k)){b=!0;break outer}}}}else b=a.intersects(this);return b},getSortedSegments:function(){function f(a,b){return a.x1-b.x1}var a=this.components.length-1,b=Array(a),c,d;for(var e=0;e<a;++e)c=this.components[e],d=this.components[e+1],c.x<d.x?b[e]={x1:c.x,y1:c.y,x2:d.x,y2:d.y}:b[e]={x1:d.x,y1:d.y,x2:c.x,y2:c.y};return b.sort(f)},splitWithSegment:function(a,b){var c=!b||b.edge!==!1,d=b&&b.tolerance,e=[],f=this.getVertices(),g=[],h=[],i=!1,j,k,l,m,n,o,p={point:!0,tolerance:d},q=null;for(var r=0,s=f.length-2;r<=s;++r){j=f[r],g.push(j.clone()),k=f[r+1],o={x1:j.x,y1:j.y,x2:k.x,y2:k.y},l=OpenLayers.Geometry.segmentsIntersect(a,o,p);if(l instanceof OpenLayers.Geometry.Point){l.x===a.x1&&l.y===a.y1||l.x===a.x2&&l.y===a.y2||l.equals(j)||l.equals(k)?n=!0:n=!1;if(n||c){l.equals(h[h.length-1])||h.push(l.clone());if(r===0)if(l.equals(j))continue;if(l.equals(k))continue;i=!0,l.equals(j)||g.push(l),e.push(new OpenLayers.Geometry.LineString(g)),g=[l.clone()]}}}i&&(g.push(k.clone()),e.push(new OpenLayers.Geometry.LineString(g)));if(h.length>0){var t=a.x1<a.x2?1:-1,u=a.y1<a.y2?1:-1;q={lines:e,points:h.sort(function(a,b){return t*a.x-t*b.x||u*a.y-u*b.y})}}return q},split:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h;if(a instanceof OpenLayers.Geometry.LineString){var i=this.getVertices(),j,k,l,m,n,o,p=[];g=[];for(var q=0,r=i.length-2;q<=r;++q){j=i[q],k=i[q+1],l={x1:j.x,y1:j.y,x2:k.x,y2:k.y},h=h||[a],d&&p.push(j.clone());for(var s=0;s<h.length;++s){m=h[s].splitWithSegment(l,b);if(m){n=m.lines,n.length>0&&(n.unshift(s,1),Array.prototype.splice.apply(h,n),s+=n.length-2);if(d)for(var t=0,u=m.points.length;t<u;++t)o=m.points[t],o.equals(j)||(p.push(o),g.push(new OpenLayers.Geometry.LineString(p)),o.equals(k)?p=[]:p=[o.clone()])}}}d&&g.length>0&&p.length>0&&(p.push(k.clone()),g.push(new OpenLayers.Geometry.LineString(p)))}else c=a.splitWith(this,b);h&&h.length>1?f=!0:h=[],g&&g.length>1?e=!0:g=[];if(f||e)d?c=[g,h]:c=h;return c},splitWith:function(a,b){return a.split(this,b)},getVertices:function(a){var b;a===!0?b=[this.components[0],this.components[this.components.length-1]]:a===!1?b=this.components.slice(1,this.components.length-1):b=this.components.slice();return b},distanceTo:function(a,b){var c=!b||b.edge!==!1,d=c&&b&&b.details,e,f={},g=Number.POSITIVE_INFINITY;if(a instanceof OpenLayers.Geometry.Point){var h=this.getSortedSegments(),i=a.x,j=a.y,k;for(var l=0,m=h.length;l<m;++l){k=h[l],e=OpenLayers.Geometry.distanceToSegment(a,k);if(e.distance<g){g=e.distance,f=e;if(g===0)break}else if(k.x2>i&&(j>k.y1&&j<k.y2||j<k.y1&&j>k.y2))break}d?f={distance:f.distance,x0:f.x,y0:f.y,x1:i,y1:j}:f=f.distance}else if(a instanceof OpenLayers.Geometry.LineString){var n=this.getSortedSegments(),o=a.getSortedSegments(),p,q,r,s,t,u=o.length,v={point:!0};outer:for(var l=0,m=n.length;l<m;++l){p=n[l],s=p.x1,t=p.y1;for(var w=0;w<u;++w){q=o[w],r=OpenLayers.Geometry.segmentsIntersect(p,q,v);if(r){g=0,f={distance:0,x0:r.x,y0:r.y,x1:r.x,y1:r.y};break outer}e=OpenLayers.Geometry.distanceToSegment({x:s,y:t},q),e.distance<g&&(g=e.distance,f={distance:g,x0:s,y0:t,x1:e.x,y1:e.y})}}d||(f=f.distance);if(g!==0)if(p){e=a.distanceTo(new OpenLayers.Geometry.Point(p.x2,p.y2),b);var x=d?e.distance:e;x<g&&(d?f={distance:g,x0:e.x1,y0:e.y1,x1:e.x0,y1:e.y0}:f=x)}}else f=a.distanceTo(this,b),d&&(f={distance:f.distance,x0:f.x1,y0:f.y1,x1:f.x0,y1:f.y0});return f},CLASS_NAME:"OpenLayers.Geometry.LineString"}),OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforesetfeature","setfeature","beforetransform","transform","transformcomplete"],geometryTypes:null,layer:null,preserveAspectRatio:!1,rotate:!0,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,initialize:function(a,b){this.EVENT_TYPES=OpenLayers.Control.TransformFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES),OpenLayers.Control.prototype.initialize.apply(this,[b]),this.layer=a,this.rotationHandleSymbolizer||(this.rotationHandleSymbolizer={stroke:!1,pointRadius:10,fillOpacity:0,cursor:"pointer"}),this.createBox(),this.createControl()},activate:function(){var a=!1;OpenLayers.Control.prototype.activate.apply(this,arguments)&&(this.dragControl.activate(),this.layer.addFeatures([this.box]),this.rotate&&this.layer.addFeatures(this.rotationHandles),this.layer.addFeatures(this.handles),a=!0);return a},deactivate:function(){var a=!1;OpenLayers.Control.prototype.deactivate.apply(this,arguments)&&(this.layer.removeFeatures(this.handles),this.rotate&&this.layer.removeFeatures(this.rotationHandles),this.layer.removeFeatures([this.box]),this.dragControl.deactivate(),a=!0);return a},setMap:function(a){this.dragControl.setMap(a),OpenLayers.Control.prototype.setMap.apply(this,arguments)},setFeature:function(a,b){b=OpenLayers.Util.applyDefaults(b,{rotation:0,scale:1,ratio:1});var c={feature:a},d=this.rotation,e=this.center;OpenLayers.Util.extend(this,b);if(this.events.triggerEvent("beforesetfeature",c)!==!1){this.feature=a,this.activate(),this._setfeature=!0;var f=this.feature.geometry.getBounds();this.box.move(f.getCenterLonLat()),this.box.geometry.rotate(-d,e),this._angle=0;var g;if(this.rotation){var h=a.geometry.clone();h.rotate(-this.rotation,this.center);var i=new OpenLayers.Feature.Vector(h.getBounds().toGeometry());i.geometry.rotate(this.rotation,this.center),this.box.geometry.rotate(this.rotation,this.center),this.box.move(i.geometry.getBounds().getCenterLonLat());var j=i.geometry.components[0].components[0];g=j.getBounds().getCenterLonLat()}else g=new OpenLayers.LonLat(f.left,f.bottom);this.handles[0].move(g),delete this._setfeature,this.events.triggerEvent("setfeature",c)}},createBox:function(){var a=this;this.center=new OpenLayers.Geometry.Point(0,0);var b=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(0,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,0),new OpenLayers.Geometry.Point(1,1),new OpenLayers.Geometry.Point(0,1),new OpenLayers.Geometry.Point(-1,1),new OpenLayers.Geometry.Point(-1,0),new OpenLayers.Geometry.Point(-1,-1)]),null,typeof this.renderIntent=="string"?null:this.renderIntent);b.geometry.move=function(b,c){a._moving=!0,OpenLayers.Geometry.LineString.prototype.move.apply(this,arguments),a.center.move(b,c),delete a._moving};var c=function(a,b){OpenLayers.Geometry.Point.prototype.move.apply(this,arguments),this._rotationHandle&&this._rotationHandle.geometry.move(a,b),this._handle.geometry.move(a,b)},d=function(a,b,c){OpenLayers.Geometry.Point.prototype.resize.apply(this,arguments),this._rotationHandle&&this._rotationHandle.geometry.resize(a,b,c),this._handle.geometry.resize(a,b,c)},e=function(a,b){OpenLayers.Geometry.Point.prototype.rotate.apply(this,arguments),this._rotationHandle&&this._rotationHandle.geometry.rotate(a,b),this._handle.geometry.rotate(a,b)},f=function(b,c){var d=this.x,e=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,g=!a._setfeature&&a.preserveAspectRatio,h=!g&&(!f||!f.shiftKey),i=new OpenLayers.Geometry.Point(d,e),j=a.center;this.rotate(-a.rotation,j),i.rotate(-a.rotation,j);var k=this.x-j.x,l=this.y-j.y,m=k-(this.x-i.x),n=l-(this.y-i.y);this.x=d,this.y=e;var o,p=1;if(h)o=Math.abs(n)<1e-5?1:l/n,p=(Math.abs(m)<1e-5?1:k/m)/o;else{var q=Math.sqrt(m*m+n*n),r=Math.sqrt(k*k+l*l);o=r/q}a._moving=!0,a.box.geometry.rotate(-a.rotation,j),delete a._moving,a.box.geometry.resize(o,j,p),a.box.geometry.rotate(a.rotation,j),a.transformFeature({scale:o,ratio:p})}},g=function(b,c){var d=this.x,e=this.y;OpenLayers.Geometry.Point.prototype.move.call(this,b,c);if(!a._moving){var f=a.dragControl.handlers.drag.evt,g=f&&f.shiftKey?45:1,h=a.center,i=this.x-h.x,j=this.y-h.y,k=i-b,l=j-c;this.x=d,this.y=e;var m=Math.atan2(l,k),n=Math.atan2(j,i),o=n-m;o*=180/Math.PI,a._angle=(a._angle+o)%360;var p=a.rotation%g;if(Math.abs(a._angle)>=g||p!==0)o=Math.round(a._angle/g)*g-p,a._angle=0,a.box.geometry.rotate(o,h),a.transformFeature({rotation:o})}},h=Array(8),i=Array(4),j,k,l;for(var m=0;m<8;++m)j=b.geometry.components[m],k=new OpenLayers.Feature.Vector(j.clone(),null,typeof this.renderIntent=="string"?null:this.renderIntent),m%2==0&&(l=new OpenLayers.Feature.Vector(j.clone(),null,typeof this.rotationHandleSymbolizer=="string"?null:this.rotationHandleSymbolizer),l.geometry.move=g,j._rotationHandle=l,i[m/2]=l),j.move=c,j.resize=d,j.rotate=e,k.geometry.move=f,j._handle=k,h[m]=k;this.box=b,this.rotationHandles=i,this.handles=h},createControl:function(){var a=this;this.dragControl=new OpenLayers.Control.DragFeature(this.layer,{documentDrag:!0,moveFeature:function(b){this.feature===a.feature&&(this.feature=a.box),OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(b,c){var d=b.geometry;b===a.box&&(a.transformFeature({center:a.center}),a.drawHandles())},onStart:function(b,c){var d=!a.geometryTypes||OpenLayers.Util.indexOf(a.geometryTypes,b.geometry.CLASS_NAME)!==-1,e=OpenLayers.Util.indexOf(a.handles,b);e+=OpenLayers.Util.indexOf(a.rotationHandles,b),b!==a.feature&&b!==a.box&&e==-2&&d&&a.setFeature(b)},onComplete:function(b,c){a.events.triggerEvent("transformcomplete",{feature:b})}})},drawHandles:function(){var a=this.layer;for(var b=0;b<8;++b)this.rotate&&b%2===0&&a.drawFeature(this.rotationHandles[b/2],this.rotationHandleSymbolizer),a.drawFeature(this.handles[b],this.renderIntent)},transformFeature:function(a){if(!this._setfeature){this.scale*=a.scale||1,this.ratio*=a.ratio||1;var b=this.rotation;this.rotation=(this.rotation+(a.rotation||0))%360;if(this.events.triggerEvent("beforetransform",a)!==!1){var c=this.feature,d=c.geometry,e=this.center;d.rotate(-b,e),a.scale||a.ratio?d.resize(a.scale,e,a.ratio):a.center&&c.move(a.center.getBounds().getCenterLonLat()),d.rotate(this.rotation,e),this.layer.drawFeature(c),c.toState(OpenLayers.State.UPDATE),this.events.triggerEvent("transform",a)}}this.layer.drawFeature(this.box,this.renderIntent),this.drawHandles()},destroy:function(){var a;for(var b=0;b<8;++b)a=this.box.geometry.components[b],a._handle.destroy(),a._handle=null,a._rotationHandle&&a._rotationHandle.destroy(),a._rotationHandle=null;this.box.destroy(),this.box=null,this.layer=null,this.dragControl.destroy(),OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.TransformFeature"}),OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{extractWaypoints:!0,extractTracks:!0,extractRoutes:!0,extractAttributes:!0,initialize:function(a){this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=[];if(this.extractTracks){var c=a.getElementsByTagName("trk");for(var d=0,e=c.length;d<e;d++){var f={};this.extractAttributes&&(f=this.parseAttributes(c[d]));var g=this.getElementsByTagNameNS(c[d],c[d].namespaceURI,"trkseg");for(var h=0,i=g.length;h<i;h++){var j=this.extractSegment(g[h],"trkpt");b.push(new OpenLayers.Feature.Vector(j,f))}}}if(this.extractRoutes){var k=a.getElementsByTagName("rte");for(var l=0,m=k.length;l<m;l++){var f={};this.extractAttributes&&(f=this.parseAttributes(k[l]));var n=this.extractSegment(k[l],"rtept");b.push(new OpenLayers.Feature.Vector(n,f))}}if(this.extractWaypoints){var o=a.getElementsByTagName("wpt");for(var p=0,e=o.length;p<e;p++){var f={};this.extractAttributes&&(f=this.parseAttributes(o[p]));var q=new OpenLayers.Geometry.Point(o[p].getAttribute("lon"),o[p].getAttribute("lat"));b.push(new OpenLayers.Feature.Vector(q,f))}}if(this.internalProjection&&this.externalProjection)for(var r=0,s=b.length;r<s;r++)b[r].geometry.transform(this.externalProjection,this.internalProjection);return b},extractSegment:function(a,b){var c=this.getElementsByTagNameNS(a,a.namespaceURI,b),d=[];for(var e=0,f=c.length;e<f;e++)d.push(new OpenLayers.Geometry.Point(c[e].getAttribute("lon"),c[e].getAttribute("lat")));return new OpenLayers.Geometry.LineString(d)},parseAttributes:function(a){var b={},c=a.firstChild;while(c){if(c.nodeType==1){var d=c.firstChild;if(d.nodeType==3||d.nodeType==4)name=c.prefix?c.nodeName.split(":")[1]:c.nodeName,name!="trkseg"&&name!="rtept"&&(b[name]=d.nodeValue)}c=c.nextSibling}return b},CLASS_NAME:"OpenLayers.Format.GPX"}),OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],initialize:function(a){OpenLayers.Geometry.LineString.prototype.initialize.apply(this,arguments)},addComponent:function(a,b){var c=!1,d=this.components.pop();if(b!=null||!a.equals(d))c=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments);var e=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[e]);return c},removeComponent:function(a){if(this.components.length>4){this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var b=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[b])}},move:function(a,b){for(var c=0,d=this.components.length;c<d-1;c++)this.components[c].move(a,b)},rotate:function(a,b){for(var c=0,d=this.components.length;c<d-1;++c)this.components[c].rotate(a,b)},resize:function(a,b,c){for(var d=0,e=this.components.length;d<e-1;++d)this.components[d].resize(a,b,c);return this},transform:function(a,b){if(a&&b){for(var c=0,d=this.components.length;c<d-1;c++){var e=this.components[c];e.transform(a,b)}this.bounds=null}return this},getCentroid:function(){if(this.components&&this.components.length>2){var a=0,b=0;for(var c=0;c<this.components.length-1;c++){var d=this.components[c],e=this.components[c+1];a+=(d.x+e.x)*(d.x*e.y-e.x*d.y),b+=(d.y+e.y)*(d.x*e.y-e.x*d.y)}var f=-1*this.getArea(),g=a/(6*f),h=b/(6*f);return new OpenLayers.Geometry.Point(g,h)}return null},getArea:function(){var a=0;if(this.components&&this.components.length>2){var b=0;for(var c=0,d=this.components.length;c<d-1;c++){var e=this.components[c],f=this.components[c+1];b+=(e.x+f.x)*(f.y-e.y)}a=-b/2}return a},getGeodesicArea:function(a){var b=this;if(a){var c=new OpenLayers.Projection("EPSG:4326");c.equals(a)||(b=this.clone().transform(a,c))}var d=0,e=b.components&&b.components.length;if(e>2){var f,g;for(var h=0;h<e-1;h++)f=b.components[h],g=b.components[h+1],d+=OpenLayers.Util.rad(g.x-f.x)*(2+Math.sin(OpenLayers.Util.rad(f.y))+Math.sin(OpenLayers.Util.rad(g.y)));d=d*6378137*6378137/2}return d},containsPoint:function(a){function f(a,b,c,d,e){return((b-d)*a+(d*c-b*e))/(c-e)}var b=OpenLayers.Number.limitSigDigs,c=14,d=b(a.x,c),e=b(a.y,c),g=this.components.length-1,h,i,j,k,l,m,n,o,p=0;for(var q=0;q<g;++q){h=this.components[q],j=b(h.x,c),k=b(h.y,c),i=this.components[q+1],l=b(i.x,c),m=b(i.y,c);if(k==m){if(e==k)if(j<=l&&(d>=j&&d<=l)||j>=l&&(d<=j&&d>=l)){p=-1;break}continue}n=b(f(e,j,k,l,m),c);if(n==d)if(k<m&&(e>=k&&e<=m)||k>m&&(e<=k&&e>=m)){p=-1;break}if(n<=d)continue;if(j!=l&&(n<Math.min(j,l)||n>Math.max(j,l)))continue;(k<m&&(e>=k&&e<m)||k>m&&(e<k&&e>=m))&&++p}var r=p==-1?1:!!(p&1);return r},intersects:function(a){var b=!1;if(a.CLASS_NAME=="OpenLayers.Geometry.Point")b=this.containsPoint(a);else if(a.CLASS_NAME=="OpenLayers.Geometry.LineString")b=a.intersects(this);else if(a.CLASS_NAME=="OpenLayers.Geometry.LinearRing")b=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[a]);else for(var c=0,d=a.components.length;c<d;++c){b=a.components[c].intersects(this);if(b)break}return b},getVertices:function(a){return a===!0?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"}),OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],initialize:function(a){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},split:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h,i,j=[],k=[a];for(var l=0,m=this.components.length;l<m;++l){f=this.components[l],h=!1;for(var n=0;n<k.length;++n){e=f.split(k[n],b);if(e){if(d){g=e[0];for(var o=0,p=g.length;o<p;++o)o===0&&j.length?j[j.length-1].addComponent(g[o]):j.push(new OpenLayers.Geometry.MultiLineString([g[o]]));h=!0,e=e[1]}if(e.length){e.unshift(n,1),Array.prototype.splice.apply(k,e);break}}}h||(j.length?j[j.length-1].addComponent(f.clone()):j=[new OpenLayers.Geometry.MultiLineString(f.clone())])}j&&j.length>1?h=!0:j=[],k&&k.length>1?i=!0:k=[];if(h||i)d?c=[j,k]:c=k;return c},splitWith:function(a,b){var c=null,d=b&&b.mutual,e,f,g,h,i,j,k;if(a instanceof OpenLayers.Geometry.LineString){k=[],j=[a];for(var l=0,m=this.components.length;l<m;++l){i=!1,f=this.components[l];for(var n=0;n<j.length;++n){e=j[n].split(f,b);if(e){d&&(g=e[0],g.length&&(g.unshift(n,1),Array.prototype.splice.apply(j,g),n+=g.length-2),e=e[1],e.length===0&&(e=[f.clone()]));for(var o=0,p=e.length;o<p;++o)o===0&&k.length?k[k.length-1].addComponent(e[o]):k.push(new OpenLayers.Geometry.MultiLineString([e[o]]));i=!0}}i||(k.length?k[k.length-1].addComponent(f.clone()):k=[new OpenLayers.Geometry.MultiLineString([f.clone()])])}}else c=a.split(this);j&&j.length>1?h=!0:j=[],k&&k.length>1?i=!0:k=[];if(h||i)d?c=[j,k]:c=k;return c},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"}),OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,freehand:!1,freehandToggle:"shiftKey",initialize:function(a,b,c){OpenLayers.Handler.Point.prototype.initialize.apply(this,arguments)},createFeature:function(a){var b=this.control.map.getLonLatFromPixel(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat)),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(){OpenLayers.Handler.Point.prototype.destroyFeature.apply(this),this.line=null},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(a){this.layer.removeFeatures([this.point]);var b=this.control.map.getLonLatFromPixel(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat)),this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length),this.callback("point",[this.point.geometry,this.getGeometry()]),this.callback("modify",[this.point.geometry,this.getSketch()]),this.drawFeature()},freehandMode:function(a){return this.freehandToggle&&a[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(a){var b=this.control.map.getLonLatFromPixel(a);this.point.geometry.x=b.lon,this.point.geometry.y=b.lat,this.callback("modify",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var a=this.line&&this.line.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiLineString([a]));return a},mousedown:function(a){if(this.lastDown&&this.lastDown.equals(a.xy))return!1;this.lastDown==null?(this.persist&&this.destroyFeature(),this.createFeature(a.xy)):(this.lastUp==null||!this.lastUp.equals(a.xy))&&this.addPoint(a.xy),this.mouseDown=!0,this.lastDown=a.xy,this.drawing=!0;return!1},mousemove:function(a){this.drawing&&(this.mouseDown&&this.freehandMode(a)?this.addPoint(a.xy):this.modifyFeature(a.xy));return!0},mouseup:function(a){this.mouseDown=!1;if(this.drawing){this.freehandMode(a)?(this.removePoint(),this.finalize()):(this.lastUp==null&&this.addPoint(a.xy),this.lastUp=a.xy);return!1}return!0},dblclick:function(a){if(!this.freehandMode(a)){var b=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[b]),this.removePoint(),this.finalize()}return!1},CLASS_NAME:"OpenLayers.Handler.Path"}),OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforesplit","split","aftersplit"],layer:null,source:null,sourceOptions:null,tolerance:null,edge:!0,deferDelete:!1,mutual:!0,targetFilter:null,sourceFilter:null,handler:null,initialize:function(a){Array.prototype.push.apply(this.EVENT_TYPES,OpenLayers.Control.prototype.EVENT_TYPES),OpenLayers.Control.prototype.initialize.apply(this,[a]),this.options=a||{},this.options.source&&this.setSource(this.options.source)},setSource:function(a){this.active?(this.deactivate(),this.handler&&(this.handler.destroy(),delete this.handler),this.source=a,this.activate()):this.source=a},activate:function(){var a=OpenLayers.Control.prototype.activate.call(this);a&&(this.source?this.source.events&&this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this}):(this.handler||(this.handler=new OpenLayers.Handler.Path(this,{done:function(a){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(a)})}},{layerOptions:this.sourceOptions})),this.handler.activate()));return a},deactivate:function(){var a=OpenLayers.Control.prototype.deactivate.call(this);a&&(this.source&&this.source.events&&this.layer.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this}));return a},onSketchComplete:function(a){this.feature=null;return!this.considerSplit(a.feature)},afterFeatureModified:function(a){if(a.modified){var b=a.feature;if(b.geometry instanceof OpenLayers.Geometry.LineString||b.geometry instanceof OpenLayers.Geometry.MultiLineString)this.feature=a.feature,this.considerSplit(a.feature)}},removeByGeometry:function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c].geometry===b){a.splice(c,1);break}},isEligible:function(a){return a.state!==OpenLayers.State.DELETE&&(a.geometry instanceof OpenLayers.Geometry.LineString||a.geometry instanceof OpenLayers.Geometry.MultiLineString)&&this.feature!==a&&(!this.targetFilter||this.targetFilter.evaluate(a.attributes))},considerSplit:function(a){sourceSplit=!1,targetSplit=!1;if(!this.sourceFilter||this.sourceFilter.evaluate(a.attributes)){var b=this.layer&&this.layer.features||[],c,d,e,f,g=[],h=[],i=this.layer===this.source&&this.mutual,j={edge:this.edge,tolerance:this.tolerance,mutual:i},k=[a.geometry],l,m,n,o;for(var p=0,q=b.length;p<q;++p){l=b[p];if(this.isEligible(l)){m=[l.geometry];for(var r=0;r<k.length;++r){n=k[r];for(var s=0;s<m.length;++s)c=m[s],n.getBounds().intersectsBounds(c.getBounds())&&(d=n.split(c,j),d&&(f=this.events.triggerEvent("beforesplit",{source:a,target:l}),f!==!1&&(i&&(o=d[0],o.length>1&&(o.unshift(r,1),Array.prototype.splice.apply(k,o),r+=o.length-3),d=d[1]),d.length>1&&(d.unshift(s,1),Array.prototype.splice.apply(m,d),s+=d.length-3))))}m&&m.length>1&&(this.geomsToFeatures(l,m),this.events.triggerEvent("split",{original:l,features:m}),Array.prototype.push.apply(g,m),h.push(l),targetSplit=!0)}}k&&k.length>1&&(this.geomsToFeatures(a,k),this.events.triggerEvent("split",{original:a,features:k}),Array.prototype.push.apply(g,k),h.push(a),sourceSplit=!0);if(sourceSplit||targetSplit){if(this.deferDelete){var t,u=[];for(var p=0,q=h.length;p<q;++p)t=h[p],t.state===OpenLayers.State.INSERT?u.push(t):(t.state=OpenLayers.State.DELETE,this.layer.drawFeature(t));this.layer.destroyFeatures(u,{silent:!0});for(var p=0,q=g.length;p<q;++p)g[p].state=OpenLayers.State.INSERT}else this.layer.destroyFeatures(h,{silent:!0});this.layer.addFeatures(g,{silent:!0}),this.events.triggerEvent("aftersplit",{source:a,features:g})}}return sourceSplit},geomsToFeatures:function(a,b){var c=a.clone();delete c.geometry;var d;for(var e=0,f=b.length;e<f;++e)d=c.clone(),d.geometry=b[e],d.state=OpenLayers.State.INSERT,b[e]=d},destroy:function(){this.active&&this.deactivate(),OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Split"}),OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],initialize:function(a){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},getArea:function(){var a=0;if(this.components&&this.components.length>0){a+=Math.abs(this.components[0].getArea());for(var b=1,c=this.components.length;b<c;b++)a-=Math.abs(this.components[b].getArea())}return a},getGeodesicArea:function(a){var b=0;if(this.components&&this.components.length>0){b+=Math.abs(this.components[0].getGeodesicArea(a));for(var c=1,d=this.components.length;c<d;c++)b-=Math.abs(this.components[c].getGeodesicArea(a))}return b},containsPoint:function(a){var b=this.components.length,c=!1;if(b>0){c=this.components[0].containsPoint(a);if(c!==1)if(c&&b>1){var d;for(var e=1;e<b;++e){d=this.components[e].containsPoint(a);if(d){d===1?c=1:c=!1;break}}}}return c},intersects:function(a){var b=!1,c,d;if(a.CLASS_NAME=="OpenLayers.Geometry.Point")b=this.containsPoint(a);else if(a.CLASS_NAME=="OpenLayers.Geometry.LineString"||a.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){for(c=0,d=this.components.length;c<d;++c){b=a.intersects(this.components[c]);if(b)break}if(!b)for(c=0,d=a.components.length;c<d;++c){b=this.containsPoint(a.components[c]);if(b)break}}else for(c=0,d=a.components.length;c<d;++c){b=this.intersects(a.components[c]);if(b)break}if(!b&&a.CLASS_NAME=="OpenLayers.Geometry.Polygon"){var e=this.components[0];for(c=0,d=e.components.length;c<d;++c){b=a.containsPoint(e.components[c]);if(b)break}}return b},distanceTo:function(a,b){var c=!b||b.edge!==!1,d;!c&&this.intersects(a)?d=0:d=OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[a,b]);return d},CLASS_NAME:"OpenLayers.Geometry.Polygon"}),OpenLayers.Geometry.Polygon.createRegularPolygon=function(a,b,c,d){var e=Math.PI*(1/c-.5);d&&(e+=d/180*Math.PI);var f,g,h,i=[];for(var j=0;j<c;++j)f=e+j*2*Math.PI/c,g=a.x+b*Math.cos(f),h=a.y+b*Math.sin(f),i.push(new OpenLayers.Geometry.Point(g,h));var k=new OpenLayers.Geometry.LinearRing(i);return new OpenLayers.Geometry.Polygon([k])},OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:!1,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},createGeometryFromItem:function(a){var b=this.getElementsByTagNameNS(a,this.georssns,"point"),c=this.getElementsByTagNameNS(a,this.geons,"lat"),d=this.getElementsByTagNameNS(a,this.geons,"long"),e=this.getElementsByTagNameNS(a,this.georssns,"line"),f=this.getElementsByTagNameNS(a,this.georssns,"polygon"),g=this.getElementsByTagNameNS(a,this.georssns,"where"),h=this.getElementsByTagNameNS(a,this.georssns,"box");if(b.length>0||c.length>0&&d.length>0){var i;b.length>0?(i=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s+/),i.length!=2&&(i=OpenLayers.String.trim(b[0].firstChild.nodeValue).split(/\s*,\s*/))):i=[parseFloat(c[0].firstChild.nodeValue),parseFloat(d[0].firstChild.nodeValue)];var j=new OpenLayers.Geometry.Point(parseFloat(i[1]),parseFloat(i[0]))}else if(e.length>0){var k=OpenLayers.String.trim(this.concatChildValues(e[0])).split(/\s+/),l=[],b;for(var m=0,n=k.length;m<n;m+=2)b=new OpenLayers.Geometry.Point(parseFloat(k[m+1]),parseFloat(k[m])),l.push(b);j=new OpenLayers.Geometry.LineString(l)}else if(f.length>0){var k=OpenLayers.String.trim(this.concatChildValues(f[0])).split(/\s+/),l=[],b;for(var m=0,n=k.length;m<n;m+=2)b=new OpenLayers.Geometry.Point(parseFloat(k[m+1]),parseFloat(k[m])),l.push(b);j=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(l)])}else if(g.length>0){this.gmlParser||(this.gmlParser=new OpenLayers.Format.GML({xy:this.xy}));var o=this.gmlParser.parseFeature(g[0]);j=o.geometry}else if(h.length>0){var k=OpenLayers.String.trim(h[0].firstChild.nodeValue).split(/\s+/),l=[],b;k.length>3&&(b=new OpenLayers.Geometry.Point(parseFloat(k[1]),parseFloat(k[0])),l.push(b),b=new OpenLayers.Geometry.Point(parseFloat(k[1]),parseFloat(k[2])),l.push(b),b=new OpenLayers.Geometry.Point(parseFloat(k[3]),parseFloat(k[2])),l.push(b),b=new OpenLayers.Geometry.Point(parseFloat(k[3]),parseFloat(k[0])),l.push(b),b=new OpenLayers.Geometry.Point(parseFloat(k[1]),parseFloat(k[0])),l.push(b)),j=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(l)])}j&&this.internalProjection&&this.externalProjection&&j.transform(this.externalProjection,this.internalProjection);return j},createFeatureFromItem:function(a){var b=this.createGeometryFromItem(a),c=this.getChildValue(a,"*","title",this.featureTitle),d=this.getChildValue(a,"*","description",this.getChildValue(a,"*","content",this.getChildValue(a,"*","summary",this.featureDescription))),e=this.getChildValue(a,"*","link");if(!e)try{e=this.getElementsByTagNameNS(a,"*","link")[0].getAttribute("href")}catch(f){e=null}var g=this.getChildValue(a,"*","id",null),h={title:c,description:d,link:e},i=new OpenLayers.Feature.Vector(b,h);i.fid=g;return i},getChildValue:function(a,b,c,d){var e,f=this.getElementsByTagNameNS(a,b,c);f&&f[0]&&f[0].firstChild&&f[0].firstChild.nodeValue?e=f[0].firstChild.nodeValue:e=d==undefined?"":d;return e},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=null;b=this.getElementsByTagNameNS(a,"*","item"),b.length==0&&(b=this.getElementsByTagNameNS(a,"*","entry"));var c=b.length,d=Array(c);for(var e=0;e<c;e++)d[e]=this.createFeatureFromItem(b[e]);return d},write:function(a){var b;if(a instanceof Array){b=this.createElementNS(this.rssns,"rss");for(var c=0,d=a.length;c<d;c++)b.appendChild(this.createFeatureXML(a[c]))}else b=this.createFeatureXML(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.rssns,"item"),d=this.createElementNS(this.rssns,"title");d.appendChild(this.createTextNode(a.attributes.title?a.attributes.title:""));var e=this.createElementNS(this.rssns,"description");e.appendChild(this.createTextNode(a.attributes.description?a.attributes.description:"")),c.appendChild(d),c.appendChild(e);if(a.attributes.link){var f=this.createElementNS(this.rssns,"link");f.appendChild(this.createTextNode(a.attributes.link)),c.appendChild(f)}for(var g in a.attributes){if(g=="link"||g=="title"||g=="description")continue;var h=this.createTextNode(a.attributes[g]),i=g;g.search(":")!=-1&&(i=g.split(":")[1]);var j=this.createElementNS(this.featureNS,"feature:"+i);j.appendChild(h),c.appendChild(j)}c.appendChild(b);return c},buildGeometryNode:function(a){this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b;if(a.CLASS_NAME=="OpenLayers.Geometry.Polygon")b=this.createElementNS(this.georssns,"georss:polygon"),b.appendChild(this.buildCoordinatesNode(a.components[0]));else if(a.CLASS_NAME=="OpenLayers.Geometry.LineString")b=this.createElementNS(this.georssns,"georss:line"),b.appendChild(this.buildCoordinatesNode(a));else if(a.CLASS_NAME=="OpenLayers.Geometry.Point")b=this.createElementNS(this.georssns,"georss:point"),b.appendChild(this.buildCoordinatesNode(a));else throw"Couldn't parse "+a.CLASS_NAME;return b},buildCoordinatesNode:function(a){var b=null;a.components&&(b=a.components);var c;if(b){var d=b.length,e=Array(d);for(var f=0;f<d;f++)e[f]=b[f].y+" "+b[f].x;c=e.join(" ")}else c=a.y+" "+a.x;return this.createTextNode(c)},CLASS_NAME:"OpenLayers.Format.GeoRSS"}),OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,extractStyles:!1,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(a){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g},this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){this.features=[],this.styles={},this.fetched={};var b={depth:0,styleBaseUrl:this.styleBaseUrl};return this.parseData(a,b)},parseData:function(a,b){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var c=["Link","NetworkLink","Style","StyleMap","Placemark"];for(var d=0,e=c.length;d<e;++d){var f=c[d],g=this.getElementsByTagNameNS(a,"*",f);if(g.length==0)continue;switch(f.toLowerCase()){case"link":case"networklink":this.parseLinks(g,b);break;case"style":this.extractStyles&&this.parseStyles(g,b);break;case"stylemap":this.extractStyles&&this.parseStyleMaps(g,b);break;case"placemark":this.parseFeatures(g,b)}}return this.features},parseLinks:function(a,b){if(b.depth>=this.maxDepth)return!1;var c=OpenLayers.Util.extend({},b);c.depth++;for(var d=0,e=a.length;d<e;d++){var f=this.parseProperty(a[d],"*","href");if(f&&!this.fetched[f]){this.fetched[f]=!0;var g=this.fetchLink(f);g&&this.parseData(g,c)}}},fetchLink:function(a){var b=OpenLayers.Request.GET({url:a,async:!1});if(b)return b.responseText},parseStyles:function(a,b){for(var c=0,d=a.length;c<d;c++){var e=this.parseStyle(a[c]);if(e){var f=(b.styleBaseUrl||"")+"#"+e.id;this.styles[f]=e}}},parseKmlColor:function(a){var b=null;if(a){var c=a.match(this.regExes.kmlColor);c&&(b={color:"#"+c[4]+c[3]+c[2],opacity:parseInt(c[1],16)/255})}return b},parseStyle:function(a){var b={},c=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],d,e,f,g;for(var h=0,i=c.length;h<i;++h){d=c[h],styleTypeNode=this.getElementsByTagNameNS(a,"*",d)[0];if(!styleTypeNode)continue;switch(d.toLowerCase()){case"linestyle":var j=this.parseProperty(styleTypeNode,"*","color"),k=this.parseKmlColor(j);k&&(b.strokeColor=k.color,b.strokeOpacity=k.opacity);var l=this.parseProperty(styleTypeNode,"*","width");l&&(b.strokeWidth=l);break;case"polystyle":var j=this.parseProperty(styleTypeNode,"*","color"),k=this.parseKmlColor(j);k&&(b.fillOpacity=k.opacity,b.fillColor=k.color);var m=this.parseProperty(styleTypeNode,"*","fill");m=="0"&&(b.fillColor="none");var n=this.parseProperty(styleTypeNode,"*","outline");n=="0"&&(b.strokeWidth="0");break;case"iconstyle":var o=parseFloat(this.parseProperty(styleTypeNode,"*","scale")||1),l=32*o,p=32*o,q=this.getElementsByTagNameNS(styleTypeNode,"*","Icon")[0];if(q){var r=this.parseProperty(q,"*","href");if(r){var s=this.parseProperty(q,"*","w"),t=this.parseProperty(q,"*","h"),u="http://maps.google.com/mapfiles/kml";OpenLayers.String.startsWith(r,u)&&!s&&!t&&(s=64,t=64,o=o/2),s=s||t,t=t||s,s&&(l=parseInt(s)*o),t&&(p=parseInt(t)*o);var v=r.match(this.regExes.kmlIconPalette);if(v){var w=v[1],x=v[2],y=this.parseProperty(q,"*","x"),z=this.parseProperty(q,"*","y"),A=y?y/32:0,B=z?7-z/32:7,C=B*8+A;r="http://maps.google.com/mapfiles/kml/pal"+w+"/icon"+C+x}b.graphicOpacity=1,b.externalGraphic=r}}var D=this.getElementsByTagNameNS(styleTypeNode,"*","hotSpot")[0];if(D){var y=parseFloat(D.getAttribute("x")),z=parseFloat(D.getAttribute("y")),E=D.getAttribute("xunits");E=="pixels"?b.graphicXOffset=-y*o:E=="insetPixels"?b.graphicXOffset=-l+y*o:E=="fraction"&&(b.graphicXOffset=-l*y);var F=D.getAttribute("yunits");F=="pixels"?b.graphicYOffset=-p+z*o+1:F=="insetPixels"?b.graphicYOffset=-(z*o)+1:F=="fraction"&&(b.graphicYOffset=-p*(1-z)+1)}b.graphicWidth=l,b.graphicHeight=p;break;case"balloonstyle":var G=OpenLayers.Util.getXmlNodeValue(styleTypeNode);G&&(b.balloonStyle=G.replace(this.regExes.straightBracket,"${$1}"));break;case"labelstyle":var j=this.parseProperty(styleTypeNode,"*","color"),k=this.parseKmlColor(j);k&&(b.fontColor=k.color,b.fontOpacity=k.opacity);break;default:}}!b.strokeColor&&b.fillColor&&(b.strokeColor=b.fillColor);var H=a.getAttribute("id");H&&b&&(b.id=H);return b},parseStyleMaps:function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c],f=this.getElementsByTagNameNS(e,"*","Pair"),g=e.getAttribute("id");for(var h=0,i=f.length;h<i;h++){var j=f[h],k=this.parseProperty(j,"*","key"),l=this.parseProperty(j,"*","styleUrl");l&&k=="normal"&&(this.styles[(b.styleBaseUrl||"")+"#"+g]=this.styles[(b.styleBaseUrl||"")+l]),!l||k!="highlight"}}},parseFeatures:function(a,b){var c=Array(a.length);for(var d=0,e=a.length;d<e;d++){var f=a[d],g=this.parseFeature.apply(this,[f]);if(!g)throw"Bad Placemark: "+d;this.extractStyles&&g.attributes&&g.attributes.styleUrl&&(g.style=this.getStyle(g.attributes.styleUrl,b));if(this.extractStyles){var h=this.getElementsByTagNameNS(f,"*","Style")[0];if(h){var i=this.parseStyle(h);i&&(g.style=OpenLayers.Util.extend(g.style,i))}}c[d]=g}this.features=this.features.concat(c)},parseFeature:function(a){var b=["MultiGeometry","Polygon","LineString","Point"],c,d,e,f;for(var g=0,h=b.length;g<h;++g){c=b[g],this.internalns=a.namespaceURI?a.namespaceURI:this.kmlns,d=this.getElementsByTagNameNS(a,this.internalns,c);if(d.length>0){var f=this.parseGeometry[c.toLowerCase()];f?(e=f.apply(this,[d[0]]),this.internalProjection&&this.externalProjection&&e.transform(this.externalProjection,this.internalProjection)):OpenLayers.Console.error(OpenLayers.i18n("unsupportedGeometryType",{geomType:c}));break}}var i;this.extractAttributes&&(i=this.parseAttributes(a));var j=new OpenLayers.Feature.Vector(e,i),k=a.getAttribute("id")||a.getAttribute("name");k!=null&&(j.fid=k);return j},getStyle:function(a,b){var c=OpenLayers.Util.removeTail(a),d=OpenLayers.Util.extend({},b);d.depth++,d.styleBaseUrl=c;if(!this.styles[a]&&!OpenLayers.String.startsWith(a,"#")&&d.depth<=this.maxDepth&&!this.fetched[c]){var e=this.fetchLink(c);e&&this.parseData(e,d)}var f=OpenLayers.Util.extend({},this.styles[a]);return f},parseGeometry:{point:function(a){var b=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),c=[];if(b.length>0){var d=b[0].firstChild.nodeValue;d=d.replace(this.regExes.removeSpace,""),c=d.split(",")}var e=null;if(c.length>1)c.length==2&&(c[2]=null),e=new OpenLayers.Geometry.Point(c[0],c[1],c[2]);else throw"Bad coordinate string: "+d;return e},linestring:function(a,b){var c=this.getElementsByTagNameNS(a,this.internalns,"coordinates"),d=null;if(c.length>0){var e=this.getChildValue(c[0]);e=e.replace(this.regExes.trimSpace,""),e=e.replace(this.regExes.trimComma,",");var f=e.split(this.regExes.splitSpace),g=f.length,h=Array(g),i,j;for(var k=0;k<g;++k){i=f[k].split(","),j=i.length;if(j>1)i.length==2&&(i[2]=null),h[k]=new OpenLayers.Geometry.Point(i[0],i[1],i[2]);else throw"Bad LineString point coordinates: "+f[k]}if(g)b?d=new OpenLayers.Geometry.LinearRing(h):d=new OpenLayers.Geometry.LineString(h);else throw"Bad LineString coordinates: "+e}return d},polygon:function(a){var b=this.getElementsByTagNameNS(a,this.internalns,"LinearRing"),c=b.length,d=Array(c);if(c>0){var e;for(var f=0,g=b.length;f<g;++f){e=this.parseGeometry.linestring.apply(this,[b[f],!0]);if(e)d[f]=e;else throw"Bad LinearRing geometry: "+f}}return new OpenLayers.Geometry.Polygon(d)},multigeometry:function(a){var b,c,d=[],e=a.childNodes;for(var f=0,g=e.length;f<g;++f){b=e[f];if(b.nodeType==1){var h=b.prefix?b.nodeName.split(":")[1]:b.nodeName,c=this.parseGeometry[h.toLowerCase()];c&&d.push(c.apply(this,[b]))}}return new OpenLayers.Geometry.Collection(d)}},parseAttributes:function(a){var b={},c=a.getElementsByTagName("ExtendedData");c.length&&(b=this.parseExtendedData(c[0]));var d,e,f,g=a.childNodes;for(var h=0,i=g.length;h<i;++h){d=g[h];if(d.nodeType==1){e=d.childNodes;if(e.length>=1&&e.length<=3){var f;switch(e.length){case 1:f=e[0];break;case 2:var j=e[0],k=e[1];f=j.nodeType==3||j.nodeType==4?j:k;break;case 3:default:f=e[1]}if(f.nodeType==3||f.nodeType==4){var l=d.prefix?d.nodeName.split(":")[1]:d.nodeName,m=OpenLayers.Util.getXmlNodeValue(f);m&&(m=m.replace(this.regExes.trimSpace,""),b[l]=m)}}}}return b},parseExtendedData:function(a){var b={},c,d,e,f,g=a.getElementsByTagName("Data");for(c=0,d=g.length;c<d;c++){e=g[c],f=e.getAttribute("name");var h={},i=e.getElementsByTagName("value");i.length&&(h.value=this.getChildValue(i[0]));var j=e.getElementsByTagName("displayName");j.length&&(h.displayName=this.getChildValue(j[0])),b[f]=h}var k=a.getElementsByTagName("SimpleData");for(c=0,d=k.length;c<d;c++){var h={};e=k[c],f=e.getAttribute("name"),h.value=this.getChildValue(e),h.displayName=f,b[f]=h}return b},parseProperty:function(a,b,c){var d,e=this.getElementsByTagNameNS(a,b,c);try{d=OpenLayers.Util.getXmlNodeValue(e[0])}catch(f){d=null}return d},write:function(a){a instanceof Array||(a=[a]);var b=this.createElementNS(this.kmlns,"kml"),c=this.createFolderXML();for(var d=0,e=a.length;d<e;++d)c.appendChild(this.createPlacemarkXML(a[d]));b.appendChild(c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFolderXML:function(){var a=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var b=this.createElementNS(this.kmlns,"name"),c=this.createTextNode(this.foldersName);b.appendChild(c),a.appendChild(b)}if(this.foldersDesc){var d=this.createElementNS(this.kmlns,"description"),e=this.createTextNode(this.foldersDesc);d.appendChild(e),a.appendChild(d)}return a},createPlacemarkXML:function(a){var b=this.createElementNS(this.kmlns,"name"),c=a.style&&a.style.label?a.style.label:a.attributes.name||a.id;b.appendChild(this.createTextNode(c));var d=this.createElementNS(this.kmlns,"description"),e=a.attributes.description||this.placemarksDesc;d.appendChild(this.createTextNode(e));var f=this.createElementNS(this.kmlns,"Placemark");a.fid!=null&&f.setAttribute("id",a.fid),f.appendChild(b),f.appendChild(d);var g=this.buildGeometryNode(a.geometry);f.appendChild(g);return f},buildGeometryNode:function(a){this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME,c=b.substring(b.lastIndexOf(".")+1),d=this.buildGeometry[c.toLowerCase()],e=null;d&&(e=d.apply(this,[a]));return e},buildGeometry:{point:function(a){var b=this.createElementNS(this.kmlns,"Point");b.appendChild(this.buildCoordinatesNode(a));return b},multipoint:function(a){return this.buildGeometry.collection.apply(this,[a])},linestring:function(a){var b=this.createElementNS(this.kmlns,"LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){return this.buildGeometry.collection.apply(this,[a])},linearring:function(a){var b=this.createElementNS(this.kmlns,"LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){var b=this.createElementNS(this.kmlns,"Polygon"),c=a.components,d,e,f;for(var g=0,h=c.length;g<h;++g)f=g==0?"outerBoundaryIs":"innerBoundaryIs",d=this.createElementNS(this.kmlns,f),e=this.buildGeometry.linearring.apply(this,[c[g]]),d.appendChild(e),b.appendChild(d);return b},multipolygon:function(a){return this.buildGeometry.collection.apply(this,[a])},collection:function(a){var b=this.createElementNS(this.kmlns,"MultiGeometry"),c;for(var d=0,e=a.components.length;d<e;++d)c=this.buildGeometryNode.apply(this,[a.components[d]]),c&&b.appendChild(c);return b}},buildCoordinatesNode:function(a){var b=this.createElementNS(this.kmlns,"coordinates"),c,d=a.components;if(d){var e,f=d.length,g=Array(f);for(var h=0;h<f;++h)e=d[h],g[h]=e.x+","+e.y;c=g.join(" ")}else c=a.x+","+a.y;var i=this.createTextNode(c);b.appendChild(i);return b},CLASS_NAME:"OpenLayers.Format.KML"}),OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:!1,interestingTagsExclude:null,areaTags:null,initialize:function(a){var b={interestingTagsExclude:["source","source_ref","source:ref","history","attribution","created_by"],areaTags:["area","building","leisure","tourism","ruins","historic","landuse","military","natural","sport"]};b=OpenLayers.Util.extend(b,a);var c={};for(var d=0;d<b.interestingTagsExclude.length;d++)c[b.interestingTagsExclude[d]]=!0;b.interestingTagsExclude=c;var e={};for(var d=0;d<b.areaTags.length;d++)e[b.areaTags[d]]=!0;b.areaTags=e,this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[b])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=this.getNodes(a),c=this.getWays(a),d=Array(c.length);for(var e=0;e<c.length;e++){var f=Array(c[e].nodes.length),g=this.isWayArea(c[e])?1:0;for(var h=0;h<c[e].nodes.length;h++){var i=b[c[e].nodes[h]],j=new OpenLayers.Geometry.Point(i.lon,i.lat);j.osm_id=parseInt(c[e].nodes[h]),f[h]=j,i.used=!0}var k=null;g?k=new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(f)):k=new OpenLayers.Geometry.LineString(f),this.internalProjection&&this.externalProjection&&k.transform(this.externalProjection,this.internalProjection);var l=new OpenLayers.Feature.Vector(k,c[e].tags);l.osm_id=parseInt(c[e].id),l.fid="way."+l.osm_id,d[e]=l}for(var m in b){var i=b[m];if(!i.used||this.checkTags){var n=null;if(this.checkTags){var o=this.getTags(i.node,!0);if(i.used&&!o[1])continue;n=o[0]}else n=this.getTags(i.node);var l=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(i.lon,i.lat),n);this.internalProjection&&this.externalProjection&&l.geometry.transform(this.externalProjection,this.internalProjection),l.osm_id=parseInt(m),l.fid="node."+l.osm_id,d.push(l)}i.node=null}return d},getNodes:function(a){var b=a.getElementsByTagName("node"),c={};for(var d=0;d<b.length;d++){var e=b[d],f=e.getAttribute("id");c[f]={lat:e.getAttribute("lat"),lon:e.getAttribute("lon"),node:e}}return c},getWays:function(a){var b=a.getElementsByTagName("way"),c=[];for(var d=0;d<b.length;d++){var e=b[d],f={id:e.getAttribute("id")};f.tags=this.getTags(e);var g=e.getElementsByTagName("nd");f.nodes=Array(g.length);for(var h=0;h<g.length;h++)f.nodes[h]=g[h].getAttribute("ref");c.push(f)}return c},getTags:function(a,b){var c=a.getElementsByTagName("tag"),d={},e=!1;for(var f=0;f<c.length;f++){var g=c[f].getAttribute("k");d[g]=c[f].getAttribute("v"),b&&(this.interestingTagsExclude[g]||(e=!0))}return b?[d,e]:d},isWayArea:function(a){var b=!1,c=!1;a.nodes[0]==a.nodes[a.nodes.length-1]&&(b=!0);if(this.checkTags)for(var d in a.tags)if(this.areaTags[d]){c=!0;break}return b&&(this.checkTags?c:!0)},write:function(a){a instanceof Array||(a=[a]),this.osm_id=1,this.created_nodes={};var b=this.createElementNS(null,"osm");b.setAttribute("version","0.5"),b.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var c=a.length-1;c>=0;c--){var d=this.createFeatureNodes(a[c]);for(var e=0;e<d.length;e++)b.appendChild(d[e])}return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureNodes:function(a){var b=[],c=a.geometry.CLASS_NAME,d=c.substring(c.lastIndexOf(".")+1);d=d.toLowerCase();var e=this.createXML[d];e&&(b=e.apply(this,[a]));return b},createXML:{point:function(a){var b=null,c=a.geometry?a.geometry:a,d=!1;a.osm_id?(b=a.osm_id,this.created_nodes[b]&&(d=!0)):(b=-this.osm_id,this.osm_id++);if(d)e=this.created_nodes[b];else var e=this.createElementNS(null,"node");this.created_nodes[b]=e,e.setAttribute("id",b),e.setAttribute("lon",c.x),e.setAttribute("lat",c.y),a.attributes&&this.serializeTags(a,e),this.setState(a,e);return d?[]:[e]},linestring:function(a){var b=[],c=a.geometry;a.osm_id?id=a.osm_id:(id=-this.osm_id,this.osm_id++);var d=this.createElementNS(null,"way");d.setAttribute("id",id);for(var e=0;e<c.components.length;e++){var f=this.createXML.point.apply(this,[c.components[e]]);if(f.length){f=f[0];var g=f.getAttribute("id");b.push(f)}else g=c.components[e].osm_id,f=this.created_nodes[g];this.setState(a,f);var h=this.createElementNS(null,"nd");h.setAttribute("ref",g),d.appendChild(h)}this.serializeTags(a,d),b.push(d);return b},polygon:function(a){var b=OpenLayers.Util.extend({area:"yes"},a.attributes),c=new OpenLayers.Feature.Vector(a.geometry.components[0],b);c.osm_id=a.osm_id;return this.createXML.linestring.apply(this,[c])}},serializeTags:function(a,b){for(var c in a.attributes){var d=this.createElementNS(null,"tag");d.setAttribute("k",c),d.setAttribute("v",a.attributes[c]),b.appendChild(d)}},setState:function(a,b){if(a.state){var c=null;switch(a.state){case OpenLayers.State.UPDATE:c="modify";case OpenLayers.State.DELETE:c="delete"}c&&b.setAttribute("action",c)}},CLASS_NAME:"OpenLayers.Format.OSM"}),OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],initialize:function(a){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"}),OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{polygon:null,initialize:function(a,b,c){OpenLayers.Handler.Path.prototype.initialize.apply(this,arguments)},createFeature:function(a){var b=this.control.map.getLonLatFromPixel(a);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(b.lon,b.lat)),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry])),this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.polygon,this.point],{silent:!0})},destroyFeature:function(){OpenLayers.Handler.Path.prototype.destroyFeature.apply(this),this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var a=this.polygon&&this.polygon.geometry;a&&this.multi&&(a=new OpenLayers.Geometry.MultiPolygon([a]));return a},dblclick:function(a){if(!this.freehandMode(a)){var b=this.line.geometry.components.length-2;this.line.geometry.removeComponent(this.line.geometry.components[b]),this.removePoint(),this.finalize()}return!1},CLASS_NAME:"OpenLayers.Handler.Polygon"}),OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(a,b){OpenLayers.Control.Panel.prototype.initialize.apply(this,[b]),this.addControls([new OpenLayers.Control.Navigation]);var c=[new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Point,{displayClass:"olControlDrawFeaturePoint"}),new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Path,{displayClass:"olControlDrawFeaturePath"}),new OpenLayers.Control.DrawFeature(a,OpenLayers.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon"})];this.addControls(c)},draw:function(){var a=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);this.activateControl(this.controls[0]);return a},CLASS_NAME:"OpenLayers.Control.EditingToolbar"}),OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:["antialiasing","blockout","font","fontcolor","fontsize","fontstyle","glowing","interval","outline","printmode","shadow","transparency"],request:null,response:null,initialize:function(a){this.request=new OpenLayers.Format.ArcXML.Request,this.response=new OpenLayers.Format.ArcXML.Response;if(a)if(a.requesttype=="feature"){this.request.get_image=null;var b=this.request.get_feature.query;this.addCoordSys(b.featurecoordsys,a.featureCoordSys),this.addCoordSys(b.filtercoordsys,a.filterCoordSys),a.polygon?(b.isspatial=!0,b.spatialfilter.polygon=a.polygon):a.envelope&&(b.isspatial=!0,b.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0},this.parseEnvelope(b.spatialfilter.envelope,a.envelope))}else if(a.requesttype=="image"){this.request.get_feature=null;var c=this.request.get_image.properties;this.parseEnvelope(c.envelope,a.envelope),this.addLayers(c.layerlist,a.layers),this.addImageSize(c.imagesize,a.tileSize),this.addCoordSys(c.featurecoordsys,a.featureCoordSys),this.addCoordSys(c.filtercoordsys,a.filterCoordSys)}else this.request=null;OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},parseEnvelope:function(a,b){b&&b.length==4&&(a.minx=b[0],a.miny=b[1],a.maxx=b[2],a.maxy=b[3])},addLayers:function(a,b){for(var c=0,d=b.length;c<d;c++)a.push(b[c])},addImageSize:function(a,b){b!==null&&(a.width=b.w,a.height=b.h,a.printwidth=b.w,a.printheight=b.h)},addCoordSys:function(a,b){typeof b=="string"?(a.id=parseInt(b),a.string=b):typeof b=="object"&&b.proj!==null?(a.id=b.proj.srsProjNumber,a.string=b.proj.srsCode):a=b},iserror:function(a){var b=null;if(a){a=OpenLayers.Format.XML.prototype.read.apply(this,[a]);var c=a.documentElement.getElementsByTagName("ERROR");b=c!==null&&c.length>0}else b=this.response.error!=="";return b},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=null;a&&a.documentElement&&(a.documentElement.nodeName=="ARCXML"?b=a.documentElement:b=a.documentElement.getElementsByTagName("ARCXML")[0]);if(!b){var c,d;try{c=a.firstChild.nodeValue,d=a.firstChild.childNodes[1].firstChild.nodeValue}catch(e){}throw{message:"Error parsing the ArcXML request",error:c,source:d}}var f=this.parseResponse(b);return f},write:function(a){a||(a=this.request);var b=this.createElementNS("","ARCXML");b.setAttribute("version","1.1");var c=this.createElementNS("","REQUEST");if(a.get_image!=null){var d=this.createElementNS("","GET_IMAGE");c.appendChild(d);var e=this.createElementNS("","PROPERTIES");d.appendChild(e);var f=a.get_image.properties;if(f.featurecoordsys!=null){var g=this.createElementNS("","FEATURECOORDSYS");e.appendChild(g),f.featurecoordsys.id===0?g.setAttribute("string",f.featurecoordsys.string):g.setAttribute("id",f.featurecoordsys.id)}if(f.filtercoordsys!=null){var h=this.createElementNS("","FILTERCOORDSYS");e.appendChild(h),f.filtercoordsys.id===0?h.setAttribute("string",f.filtercoordsys.string):h.setAttribute("id",f.filtercoordsys.id)}if(f.envelope!=null){var i=this.createElementNS("","ENVELOPE");e.appendChild(i),i.setAttribute("minx",f.envelope.minx),i.setAttribute("miny",f.envelope.miny),i.setAttribute("maxx",f.envelope.maxx),i.setAttribute("maxy",f.envelope.maxy)}var j=this.createElementNS("","IMAGESIZE");e.appendChild(j),j.setAttribute("height",f.imagesize.height),j.setAttribute("width",f.imagesize.width);if(f.imagesize.height!=f.imagesize.printheight||f.imagesize.width!=f.imagesize.printwidth)j.setAttribute("printheight",f.imagesize.printheight),j.setArrtibute("printwidth",f.imagesize.printwidth);if(f.background!=null){var k=this.createElementNS("","BACKGROUND");e.appendChild(k),k.setAttribute("color",f.background.color.r+","+f.background.color.g+","+f.background.color.b),f.background.transcolor!==null&&k.setAttribute("transcolor",f.background.transcolor.r+","+f.background.transcolor.g+","+f.background.transcolor.b)}if(f.layerlist!=null&&f.layerlist.length>0){var l=this.createElementNS("","LAYERLIST");e.appendChild(l);for(var m=0;m<f.layerlist.length;m++){var n=this.createElementNS("","LAYERDEF");l.appendChild(n),n.setAttribute("id",f.layerlist[m].id),n.setAttribute("visible",f.layerlist[m].visible);if(typeof f.layerlist[m].query=="object"){var o=f.layerlist[m].query;if(o.where.length<0)continue;var p=null;typeof o.spatialfilter=="boolean"&&o.spatialfilter?p=this.createElementNS("","SPATIALQUERY"):p=this.createElementNS("","QUERY"),p.setAttribute("where",o.where),typeof o.accuracy=="number"&&o.accuracy>0&&p.setAttribute("accuracy",o.accuracy),typeof o.featurelimit=="number"&&o.featurelimit<2e3&&p.setAttribute("featurelimit",o.featurelimit),typeof o.subfields=="string"&&o.subfields!="#ALL#"&&p.setAttribute("subfields",o.subfields),typeof o.joinexpression=="string"&&o.joinexpression.length>0&&p.setAttribute("joinexpression",o.joinexpression),typeof o.jointables=="string"&&o.jointables.length>0&&p.setAttribute("jointables",o.jointables),n.appendChild(p)}typeof f.layerlist[m].renderer=="object"&&this.addRenderer(n,f.layerlist[m].renderer)}}}else if(a.get_feature!=null){var d=this.createElementNS("","GET_FEATURES");d.setAttribute("outputmode","newxml"),d.setAttribute("checkesc","true"),a.get_feature.geometry?d.setAttribute("geometry",a.get_feature.geometry):d.setAttribute("geometry","false"),a.get_feature.compact&&d.setAttribute("compact",a.get_feature.compact),a.get_feature.featurelimit=="number"&&d.setAttribute("featurelimit",a.get_feature.featurelimit),d.setAttribute("globalenvelope","true"),c.appendChild(d);if(a.get_feature.layer!=null&&a.get_feature.layer.length>0){var q=this.createElementNS("","LAYER");q.setAttribute("id",a.get_feature.layer),d.appendChild(q)}var r=a.get_feature.query;if(r!=null){var s=null;r.isspatial?s=this.createElementNS("","SPATIALQUERY"):s=this.createElementNS("","QUERY"),d.appendChild(s),typeof r.accuracy=="number"&&s.setAttribute("accuracy",r.accuracy);if(r.featurecoordsys!=null){var t=this.createElementNS("","FEATURECOORDSYS");r.featurecoordsys.id==0?t.setAttribute("string",r.featurecoordsys.string):t.setAttribute("id",r.featurecoordsys.id),s.appendChild(t)}if(r.filtercoordsys!=null){var u=this.createElementNS("","FILTERCOORDSYS");r.filtercoordsys.id===0?u.setAttribute("string",r.filtercoordsys.string):u.setAttribute("id",r.filtercoordsys.id),s.appendChild(u)}if(r.buffer>0){var v=this.createElementNS("","BUFFER");v.setAttribute("distance",r.buffer),s.appendChild(v)}if(r.isspatial){var w=this.createElementNS("","SPATIALFILTER");w.setAttribute("relation",r.spatialfilter.relation),s.appendChild(w);if(r.spatialfilter.envelope){var x=this.createElementNS("","ENVELOPE");x.setAttribute("minx",r.spatialfilter.envelope.minx),x.setAttribute("miny",r.spatialfilter.envelope.miny),x.setAttribute("maxx",r.spatialfilter.envelope.maxx),x.setAttribute("maxy",r.spatialfilter.envelope.maxy),w.appendChild(x)}else typeof r.spatialfilter.polygon=="object"&&w.appendChild(this.writePolygonGeometry(r.spatialfilter.polygon))}r.where!=null&&r.where.length>0&&s.setAttribute("where",r.where)}}b.appendChild(c);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},addGroupRenderer:function(a,b){var c=this.createElementNS("","GROUPRENDERER");a.appendChild(c);for(var d=0;d<b.length;d++){var e=b[d];this.addRenderer(c,e)}},addRenderer:function(a,b){if(b instanceof Array)this.addGroupRenderer(a,b);else{var c=this.createElementNS("",b.type.toUpperCase()+"RENDERER");a.appendChild(c),c.tagName=="VALUEMAPRENDERER"?this.addValueMapRenderer(c,b):c.tagName=="VALUEMAPLABELRENDERER"?this.addValueMapLabelRenderer(c,b):c.tagName=="SIMPLELABELRENDERER"?this.addSimpleLabelRenderer(c,b):c.tagName=="SCALEDEPENDENTRENDERER"&&this.addScaleDependentRenderer(c,b)}},addScaleDependentRenderer:function(a,b){(typeof b.lower=="string"||typeof b.lower=="number")&&a.setAttribute("lower",b.lower),(typeof b.upper=="string"||typeof b.upper=="number")&&a.setAttribute("upper",b.upper),this.addRenderer(a,b.renderer)},addValueMapLabelRenderer:function(a,b){a.setAttribute("lookupfield",b.lookupfield),a.setAttribute("labelfield",b.labelfield);if(typeof b.exacts=="object")for(var c=0,d=b.exacts.length;c<d;c++){var e=b.exacts[c],f=this.createElementNS("","EXACT");typeof e.value=="string"&&f.setAttribute("value",e.value),typeof e.label=="string"&&f.setAttribute("label",e.label),typeof e.method=="string"&&f.setAttribute("method",e.method),a.appendChild(f);if(typeof e.symbol=="object"){var g=null;e.symbol.type=="text"&&(g=this.createElementNS("","TEXTSYMBOL"));if(g!=null){var h=this.fontStyleKeys;for(var i=0,j=h.length;i<j;i++){var k=h[i];e.symbol[k]&&g.setAttribute(k,e.symbol[k])}f.appendChild(g)}}}},addValueMapRenderer:function(a,b){a.setAttribute("lookupfield",b.lookupfield);if(typeof b.ranges=="object")for(var c=0,d=b.ranges.length;c<d;c++){var e=b.ranges[c],f=this.createElementNS("","RANGE");f.setAttribute("lower",e.lower),f.setAttribute("upper",e.upper),a.appendChild(f);if(typeof e.symbol=="object"){var g=null;e.symbol.type=="simplepolygon"&&(g=this.createElementNS("","SIMPLEPOLYGONSYMBOL")),g!=null&&(typeof e.symbol.boundarycolor=="string"&&g.setAttribute("boundarycolor",e.symbol.boundarycolor),typeof e.symbol.fillcolor=="string"&&g.setAttribute("fillcolor",e.symbol.fillcolor),typeof e.symbol.filltransparency=="number"&&g.setAttribute("filltransparency",e.symbol.filltransparency),f.appendChild(g))}}else if(typeof b.exacts=="object")for(var h=0,i=b.exacts.length;h<i;h++){var j=b.exacts[h],k=this.createElementNS("","EXACT");typeof j.value=="string"&&k.setAttribute("value",j.value),typeof j.label=="string"&&k.setAttribute("label",j.label),typeof j.method=="string"&&k.setAttribute("method",j.method),a.appendChild(k);if(typeof j.symbol=="object"){var g=null;j.symbol.type=="simplemarker"&&(g=this.createElementNS("","SIMPLEMARKERSYMBOL")),g!=null&&(typeof j.symbol.antialiasing=="string"&&g.setAttribute("antialiasing",j.symbol.antialiasing),typeof j.symbol.color=="string"&&g.setAttribute("color",j.symbol.color),typeof j.symbol.outline=="string"&&g.setAttribute("outline",j.symbol.outline),typeof j.symbol.overlap=="string"&&g.setAttribute("overlap",j.symbol.overlap),typeof j.symbol.shadow=="string"&&g.setAttribute("shadow",j.symbol.shadow),typeof j.symbol.transparency=="number"&&g.setAttribute("transparency",j.symbol.transparency),typeof j.symbol.usecentroid=="string"&&g.setAttribute("usecentroid",j.symbol.usecentroid),typeof j.symbol.width=="number"&&g.setAttribute("width",j.symbol.width),k.appendChild(g))}}},addSimpleLabelRenderer:function(a,b){a.setAttribute("field",b.field);var c=["featureweight","howmanylabels","labelbufferratio","labelpriorities","labelweight","linelabelposition","rotationalangles"];for(var d=0,e=c.length;d<e;d++){var f=c[d];b[f]&&a.setAttribute(f,b[f])}if(b.symbol.type=="text"){var g=b.symbol,h=this.createElementNS("","TEXTSYMBOL");a.appendChild(h);var c=this.fontStyleKeys;for(var d=0,e=c.length;d<e;d++){var f=c[d];g[f]&&h.setAttribute(f,b[f])}}},writePolygonGeometry:function(a){if(!(a instanceof OpenLayers.Geometry.Polygon))throw{message:"Cannot write polygon geometry to ArcXML with an "+a.CLASS_NAME+" object.",geometry:a};var b=this.createElementNS("","POLYGON");for(var c=0,d=a.components.length;c<d;c++){var e=a.components[c],f=this.createElementNS("","RING");for(var g=0,h=e.components.length;g<h;g++){var i=e.components[g],j=this.createElementNS("","POINT");j.setAttribute("x",i.x),j.setAttribute("y",i.y),f.appendChild(j)}b.appendChild(f)}return b},parseResponse:function(a){if(typeof a=="string"){var b=new OpenLayers.Format.XML;a=b.read(a)}var c=new OpenLayers.Format.ArcXML.Response,d=a.getElementsByTagName("ERROR");if(d!=null&&d.length>0)c.error=this.getChildValue(d,"Unknown error.");else{var e=a.getElementsByTagName("RESPONSE");if(e==null||e.length==0){c.error="No RESPONSE tag found in ArcXML response.";return c}var f=e[0].firstChild.nodeName;f=="#text"&&(f=e[0].firstChild.nextSibling.nodeName);if(f=="IMAGE"){var g=a.getElementsByTagName("ENVELOPE"),h=a.getElementsByTagName("OUTPUT");if(g==null||g.length==0)c.error="No ENVELOPE tag found in ArcXML response.";else if(h==null||h.length==0)c.error="No OUTPUT tag found in ArcXML response.";else{var i=this.parseAttributes(g[0]),j=this.parseAttributes(h[0]);typeof j.type=="string"?c.image={envelope:i,output:{type:j.type,data:this.getChildValue(h[0])}}:c.image={envelope:i,output:j}}}else if(f=="FEATURES"){var k=e[0].getElementsByTagName("FEATURES"),l=k[0].getElementsByTagName("FEATURECOUNT");c.features.featurecount=l[0].getAttribute("count");if(c.features.featurecount>0){var m=k[0].getElementsByTagName("ENVELOPE");c.features.envelope=this.parseAttributes(m[0],typeof 0);var n=k[0].getElementsByTagName("FEATURE");for(var o=0;o<n.length;o++){var p=new OpenLayers.Feature.Vector,q=n[o].getElementsByTagName("FIELD");for(var r=0;r<q.length;r++){var s=q[r].getAttribute("name"),t=q[r].getAttribute("value");p.attributes[s]=t}var u=n[o].getElementsByTagName("POLYGON");if(u.length>0){var v=u[0].getElementsByTagName("RING"),w=[];for(var x=0;x<v.length;x++){var y=[];y.push(this.parsePointGeometry(v[x]));var z=v[x].getElementsByTagName("HOLE");for(var A=0;A<z.length;A++)y.push(this.parsePointGeometry(z[A]));z=null,w.push(new OpenLayers.Geometry.Polygon(y)),y=null}v=null,w.length==1?p.geometry=w[0]:p.geometry=new OpenLayers.Geometry.MultiPolygon(w)}c.features.feature.push(p)}}}else c.error="Unidentified response type."}return c},parseAttributes:function(a,b){var c={};for(var d=0;d<a.attributes.length;d++)b=="number"?c[a.attributes[d].nodeName]=parseFloat(a.attributes[d].nodeValue):c[a.attributes[d].nodeName]=a.attributes[d].nodeValue;return c},parsePointGeometry:function(a){var b=[],c=a.getElementsByTagName("COORDS");if(c.length>0){var d=this.getChildValue(c[0]);d=d.split(/;/);for(var e=0;e<d.length;e++){var f=d[e].split(/ /);b.push(new OpenLayers.Geometry.Point(parseFloat(f[0]),parseFloat(f[1])))}c=null}else{var g=a.getElementsByTagName("POINT");if(g.length>0)for(var h=0;h<g.length;h++)b.push(new OpenLayers.Geometry.Point(parseFloat(g[h].getAttribute("x")),parseFloat(g[h].getAttribute("y"))));g=null}return new OpenLayers.Geometry.LinearRing(b)},CLASS_NAME:"OpenLayers.Format.ArcXML"}),OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(a){var b={get_image:{properties:{background:null,draw:!0,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:!1},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"",legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:!1,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]};return OpenLayers.Util.extend(this,b)},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"}),OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(a){var b={image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""};return OpenLayers.Util.extend(this,b)},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"}),OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(a){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));var b=this.getElementsByTagNameNS(a.documentElement,this.gmlns,this.featureName),c=[];for(var d=0;d<b.length;d++){var e=this.parseFeature(b[d]);e&&c.push(e)}return c},parseFeature:function(a){var b=["MultiPolygon","Polygon","MultiLineString","LineString","MultiPoint","Point","Envelope","Box"],c,d,e,f;for(var g=0;g<b.length;++g){c=b[g],d=this.getElementsByTagNameNS(a,this.gmlns,c);if(d.length>0){f=this.parseGeometry[c.toLowerCase()],f?(e=f.apply(this,[d[0]]),this.internalProjection&&this.externalProjection&&e.transform(this.externalProjection,this.internalProjection)):OpenLayers.Console.error(OpenLayers.i18n("unsupportedGeometryType",{geomType:c}));break}}var h;this.extractAttributes&&(h=this.parseAttributes(a));var i=new OpenLayers.Feature.Vector(e,h);i.gml={featureType:a.firstChild.nodeName.split(":")[1],featureNS:a.firstChild.namespaceURI,featureNSPrefix:a.firstChild.prefix};var j=this.getElementsByTagNameNS(a,this.gmlns,"boundedBy");j.length===1&&(f=this.parseGeometry.box,f&&(i.bounds=f.apply(this,[j[0]])));var k=a.firstChild,l;while(k){if(k.nodeType==1){l=k.getAttribute("fid")||k.getAttribute("id");if(l)break}k=k.nextSibling}i.fid=l;return i},parseGeometry:{point:function(a){var b,c,d=[],b=this.getElementsByTagNameNS(a,this.gmlns,"pos");b.length>0&&(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),d=c.split(this.regExes.splitSpace)),d.length==0&&(b=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),b.length>0&&(c=b[0].firstChild.nodeValue,c=c.replace(this.regExes.removeSpace,""),d=c.split(",")));if(d.length==0){b=this.getElementsByTagNameNS(a,this.gmlns,"coord");if(b.length>0){var e=this.getElementsByTagNameNS(b[0],this.gmlns,"X"),f=this.getElementsByTagNameNS(b[0],this.gmlns,"Y");e.length>0&&f.length>0&&(d=[e[0].firstChild.nodeValue,f[0].firstChild.nodeValue])}}d.length==2&&(d[2]=null);return this.xy?new OpenLayers.Geometry.Point(d[0],d[1],d[2]):new OpenLayers.Geometry.Point(d[1],d[0],d[2])},multipoint:function(a){var b=this.getElementsByTagNameNS(a,this.gmlns,"Point"),c=[];if(b.length>0){var d;for(var e=0;e<b.length;++e)d=this.parseGeometry.point.apply(this,[b[e]]),d&&c.push(d)}return new OpenLayers.Geometry.MultiPoint(c)},linestring:function(a,b){var c,d,e=[],f=[];c=this.getElementsByTagNameNS(a,this.gmlns,"posList");if(c.length>0){d=this.getChildValue(c[0]),d=d.replace(this.regExes.trimSpace,""),e=d.split(this.regExes.splitSpace);var g=parseInt(c[0].getAttribute("dimension")),h,i,j,k;for(var l=0;l<e.length/g;++l)h=l*g,i=e[h],j=e[h+1],k=g==2?null:e[h+2],this.xy?f.push(new OpenLayers.Geometry.Point(i,j,k)):f.push(new OpenLayers.Geometry.Point(j,i,k))}if(e.length==0){c=this.getElementsByTagNameNS(a,this.gmlns,"coordinates");if(c.length>0){d=this.getChildValue(c[0]),d=d.replace(this.regExes.trimSpace,""),d=d.replace(this.regExes.trimComma,",");var m=d.split(this.regExes.splitSpace);for(var l=0;l<m.length;++l)e=m[l].split(","),e.length==2&&(e[2]=null),this.xy?f.push(new OpenLayers.Geometry.Point(e[0],e[1],e[2])):f.push(new OpenLayers.Geometry.Point(e[1],e[0],e[2]))}}var n=null;f.length!=0&&(b?n=new OpenLayers.Geometry.LinearRing(f):n=new OpenLayers.Geometry.LineString(f));return n},multilinestring:function(a){var b=this.getElementsByTagNameNS(a,this.gmlns,"LineString"),c=[];if(b.length>0){var d;for(var e=0;e<b.length;++e)d=this.parseGeometry.linestring.apply(this,[b[e]]),d&&c.push(d)}return new OpenLayers.Geometry.MultiLineString(c)},polygon:function(a){var b=this.getElementsByTagNameNS(a,this.gmlns,"LinearRing"),c=[];if(b.length>0){var d;for(var e=0;e<b.length;++e)d=this.parseGeometry.linestring.apply(this,[b[e],!0]),d&&c.push(d)}return new OpenLayers.Geometry.Polygon(c)},multipolygon:function(a){var b=this.getElementsByTagNameNS(a,this.gmlns,"Polygon"),c=[];if(b.length>0){var d;for(var e=0;e<b.length;++e)d=this.parseGeometry.polygon.apply(this,[b[e]]),d&&c.push(d)}return new OpenLayers.Geometry.MultiPolygon(c)},envelope:function(a){var b=[],c,d,e=this.getElementsByTagNameNS(a,this.gmlns,"lowerCorner");if(e.length>0){var f=[];e.length>0&&(c=e[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),f=c.split(this.regExes.splitSpace)),f.length==2&&(f[2]=null);if(this.xy)var g=new OpenLayers.Geometry.Point(f[0],f[1],f[2]);else var g=new OpenLayers.Geometry.Point(f[1],f[0],f[2])}var h=this.getElementsByTagNameNS(a,this.gmlns,"upperCorner");if(h.length>0){var f=[];h.length>0&&(c=h[0].firstChild.nodeValue,c=c.replace(this.regExes.trimSpace,""),f=c.split(this.regExes.splitSpace)),f.length==2&&(f[2]=null);if(this.xy)var i=new OpenLayers.Geometry.Point(f[0],f[1],f[2]);else var i=new OpenLayers.Geometry.Point(f[1],f[0],f[2])}if(g&&i){b.push(new OpenLayers.Geometry.Point(g.x,g.y)),b.push(new OpenLayers.Geometry.Point(i.x,g.y)),b.push(new OpenLayers.Geometry.Point(i.x,i.y)),b.push(new OpenLayers.Geometry.Point(g.x,i.y)),b.push(new OpenLayers.Geometry.Point(g.x,g.y));var j=new OpenLayers.Geometry.LinearRing(b);d=new OpenLayers.Geometry.Polygon([j])}return d},box:function(a){var b=this.getElementsByTagNameNS(a,this.gmlns,"coordinates"),c,d,e=null,f=null;b.length>0&&(c=b[0].firstChild.nodeValue,d=c.split(" "),d.length==2&&(e=d[0].split(","),f=d[1].split(",")));if(e!==null&&f!==null)return new OpenLayers.Bounds(parseFloat(e[0]),parseFloat(e[1]),parseFloat(f[0]),parseFloat(f[1]))}},parseAttributes:function(a){var b={},c=a.firstChild,d,e,f,g,h,i,j;while(c){if(c.nodeType==1){d=c.childNodes;for(e=0;e<d.length;++e){f=d[e];if(f.nodeType==1){g=f.childNodes;if(g.length==1){h=g[0];if(h.nodeType==3||h.nodeType==4)i=f.prefix?f.nodeName.split(":")[1]:f.nodeName,j=h.nodeValue.replace(this.regExes.trimSpace,""),b[i]=j}else b[f.nodeName.split(":").pop()]=null}}break}c=c.nextSibling}return b},write:function(a){a instanceof Array||(a=[a]);var b=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName);for(var c=0;c<a.length;c++)b.appendChild(this.createFeatureXML(a[c]));return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=a.geometry,c=this.buildGeometryNode(b),d=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);d.appendChild(c);var e=this.createElementNS(this.gmlns,"gml:"+this.featureName),f=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName),g=a.fid||a.id;f.setAttribute("fid",g),f.appendChild(d);for(var h in a.attributes){var i=this.createTextNode(a.attributes[h]),j=h.substring(h.lastIndexOf(":")+1),k=this.createElementNS(this.featureNS,this.featurePrefix+":"+j);k.appendChild(i),f.appendChild(k)}e.appendChild(f);return e},buildGeometryNode:function(a){this.externalProjection&&this.internalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME,c=b.substring(b.lastIndexOf(".")+1),d=this.buildGeometry[c.toLowerCase()];return d.apply(this,[a])},buildGeometry:{point:function(a){var b=this.createElementNS(this.gmlns,"gml:Point");b.appendChild(this.buildCoordinatesNode(a));return b},multipoint:function(a){var b=this.createElementNS(this.gmlns,"gml:MultiPoint"),c=a.components,d,e;for(var f=0;f<c.length;f++)d=this.createElementNS(this.gmlns,"gml:pointMember"),e=this.buildGeometry.point.apply(this,[c[f]]),d.appendChild(e),b.appendChild(d);return b},linestring:function(a){var b=this.createElementNS(this.gmlns,"gml:LineString");b.appendChild(this.buildCoordinatesNode(a));return b},multilinestring:function(a){var b=this.createElementNS(this.gmlns,"gml:MultiLineString"),c=a.components,d,e;for(var f=0;f<c.length;++f)d=this.createElementNS(this.gmlns,"gml:lineStringMember"),e=this.buildGeometry.linestring.apply(this,[c[f]]),d.appendChild(e),b.appendChild(d);return b},linearring:function(a){var b=this.createElementNS(this.gmlns,"gml:LinearRing");b.appendChild(this.buildCoordinatesNode(a));return b},polygon:function(a){var b=this.createElementNS(this.gmlns,"gml:Polygon"),c=a.components,d,e,f;for(var g=0;g<c.length;++g)f=g==0?"outerBoundaryIs":"innerBoundaryIs",d=this.createElementNS(this.gmlns,"gml:"+f),e=this.buildGeometry.linearring.apply(this,[c[g]]),d.appendChild(e),b.appendChild(d);return b},multipolygon:function(a){var b=this.createElementNS(this.gmlns,"gml:MultiPolygon"),c=a.components,d,e;for(var f=0;f<c.length;++f)d=this.createElementNS(this.gmlns,"gml:polygonMember"),e=this.buildGeometry.polygon.apply(this,[c[f]]),d.appendChild(e),b.appendChild(d);return b},bounds:function(a){var b=this.createElementNS(this.gmlns,"gml:Box");b.appendChild(this.buildCoordinatesNode(a));return b}},buildCoordinatesNode:function(a){var b=this.createElementNS(this.gmlns,"gml:coordinates");b.setAttribute("decimal","."),b.setAttribute("cs",","),b.setAttribute("ts"," ");var c=[];if(a instanceof OpenLayers.Bounds)c.push(a.left+","+a.bottom),c.push(a.right+","+a.top);else{var d=a.components?a.components:[a];for(var e=0;e<d.length;e++)c.push(d[e].x+","+d[e].y)}var f=this.createTextNode(c.join(" "));b.appendChild(f);return b},CLASS_NAME:"OpenLayers.Format.GML"}),OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,initialize:function(a){OpenLayers.Format.JSON.prototype.initialize.apply(this,[a])},read:function(a,b,c){b=b?b:"FeatureCollection";var d=null,e=null;typeof a=="string"?e=OpenLayers.Format.JSON.prototype.read.apply(this,[a,c]):e=a;if(e){if(typeof e.type!="string")OpenLayers.Console.error("Bad GeoJSON - no type: "+a);else if(this.isValidType(e,b))switch(b){case"Geometry":try{d=this.parseGeometry(e)}catch(f){OpenLayers.Console.error(f)}break;case"Feature":try{d=this.parseFeature(e),d.type="Feature"}catch(f){OpenLayers.Console.error(f)}break;case"FeatureCollection":d=[];switch(e.type){case"Feature":try{d.push(this.parseFeature(e))}catch(f){d=null,OpenLayers.Console.error(f)}break;case"FeatureCollection":for(var g=0,h=e.features.length;g<h;++g)try{d.push(this.parseFeature(e.features[g]))}catch(f){d=null,OpenLayers.Console.error(f)}break;default:try{var i=this.parseGeometry(e);d.push(new OpenLayers.Feature.Vector(i))}catch(f){d=null,OpenLayers.Console.error(f)}}}}else OpenLayers.Console.error("Bad JSON: "+a);return d},isValidType:function(a,b){var c=!1;switch(b){case"Geometry":OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],a.type)==-1?OpenLayers.Console.error("Unsupported geometry type: "+a.type):c=!0;break;case"FeatureCollection":c=!0;break;default:a.type==b?c=!0:OpenLayers.Console.error("Cannot convert types from "+a.type+" to "+b)}return c},parseFeature:function(a){var b,c,d,e;d=a.properties?a.properties:{},e=a.geometry&&a.geometry.bbox||a.bbox;try{c=this.parseGeometry(a.geometry)}catch(f){throw f}b=new OpenLayers.Feature.Vector(c,d),e&&(b.bounds=OpenLayers.Bounds.fromArray(e)),a.id&&(b.fid=a.id);return b},parseGeometry:function(a){if(a==null)return null;var b,c=!1;if(a.type=="GeometryCollection"){if(!(a.geometries instanceof Array))throw"GeometryCollection must have geometries array: "+a;var d=a.geometries.length,e=Array(d);for(var f=0;f<d;++f)e[f]=this.parseGeometry.apply(this,[a.geometries[f]]);b=new OpenLayers.Geometry.Collection(e),c=!0}else{if(!(a.coordinates instanceof Array))throw"Geometry must have coordinates array: "+a;if(!this.parseCoords[a.type.toLowerCase()])throw"Unsupported geometry type: "+a.type;try{b=this.parseCoords[a.type.toLowerCase()].apply(this,[a.coordinates])}catch(g){throw g}}this.internalProjection&&this.externalProjection&&!c&&b.transform(this.externalProjection,this.internalProjection);return b},parseCoords:{point:function(a){if(this.ignoreExtraDims==!1&&a.length!=2)throw"Only 2D points are supported: "+a;return new OpenLayers.Geometry.Point(a[0],a[1])},multipoint:function(a){var b=[],c=null;for(var d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f}b.push(c)}return new OpenLayers.Geometry.MultiPoint(b)},linestring:function(a){var b=[],c=null;for(var d=0,e=a.length;d<e;++d){try{c=this.parseCoords.point.apply(this,[a[d]])}catch(f){throw f}b.push(c)}return new OpenLayers.Geometry.LineString(b)},multilinestring:function(a){var b=[],c=null;for(var d=0,e=a.length;d<e;++d){try{c=this.parseCoords.linestring.apply(this,[a[d]])}catch(f){throw f}b.push(c)}return new OpenLayers.Geometry.MultiLineString(b)},polygon:function(a){var b=[],c,d;for(var e=0,f=a.length;e<f;++e){try{d=this.parseCoords.linestring.apply(this,[a[e]])}catch(g){throw g}c=new OpenLayers.Geometry.LinearRing(d.components),b.push(c)}return new OpenLayers.Geometry.Polygon(b)},multipolygon:function(a){var b=[],c=null;for(var d=0,e=a.length;d<e;++d){try{c=this.parseCoords.polygon.apply(this,[a[d]])}catch(f){throw f}b.push(c)}return new OpenLayers.Geometry.MultiPolygon(b)},box:function(a){if(a.length!=2)throw"GeoJSON box coordinates must have 2 elements";return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(a[0][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[0][1]),new OpenLayers.Geometry.Point(a[1][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[1][1]),new OpenLayers.Geometry.Point(a[0][0],a[0][1])])])}},write:function(a,b){var c={type:null};if(a instanceof Array){c.type="FeatureCollection";var d=a.length;c.features=Array(d);for(var e=0;e<d;++e){var f=a[e];if(!f instanceof OpenLayers.Feature.Vector){var g="FeatureCollection only supports collections of features: "+f;throw g}c.features[e]=this.extract.feature.apply(this,[f])}}else a.CLASS_NAME.indexOf("OpenLayers.Geometry")==0?c=this.extract.geometry.apply(this,[a]):a instanceof OpenLayers.Feature.Vector&&(c=this.extract.feature.apply(this,[a]),a.layer&&a.layer.projection&&(c.crs=this.createCRSObject(a)));return OpenLayers.Format.JSON.prototype.write.apply(this,[c,b])},createCRSObject:function(a){var b=a.layer.projection.toString(),c={};if(b.match(/epsg:/i)){var d=parseInt(b.substring(b.indexOf(":")+1));d==4326?c={type:"OGC",properties:{urn:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:c={type:"EPSG",properties:{code:d}}}return c},extract:{feature:function(a){var b=this.extract.geometry.apply(this,[a.geometry]);return{type:"Feature",id:a.fid==null?a.id:a.fid,properties:a.attributes,geometry:b}},geometry:function(a){if(a==null)return null;this.internalProjection&&this.externalProjection&&(a=a.clone(),a.transform(this.internalProjection,this.externalProjection));var b=a.CLASS_NAME.split(".")[2],c=this.extract[b.toLowerCase()].apply(this,[a]),d;b=="Collection"?d={type:"GeometryCollection",geometries:c}:d={type:b,coordinates:c};return d},point:function(a){return[a.x,a.y]},multipoint:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},linestring:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push(this.extract.point.apply(this,[a.components[c]]));return b},multilinestring:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,[a.components[c]]));return b},polygon:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push(this.extract.linestring.apply(this,[a.components[c]]));return b},multipolygon:function(a){var b=[];for(var c=0,d=a.components.length;c<d;++c)b.push(this.extract.polygon.apply(this,[a.components[c]]));return b},collection:function(a){var b=a.components.length,c=Array(b);for(var d=0;d<b;++d)c[d]=this.extract.geometry.apply(this,[a.components[d]]);return c}},CLASS_NAME:"OpenLayers.Format.GeoJSON"}),OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){var b=new OpenLayers.Format.ArcXML,c=b.read(a);return c.features.feature}}),OpenLayers.Format.GML||(OpenLayers.Format.GML={}),OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:!0,srsName:null,xy:!0,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]),this.setGeometryTypes(),a&&a.featureNS&&this.setNamespace("feature",a.featureNS),this.singleFeatureType=!a||typeof a.featureType==="string"},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a])),a&&a.nodeType==9&&(a=a.documentElement);var b=[];this.readNode(a,{features:b});if(b.length==0){var c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMember");if(c.length)for(var d=0,e=c.length;d<e;++d)this.readNode(c[d],{features:b});else{var c=this.getElementsByTagNameNS(a,this.namespaces.gml,"featureMembers");c.length&&this.readNode(c[0],{features:b})}}return b},readers:{gml:{featureMember:function(a,b){this.readChildNodes(a,b)},featureMembers:function(a,b){this.readChildNodes(a,b)},name:function(a,b){b.name=this.getChildValue(a)},boundedBy:function(a,b){var c={};this.readChildNodes(a,c),c.components&&c.components.length>0&&(b.bounds=c.components[0])},Point:function(a,b){var c={points:[]};this.readChildNodes(a,c),b.components||(b.components=[]),b.components.push(c.points[0])},coordinates:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,"");c=c.replace(this.regExes.trimComma,",");var d=c.split(this.regExes.splitSpace),e,f=d.length,g=Array(f);for(var h=0;h<f;++h)e=d[h].split(","),this.xy?g[h]=new OpenLayers.Geometry.Point(e[0],e[1],e[2]):g[h]=new OpenLayers.Geometry.Point(e[1],e[0],e[2]);b.points=g},coord:function(a,b){var c={};this.readChildNodes(a,c),b.points||(b.points=[]),b.points.push(new OpenLayers.Geometry.Point(c.x,c.y,c.z))},X:function(a,b){b.x=this.getChildValue(a)},Y:function(a,b){b.y=this.getChildValue(a)},Z:function(a,b){b.z=this.getChildValue(a)},MultiPoint:function(a,b){var c={components:[]};this.readChildNodes(a,c),b.components=[new OpenLayers.Geometry.MultiPoint(c.components)]},pointMember:function(a,b){this.readChildNodes(a,b)},LineString:function(a,b){var c={};this.readChildNodes(a,c),b.components||(b.components=[]),b.components.push(new OpenLayers.Geometry.LineString(c.points))},MultiLineString:function(a,b){var c={components:[]};this.readChildNodes(a,c),b.components=[new OpenLayers.Geometry.MultiLineString(c.components)]},lineStringMember:function(a,b){this.readChildNodes(a,b)},Polygon:function(a,b){var c={outer:null,inner:[]};this.readChildNodes(a,c),c.inner.unshift(c.outer),b.components||(b.components=[]),b.components.push(new OpenLayers.Geometry.Polygon(c.inner))},LinearRing:function(a,b){var c={};this.readChildNodes(a,c),b.components=[new OpenLayers.Geometry.LinearRing(c.points)]},MultiPolygon:function(a,b){var c={components:[]};this.readChildNodes(a,c),b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)]},polygonMember:function(a,b){this.readChildNodes(a,b)},GeometryCollection:function(a,b){var c={components:[]};this.readChildNodes(a,c),b.components=[new OpenLayers.Geometry.Collection(c.components)]},geometryMember:function(a,b){this.readChildNodes(a,b)}},feature:{"*":function(a,b){var c,d=a.localName||a.nodeName.split(":").pop();b.features?this.singleFeatureType||OpenLayers.Util.indexOf(this.featureType,d)===-1?d===this.featureType&&(c="_typeName"):c="_typeName":a.childNodes.length==0||a.childNodes.length==1&&a.firstChild.nodeType==3?this.extractAttributes&&(c="_attribute"):c="_geometry",c&&this.readers.feature[c].apply(this,[a,b])},_typeName:function(a,b){var c={components:[],attributes:{}};this.readChildNodes(a,c),c.name&&(c.attributes.name=c.name);var d=new OpenLayers.Feature.Vector(c.components[0],c.attributes);this.singleFeatureType||(d.type=a.nodeName.split(":").pop(),d.namespace=a.namespaceURI);var e=a.getAttribute("fid")||this.getAttributeNS(a,this.namespaces.gml,"id");e&&(d.fid=e),this.internalProjection&&this.externalProjection&&d.geometry&&d.geometry.transform(this.externalProjection,this.internalProjection),c.bounds&&(d.bounds=c.bounds),b.features.push(d)},_geometry:function(a,b){this.readChildNodes(a,b)},_attribute:function(a,b){var c=a.localName||a.nodeName.split(":").pop(),d=this.getChildValue(a);b.attributes[c]=d}},wfs:{FeatureCollection:function(a,b){this.readChildNodes(a,b)}}},write:function(a){var b;a instanceof Array?b="featureMembers":b="featureMember";var c=this.writeNode("gml:"+b,a);this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},writers:{gml:{featureMember:function(a){var b=this.createElementNSPlus("gml:featureMember");this.writeNode("feature:_typeName",a,b);return b},MultiPoint:function(a){var b=this.createElementNSPlus("gml:MultiPoint");for(var c=0;c<a.components.length;++c)this.writeNode("pointMember",a.components[c],b);return b},pointMember:function(a){var b=this.createElementNSPlus("gml:pointMember");this.writeNode("Point",a,b);return b},MultiLineString:function(a){var b=this.createElementNSPlus("gml:MultiLineString");for(var c=0;c<a.components.length;++c)this.writeNode("lineStringMember",a.components[c],b);return b},lineStringMember:function(a){var b=this.createElementNSPlus("gml:lineStringMember");this.writeNode("LineString",a,b);return b},MultiPolygon:function(a){var b=this.createElementNSPlus("gml:MultiPolygon");for(var c=0;c<a.components.length;++c)this.writeNode("polygonMember",a.components[c],b);return b},polygonMember:function(a){var b=this.createElementNSPlus("gml:polygonMember");this.writeNode("Polygon",a,b);return b},GeometryCollection:function(a){var b=this.createElementNSPlus("gml:GeometryCollection");for(var c=0,d=a.components.length;c<d;++c)this.writeNode("geometryMember",a.components[c],b);return b},geometryMember:function(a){var b=this.createElementNSPlus("gml:geometryMember"),c=this.writeNode("feature:_geometry",a);b.appendChild(c.firstChild);return b}},feature:{_typeName:function(a){var b=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:a.fid}});a.geometry&&this.writeNode("feature:_geometry",a.geometry,b);for(var c in a.attributes){var d=a.attributes[c];d!=null&&this.writeNode("feature:_attribute",{name:c,value:d},b)}return b},_geometry:function(a){this.externalProjection&&this.internalProjection&&(a=a.clone().transform(this.internalProjection,this.externalProjection));var b=this.createElementNSPlus("feature:"+this.geometryName),c=this.geometryTypes[a.CLASS_NAME],d=this.writeNode("gml:"+c,a,b);this.srsName&&d.setAttribute("srsName",this.srsName);return b},_attribute:function(a){return this.createElementNSPlus("feature:"+a.name,{value:a.value})}},wfs:{FeatureCollection:function(a){var b=this.createElementNSPlus("wfs:FeatureCollection");for(var c=0,d=a.length;c<d;++c)this.writeNode("gml:featureMember",a[c],b);return b}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"}),OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(a,b){OpenLayers.Format.GML.prototype.initialize.apply(this,[a]),this.layer=b,this.layer.featureNS&&(this.featureNS=this.layer.featureNS),this.layer.options.geometry_column&&(this.geometryName=this.layer.options.geometry_column),this.layer.options.typename&&(this.featureName=this.layer.options.typename)},write:function(a){var b=this.createElementNS(this.wfsns,"wfs:Transaction");b.setAttribute("version","1.0.0"),b.setAttribute("service","WFS");for(var c=0;c<a.length;c++)switch(a[c].state){case OpenLayers.State.INSERT:b.appendChild(this.insert(a[c]));break;case OpenLayers.State.UPDATE:b.appendChild(this.update(a[c]));break;case OpenLayers.State.DELETE:b.appendChild(this.remove(a[c]))}return OpenLayers.Format.XML.prototype.write.apply(this,[b])},createFeatureXML:function(a){var b=this.buildGeometryNode(a.geometry),c=this.createElementNS(this.featureNS,"feature:"+this.geometryName);c.appendChild(b);var d=this.createElementNS(this.featureNS,"feature:"+this.featureName);d.appendChild(c);for(var e in a.attributes){var f=this.createTextNode(a.attributes[e]),g=e;e.search(":")!=-1&&(g=e.split(":")[1]);var h=this.createElementNS(this.featureNS,"feature:"+g);h.appendChild(f),d.appendChild(h)}return d},insert:function(a){var b=this.createElementNS(this.wfsns,"wfs:Insert");b.appendChild(this.createFeatureXML(a));return b},update:function(a){a.fid||OpenLayers.Console.userError(OpenLayers.i18n("noFID"));var b=this.createElementNS(this.wfsns,"wfs:Update");b.setAttribute("typeName",this.featurePrefix+":"+this.featureName),b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var c=this.createElementNS(this.wfsns,"wfs:Property"),d=this.createElementNS(this.wfsns,"wfs:Name"),e=this.createTextNode(this.geometryName);d.appendChild(e),c.appendChild(d);var f=this.createElementNS(this.wfsns,"wfs:Value"),g=this.buildGeometryNode(a.geometry);a.layer&&g.setAttribute("srsName",a.layer.projection.getCode()),f.appendChild(g),c.appendChild(f),b.appendChild(c);for(var h in a.attributes)c=this.createElementNS(this.wfsns,"wfs:Property"),d=this.createElementNS(this.wfsns,"wfs:Name"),d.appendChild(this.createTextNode(h)),c.appendChild(d),f=this.createElementNS(this.wfsns,"wfs:Value"),f.appendChild(this.createTextNode(a.attributes[h])),c.appendChild(f),b.appendChild(c);var i=this.createElementNS(this.ogcns,"ogc:Filter"),j=this.createElementNS(this.ogcns,"ogc:FeatureId");j.setAttribute("fid",a.fid),i.appendChild(j),b.appendChild(i);return b},remove:function(a){if(!a.fid){OpenLayers.Console.userError(OpenLayers.i18n("noFID"));return!1}var b=this.createElementNS(this.wfsns,"wfs:Delete");b.setAttribute("typeName",this.featurePrefix+":"+this.featureName),b.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var c=this.createElementNS(this.ogcns,"ogc:Filter"),d=this.createElementNS(this.ogcns,"ogc:FeatureId");d.setAttribute("fid",a.fid),c.appendChild(d),b.appendChild(c);return b},destroy:function(){this.layer=null},CLASS_NAME:"OpenLayers.Format.WFS"}),OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:"9.2",ServiceName:""},tileSize:null,featureCoordSys:"4326",filterCoordSys:"4326",layers:null,async:!0,name:"ArcIMS",isBaseLayer:!0,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:"4326",filterCoordSys:"4326",layers:null,isBaseLayer:!0,async:!0,name:"ArcIMS"},initialize:function(a,b,c){this.tileSize=new OpenLayers.Size(512,512),this.params=OpenLayers.Util.applyDefaults({ServiceName:c.serviceName},this.DEFAULT_PARAMS),this.options=OpenLayers.Util.applyDefaults(c,this.DEFAULT_OPTIONS),OpenLayers.Layer.Grid.prototype.initialize.apply(this,[a,b,this.params,c]),this.transparent&&(this.isBaseLayer||(this.isBaseLayer=!1),this.format=="image/jpeg"&&(this.format=OpenLayers.Util.alphaHack()?"image/gif":"image/png")),this.options.layers===null&&(this.options.layers=[])},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},getURL:function(a){var b="";a=this.adjustBounds(a);var c=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:a.toArray(),tileSize:this.tileSize})),d=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:c.write(),async:!1});if(d!=null){var e=d.responseXML;if(!e||!e.documentElement)e=d.responseText;var f=new OpenLayers.Format.ArcXML,g=f.read(e);b=this.getUrlOrImage(g.image.output)}return b},getURLasync:function(a,b,c,d){a=this.adjustBounds(a);var e=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:a.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(),async:!0,data:e.write(),callback:function(a){var e=a.responseXML;if(!e||!e.documentElement)e=a.responseText;var f=new OpenLayers.Format.ArcXML,g=f.read(e);b[c]=this.getUrlOrImage(g.image.output),d.apply(b)},scope:this})},getUrlOrImage:function(a){var b="";a.url?b=a.url:a.data&&(b="data:image/"+a.type+";base64,"+a.data);return b},setLayerQuery:function(a,b){for(var c=0;c<this.options.layers.length;c++)if(a==this.options.layers[c].id){this.options.layers[c].query=b;return}this.options.layers.push({id:a,visible:!0,query:b})},getFeatureInfo:function(a,b,c){var d=c.buffer||1,e=c.callback||function(){},f=c.scope||window,g={};OpenLayers.Util.extend(g,this.options),g.requesttype="feature",a instanceof OpenLayers.LonLat?(g.polygon=null,g.envelope=[a.lon-d,a.lat-d,a.lon+d,a.lat+d]):a instanceof OpenLayers.Geometry.Polygon&&(g.envelope=null,g.polygon=a);var h=new OpenLayers.Format.ArcXML(g);OpenLayers.Util.extend(h.request.get_feature,c),h.request.get_feature.layer=b.id;if(typeof b.query.accuracy=="number")h.request.get_feature.query.accuracy=b.query.accuracy;else{var i=this.map.getCenter(),j=this.map.getViewPortPxFromLonLat(i);j.x++;var k=this.map.getLonLatFromPixel(j);h.request.get_feature.query.accuracy=k.lon-i.lon}h.request.get_feature.query.where=b.query.where,h.request.get_feature.query.spatialfilter.relation="area_intersection",OpenLayers.Request.POST({url:this.getFullRequestString({CustomService:"Query"}),data:h.write(),callback:function(a){var b=h.parseResponse(a.responseText);h.iserror()?e.call(f,null):e.call(f,b.features)}})},addTile:function(a,b){return new OpenLayers.Tile.Image(this,b,a,null,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.ArcIMS"}),OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c),b.outer=c.components[0]},innerBoundaryIs:function(a,b){var c={};this.readChildNodes(a,c),b.inner.push(c.components[0])},Box:function(a,b){var c={};this.readChildNodes(a,c),b.components||(b.components=[]);var d=c.points[0],e=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,d.y,e.x,e.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){var b;a instanceof Array?b="wfs:FeatureCollection":b="gml:featureMember";var c=this.writeNode(b,a);this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("coordinates",[a],b);return b},coordinates:function(a){var b=a.length,c=Array(b),d;for(var e=0;e<b;++e)d=a[e],this.xy?c[e]=d.x+","+d.y:c[e]=d.y+","+d.x,d.z!=undefined&&(c[e]+=","+d.z);return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:b==1?c[0]:c.join(" ")})},LineString:function(a){var b=this.createElementNSPlus("gml:LineString");this.writeNode("coordinates",a.components,b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",a.components[0],b);for(var c=1;c<a.components.length;++c)this.writeNode("innerBoundaryIs",a.components[c],b);return b},outerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:outerBoundaryIs");this.writeNode("LinearRing",a,b);return b},innerBoundaryIs:function(a){var b=this.createElementNSPlus("gml:innerBoundaryIs");this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("coordinates",a.components,b);return b},Box:function(a){var b=this.createElementNSPlus("gml:Box");this.writeNode("coordinates",[{x:a.left,y:a.bottom},{x:a.right,y:a.top}],b),this.srsName&&b.setAttribute("srsName",this.srsName);return b}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},CLASS_NAME:"OpenLayers.Format.GML.v2"}),OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:!1,multiCurve:!0,surface:!1,multiSurface:!0,initialize:function(a){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[a])},readers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(a,b){this.readChildNodes(a,b)},Curve:function(a,b){var c={points:[]};this.readChildNodes(a,c),b.components||(b.components=[]),b.components.push(new OpenLayers.Geometry.LineString(c.points))},segments:function(a,b){this.readChildNodes(a,b)},LineStringSegment:function(a,b){var c={};this.readChildNodes(a,c),c.points&&Array.prototype.push.apply(b.points,c.points)},pos:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),d=c.split(this.regExes.splitSpace),e;this.xy?e=new OpenLayers.Geometry.Point(d[0],d[1],d[2]):e=new OpenLayers.Geometry.Point(d[1],d[0],d[2]),b.points=[e]},posList:function(a,b){var c=this.getChildValue(a).replace(this.regExes.trimSpace,""),d=c.split(this.regExes.splitSpace),e=parseInt(a.getAttribute("dimension"))||2,f,g,h,i,j=d.length/e,k=Array(j);for(var l=0,m=d.length;l<m;l+=e)g=d[l],h=d[l+1],i=e==2?undefined:d[l+2],this.xy?k[l/e]=new OpenLayers.Geometry.Point(g,h,i):k[l/e]=new OpenLayers.Geometry.Point(h,g,i);b.points=k},Surface:function(a,b){this.readChildNodes(a,b)},patches:function(a,b){this.readChildNodes(a,b)},PolygonPatch:function(a,b){this.readers.gml.Polygon.apply(this,[a,b])},exterior:function(a,b){var c={};this.readChildNodes(a,c),b.outer=c.components[0]},interior:function(a,b){var c={};this.readChildNodes(a,c),b.inner.push(c.components[0])},MultiCurve:function(a,b){var c={components:[]};this.readChildNodes(a,c),c.components.length>0&&(b.components=[new OpenLayers.Geometry.MultiLineString(c.components)])},curveMember:function(a,b){this.readChildNodes(a,b)},MultiSurface:function(a,b){var c={components:[]};this.readChildNodes(a,c),c.components.length>0&&(b.components=[new OpenLayers.Geometry.MultiPolygon(c.components)])},surfaceMember:function(a,b){this.readChildNodes(a,b)},surfaceMembers:function(a,b){this.readChildNodes(a,b)},pointMembers:function(a,b){this.readChildNodes(a,b)},lineStringMembers:function(a,b){this.readChildNodes(a,b)},polygonMembers:function(a,b){this.readChildNodes(a,b)},geometryMembers:function(a,b){this.readChildNodes(a,b)},Envelope:function(a,b){var c={points:Array(2)};this.readChildNodes(a,c),b.components||(b.components=[]);var d=c.points[0],e=c.points[1];b.components.push(new OpenLayers.Bounds(d.x,d.y,e.x,e.y))},lowerCorner:function(a,b){var c={};this.readers.gml.pos.apply(this,[a,c]),b.points[0]=c.points[0]},upperCorner:function(a,b){var c={};this.readers.gml.pos.apply(this,[a,c]),b.points[1]=c.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(a){var b;a instanceof Array?b="featureMembers":b="featureMember";var c=this.writeNode("gml:"+b,a);this.setAttributeNS(c,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[c])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(a){var b=this.createElementNSPlus("gml:featureMembers");for(var c=0,d=a.length;c<d;++c)this.writeNode("feature:_typeName",a[c],b);return b},Point:function(a){var b=this.createElementNSPlus("gml:Point");this.writeNode("pos",a,b);return b},pos:function(a){var b=this.xy?a.x+" "+a.y:a.y+" "+a.x;return this.createElementNSPlus("gml:pos",{value:b})},LineString:function(a){var b=this.createElementNSPlus("gml:LineString");this.writeNode("posList",a.components,b);return b},Curve:function(a){var b=this.createElementNSPlus("gml:Curve");this.writeNode("segments",a,b);return b},segments:function(a){var b=this.createElementNSPlus("gml:segments");this.writeNode("LineStringSegment",a,b);return b},LineStringSegment:function(a){var b=this.createElementNSPlus("gml:LineStringSegment");this.writeNode("posList",a.components,b);return b},posList:function(a){var b=a.length,c=Array(b),d;for(var e=0;e<b;++e)d=a[e],this.xy?c[e]=d.x+" "+d.y:c[e]=d.y+" "+d.x;return this.createElementNSPlus("gml:posList",{value:c.join(" ")})},Surface:function(a){var b=this.createElementNSPlus("gml:Surface");this.writeNode("patches",a,b);return b},patches:function(a){var b=this.createElementNSPlus("gml:patches");this.writeNode("PolygonPatch",a,b);return b},PolygonPatch:function(a){var b=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",a.components[0],b);for(var c=1,d=a.components.length;c<d;++c)this.writeNode("interior",a.components[c],b);return b},Polygon:function(a){var b=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",a.components[0],b);for(var c=1,d=a.components.length;c<d;++c)this.writeNode("interior",a.components[c],b);return b},exterior:function(a){var b=this.createElementNSPlus("gml:exterior");this.writeNode("LinearRing",a,b);return b},interior:function(a){var b=this.createElementNSPlus("gml:interior");this.writeNode("LinearRing",a,b);return b},LinearRing:function(a){var b=this.createElementNSPlus("gml:LinearRing");this.writeNode("posList",a.components,b);return b},MultiCurve:function(a){var b=this.createElementNSPlus("gml:MultiCurve");for(var c=0,d=a.components.length;c<d;++c)this.writeNode("curveMember",a.components[c],b);return b},curveMember:function(a){var b=this.createElementNSPlus("gml:curveMember");this.curve?this.writeNode("Curve",a,b):this.writeNode("LineString",a,b);return b},MultiSurface:function(a){var b=this.createElementNSPlus("gml:MultiSurface");for(var c=0,d=a.components.length;c<d;++c)this.writeNode("surfaceMember",a.components[c],b);return b},surfaceMember:function(a){var b=this.createElementNSPlus("gml:surfaceMember");this.surface?this.writeNode("Surface",a,b):this.writeNode("Polygon",a,b);return b},Envelope:function(a){var b=this.createElementNSPlus("gml:Envelope");this.writeNode("lowerCorner",a,b),this.writeNode("upperCorner",a,b),this.srsName&&b.setAttribute("srsName",this.srsName);return b},lowerCorner:function(a){var b=this.xy?a.left+" "+a.bottom:a.bottom+" "+a.left;return this.createElementNSPlus("gml:lowerCorner",{value:b})},upperCorner:function(a){var b=this.xy?a.right+" "+a.top:a.top+" "+a.right;return this.createElementNSPlus("gml:upperCorner",{value:b})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":this.curve===!0?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":this.multiCurve===!1?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":this.surface===!0?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":this.multiSurface===!1?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"}),OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:!1,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a]));return this.parseFeatures(a)},write:function(a){var b;if(a instanceof Array){b=this.createElementNSPlus("atom:feed"),b.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle}));for(var c=0,d=a.length;c<d;c++)b.appendChild(this.buildEntryNode(a[c]))}else b=this.buildEntryNode(a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},buildContentNode:function(a){var b=this.createElementNSPlus("atom:content",{attributes:{type:a.type||null}});if(a.src)b.setAttribute("src",a.src);else if(a.type=="text"||a.type==null)b.appendChild(this.createTextNode(a.value));else if(a.type=="html"){if(typeof a.value!="string")throw"HTML content must be in form of an escaped string";b.appendChild(this.createTextNode(a.value))}else a.type=="xhtml"?b.appendChild(a.value):a.type=="xhtml"||a.type.match(/(\+|\/)xml$/)?b.appendChild(a.value):b.appendChild(this.createTextNode(a.value));return b},buildEntryNode:function(a){var b=a.attributes,c=b.atom||{},d=this.createElementNSPlus("atom:entry");if(c.authors){var e=c.authors instanceof Array?c.authors:[c.authors];for(var f=0,g=e.length;f<g;f++)d.appendChild(this.buildPersonConstructNode("author",e[f]))}if(c.categories){var h=c.categories instanceof Array?c.categories:[c.categories],i;for(var f=0,g=h.length;f<g;f++)i=h[f],d.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:i.term,scheme:i.scheme||null,label:i.label||null}}))}c.content&&d.appendChild(this.buildContentNode(c.content));if(c.contributors){var j=c.contributors instanceof Array?c.contributors:[c.contributors];for(var f=0,g=j.length;f<g;f++)d.appendChild(this.buildPersonConstructNode("contributor",j[f]))}a.fid&&d.appendChild(this.createElementNSPlus("atom:id",{value:a.fid}));if(c.links){var k=c.links instanceof Array?c.links:[c.links],l;for(var f=0,g=k.length;f<g;f++)l=k[f],d.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:l.href,rel:l.rel||null,type:l.type||null,hreflang:l.hreflang||null,title:l.title||null,length:l.length||null}}))}c.published&&d.appendChild(this.createElementNSPlus("atom:published",{value:c.published})),c.rights&&d.appendChild(this.createElementNSPlus("atom:rights",{value:c.rights})),(c.summary||b.description)&&d.appendChild(this.createElementNSPlus("atom:summary",{value:c.summary||b.description})),d.appendChild(this.createElementNSPlus("atom:title",{value:c.title||b.title||this.defaultEntryTitle})),c.updated&&d.appendChild(this.createElementNSPlus("atom:updated",{value:c.updated}));if(a.geometry){var m=this.createElementNSPlus("georss:where");m.appendChild(this.buildGeometryNode(a.geometry)),d.appendChild(m)}return d},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,featureNS:"http://example.com#feature",internalProjection:this.internalProjection,externalProjection:this.externalProjection})},buildGeometryNode:function(a){this.gmlParser||this.initGmlParser();var b=this.gmlParser.writeNode("feature:_geometry",a);return b.firstChild},buildPersonConstructNode:function(a,b){var c=["uri","email"],d=this.createElementNSPlus("atom:"+a);d.appendChild(this.createElementNSPlus("atom:name",{value:b.name}));for(var e=0,f=c.length;e<f;e++)b[c[e]]&&d.appendChild(this.createElementNSPlus("atom:"+c[e],{value:b[c[e]]}));return d},getFirstChildValue:function(a,b,c,d){var e,f=this.getElementsByTagNameNS(a,b,c);f&&f.length>0?e=this.getChildValue(f[0],d):e=d;return e},parseFeature:function(a){var b={},c=null,d=null,e=null,f=this.namespaces.atom;this.parsePersonConstructs(a,"author",b),d=this.getElementsByTagNameNS(a,f,"category"),d.length>0&&(b.categories=[]);for(var g=0,h=d.length;g<h;g++)c={},c.term=d[g].getAttribute("term"),e=d[g].getAttribute("scheme"),e&&(c.scheme=e),e=d[g].getAttribute("label"),e&&(c.label=e),b.categories.push(c);d=this.getElementsByTagNameNS(a,f,"content"),d.length>0&&(c={},e=d[0].getAttribute("type"),e&&(c.type=e),e=d[0].getAttribute("src"),e?c.src=e:(c.type=="text"||c.type=="html"||c.type==null?c.value=this.getFirstChildValue(a,f,"content",null):c.type=="xhtml"||c.type.match(/(\+|\/)xml$/)?c.value=this.getChildEl(d[0]):c.value=this.getFirstChildValue(a,f,"content",null),b.content=c)),this.parsePersonConstructs(a,"contributor",b),b.id=this.getFirstChildValue(a,f,"id",null),d=this.getElementsByTagNameNS(a,f,"link"),d.length>0&&(b.links=Array(d.length));var i=["rel","type","hreflang","title","length"];for(var g=0,h=d.length;g<h;g++){c={},c.href=d[g].getAttribute("href");for(var j=0,k=i.length;j<k;j++)e=d[g].getAttribute(i[j]),e&&(c[i[j]]=e);b.links[g]=c}c=this.getFirstChildValue(a,f,"published",null),c&&(b.published=c),c=this.getFirstChildValue(a,f,"rights",null),c&&(b.rights=c),c=this.getFirstChildValue(a,f,"summary",null),c&&(b.summary=c),b.title=this.getFirstChildValue(a,f,"title",null),b.updated=this.getFirstChildValue(a,f,"updated",null);var l={title:b.title,description:b.summary,atom:b},m=this.parseLocations(a)[0],n=new OpenLayers.Feature.Vector(m,l);n.fid=b.id;return n},parseFeatures:function(a){var b=[],c=this.getElementsByTagNameNS(a,this.namespaces.atom,"entry");c.length==0&&(c=[a]);for(var d=0,e=c.length;d<e;d++)b.push(this.parseFeature(c[d]));return b},parseLocations:function(a){var b=this.namespaces.georss,c={components:[]},d=this.getElementsByTagNameNS(a,b,"where");if(d&&d.length>0){this.gmlParser||this.initGmlParser();for(var e=0,f=d.length;e<f;e++)this.gmlParser.readChildNodes(d[e],c)}var g=c.components,h=this.getElementsByTagNameNS(a,b,"point");if(h&&h.length>0)for(var e=0,f=h.length;e<f;e++){var i=OpenLayers.String.trim(h[e].firstChild.nodeValue).split(/\s+/);i.length!=2&&(i=OpenLayers.String.trim(h[e].firstChild.nodeValue).split(/\s*,\s*/)),g.push(new OpenLayers.Geometry.Point(parseFloat(i[1]),parseFloat(i[0])))}var j=this.getElementsByTagNameNS(a,b,"line");if(j&&j.length>0){var k,l,m;for(var e=0,f=j.length;e<f;e++){k=OpenLayers.String.trim(j[e].firstChild.nodeValue).split(/\s+/),m=[];for(var n=0,o=k.length;n<o;n+=2)l=new OpenLayers.Geometry.Point(parseFloat(k[n+1]),parseFloat(k[n])),m.push(l);g.push(new OpenLayers.Geometry.LineString(m))}}var p=this.getElementsByTagNameNS(a,b,"polygon");if(p&&p.length>0){var k,l,m;for(var e=0,f=p.length;e<f;e++){k=OpenLayers.String.trim(p[e].firstChild.nodeValue).split(/\s+/),m=[];for(var n=0,o=k.length;n<o;n+=2)l=new OpenLayers.Geometry.Point(parseFloat(k[n+1]),parseFloat(k[n])),m.push(l);g.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(g)]))}}if(this.internalProjection&&this.externalProjection)for(var e=0,f=g.length;e<f;e++)g[e]&&g[e].transform(this.externalProjection,this.internalProjection);return g},parsePersonConstructs:function(a,b,c){var d=[],e=this.namespaces.atom,f=this.getElementsByTagNameNS(a,e,b),g=["uri","email"];for(var h=0,i=f.length;h<i;h++){var j={};j.name=this.getFirstChildValue(f[h],e,"name",null);for(var k=0,l=g.length;k<l;k++){var m=this.getFirstChildValue(f[h],e,g[k],null);m&&(j[g[k]]=m)}d.push(j)}d.length>0&&(c[b+"s"]=d)},CLASS_NAME:"OpenLayers.Format.Atom"}),OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(a,c),b.filters.push(c)},PropertyIsNotEqualTo:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(a,c),b.filters.push(c)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escape");c.value2regex(d,e,f),b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo");this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{wildCard:"*",singleChar:".",escape:"!"}});this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Box",a.value,b);a.projection&&c.setAttribute("srsName",a.projection);return b}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);var d;a.value instanceof OpenLayers.Geometry?d=this.writeNode("feature:_geometry",a.value).firstChild:d=this.writeNode("gml:Box",a.value),a.projection&&d.setAttribute("srsName",a.projection),c.appendChild(d);return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"}),OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(a){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[a])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a,b){var c=a.getAttribute("matchCase"),d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:c!=="false"&&c!=="0"});this.readChildNodes(a,d),b.filters.push(d)},PropertyIsNotEqualTo:function(a,b){var c=a.getAttribute("matchCase"),d=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:c!=="false"&&c!=="0"});this.readChildNodes(a,d),b.filters.push(d)},PropertyIsLike:function(a,b){var c=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(a,c);var d=a.getAttribute("wildCard"),e=a.getAttribute("singleChar"),f=a.getAttribute("escapeChar");c.value2regex(d,e,f),b.filters.push(c)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.value,b);return b},PropertyIsNotEqualTo:function(a){var b=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",{attributes:{matchCase:a.matchCase}});this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.value,b);return b},PropertyIsLike:function(a){var b=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{wildCard:"*",singleChar:".",escapeChar:"!"}});this.writeNode("PropertyName",a,b),this.writeNode("Literal",a.regex2value(),b);return b},BBOX:function(a){var b=this.createElementNSPlus("ogc:BBOX");this.writeNode("PropertyName",a,b);var c=this.writeNode("gml:Envelope",a.value);a.projection&&c.setAttribute("srsName",a.projection),b.appendChild(c);return b}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(a,b){var c=this.createElementNSPlus("ogc:"+b);this.writeNode("PropertyName",a,c);var d;a.value instanceof OpenLayers.Geometry?d=this.writeNode("feature:_geometry",a.value).firstChild:d=this.writeNode("gml:Envelope",a.value),a.projection&&d.setAttribute("srsName",a.projection),c.appendChild(d);return c},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"}),OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,{namespaces:{ows:"http://www.opengis.net/ows/1.1",sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a]),this.options=a},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a])),a&&a.nodeType==9&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{gml:OpenLayers.Util.applyDefaults({name:function(a,b){b.name=this.getChildValue(a)},TimePeriod:function(a,b){b.timePeriod={},this.readChildNodes(a,b.timePeriod)},beginPosition:function(a,b){b.beginPosition=this.getChildValue(a)},endPosition:function(a,b){b.endPosition=this.getChildValue(a)}},OpenLayers.Format.GML.v3.prototype.readers.gml),sos:{Capabilities:function(a,b){this.readChildNodes(a,b)},Contents:function(a,b){b.contents={},this.readChildNodes(a,b.contents)},ObservationOfferingList:function(a,b){b.offeringList={},this.readChildNodes(a,b.offeringList)},ObservationOffering:function(a,b){var c=this.getAttributeNS(a,this.namespaces.gml,"id");b[c]={procedures:[],featureOfInterestIds:[],responseFormats:[],resultModels:[],responseModes:[]},this.readChildNodes(a,b[c])},time:function(a,b){b.time={},this.readChildNodes(a,b.time)},procedure:function(a,b){b.procedures.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},observedProperty:function(a,b){b.observedProperty=this.getAttributeNS(a,this.namespaces.xlink,"href")},featureOfInterest:function(a,b){b.featureOfInterestIds.push(this.getAttributeNS(a,this.namespaces.xlink,"href"))},responseFormat:function(a,b){b.responseFormats.push(this.getChildValue(a))},resultModel:function(a,b){b.resultModels.push(this.getChildValue(a))},responseMode:function(a,b){b.responseModes.push(this.getChildValue(a))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.SOSCapabilities.v1_0_0"}),OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",sa:"http://www.opengis.net/sampling/1.0",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",defaultPrefix:"sos",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a])),a&&a.nodeType==9&&(a=a.documentElement);var b={features:[]};this.readNode(a,b);var c=[];for(var d=0,e=b.features.length;d<e;d++){var f=b.features[d];this.internalProjection&&this.externalProjection&&f.components[0]&&f.components[0].transform(this.externalProjection,this.internalProjection);var g=new OpenLayers.Feature.Vector(f.components[0],f.attributes);c.push(g)}return c},readers:{sa:{SamplingPoint:function(a,b){if(!b.attributes){var c={attributes:{}};b.features.push(c),b=c}b.attributes.id=this.getAttributeNS(a,this.namespaces.gml,"id"),this.readChildNodes(a,b)},position:function(a,b){this.readChildNodes(a,b)}},gml:OpenLayers.Util.applyDefaults({FeatureCollection:function(a,b){this.readChildNodes(a,b)},featureMember:function(a,b){var c={attributes:{}};b.features.push(c),this.readChildNodes(a,c)},name:function(a,b){b.attributes.name=this.getChildValue(a)},pos:function(a,b){this.externalProjection||(this.externalProjection=new OpenLayers.Projection(a.getAttribute("srsName"))),OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[a,b])}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetFeatureOfInterest:function(a){var b=this.createElementNSPlus("GetFeatureOfInterest",{attributes:{version:this.VERSION,service:"SOS","xsi:schemaLocation":this.schemaLocation}});for(var c=0,d=a.fois.length;c<d;c++)this.writeNode("FeatureOfInterestId",{foi:a.fois[c]},b);return b},FeatureOfInterestId:function(a){var b=this.createElementNSPlus("FeatureOfInterestId",{value:a.foi});return b}}},CLASS_NAME:"OpenLayers.Format.SOSGetFeatureOfInterest"}),OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml",sos:"http://www.opengis.net/sos/1.0",ogc:"http://www.opengis.net/ogc",om:"http://www.opengis.net/om/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd",defaultPrefix:"sos",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a])),a&&a.nodeType==9&&(a=a.documentElement);var b={measurements:[]};this.readNode(a,b);return b},write:function(a){var b=this.writeNode("sos:GetObservation",a);this.setAttributeNS(b,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},readers:{om:{ObservationCollection:function(a,b){b.id=this.getAttributeNS(a,this.namespaces.gml,"id"),this.readChildNodes(a,b)},member:function(a,b){this.readChildNodes(a,b)},Measurement:function(a,b){var c={};b.measurements.push(c),this.readChildNodes(a,c)},samplingTime:function(a,b){var c={};b.samplingTime=c,this.readChildNodes(a,c)},observedProperty:function(a,b){b.observedProperty=this.getAttributeNS(a,this.namespaces.xlink,"href"),this.readChildNodes(a,b)},procedure:function(a,b){b.procedure=this.getAttributeNS(a,this.namespaces.xlink,"href"),this.readChildNodes(a,b)},result:function(a,b){var c={};b.result=c,this.getChildValue(a)!==""?(c.value=this.getChildValue(a),c.uom=a.getAttribute("uom")):this.readChildNodes(a,c)}},gml:OpenLayers.Util.applyDefaults({TimeInstant:function(a,b){var c={};b.timeInstant=c,this.readChildNodes(a,c)},timePosition:function(a,b){b.timePosition=this.getChildValue(a)}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetObservation:function(a){var b=this.createElementNSPlus("GetObservation",{attributes:{version:this.VERSION,service:"SOS"}});this.writeNode("offering",a,b),this.writeNode("eventTime",a,b),this.writeNode("procedure",a,b),this.writeNode("observedProperty",a,b),this.writeNode("responseFormat",a,b),this.writeNode("resultModel",a,b),this.writeNode("responseMode",a,b);return b},responseFormat:function(a){return this.createElementNSPlus("responseFormat",{value:a.responseFormat})},procedure:function(a){return this.createElementNSPlus("procedure",{value:a.procedure})},offering:function(a){return this.createElementNSPlus("offering",{value:a.offering})},observedProperty:function(a){return this.createElementNSPlus("observedProperty",{value:a.observedProperty})},eventTime:function(a){var b=this.createElementNSPlus("eventTime");a.eventTime==="latest"&&this.writeNode("ogc:TM_Equals",a,b);return b},resultModel:function(a){return this.createElementNSPlus("resultModel",{value:a.resultModel})},responseMode:function(a){return this.createElementNSPlus("responseMode",{value:a.responseMode})}},ogc:{TM_Equals:function(a){var b=this.createElementNSPlus("ogc:TM_Equals");this.writeNode("ogc:PropertyName",{property:"urn:ogc:data:time:iso8601"},b),a.eventTime==="latest"&&this.writeNode("gml:TimeInstant",{value:"latest"},b);return b},PropertyName:function(a){return this.createElementNSPlus("ogc:PropertyName",{value:a.property})}},gml:{TimeInstant:function(a){var b=this.createElementNSPlus("gml:TimeInstant");this.writeNode("gml:timePosition",a,b);return b},timePosition:function(a){var b=this.createElementNSPlus("gml:timePosition",{value:a.value});return b}}},CLASS_NAME:"OpenLayers.Format.SOSGetObservation"}),OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",ows:"http://www.opengis.net/ows"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",requestId:null,resultType:null,outputFormat:null,outputSchema:null,startPosition:null,maxRecords:null,DistributedSearch:null,ResponseHandler:null,Query:null,initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(a){typeof a=="string"&&(a=OpenLayers.Format.XML.prototype.read.apply(this,[a])),a&&a.nodeType==9&&(a=a.documentElement);var b={};this.readNode(a,b);return b},readers:{csw:{GetRecordsResponse:function(a,b){b.records=[],this.readChildNodes(a,b);var c=this.getAttributeNS(a,"","version");c!=""&&(b.version=c)},RequestId:function(a,b){b.RequestId=this.getChildValue(a)},SearchStatus:function(a,b){b.SearchStatus={};var c=this.getAttributeNS(a,"","timestamp");c!=""&&(b.SearchStatus.timestamp=c)},SearchResults:function(a,b){this.readChildNodes(a,b);var c=a.attributes,d={};for(var e=0,f=c.length;e<f;++e)c[e].name=="numberOfRecordsMatched"||c[e].name=="numberOfRecordsReturned"||c[e].name=="nextRecord"?d[c[e].name]=parseInt(c[e].nodeValue):d[c[e].name]=c[e].nodeValue;b.SearchResults=d},SummaryRecord:function(a,b){var c={type:"SummaryRecord"};this.readChildNodes(a,c),b.records.push(c)},BriefRecord:function(a,b){var c={type:"BriefRecord"};this.readChildNodes(a,c),b.records.push(c)},DCMIRecord:function(a,b){var c={type:"DCMIRecord"};this.readChildNodes(a,c),b.records.push(c)},Record:function(a,b){var c={type:"Record"};this.readChildNodes(a,c),b.records.push(c)}},dc:{"*":function(a,b){var c=a.localName||a.nodeName.split(":").pop();b[c]instanceof Array||(b[c]=[]);var d={},e=a.attributes;for(var f=0,g=e.length;f<g;++f)d[e[f].name]=e[f].nodeValue;d.value=this.getChildValue(a),b[c].push(d)}},dct:{"*":function(a,b){var c=a.localName||a.nodeName.split(":").pop();b[c]instanceof Array||(b[c]=[]),b[c].push(this.getChildValue(a))}},ows:{WGS84BoundingBox:function(a,b){b.BoundingBox instanceof Array||(b.BoundingBox=[]);var c=this.getChildValue(this.getElementsByTagNameNS(a,this.namespaces.ows,"LowerCorner")[0]).split(" ",2),d=this.getChildValue(this.getElementsByTagNameNS(a,this.namespaces.ows,"UpperCorner")[0]).split(" ",2),e={value:[parseFloat(c[0]),parseFloat(c[1]),parseFloat(d[0]),parseFloat(d[1])]},f=a.attributes;for(var g=0,h=f.length;g<h;++g)e[f[g].name]=f[g].nodeValue;b.BoundingBox.push(e)},BoundingBox:function(a,b){this.readers.ows.WGS84BoundingBox.apply(this,[a,b])}}},write:function(a){var b=this.writeNode("csw:GetRecords",a);return OpenLayers.Format.XML.prototype.write.apply(this,[b])},writers:{csw:{GetRecords:function(a){a||(a={});var b=this.createElementNSPlus("csw:GetRecords",{attributes:{service:"CSW",version:this.version,requestId:a.requestId||this.requestId,resultType:a.resultType||this.resultType,outputFormat:a.outputFormat||this.outputFormat,outputSchema:a.outputSchema||this.outputSchema,startPosition:a.startPosition||this.startPosition,maxRecords:a.maxRecords||this.maxRecords}});(a.DistributedSearch||this.DistributedSearch)&&this.writeNode("csw:DistributedSearch",a.DistributedSearch||this.DistributedSearch,b);var c=a.ResponseHandler||this.ResponseHandler;if(c instanceof Array&&c.length>0)for(var d=0,e=c.length;d<e;d++)this.writeNode("csw:ResponseHandler",c[d],b);this.writeNode("Query",a.Query||this.Query,b);return b},DistributedSearch:function(a){var b=this.createElementNSPlus("csw:DistributedSearch",{attributes:{hopCount:a.hopCount}});return b},ResponseHandler:function(a){var b=this.createElementNSPlus("csw:ResponseHandler",{value:a.value});return b},Query:function(a){a||(a={});var b=this.createElementNSPlus("csw:Query",{attributes:{typeNames:a.typeNames||"csw:Record"}}),c=a.ElementName;if(c instanceof Array&&c.length>0)for(var d=0,e=c.length;d<e;d++)this.writeNode("csw:ElementName",c[d],b);else this.writeNode("csw:ElementSetName",a.ElementSetName||{value:"summary"},b);a.Constraint&&this.writeNode("csw:Constraint",a.Constraint,b);return b},ElementName:function(a){var b=this.createElementNSPlus("csw:ElementName",{value:a.value});return b},ElementSetName:function(a){var b=this.createElementNSPlus("csw:ElementSetName",{attributes:{typeNames:a.typeNames},value:a.value});return b},Constraint:function(a){var b=this.createElementNSPlus("csw:Constraint",{attributes:{version:a.version}});if(a.Filter){var c=new OpenLayers.Format.Filter({version:a.version});b.appendChild(c.write(a.Filter))}else if(a.CqlText){var d=this.createElementNSPlus("CqlText",{value:a.CqlText.value});b.appendChild(d)}return b}}},CLASS_NAME:"OpenLayers.Format.CSWGetRecords.v2_0_2"}),OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3,graphicName:"square"},initialize:function(a){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[a])},read:function(a,b){b=OpenLayers.Util.applyDefaults(b,this.options);var c={namedLayers:b.namedLayersAsArray===!0?[]:{}};this.readChildNodes(a,c);return c},readers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(a,b){b.version=a.getAttribute("version"),this.readChildNodes(a,b)},Name:function(a,b){b.name=this.getChildValue(a)},Title:function(a,b){b.title=this.getChildValue(a)},Abstract:function(a,b){b.description=this.getChildValue(a)},NamedLayer:function(a,b){var c={userStyles:[],namedStyles:[]};this.readChildNodes(a,c);for(var d=0,e=c.userStyles.length;d<e;++d)c.userStyles[d].layerName=c.name;b.namedLayers instanceof Array?b.namedLayers.push(c):b.namedLayers[c.name]=c},NamedStyle:function(a,b){b.namedStyles.push(this.getChildName(a.firstChild))},UserStyle:function(a,b){var c={defaultsPerSymbolizer:!0,rules:[]};this.readChildNodes(a,c);var d=new OpenLayers.Style(this.defaultSymbolizer,c);b.userStyles.push(d)},IsDefault:function(a,b){this.getChildValue(a)=="1"&&(b.isDefault=!0)},FeatureTypeStyle:function(a,b){var c={rules:[]};this.readChildNodes(a,c),b.rules=c.rules},Rule:function(a,b){var c=new OpenLayers.Rule;this.readChildNodes(a,c),b.rules.push(c)},ElseFilter:function(a,b){b.elseFilter=!0},MinScaleDenominator:function(a,b){b.minScaleDenominator=parseFloat(this.getChildValue(a))},MaxScaleDenominator:function(a,b){b.maxScaleDenominator=parseFloat(this.getChildValue(a))},TextSymbolizer:function(a,b){var c=b.symbolizer.Text||{};this.readChildNodes(a,c),b.symbolizer.Text=c},Label:function(a,b){var c={};this.readChildNodes(a,c);if(c.property)b.label="${"+c.property+"}";else{var d=this.readOgcExpression(a);d&&(b.label=d)}},Font:function(a,b){this.readChildNodes(a,b)},Halo:function(a,b){var c={};this.readChildNodes(a,c),b.haloRadius=c.haloRadius,b.haloColor=c.fillColor,b.haloOpacity=c.fillOpacity},Radius:function(a,b){var c=this.readOgcExpression(a);c!=null&&(b.haloRadius=c)},LineSymbolizer:function(a,b){var c=b.symbolizer.Line||{};this.readChildNodes(a,c),b.symbolizer.Line=c},PolygonSymbolizer:function(a,b){var c=b.symbolizer.Polygon||{};this.readChildNodes(a,c),b.symbolizer.Polygon=c},PointSymbolizer:function(a,b){var c=b.symbolizer.Point||{};this.readChildNodes(a,c),b.symbolizer.Point=c},Stroke:function(a,b){b.stroke=!0,this.readChildNodes(a,b)},Fill:function(a,b){b.fill=!0,this.readChildNodes(a,b)},CssParameter:function(a,b){var c=a.getAttribute("name"),d=this.cssMap[c];if(d){var e=this.readOgcExpression(a);e&&(b[d]=e)}},Graphic:function(a,b){b.graphic=!0;var c={};this.readChildNodes(a,c);var d=["strokeColor","strokeWidth","strokeOpacity","strokeLinecap","fillColor","fillOpacity","graphicName","rotation","graphicFormat"],e,f;for(var g=0,h=d.length;g<h;++g)e=d[g],f=c[e],f!=undefined&&(b[e]=f);c.opacity!=undefined&&(b.graphicOpacity=c.opacity),c.size!=undefined&&(b.pointRadius=c.size/2),c.href!=undefined&&(b.externalGraphic=c.href),c.rotation!=undefined&&(b.rotation=c.rotation)},ExternalGraphic:function(a,b){this.readChildNodes(a,b)},Mark:function(a,b){this.readChildNodes(a,b)},WellKnownName:function(a,b){b.graphicName=this.getChildValue(a)},Opacity:function(a,b){var c=this.readOgcExpression(a);c&&(b.opacity=c)},Size:function(a,b){var c=this.readOgcExpression(a);c&&(b.size=c)},Rotation:function(a,b){var c=this.readOgcExpression(a);c&&(b.rotation=c)},OnlineResource:function(a,b){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},Format:function(a,b){b.graphicFormat=this.getChildValue(a)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),cssMap:{stroke:"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle",fill:"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(a){var b=null;for(var c in this.cssMap)if(this.cssMap[c]==a){b=c;break}return b},getGraphicFormat:function(a){var b,c;for(var d in this.graphicFormats)if(this.graphicFormats[d].test(a)){b=d;break}return b||this.defautlGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(a){return this.writers.sld.StyledLayerDescriptor.apply(this,[a])},writers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(a){var b=this.createElementNSPlus("sld:StyledLayerDescriptor",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});b.setAttribute("xmlns:ogc",this.namespaces.ogc),b.setAttribute("xmlns:gml",this.namespaces.gml),a.name&&this.writeNode("Name",a.name,b),a.title&&this.writeNode("Title",a.title,b),a.description&&this.writeNode("Abstract",a.description,b);if(a.namedLayers instanceof Array)for(var c=0,d=a.namedLayers.length;c<d;++c)this.writeNode("NamedLayer",a.namedLayers[c],b);else for(var e in a.namedLayers)this.writeNode("NamedLayer",a.namedLayers[e],b);return b},Name:function(a){return this.createElementNSPlus("sld:Name",{value:a})},Title:function(a){return this.createElementNSPlus("sld:Title",{value:a})},Abstract:function(a){return this.createElementNSPlus("sld:Abstract",{value:a})},NamedLayer:function(a){var b=this.createElementNSPlus("sld:NamedLayer");this.writeNode("Name",a.name,b);if(a.namedStyles)for(var c=0,d=a.namedStyles.length;c<d;++c)this.writeNode("NamedStyle",a.namedStyles[c],b);if(a.userStyles)for(var c=0,d=a.userStyles.length;c<d;++c)this.writeNode("UserStyle",a.userStyles[c],b);return b},NamedStyle:function(a){var b=this.createElementNSPlus("sld:NamedStyle");this.writeNode("Name",a,b);return b},UserStyle:function(a){var b=this.createElementNSPlus("sld:UserStyle");a.name&&this.writeNode("Name",a.name,b),a.title&&this.writeNode("Title",a.title,b),a.description&&this.writeNode("Abstract",a.description,b),a.isDefault&&this.writeNode("IsDefault",a.isDefault,b),this.writeNode("FeatureTypeStyle",a,b);return b},IsDefault:function(a){return this.createElementNSPlus("sld:IsDefault",{value:a?"1":"0"})},FeatureTypeStyle:function(a){var b=this.createElementNSPlus("sld:FeatureTypeStyle");for(var c=0,d=a.rules.length;c<d;++c)this.writeNode("Rule",a.rules[c],b);return b},Rule:function(a){var b=this.createElementNSPlus("sld:Rule");a.name&&this.writeNode("Name",a.name,b),a.title&&this.writeNode("Title",a.title,b),a.description&&this.writeNode("Abstract",a.description,b),a.elseFilter?this.writeNode("ElseFilter",null,b):a.filter&&this.writeNode("ogc:Filter",a.filter,b),a.minScaleDenominator!=undefined&&this.writeNode("MinScaleDenominator",a.minScaleDenominator,b),a.maxScaleDenominator!=undefined&&this.writeNode("MaxScaleDenominator",a.maxScaleDenominator,b);var c=OpenLayers.Style.SYMBOLIZER_PREFIXES,d,e;for(var f=0,g=c.length;f<g;++f)d=c[f],e=a.symbolizer[d],e&&this.writeNode(d+"Symbolizer",e,b);return b},ElseFilter:function(){return this.createElementNSPlus("sld:ElseFilter")},MinScaleDenominator:function(a){return this.createElementNSPlus("sld:MinScaleDenominator",{value:a})},MaxScaleDenominator:function(a){return this.createElementNSPlus("sld:MaxScaleDenominator",{value:a})},LineSymbolizer:function(a){var b=this.createElementNSPlus("sld:LineSymbolizer");this.writeNode("Stroke",a,b);return b},Stroke:function(a){var b=this.createElementNSPlus("sld:Stroke");a.strokeColor!=undefined&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeColor"},b),a.strokeOpacity!=undefined&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeOpacity"},b),a.strokeWidth!=undefined&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeWidth"},b),a.strokeDashstyle!=undefined&&a.strokeDashstyle!=="solid"&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeDashstyle"},b),a.strokeLinecap!=undefined&&this.writeNode("CssParameter",{symbolizer:a,key:"strokeLinecap"},b);return b},CssParameter:function(a){return this.createElementNSPlus("sld:CssParameter",{attributes:{name:this.getCssProperty(a.key)},value:a.symbolizer[a.key]})},TextSymbolizer:function(a){var b=this.createElementNSPlus("sld:TextSymbolizer");a.label!=null&&this.writeNode("Label",a.label,b),(a.fontFamily!=null||a.fontSize!=null||a.fontWeight!=null||a.fontStyle!=null)&&this.writeNode("Font",a,b),(a.haloRadius!=null||a.haloColor!=null||a.haloOpacity!=null)&&this.writeNode("Halo",a,b),(a.fillColor!=null||a.fillOpacity!=null)&&this.writeNode("Fill",a,b);return b},Font:function(a){var b=this.createElementNSPlus("sld:Font");a.fontFamily&&this.writeNode("CssParameter",{symbolizer:a,key:"fontFamily"},b),a.fontSize&&this.writeNode("CssParameter",{symbolizer:a,key:"fontSize"},b),a.fontWeight&&this.writeNode("CssParameter",{symbolizer:a,key:"fontWeight"},b),a.fontStyle&&this.writeNode("CssParameter",{symbolizer:a,key:"fontStyle"},b);return b},Label:function(a){var b=this.createElementNSPlus("sld:Label"),c=a.split("${");b.appendChild(this.createTextNode(c[0]));var d,e;for(var f=1,g=c.length;f<g;f++)d=c[f],e=d.indexOf("}"),e>0?(this.writeNode("ogc:PropertyName",{property:d.substring(0,e)},b),b.appendChild(this.createTextNode(d.substring(++e)))):b.appendChild(this.createTextNode("${"+d));return b},Halo:function(a){var b=this.createElementNSPlus("sld:Halo");a.haloRadius&&this.writeNode("Radius",a.haloRadius,b),(a.haloColor||a.haloOpacity)&&this.writeNode("Fill",{fillColor:a.haloColor,fillOpacity:a.haloOpacity},b);return b},Radius:function(a){return node=this.createElementNSPlus("sld:Radius",{value:a})},PolygonSymbolizer:function(a){var b=this.createElementNSPlus("sld:PolygonSymbolizer");(a.fillColor!=undefined||a.fillOpacity!=undefined)&&this.writeNode("Fill",a,b),(a.strokeWidth!=undefined||a.strokeColor!=undefined||a.strokeOpacity!=undefined||a.strokeDashstyle!=undefined)&&this.writeNode("Stroke",a,b);return b},Fill:function(a){var b=this.createElementNSPlus("sld:Fill");a.fillColor&&this.writeNode("CssParameter",{symbolizer:a,key:"fillColor"},b),a.fillOpacity!=null&&this.writeNode("CssParameter",{symbolizer:a,key:"fillOpacity"},b);return b},PointSymbolizer:function(a){var b=this.createElementNSPlus("sld:PointSymbolizer");this.writeNode("Graphic",a,b);return b},Graphic:function(a){var b=this.createElementNSPlus("sld:Graphic");a.externalGraphic!=undefined?this.writeNode("ExternalGraphic",a,b):this.writeNode("Mark",a,b),a.graphicOpacity!=undefined&&this.writeNode("Opacity",a.graphicOpacity,b),a.pointRadius!=undefined&&this.writeNode("Size",a.pointRadius*2,b),a.rotation!=undefined&&this.writeNode("Rotation",a.rotation,b);return b},ExternalGraphic:function(a){var b=this.createElementNSPlus("sld:ExternalGraphic");this.writeNode("OnlineResource",a.externalGraphic,b);var c=a.graphicFormat||this.getGraphicFormat(a.externalGraphic);this.writeNode("Format",c,b);return b},Mark:function(a){var b=this.createElementNSPlus("sld:Mark");a.graphicName&&this.writeNode("WellKnownName",a.graphicName,b),this.writeNode("Fill",a,b),this.writeNode("Stroke",a,b);return b},WellKnownName:function(a){return this.createElementNSPlus("sld:WellKnownName",{value:a})},Opacity:function(a){return this.createElementNSPlus("sld:Opacity",{value:a})},Size:function(a){return this.createElementNSPlus("sld:Size",{value:a})},Rotation:function(a){return this.createElementNSPlus("sld:Rotation",{value:a})},OnlineResource:function(a){return this.createElementNSPlus("sld:OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":a}})},Format:function(a){return this.createElementNSPlus("sld:Format",{value:a})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:"OpenLayers.Format.SLD.v1"}),OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:!1,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[a]),OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(a,b){b.insertIds=[],b.success=!1,this.readChildNodes(a,b)},InsertResult:function(a,b){var c={fids:[]};this.readChildNodes(a,c),b.insertIds.push(c.fids[0])},TransactionResult:function(a,b){this.readChildNodes(a,b)},Status:function(a,b){this.readChildNodes(a,b)},SUCCESS:function(a,b){b.success=!0}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(a){a=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},a);var b=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(a.featureNS?a.featurePrefix+":":"")+a.featureType}});a.srsNameInQuery&&a.srsName&&b.setAttribute("srsName",a.srsName),a.featureNS&&b.setAttribute("xmlns:"+a.featurePrefix,a.featureNS);if(a.propertyNames)for(var c=0,d=a.propertyNames.length;c<d;c++)this.writeNode("ogc:PropertyName",{property:a.propertyNames[c]},b);a.filter&&(this.setFilterProperty(a.filter),this.writeNode("ogc:Filter",a.filter,b));return b}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"}),OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(a){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[a]),OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[a])},readers:{wfs:OpenLayers.Util.applyDefaults({TransactionResponse:function(a,b){b.insertIds=[],b.success=!1,this.readChildNodes(a,b)},TransactionSummary:function(a,b){b.success=!0},InsertResults:function(a,b){this.readChildNodes(a,b)},Feature:function(a,b){var c={fids:[]};this.readChildNodes(a,c),b.insertIds.push(c.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc},writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(a){a=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},a);var b=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(a.featureNS?a.featurePrefix+":":"")+a.featureType,srsName:a.srsName}});a.featureNS&&b.setAttribute("xmlns:"+a.featurePrefix,a.featureNS);if(a.propertyNames)for(var c=0,d=a.propertyNames.length;c<d;c++)this.writeNode("wfs:PropertyName",{property:a.propertyNames[c]},b);a.filter&&(this.setFilterProperty(a.filter),this.writeNode("ogc:Filter",a.filter,b));return b},PropertyName:function(a){return this.createElementNSPlus("wfs:PropertyName",{value:a.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"}),OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,{fois:null,formatOptions:null,initialize:function(a){OpenLayers.Protocol.prototype.initialize.apply(this,[a]),a.format||(this.format=new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions))},destroy:function(){this.options&&!this.options.format&&this.format.destroy(),this.format=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(a){a=OpenLayers.Util.extend({},a),OpenLayers.Util.applyDefaults(a,this.options||{});var b=new OpenLayers.Protocol.Response({requestType:"read"}),c=this.format,d=OpenLayers.Format.XML.prototype.write.apply(c,[c.writeNode("sos:GetFeatureOfInterest",{fois:this.fois})]);b.priv=OpenLayers.Request.POST({url:a.url,callback:this.createCallback(this.handleRead,b,a),data:d});return b},handleRead:function(a,b){if(b.callback){var c=a.priv;c.status>=200&&c.status<300?(a.features=this.parseFeatures(c),a.code=OpenLayers.Protocol.Response.SUCCESS):a.code=OpenLayers.Protocol.Response.FAILURE,b.callback.call(b.scope,a)}},parseFeatures:function(a){var b=a.responseXML;if(!b||!b.documentElement)b=a.responseText;if(!b||b.length<=0)return null;return this.format.read(b)},CLASS_NAME:"OpenLayers.Protocol.SOS.v1_0_0"}),OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",initialize:function(a){OpenLayers.Format.SLD.v1.prototype.initialize.apply(this,[a])},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"}),OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"}),OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"}),define("lib/openlayers/OpenLayers",function(){}),define("lib/tools/maps",["lib/openlayers/OpenLayers"],function(){function s(){}function r(){}function q(){var b=l(application.settings.services.tms);if(b)o(application.settings.services.tms,!0);else{if(application.settings.services.tms.osm){center_lonlat=k(application.settings.services.tms.osm_ztop,application.settings.services.tms.center[0],application.settings.services.tms.center[1]);var c=new OpenLayers.LonLat(center_lonlat[0],center_lonlat[1]),d=(new OpenLayers.LonLat(c.lon,c.lat)).transform(new OpenLayers.Projection("EPSG:4326"),a.getProjectionObject())}else var d=new OpenLayers.LonLat(application.settings.services.tms.center[0]*256,-application.settings.services.tms.center[1]*256);a.isValidLonLat(d)||alert("Invalid center!"),a.setCenter(d,application.settings.services.tms.center[2]),a.render("map")}}function p(){typeof application.settings.services.tms!=="undefined"?application.settings.map_enabled==!0?q():(application.settings.services.tms.ssl?g="https://"+application.settings.services.tms.uri:g="http://"+application.settings.services.tms.uri,o(application.settings.services.tms,!0),application.settings.map_enabled=!0):$("#map").html("<div class='osmaps-error'>Error 1: Map-service not defined yet...</div>").addClass("osmaps-disabled")}function o(e,f){l(e);if(application.settings.services.tms.osm==!0){var h=["156543.0339","78271.51695","39135.758475","19567.8792375","9783.93961875","4891.96980937","2445.98490469","1222.99245234","611.496226172","305.748113086","152.874056543","76.4370282715","38.2185141357","19.1092570679","9.55462853394","4.77731426697","2.38865713348","1.19432856674"];$("head").append("<link type='text/css' href='http://"+application.settings.services.web_ui.uri+"/media/themes/"+e.theme+"/css/osm_map.css' media='screen' rel='stylesheet' />"),a=new OpenLayers.Map("map",{controls:[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanZoomBar,new OpenLayers.Control.MousePosition],maxExtent:new OpenLayers.Bounds(-20037508.34,-20037508.34,20037508.34,20037508.34),units:"m",theme:null,projection:"EPSG:900913",displayProjection:new OpenLayers.Projection("EPSG:4326"),url:g}),osm_grid=new OpenLayers.Layer.TMS("map",a.url+"/tiles/",{type:"png",getURL:m,displayOutsideMaxExtent:!0}),osm_grid.setIsBaseLayer(!1),mapnik=new OpenLayers.Layer.OSM.Mapnik("Mapnik",{resolutions:h}),mapnik.setIsBaseLayer(!0),a.addLayers([osm_grid,mapnik]),center_lonlat=k(application.settings.services.tms.osm_ztop,application.settings.services.tms.center[0],application.settings.services.tms.center[1]);var i=new OpenLayers.LonLat(center_lonlat[0],center_lonlat[1]);lonLat=(new OpenLayers.LonLat(i.lon,i.lat)).transform(new OpenLayers.Projection("EPSG:4326"),a.getProjectionObject()),a.setCenter(lonLat,e.center[2])}else $("head").append("<link type='text/css' href='http://"+application.settings.services.web_ui.uri+"/media/themes/"+e.theme+"/css/raw_map.css' media='screen' rel='stylesheet' />"),gridsize=Math.pow(2,application.settings.services.tms.raw_ztop),boundspx=gridsize*256,a=new OpenLayers.Map({controls:[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanZoomBar],numZoomLevels:e.zlevels+1,maxExtent:new OpenLayers.Bounds(0,-boundspx,boundspx,0),maxResolution:gridsize,theme:null,url:g}),raw_grid=new OpenLayers.Layer.TMS("map",a.url+"/tiles/",{type:"png",getURL:m,displayOutsideMaxExtent:!0}),raw_grid.setIsBaseLayer(!0),a.addLayer(raw_grid),e.center!=undefined?(center=new OpenLayers.LonLat(e.center[0]*256,-e.center[1]*256),a.isValidLonLat(center)?a.setCenter(center,e.center[2]):(center=new OpenLayers.LonLat(1e3,1e3),a.setCenter(center,e.center[2]))):a.setCenter(new OpenLayers.LonLat(boundspx/2,-boundspx/2),3);f==!0&&a.render("map"),OpenLayers.Control.Click=OpenLayers.Class(OpenLayers.Control,{defaultHandlerOptions:{single:!0,"double":!1,pixelTolerance:0,stopSingle:!1,stopDouble:!1},initialize:function(a){this.handlerOptions=OpenLayers.Util.extend({},this.defaultHandlerOptions),OpenLayers.Control.prototype.initialize.apply(this,arguments),this.handler=new OpenLayers.Handler.Click(this,{click:this.trigger},this.handlerOptions)},trigger:function(c){var d=a.getLonLatFromViewPortPx(c.xy);application.settings.services.tms.osm&&(d=d.transform(new OpenLayers.Projection("EPSG:900913"),new OpenLayers.Projection("EPSG:4326"))),application.ws.remote("/data/maps/cells/read/",{lonlat:[d.lon,d.lat]},function(c){var d=new OpenLayers.LonLat(c.lonlat[0],c.lonlat[1]);application.settings.services.tms.osm&&(d=d.transform(new OpenLayers.Projection("EPSG:4326"),new OpenLayers.Projection("EPSG:900913")));var e=0;a.popups.length>0&&a.removePopup(b);if(c.name!=null){$(document).trigger("MAP_REGION_LOCATION",[c.x,c.y]);var f="<div class='hwios-widget'><div class='ui-widget-header'><span class='ui-icon menu-icon ui-icon-pin-s'></span><span>"+gettext("Region")+" "+c.name+"</span></div><div class='ui-widget-content ui-corner-bottom'><table id='map_popup_info'><tr><td><b>"+gettext("Address")+":</b></td><td>"+c.ip+":"+c.port+"</td></tr><tr><td><b>"+gettext("Position")+":</b></td><td> "+c.x+","+c.y+"</td></tr></table></div></div>";e=1}else $(document).trigger("MAP_FREE_LOCATION",[c.x,c.y]);e>0&&(b=new OpenLayers.Popup("regionpopup",d,new OpenLayers.Size(150,200),f,!0),b.autoSize=!0,a.addPopup(b))})}}),d===undefined&&(d=new OpenLayers.Control.PanZoomBar),a.addControl(new OpenLayers.Control.PanZoomBar),c=new OpenLayers.Control.Click,a.addControl(c),c.activate()}function m(a){var b=this.map.getResolution(),c=Math.round((a.left-this.maxExtent.left)/(b*this.tileSize.w)),d=Math.round((this.maxExtent.top-a.top)/(b*this.tileSize.h)),e=this.map.getZoom(),f=e+"/"+c+"/"+d+"."+this.type+"?cache="+application.settings.services.tms.cache,g=this.url;g instanceof Array&&(g=this.selectUrl(f,g));return g+f}function l(b){if(h){h=!1,typeof grid!="undefined"&&delete grid,typeof osm_layer!="undefined"&&delete osm_layer,typeof a!="undefined"&&a.destroy();return!0}OpenLayers.ImgPath="/media/themes/"+b.theme+"/css/images/map/";return!1}function k(a,b,c){n=Math.pow(2,a),lon_deg=b/n*360-180,lat_rad=Math.atan(Math.sinh(Math.PI*(1-2*c/n))),lat_deg=lat_rad*180/Math.PI;return[lon_deg,lat_deg]}function j(){application.ws.method("/data/maps/settings/update/",function(a){application.settings.services.tms=a,h=!0})}function i(){application.functions.maps={},application.functions.maps.route=function(a,b){routes=[[XRegExp("^/maps/$"),application.functions.maps.view_maps]],application.route_uri_to_mod_function(a,routes,b)},application.functions.maps.view_maps=function(){application.ws.remote("/maps/",{},function(a){application.functions.ui.transition(a.data.dom.main,$(".main")),p()})}}OpenLayers.Layer.OSM.Mapnik=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(a,b){var c=["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"];b=OpenLayers.Util.extend({},b);var d=[a,c,b];OpenLayers.Layer.OSM.prototype.initialize.apply(this,d)},CLASS_NAME:"OpenLayers.Layer.OSM.Mapnik"});var a,b,c,d,e,f=!1,g="",h=!1;return{init:function(a,b){i(),j(),application.functions.maps.route(a,b);return"maps"},load:function(a,b){r(),application.functions.maps.route(a,b)},clean_up:function(){s()},connect:function(){typeof application.settings.services.tms!=="undefined"?application.settings.map_enabled==!0?q():(application.settings.services.tms.ssl?g="https://"+application.settings.services.tms.uri:g="http://"+application.settings.services.tms.uri,o(application.settings.services.tms,!0),application.settings.map_enabled=!0):$("#map").html("<div class='osmaps-error'>Error 1: Map-service not defined yet...</div>").addClass("osmaps-disabled")},reset_cache:function(){application.settings.services.tms.cache=(new Date).getTime()},get_zoom:function(){return a.getZoom()},center_lonlat:function(b,c,d){d===undefined?d=application.settings.services.tms.center[2]:d=d;var e=new OpenLayers.LonLat(b,c),f=(new OpenLayers.LonLat(e.lon,e.lat)).transform(new OpenLayers.Projection("EPSG:4326"),a.getProjectionObject());a.setCenter(f,d)}}}),jQuery.fn.extend({mousehold:function(a,b){a&&typeof a=="function"&&(b=a,a=100);if(b&&typeof b=="function"){var c=0,d=0;return this.each(function(){jQuery(this).mousedown(function(e){d=1;var g=this,h=e.offsetX,i=e.offsetY;c=setInterval(function(){b.call(g,h,i),d=2},a)}),clearMousehold=function(){clearInterval(c),d==1&&b.call(this,1),d=0},jQuery(this).mouseout(clearMousehold),jQuery(this).mouseup(clearMousehold)})}}}),define("lib/jquery/jquery.misc",function(){}),function(){window.$jit=function(a){a=a||window;for(var b in $jit)$jit[b].$extend&&(a[b]=$jit[b])},$jit.version="2.0.0b";var a=function(a){return document.getElementById(a)};a.empty=function(){},a.extend=function(a,b){for(var c in b||{})a[c]=b[c];return a},a.lambda=function(a){return typeof a=="function"?a:function(){return a}},a.time=Date.now||function(){return+(new Date)},a.splat=function(b){var c=a.type(b);return c?c!="array"?[b]:b:[]},a.type=function(b){var c=a.type.s.call(b).match(/^\[object\s(.*)\]$/)[1].toLowerCase();if(c!="object")return c;if(b&&b.$$family)return b.$$family;return b&&b.nodeName&&b.nodeType==1?"element":c},a.type.s=Object.prototype.toString,a.each=function(b,c){var d=a.type(b);if(d=="object")for(var e in b)c(b[e],e);else for(var f=0,g=b.length;f<g;f++)c(b[f],f)},a.indexOf=function(a,b){if(Array.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},a.map=function(b,c){var d=[];a.each(b,function(a,b){d.push(c(a,b))});return d},a.reduce=function(a,b,c){var d=a.length;if(d==0)return c;var e=arguments.length==3?c:a[--d];while(d--)e=b(e,a[d]);return e},a.merge=function(){var b={};for(var c=0,d=arguments.length;c<d;c++){var e=arguments[c];if(a.type(e)!="object")continue;for(var f in e){var g=e[f],h=b[f];b[f]=h&&a.type(g)=="object"&&a.type(h)=="object"?a.merge(h,g):a.unlink(g)}}return b},a.unlink=function(b){var c;switch(a.type(b)){case"object":c={};for(var d in b)c[d]=a.unlink(b[d]);break;case"array":c=[];for(var e=0,f=b.length;e<f;e++)c[e]=a.unlink(b[e]);break;default:return b}return c},a.zip=function(){if(arguments.length===0)return[];for(var a=0,b=[],c=arguments.length,d=arguments[0].length;a<d;a++){for(var e=0,f=[];e<c;e++)f.push(arguments[e][a]);b.push(f)}return b},a.rgbToHex=function(a,b){if(a.length<3)return null;if(a.length==4&&a[3]==0&&!b)return"transparent";var c=[];for(var d=0;d<3;d++){var e=(a[d]-0).toString(16);c.push(e.length==1?"0"+e:e)}return b?c:"#"+c.join("")},a.hexToRgb=function(a){if(a.length!=7){a=a.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/),a.shift();if(a.length!=3)return null;var b=[];for(var c=0;c<3;c++){var d=a[c];d.length==1&&(d+=d),b.push(parseInt(d,16))}return b}a=parseInt(a.slice(1),16);return[a>>16,a>>8&255,a&255]},a.destroy=function(b){a.clean(b),b.parentNode&&b.parentNode.removeChild(b),b.clearAttributes&&b.clearAttributes()},a.clean=function(b){for(var c=b.childNodes,d=0,e=c.length;d<e;d++)a.destroy(c[d])},a.addEvent=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},a.addEvents=function(b,c){for(var d in c)a.addEvent(b,d,c[d])},a.hasClass=function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>-1},a.addClass=function(b,c){a.hasClass(b,c)||(b.className=b.className+" "+c)},a.removeClass=function(a,b){a.className=a.className.replace(new RegExp("(^|\\s)"+b+"(?:\\s|$)"),"$1")},a.getPos=function(a){function f(a){return/^(?:body|html)$/i.test(a.tagName)}function e(a){var b={x:0,y:0};while(a&&!f(a))b.x+=a.scrollLeft,b.y+=a.scrollTop,a=a.parentNode;return b}function d(a){var b={x:0,y:0};while(a&&!f(a))b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;return b}var b=d(a),c=e(a);return{x:b.x-c.x,y:b.y-c.y}},a.event={get:function(a,b){b=b||window;return a||b.event},getWheel:function(a){return a.wheelDelta?a.wheelDelta/120:-(a.detail||0)/3},isRightClick:function(a){return a.which==3||a.button==2},getPos:function(a,b){b=b||window,a=a||b.event;var c=b.document;c=c.documentElement||c.body,a.touches&&a.touches.length&&(a=a.touches[0]);var d={x:a.pageX||a.clientX+c.scrollLeft,y:a.pageY||a.clientY+c.scrollTop};return d},stop:function(a){a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1}},$jit.util=$jit.id=a;var b=function(c){c=c||{};var d=function(){for(var c in this)typeof this[c]!="function"&&(this[c]=a.unlink(this[c]));this.constructor=d;if(b.prototyping)return this;var e=this.initialize?this.initialize.apply(this,arguments):this;this.$$family="class";return e};for(var e in b.Mutators){if(!c[e])continue;c=b.Mutators[e](c,c[e]),delete c[e]}a.extend(d,this),d.constructor=b,d.prototype=c;return d};b.Mutators={Implements:function(c,d){a.each(a.splat(d),function(a){b.prototyping=a;var d=typeof a=="function"?new a:a;for(var e in d)e in c||(c[e]=d[e]);delete b.prototyping});return c}},a.extend(b,{inherit:function(c,d){for(var e in d){var f=d[e],g=c[e],h=a.type(f);g&&h=="function"?f!=g&&b.override(c,e,f):h=="object"?c[e]=a.merge(g,f):c[e]=f}return c},override:function(a,c,d){var e=b.prototyping;e&&a[c]!=e[c]&&(e=null);var f=function(){var b=this.parent;this.parent=e?e[c]:a[c];var f=d.apply(this,arguments);this.parent=b;return f};a[c]=f}}),b.prototype.implement=function(){var c=this.prototype;a.each(Array.prototype.slice.call(arguments||[]),function(a){b.inherit(c,a)});return this},$jit.Class=b,$jit.json={prune:function(a,b){this.each(a,function(a,c){c==b&&a.children&&(delete a.children,a.children=[])})},getParent:function(a,b){if(a.id==b)return!1;var c=a.children;if(c&&c.length>0)for(var d=0;d<c.length;d++){if(c[d].id==b)return a;var e=this.getParent(c[d],b);if(e)return e}return!1},getSubtree:function(a,b){if(a.id==b)return a;for(var c=0,d=a.children;c<d.length;c++){var e=this.getSubtree(d[c],b);if(e!=null)return e}return null},eachLevel:function(a,b,c,d){if(b<=c){d(a,b);if(!a.children)return;for(var e=0,f=a.children;e<f.length;e++)this.eachLevel(f[e],b+1,c,d)}},each:function(a,b){this.eachLevel(a,0,Number.MAX_VALUE,b)}},$jit.Trans={$extend:!0,linear:function(a){return a}};var c=$jit.Trans;(function(){var b=function(b,c){c=a.splat(c);return a.extend(b,{easeIn:function(a){return b(a,c)},easeOut:function(a){return 1-b(1-a,c)},easeInOut:function(a){return a<=.5?b(2*a,c)/2:(2-b(2*(1-a),c))/2}})},d={Pow:function(a,b){return Math.pow(a,b[0]||6)},Expo:function(a){return Math.pow(2,8*(a-1))},Circ:function(a){return 1-Math.sin(Math.acos(a))},Sine:function(a){return 1-Math.sin((1-a)*Math.PI/2)},Back:function(a,b){b=b[0]||1.618;return Math.pow(a,2)*((b+1)*a-b)},Bounce:function(a){var b;for(var c=0,d=1;1;c+=d,d/=2)if(a>=(7-4*c)/11){b=d*d-Math.pow((11-6*c-11*a)/4,2);break}return b},Elastic:function(a,b){return Math.pow(2,10*--a)*Math.cos(20*a*Math.PI*(b[0]||1)/3)}};a.each(d,function(a,d){c[d]=b(a)}),a.each(["Quad","Cubic","Quart","Quint"],function(a,d){c[a]=b(function(a){return Math.pow(a,[d+2])})})})();var d=new b({initialize:function(a){this.setOptions(a)},setOptions:function(b){var d={duration:2500,fps:40,transition:c.Quart.easeInOut,compute:a.empty,complete:a.empty,link:"ignore"};this.opt=a.merge(d,b||{});return this},step:function(){var b=a.time(),c=this.opt;if(b<this.time+c.duration){var d=c.transition((b-this.time)/c.duration);c.compute(d)}else this.timer=clearInterval(this.timer),c.compute(1),c.complete()},start:function(){if(!this.check())return this;this.time=0,this.startTimer();return this},startTimer:function(){var b=this,c=this.opt.fps;if(this.timer)return!1;this.time=a.time()-this.time,this.timer=setInterval(function(){b.step()},Math.round(1e3/c));return!0},pause:function(){this.stopTimer();return this},resume:function(){this.startTimer();return this},stopTimer:function(){if(!this.timer)return!1;this.time=a.time()-this.time,this.timer=clearInterval(this.timer);return!0},check:function(){if(!this.timer)return!0;if(this.opt.link=="cancel"){this.stopTimer();return!0}return!1}}),e=function(){var b=arguments;for(var c=0,d=b.length,f={};c<d;c++){var g=e[b[c]];g.$extend?a.extend(f,g):f[b[c]]=g}return f};e.AreaChart={$extend:!0,animate:!0,labelOffset:3,type:"stacked",Tips:{enable:!1,onShow:a.empty,onHide:a.empty},Events:{enable:!1,onClick:a.empty},selectOnHover:!0,showAggregates:!0,showLabels:!0,filterOnClick:!1,restoreOnRightClick:!1},e.Margin={$extend:!1,top:0,left:0,right:0,bottom:0},e.Canvas={$extend:!0,injectInto:"id",width:!1,height:!1,useCanvas:!1,withLabels:!0,background:!1},e.Tree={$extend:!0,orientation:"left",subtreeOffset:8,siblingOffset:5,indent:10,multitree:!1,align:"center"},e.Node={$extend:!1,overridable:!1,type:"circle",color:"#ccb",alpha:1,dim:3,height:20,width:90,autoHeight:!1,autoWidth:!1,lineWidth:1,transform:!0,align:"center",angularWidth:1,span:1,CanvasStyles:{}},e.Edge={$extend:!1,overridable:!1,type:"line",color:"#ccb",lineWidth:1,dim:15,alpha:1,epsilon:7,CanvasStyles:{}},e.Fx={$extend:!0,fps:40,duration:2500,transition:$jit.Trans.Quart.easeInOut,clearCanvas:!0},e.Label={$extend:!1,overridable:!1,type:"HTML",style:" ",size:10,family:"sans-serif",textAlign:"center",textBaseline:"alphabetic",color:"#fff"},e.Tips={$extend:!1,enable:!1,type:"auto",offsetX:20,offsetY:20,force:!1,onShow:a.empty,onHide:a.empty},e.NodeStyles={$extend:!1,enable:!1,type:"auto",stylesHover:!1,stylesClick:!1},e.Events={$extend:!1,enable:!1,enableForEdges:!1,type:"auto",onClick:a.empty,onRightClick:a.empty,onMouseMove:a.empty,onMouseEnter:a.empty,onMouseLeave:a.empty,onDragStart:a.empty,onDragMove:a.empty,onDragCancel:a.empty,onDragEnd:a.empty,onTouchStart:a.empty,onTouchMove:a.empty,onTouchEnd:a.empty,onMouseWheel:a.empty},e.Navigation={$extend:!1,enable:!1,type:"auto",panning:!1,zooming:!1},e.Controller={$extend:!0,onBeforeCompute:a.empty,onAfterCompute:a.empty,onCreateLabel:a.empty,onPlaceLabel:a.empty,onComplete:a.empty,onBeforePlotLine:a.empty,onAfterPlotLine:a.empty,onBeforePlotNode:a.empty,onAfterPlotNode:a.empty,request:!1};var f={initialize:function(a,b){this.viz=b,this.canvas=b.canvas,this.config=b.config[a],this.nodeTypes=b.fx.nodeTypes;var c=this.config.type;this.dom=c=="auto"?b.config.Label.type!="Native":c!="Native",this.labelContainer=this.dom&&b.labels.getLabelContainer(),this.isEnabled()&&this.initializePost()},initializePost:a.empty,setAsProperty:a.lambda(!1),isEnabled:function(){return this.config.enable},isLabel:function(b,c){b=a.event.get(b,c);var d=this.labelContainer,e=b.target||b.srcElement;if(e&&e.parentNode==d)return e;return!1}},g={onMouseUp:a.empty,onMouseDown:a.empty,onMouseMove:a.empty,onMouseOver:a.empty,onMouseOut:a.empty,onMouseWheel:a.empty,onTouchStart:a.empty,onTouchMove:a.empty,onTouchEnd:a.empty,onTouchCancel:a.empty},h=new b({initialize:function(a){this.viz=a,this.canvas=a.canvas,this.node=!1,this.edge=!1,this.registeredObjects=[],this.attachEvents()},attachEvents:function(){var b=this.canvas.getElement(),c=this;b.oncontextmenu=a.lambda(!1),a.addEvents(b,{mouseup:function(b,d){var e=a.event.get(b,d);c.handleEvent("MouseUp",b,d,c.makeEventObject(b,d),a.event.isRightClick(e))},mousedown:function(b,d){var e=a.event.get(b,d);c.handleEvent("MouseDown",b,d,c.makeEventObject(b,d),a.event.isRightClick(e))},mousemove:function(a,b){c.handleEvent("MouseMove",a,b,c.makeEventObject(a,b))},mouseover:function(a,b){c.handleEvent("MouseOver",a,b,c.makeEventObject(a,b))},mouseout:function(a,b){c.handleEvent("MouseOut",a,b,c.makeEventObject(a,b))},touchstart:function(a,b){c.handleEvent("TouchStart",a,b,c.makeEventObject(a,b))},touchmove:function(a,b){c.handleEvent("TouchMove",a,b,c.makeEventObject(a,b))},touchend:function(a,b){c.handleEvent("TouchEnd",a,b,c.makeEventObject(a,b))}});var d=function(b,d){var e=a.event.get(b,d),f=a.event.getWheel(e);c.handleEvent("MouseWheel",b,d,f)};document.getBoxObjectFor||window.mozInnerScreenX!=null?b.addEventListener("DOMMouseScroll",d,!1):a.addEvent(b,"mousewheel",d)},register:function(a){this.registeredObjects.push(a)},handleEvent:function(){var a=Array.prototype.slice.call(arguments),b=a.shift();for(var c=0,d=this.registeredObjects,e=d.length;c<e;c++)d[c]["on"+b].apply(d[c],a)},makeEventObject:function(b,c){var d=this,e=this.viz.graph,f=this.viz.fx,g=f.nodeTypes,h=f.edgeTypes;return{pos:!1,node:!1,edge:!1,contains:!1,getNodeCalled:!1,getEdgeCalled:!1,getPos:function(){var e=d.viz.canvas,f=e.getSize(),g=e.getPos(),h=e.translateOffsetX,i=e.translateOffsetY,j=e.scaleOffsetX,k=e.scaleOffsetY,l=a.event.getPos(b,c);this.pos={x:(l.x-g.x-f.width/2-h)*1/j,y:(l.y-g.y-f.height/2-i)*1/k};return this.pos},getNode:function(){if(this.getNodeCalled)return this.node;this.getNodeCalled=!0;for(var a in e.nodes){var b=e.nodes[a],c=b&&g[b.getData("type")],h=c&&c.contains&&c.contains.call(f,b,this.getPos());if(h){this.contains=h;return d.node=this.node=b}}return d.node=this.node=!1},getEdge:function(){if(this.getEdgeCalled)return this.edge;this.getEdgeCalled=!0;var a={};for(var b in e.edges){var c=e.edges[b];a[b]=!0;for(var g in c){if(g in a)continue;var i=c[g],j=i&&h[i.getData("type")],k=j&&j.contains&&j.contains.call(f,i,this.getPos());if(k){this.contains=k;return d.edge=this.edge=i}}}return d.edge=this.edge=!1},getContains:function(){if(this.getNodeCalled)return this.contains;this.getNode();return this.contains}}}}),i={initializeExtras:function(){var b=new h(this),c=this;a.each(["NodeStyles","Tips","Navigation","Events"],function(a){var d=new i.Classes[a](a,c);d.isEnabled()&&b.register(d),d.setAsProperty()&&(c[a.toLowerCase()]=d)})}};i.Classes={},i.Classes.Events=new b({Implements:[f,g],initializePost:function(){this.fx=this.viz.fx,this.ntypes=this.viz.fx.nodeTypes,this.etypes=this.viz.fx.edgeTypes,this.hovered=!1,this.pressed=!1,this.touched=!1,this.touchMoved=!1,this.moved=!1},setAsProperty:a.lambda(!0),onMouseUp:function(b,c,d,e){var f=a.event.get(b,c);this.moved||(e?this.config.onRightClick(this.hovered,d,f):this.config.onClick(this.pressed,d,f)),this.pressed&&(this.moved?this.config.onDragEnd(this.pressed,d,f):this.config.onDragCancel(this.pressed,d,f),this.pressed=this.moved=!1)},onMouseOut:function(b,c,d){var e=a.event.get(b,c),f;if(this.dom&&(f=this.isLabel(b,c)))this.config.onMouseLeave(this.viz.graph.getNode(f.id),d,e),this.hovered=!1;else{var g=e.relatedTarget,h=this.canvas.getElement();while(g&&g.parentNode){if(h==g.parentNode)return;g=g.parentNode}this.hovered&&(this.config.onMouseLeave(this.hovered,d,e),this.hovered=!1)}},onMouseOver:function(b,c,d){var e=a.event.get(b,c),f;this.dom&&(f=this.isLabel(b,c))&&(this.hovered=this.viz.graph.getNode(f.id),this.config.onMouseEnter(this.hovered,d,e))},onMouseMove:function(b,c,d){var e,f=a.event.get(b,c);if(this.pressed)this.moved=!0,this.config.onDragMove(this.pressed,d,f);else if(this.dom)this.config.onMouseMove(this.hovered,d,f);else{if(this.hovered){var g=this.hovered,h=g.nodeFrom?this.etypes[g.getData("type")]:this.ntypes[g.getData("type")],i=h&&h.contains&&h.contains.call(this.fx,g,d.getPos());if(i){this.config.onMouseMove(g,d,f);return}this.config.onMouseLeave(g,d,f),this.hovered=!1}(this.hovered=d.getNode()||this.config.enableForEdges&&d.getEdge())?this.config.onMouseEnter(this.hovered,d,f):this.config.onMouseMove(!1,d,f)}},onMouseWheel:function(b,c,d){this.config.onMouseWheel(d,a.event.get(b,c))},onMouseDown:function(b,c,d){var e=a.event.get(b,c);this.pressed=d.getNode()||this.config.enableForEdges&&d.getEdge(),this.config.onDragStart(this.pressed,d,e)},onTouchStart:function(b,c,d){var e=a.event.get(b,c);this.touched=d.getNode()||this.config.enableForEdges&&d.getEdge(),this.config.onTouchStart(this.touched,d,e)},onTouchMove:function(b,c,d){var e=a.event.get(b,c);this.touched&&(this.touchMoved=!0,this.config.onTouchMove(this.touched,d,e))},onTouchEnd:function(b,c,d){var e=a.event.get(b,c);this.touched&&(this.touchMoved?this.config.onTouchEnd(this.touched,d,e):this.config.onTouchCancel(this.touched,d,e),this.touched=this.touchMoved=!1)}}),i.Classes.Tips=new b({Implements:[f,g],initializePost:function(){if(document.body){var b=a("_tooltip")||document.createElement("div");b.id="_tooltip",b.className="tip",a.extend(b.style,{position:"absolute",display:"none",zIndex:13e3}),document.body.appendChild(b),this.tip=b,this.node=!1}},setAsProperty:a.lambda(!0),onMouseOut:function(a,b){if(this.dom&&this.isLabel(a,b))this.hide(!0);else{var c=a.relatedTarget,d=this.canvas.getElement();while(c&&c.parentNode){if(d==c.parentNode)return;c=c.parentNode}this.hide(!1)}},onMouseOver:function(a,b){var c;this.dom&&(c=this.isLabel(a,b))&&(this.node=this.viz.graph.getNode(c.id),this.config.onShow(this.tip,this.node,c))},onMouseMove:function(b,c,d){this.dom&&this.isLabel(b,c)&&this.setTooltipPosition(a.event.getPos(b,c));if(!this.dom){var e=d.getNode();if(!e){this.hide(!0);return}if(this.config.force||!this.node||this.node.id!=e.id)this.node=e,this.config.onShow(this.tip,e,d.getContains());this.setTooltipPosition(a.event.getPos(b,c))}},setTooltipPosition:function(a){var b=this.tip,c=b.style,d=this.config;c.display="";var e={height:document.body.clientHeight,width:document.body.clientWidth},f={width:b.offsetWidth,height:b.offsetHeight},g=d.offsetX,h=d.offsetY;c.top=(a.y+h+f.height>e.height?a.y-f.height-h:a.y+h)+"px",c.left=(a.x+f.width+g>e.width?a.x-f.width-g:a.x+g)+"px"},hide:function(a){this.tip.style.display="none",a&&this.config.onHide()}}),i.Classes.NodeStyles=new b({Implements:[f,g],initializePost:function(){this.fx=this.viz.fx,this.types=this.viz.fx.nodeTypes,this.nStyles=this.config,this.nodeStylesOnHover=this.nStyles.stylesHover,this.nodeStylesOnClick=this.nStyles.stylesClick,this.hoveredNode=!1,this.fx.nodeFxAnimation=new d,this.down=!1,this.move=!1},onMouseOut:function(a,b){this.down=this.move=!1;if(this.hoveredNode){this.dom&&this.isLabel(a,b)&&this.toggleStylesOnHover(this.hoveredNode,!1);var c=a.relatedTarget,d=this.canvas.getElement();while(c&&c.parentNode){if(d==c.parentNode)return;c=c.parentNode}this.toggleStylesOnHover(this.hoveredNode,!1),this.hoveredNode=!1}},onMouseOver:function(a,b){var c;if(this.dom&&(c=this.isLabel(a,b))){var d=this.viz.graph.getNode(c.id);if(d.selected)return;this.hoveredNode=d,this.toggleStylesOnHover(this.hoveredNode,!0)}},onMouseDown:function(a,b,c,d){if(!d){var e;this.dom&&(e=this.isLabel(a,b))?this.down=this.viz.graph.getNode(e.id):this.dom||(this.down=c.getNode()),this.move=!1}},onMouseUp:function(a,b,c,d){d||(this.move||this.onClick(c.getNode()),this.down=this.move=!1)},getRestoredStyles:function(a,b){var c={},d=this["nodeStylesOn"+b];for(var e in d)c[e]=a.styles["$"+e];return c},toggleStylesOnHover:function(a,b){this.nodeStylesOnHover&&this.toggleStylesOn("Hover",a,b)},toggleStylesOnClick:function(a,b){this.nodeStylesOnClick&&this.toggleStylesOn("Click",a,b)},toggleStylesOn:function(b,d,e){var f=this.viz,g=this.nStyles;if(e){var h=this;d.styles||(d.styles=a.merge(d.data,{}));for(var i in this["nodeStylesOn"+b]){var j="$"+i;j in d.styles||(d.styles[j]=d.getData(i))}f.fx.nodeFx(a.extend({elements:{id:d.id,properties:h["nodeStylesOn"+b]},transition:c.Quart.easeOut,duration:300,fps:40},this.config))}else{var k=this.getRestoredStyles(d,b);f.fx.nodeFx(a.extend({elements:{id:d.id,properties:k},transition:c.Quart.easeOut,duration:300,fps:40},this.config))}},onClick:function(a){if(a){var b=this.nodeStylesOnClick;if(!b)return;a.selected?(this.toggleStylesOnClick(a,!1),delete a.selected):(this.viz.graph.eachNode(function(a){if(a.selected){for(var c in b)a.setData(c,a.styles["$"+c],"end");delete a.selected}}),this.toggleStylesOnClick(a,!0),a.selected=!0,delete a.hovered,this.hoveredNode=!1)}},onMouseMove:function(a,b,c){this.down&&(this.move=!0);if(!this.dom||!this.isLabel(a,b)){var d=this.nodeStylesOnHover;if(!d)return;if(!this.dom){if(this.hoveredNode){var e=this.types[this.hoveredNode.getData("type")],f=e&&e.contains&&e.contains.call(this.fx,this.hoveredNode,c.getPos());if(f)return}var g=c.getNode();if(!this.hoveredNode&&!g)return;if(g.hovered)return;g&&!g.selected?(this.fx.nodeFxAnimation.stopTimer(),this.viz.graph.eachNode(function(a){if(a.hovered&&!a.selected){for(var b in d)a.setData(b,a.styles["$"+b],"end");delete a.hovered}}),g.hovered=!0,this.hoveredNode=g,this.toggleStylesOnHover(g,!0)):this.hoveredNode&&!this.hoveredNode.selected&&(this.fx.nodeFxAnimation.stopTimer(),this.toggleStylesOnHover(this.hoveredNode,!1),delete this.hoveredNode.hovered,this.hoveredNode=!1)}}}}),i.Classes.Navigation=new b({Implements:[f,g],initializePost:function(){this.pos=!1,this.pressed=!1},onMouseWheel:function(b,c,d){if(this.config.zooming){a.event.stop(a.event.get(b,c));var e=this.config.zooming/1e3,f=1+d*e;this.canvas.scale(f,f)}},onMouseDown:function(a,b,c){if(this.config.panning){if(this.config.panning=="avoid nodes"&&c.getNode())return;this.pressed=!0,this.pos=c.getPos();var d=this.canvas,e=d.translateOffsetX,f=d.translateOffsetY,g=d.scaleOffsetX,h=d.scaleOffsetY;this.pos.x*=g,this.pos.x+=e,this.pos.y*=h,this.pos.y+=f}},onMouseMove:function(a,b,c){if(this.config.panning){if(!this.pressed)return;if(this.config.panning=="avoid nodes"&&c.getNode())return;var d=this.pos,e=c.getPos(),f=this.canvas,g=f.translateOffsetX,h=f.translateOffsetY,i=f.scaleOffsetX,j=f.scaleOffsetY;e.x*=i,e.y*=j,e.x+=g,e.y+=h;var k=e.x-d.x,l=e.y-d.y;this.pos=e,this.canvas.translate(k*1/i,l*1/j)}},onMouseUp:function(a,b,c,d){this.config.panning&&(this.pressed=!1)}});var j;(function(){function e(b,c){var e=document.createElement(b);for(var f in c)typeof c[f]=="object"?a.extend(e[f],c[f]):e[f]=c[f];b=="canvas"&&!d&&G_vmlCanvasManager&&(e=G_vmlCanvasManager.initElement(document.body.appendChild(e)));return e}var c=typeof HTMLCanvasElement,d=c=="object"||c=="function";$jit.Canvas=j=new b({canvases:[],pos:!1,element:!1,labelContainer:!1,translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(b,c){this.viz=b,this.opt=c;var d=a.type(c.injectInto)=="string"?c.injectInto:c.injectInto.id,f=d+"-label",g=a(d),h=c.width||g.offsetWidth,i=c.height||g.offsetHeight;this.id=d;var k={injectInto:d,width:h,height:i};this.element=e("div",{id:d+"-canvaswidget",style:{position:"relative",width:h+"px",height:i+"px"}}),this.labelContainer=this.createLabelContainer(c.Label.type,f,k),this.canvases.push(new j.Base({config:a.extend({idSuffix:"-canvas"},k),plot:function(a){b.fx.plot()},resize:function(){b.refresh()}}));var l=c.background;if(l){var m=new j.Background[l.type](b,a.extend(l,k));this.canvases.push(new j.Base(m))}var n=this.canvases.length;while(n--)this.element.appendChild(this.canvases[n].canvas),n>0&&this.canvases[n].plot();this.element.appendChild(this.labelContainer),g.appendChild(this.element);var o=null,p=this;a.addEvent(window,"scroll",function(){clearTimeout(o),o=setTimeout(function(){p.getPos(!0)},500)})},getCtx:function(a){return this.canvases[a||0].getCtx()},getConfig:function(){return this.opt},getElement:function(){return this.element},getSize:function(a){return this.canvases[a||0].getSize()},resize:function(a,b){this.getPos(!0),this.translateOffsetX=this.translateOffsetY=0,this.scaleOffsetX=this.scaleOffsetY=1;for(var c=0,d=this.canvases.length;c<d;c++)this.canvases[c].resize(a,b);var e=this.element.style;e.width=a+"px",e.height=b+"px",this.labelContainer&&(this.labelContainer.style.width=a+"px")},translate:function(a,b,c){this.translateOffsetX+=a*this.scaleOffsetX,this.translateOffsetY+=b*this.scaleOffsetY;for(var d=0,e=this.canvases.length;d<e;d++)this.canvases[d].translate(a,b,c)},scale:function(a,b,c){var d=this.scaleOffsetX*a,e=this.scaleOffsetY*b,f=this.translateOffsetX*(a-1)/d,g=this.translateOffsetY*(b-1)/e;this.scaleOffsetX=d,this.scaleOffsetY=e;for(var h=0,i=this.canvases.length;h<i;h++)this.canvases[h].scale(a,b,!0);this.translate(f,g,!1)},getPos:function(b){if(b||!this.pos)return this.pos=a.getPos(this.getElement());return this.pos},clear:function(a){this.canvases[a||0].clear()},path:function(a,b){var c=this.canvases[0].getCtx();c.beginPath(),b(c),c[a](),c.closePath()},createLabelContainer:function(a,b,c){var d="http://www.w3.org/2000/svg";if(a=="HTML"||a=="Native")return e("div",{id:b,style:{overflow:"visible",position:"absolute",top:0,left:0,width:c.width+"px",height:0}});if(a=="SVG"){var f=document.createElementNS(d,"svg:svg");f.setAttribute("width",c.width),f.setAttribute("height",c.height);var g=f.style;g.position="absolute",g.left=g.top="0px";var h=document.createElementNS(d,"svg:g");h.setAttribute("width",c.width),h.setAttribute("height",c.height),h.setAttribute("x",0),h.setAttribute("y",0),h.setAttribute("id",b),f.appendChild(h);return f}}}),j.Base=new b({translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(a){this.viz=a,this.opt=a.config,this.size=!1,this.createCanvas(),this.translateToCenter()},createCanvas:function(){var a=this.opt,b=a.width,c=a.height;this.canvas=e("canvas",{id:a.injectInto+a.idSuffix,width:b,height:c,style:{position:"absolute",top:0,left:0,width:b+"px",height:c+"px"}})},getCtx:function(){if(!this.ctx)return this.ctx=this.canvas.getContext("2d");return this.ctx},getSize:function(){if(this.size)return this.size;var a=this.canvas;return this.size={width:a.width,height:a.height}},translateToCenter:function(a){var b=this.getSize(),c=a?b.width-a.width-this.translateOffsetX*2:b.width;height=a?b.height-a.height-this.translateOffsetY*2:b.height;var d=this.getCtx();a&&d.scale(1/this.scaleOffsetX,1/this.scaleOffsetY),d.translate(c/2,height/2)},resize:function(a,b){var c=this.getSize(),e=this.canvas,f=e.style;this.size=!1,e.width=a,e.height=b,f.width=a+"px",f.height=b+"px",d?this.translateToCenter():this.translateToCenter(c),this.translateOffsetX=this.translateOffsetY=0,this.scaleOffsetX=this.scaleOffsetY=1,this.clear(),this.viz.resize(a,b,this)},translate:function(a,b,c){var d=this.scaleOffsetX,e=this.scaleOffsetY;this.translateOffsetX+=a*d,this.translateOffsetY+=b*e,this.getCtx().translate(a,b),!c&&this.plot()},scale:function(a,b,c){this.scaleOffsetX*=a,this.scaleOffsetY*=b,this.getCtx().scale(a,b),!c&&this.plot()},clear:function(){var a=this.getSize(),b=this.translateOffsetX,c=this.translateOffsetY,d=this.scaleOffsetX,e=this.scaleOffsetY;this.getCtx().clearRect((-a.width/2-b)*1/d,(-a.height/2-c)*1/e,a.width*1/d,a.height*1/e)},plot:function(){this.clear(),this.viz.plot(this)}}),j.Background={},j.Background.Circles=new b({initialize:function(b,c){this.viz=b,this.config=a.merge({idSuffix:"-bkcanvas",levelDistance:100,numberOfCircles:6,CanvasStyles:{},offset:0},c)},resize:function(a,b,c){this.plot(c)},plot:function(a){var b=a.canvas,c=a.getCtx(),d=this.config,e=d.CanvasStyles;for(var f in e)c[f]=e[f];var g=d.numberOfCircles,h=d.levelDistance;for(var i=1;i<=g;i++)c.beginPath(),c.arc(0,0,h*i,0,2*Math.PI,!1),c.stroke(),c.closePath()}})})();var k=function(a,b){this.theta=a,this.rho=b};$jit.Polar=k,k.prototype={getc:function(a){return this.toComplex(a)},getp:function(){return this},set:function(a){a=a.getp(),this.theta=a.theta,this.rho=a.rho},setc:function(a,b){this.rho=Math.sqrt(a*a+b*b),this.theta=Math.atan2(b,a),this.theta<0&&(this.theta+=Math.PI*2)},setp:function(a,b){this.theta=a,this.rho=b},clone:function(){return new k(this.theta,this.rho)},toComplex:function(a){var b=Math.cos(this.theta)*this.rho,c=Math.sin(this.theta)*this.rho;if(a)return{x:b,y:c};return new m(b,c)},add:function(a){return new k(this.theta+a.theta,this.rho+a.rho)},scale:function(a){return new k(this.theta,this.rho*a)},equals:function(a){return this.theta==a.theta&&this.rho==a.rho},$add:function(a){this.theta=this.theta+a.theta,this.rho+=a.rho;return this},$madd:function(a){this.theta=(this.theta+a.theta)%(Math.PI*2),this.rho+=a.rho;return this},$scale:function(a){this.rho*=a;return this},interpolate:function(a,b){var c=Math.PI,d=c*2,e=function(a){var b=a<0?a%d+d:a%d;return b},f=this.theta,g=a.theta,h,i=Math.abs(f-g);i==c?f>g?h=e(g+(f-d-g)*b):h=e(g-d+(f-g)*b):i<c?h=e(g+(f-g)*b):f>g?h=e(g+(f-d-g)*b):h=e(g-d+(f-(g-d))*b);var j=(this.rho-a.rho)*b+a.rho;return{theta:h,rho:j}}};var l=function(a,b){return new k(a,b)};k.KER=l(0,0);var m=function(a,b){this.x=a,this.y=b};$jit.Complex=m,m.prototype={getc:function(){return this},getp:function(a){return this.toPolar(a)},set:function(a){a=a.getc(!0),this.x=a.x,this.y=a.y},setc:function(a,b){this.x=a,this.y=b},setp:function(a,b){this.x=Math.cos(a)*b,this.y=Math.sin(a)*b},clone:function(){return new m(this.x,this.y)},toPolar:function(a){var b=this.norm(),c=Math.atan2(this.y,this.x);c<0&&(c+=Math.PI*2);if(a)return{theta:c,rho:b};return new k(c,b)},norm:function(){return Math.sqrt(this.squaredNorm())},squaredNorm:function(){return this.x*this.x+this.y*this.y},add:function(a){return new m(this.x+a.x,this.y+a.y)},prod:function(a){return new m(this.x*a.x-this.y*a.y,this.y*a.x+this.x*a.y)},conjugate:function(){return new m(this.x,-this.y)},scale:function(a){return new m(this.x*a,this.y*a)},equals:function(a){return this.x==a.x&&this.y==a.y},$add:function(a){this.x+=a.x,this.y+=a.y;return this},$prod:function(a){var b=this.x,c=this.y;this.x=b*a.x-c*a.y,this.y=c*a.x+b*a.y;return this},$conjugate:function(){this.y=-this.y;return this},$scale:function(a){this.x*=a,this.y*=a;return this},$div:function(a){var b=this.x,c=this.y,d=a.squaredNorm();this.x=b*a.x+c*a.y,this.y=c*a.x-b*a.y;return this.$scale(1/d)}};var n=function(a,b){return new m(a,b)};m.KER=n(0,0),$jit.Graph=new b({initialize:function(b,c,d,e){var f={complex:!1,Node:{}};this.Node=c,this.Edge=d,this.Label=e,this.opt=a.merge(f,b||{}),this.nodes={},this.edges={};var g=this;this.nodeList={};for(var h in p)g.nodeList[h]=function(a){return function(){var b=Array.prototype.slice.call(arguments);g.eachNode(function(c){c[a].apply(c,b)})}}(h)},getNode:function(a){if(this.hasNode(a))return this.nodes[a];return!1},getByName:function(a){for(var b in this.nodes){var c=this.nodes[b];if(c.name==a)return c}return!1},getAdjacence:function(a,b){if(a in this.edges)return this.edges[a][b];return!1},addNode:function(b){if(!this.nodes[b.id]){var c=this.edges[b.id]={};this.nodes[b.id]=new o.Node(a.extend({id:b.id,name:b.name,data:a.merge(b.data||{},{}),adjacencies:c},this.opt.Node),this.opt.complex,this.Node,this.Edge,this.Label)}return this.nodes[b.id]},addAdjacence:function(a,b,c){this.hasNode(a.id)||this.addNode(a),this.hasNode(b.id)||this.addNode(b),a=this.nodes[a.id],b=this.nodes[b.id];if(!a.adjacentTo(b)){var d=this.edges[a.id]=this.edges[a.id]||{},e=this.edges[b.id]=this.edges[b.id]||{};d[b.id]=e[a.id]=new o.Adjacence(a,b,c,this.Edge,this.Label);return d[b.id]}return this.edges[a.id][b.id]},removeNode:function(a){if(this.hasNode(a)){delete this.nodes[a];var b=this.edges[a];for(var c in b)delete this.edges[c][a];delete this.edges[a]}},removeAdjacence:function(a,b){delete this.edges[a][b],delete this.edges[b][a]},hasNode:function(a){return a in this.nodes},empty:function(){this.nodes={},this.edges={}}});var o=$jit.Graph,p;(function(){var b=function(a,b,c,d,e){var f;c=c||"current",a="$"+(a?a+"-":""),c=="current"?f=this.data:c=="start"?f=this.startData:c=="end"&&(f=this.endData);var g=a+b;if(d)return f[g];if(!this.Config.overridable)return e[b]||0;return g in f?f[g]:g in this.data?this.data[g]:e[b]||0},c=function(a,b,c,d){d=d||"current",a="$"+(a?a+"-":"");var e;d=="current"?e=this.data:d=="start"?e=this.startData:d=="end"&&(e=this.endData),e[a+b]=c},d=function(b,c){b="$"+(b?b+"-":"");var d=this;a.each(c,function(a){var c=b+a;delete d.data[c],delete d.endData[c],delete d.startData[c]})};p={getData:function(a,c,d){return b.call(this,"",a,c,d,this.Config)},setData:function(a,b,d){c.call(this,"",a,b,d)},setDataset:function(b,c){b=a.splat(b);for(var d in c)for(var e=0,f=a.splat(c[d]),g=b.length;e<g;e++)this.setData(d,f[e],b[e])},removeData:function(){d.call(this,"",Array.prototype.slice.call(arguments))},getCanvasStyle:function(a,c,d){return b.call(this,"canvas",a,c,d,this.Config.CanvasStyles)},setCanvasStyle:function(a,b,d){c.call(this,"canvas",a,b,d)},setCanvasStyles:function(b,c){b=a.splat(b);for(var d in c)for(var e=0,f=a.splat(c[d]),g=b.length;e<g;e++)this.setCanvasStyle(d,f[e],b[e])},removeCanvasStyle:function(){d.call(this,"canvas",Array.prototype.slice.call(arguments))},getLabelData:function(a,c,d){return b.call(this,"label",a,c,d,this.Label)},setLabelData:function(a,b,d){c.call(this,"label",a,b,d)},setLabelDataset:function(b,c){b=a.splat(b);for(var d in c)for(var e=0,f=a.splat(c[d]),g=b.length;e<g;e++)this.setLabelData(d,f[e],b[e])},removeLabelData:function(){d.call(this,"label",Array.prototype.slice.call(arguments))}}})(),o.Node=new b({initialize:function(b,c,d,e,f){var g={id:"",name:"",data:{},startData:{},endData:{},adjacencies:{},selected:!1,drawn:!1,exist:!1,angleSpan:{begin:0,end:0},pos:c&&n(0,0)||l(0,0),startPos:c&&n(0,0)||l(0,0),endPos:c&&n(0,0)||l(0,0)};a.extend(this,a.extend(g,b)),this.Config=this.Node=d,this.Edge=e,this.Label=f},adjacentTo:function(a){return a.id in this.adjacencies},getAdjacency:function(a){return this.adjacencies[a]},getPos:function(a){a=a||"current";if(a=="current")return this.pos;if(a=="end")return this.endPos;if(a=="start")return this.startPos},setPos:function(a,b){b=b||"current";var c;b=="current"?c=this.pos:b=="end"?c=this.endPos:b=="start"&&(c=this.startPos),c.set(a)}}),o.Node.implement(p),o.Adjacence=new b({initialize:function(a,b,c,d,e){this.nodeFrom=a,this.nodeTo=b,this.data=c||{},this.startData={},this.endData={},this.Config=this.Edge=d,this.Label=e}}),o.Adjacence.implement(p),o.Util={filter:function(b){if(!b||a.type(b)!="string")return function(){return!0};var c=b.split(" ");return function(a){for(var b=0;b<c.length;b++)if(a[c[b]])return!1;return!0}},getNode:function(a,b){return a.nodes[b]},eachNode:function(a,b,c){var d=this.filter(c);for(var e in a.nodes)d(a.nodes[e])&&b(a.nodes[e])},eachAdjacency:function(a,b,c){var d=a.adjacencies,e=this.filter(c);for(var f in d){var g=d[f];if(e(g)){if(g.nodeFrom!=a){var h=g.nodeFrom;g.nodeFrom=g.nodeTo,g.nodeTo=h}b(g,f)}}},computeLevels:function(a,b,c,d){c=c||0;var e=this.filter(d);this.eachNode(a,function(a){a._flag=!1,a._depth=-1},d);var f=a.getNode(b);f._depth=c;var g=[f];while(g.length!=0){var h=g.pop();h._flag=!0,this.eachAdjacency(h,function(a){var b=a.nodeTo;b._flag==!1&&e(b)&&(b._depth<0&&(b._depth=h._depth+1+c),g.unshift(b))},d)}},eachBFS:function(a,b,c,d){var e=this.filter(d);this.clean(a);var f=[a.getNode(b)];while(f.length!=0){var g=f.pop();g._flag=!0,c(g,g._depth),this.eachAdjacency(g,function(a){var b=a.nodeTo;b._flag==!1&&e(b)&&(b._flag=!0,f.unshift(b))},d)}},eachLevel:function(a,b,c,d,e){var f=a._depth,g=this.filter(e),h=this;c=c===!1?Number.MAX_VALUE-f:c,function i(a,b,c){var e=a._depth;e>=b&&e<=c&&g(a)&&d(a,e),e<c&&h.eachAdjacency(a,function(a){var d=a.nodeTo;d._depth>e&&i(d,b,c)})}(a,b+f,c+f)},eachSubgraph:function(a,b,c){this.eachLevel(a,0,!1,b,c)},eachSubnode:function(a,b,c){this.eachLevel(a,1,1,b,c)},anySubnode:function(b,c,d){var e=!1;c=c||a.lambda(!0);var f=a.type(c)=="string"?function(a){return a[c]}:c;this.eachSubnode(b,function(a){f(a)&&(e=!0)},d);return e},getSubnodes:function(b,c,d){var e=[],f=this;c=c||0;var g,h;a.type(c)=="array"?(g=c[0],h=c[1]):(g=c,h=Number.MAX_VALUE-b._depth),this.eachLevel(b,g,h,function(a){e.push(a)},d);return e},getParents:function(a){var b=[];this.eachAdjacency(a,function(c){var d=c.nodeTo;d._depth<a._depth&&b.push(d)});return b},isDescendantOf:function(a,b){if(a.id==b)return!0;var c=this.getParents(a),d=!1;for(var e=0;!d&&e<c.length;e++)d=d||this.isDescendantOf(c[e],b);return d},clean:function(a){this.eachNode(a,function(a){a._flag=!1})},getClosestNodeToOrigin:function(a,b,c){return this.getClosestNodeToPos(a,k.KER,b,c)},getClosestNodeToPos:function(a,b,c,d){var e=null;c=c||"current",b=b&&b.getc(!0)||m.KER;var f=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};this.eachNode(a,function(a){e=e==null||f(a.getPos(c).getc(!0),b)<f(e.getPos(c).getc(!0),b)?a:e},d);return e}},a.each(["getNode","eachNode","computeLevels","eachBFS","clean","getClosestNodeToPos","getClosestNodeToOrigin"],function(a){o.prototype[a]=function(){return o.Util[a].apply(o.Util,[this].concat(Array.prototype.slice.call(arguments)))}}),a.each(["eachAdjacency","eachLevel","eachSubgraph","eachSubnode","anySubnode","getSubnodes","getParents","isDescendantOf"],function(a){o.Node.prototype[a]=function(){return o.Util[a].apply(o.Util,[this].concat(Array.prototype.slice.call(arguments)))}}),o.Op={options:{type:"nothing",duration:2e3,hideLabels:!0,fps:30},initialize:function(a){this.viz=a},removeNode:function(b,c){var d=this.viz,e=a.merge(this.options,d.controller,c),f=a.splat(b),g,h,i;switch(e.type){case"nothing":for(g=0;g<f.length;g++)d.graph.removeNode(f[g]);break;case"replot":this.removeNode(f,{type:"nothing"}),d.labels.clearLabels(),d.refresh(!0);break;case"fade:seq":case"fade":h=this;for(g=0;g<f.length;g++)i=d.graph.getNode(f[g]),i.setData("alpha",0,"end");d.fx.animate(a.merge(e,{modes:["node-property:alpha"],onComplete:function(){h.removeNode(f,{type:"nothing"}),d.labels.clearLabels(),d.reposition(),d.fx.animate(a.merge(e,{modes:["linear"]}))}}));break;case"fade:con":h=this;for(g=0;g<f.length;g++)i=d.graph.getNode(f[g]),i.setData("alpha",0,"end"),i.ignore=!0;d.reposition(),d.fx.animate(a.merge(e,{modes:["node-property:alpha","linear"],onComplete:function(){h.removeNode(f,{type:"nothing"})}}));break;case"iter":h=this,d.fx.sequence({condition:function(){return f.length!=0},step:function(){h.removeNode(f.shift(),{type:"nothing"}),d.labels.clearLabels()},onComplete:function(){e.onComplete()},duration:Math.ceil(e.duration/f.length)});break;default:this.doError()}},removeEdge:function(b,c){var d=this.viz,e=a.merge(this.options,d.controller,c),f=a.type(b[0])=="string"?[b]:b,g,h,i;switch(e.type){case"nothing":for(g=0;g<f.length;g++)d.graph.removeAdjacence(f[g][0],f[g][1]);break;case"replot":this.removeEdge(f,{type:"nothing"}),d.refresh(!0);break;case"fade:seq":case"fade":h=this;for(g=0;g<f.length;g++)i=d.graph.getAdjacence(f[g][0],f[g][1]),i&&i.setData("alpha",0,"end");d.fx.animate(a.merge(e,{modes:["edge-property:alpha"],onComplete:function(){h.removeEdge(f,{type:"nothing"}),d.reposition(),d.fx.animate(a.merge(e,{modes:["linear"]}))}}));break;case"fade:con":h=this;for(g=0;g<f.length;g++)i=d.graph.getAdjacence(f[g][0],f[g][1]),i&&(i.setData("alpha",0,"end"),i.ignore=!0);d.reposition(),d.fx.animate(a.merge(e,{modes:["edge-property:alpha","linear"],onComplete:function(){h.removeEdge(f,{type:"nothing"})}}));break;case"iter":h=this,d.fx.sequence({condition:function(){return f.length!=0},step:function(){h.removeEdge(f.shift(),{type:"nothing"}),d.labels.clearLabels()},onComplete:function(){e.onComplete()},duration:Math.ceil(e.duration/f.length)});break;default:this.doError()}},sum:function(b,c){var d=this.viz,e=a.merge(this.options,d.controller,c),f=d.root,g;d.root=c.id||d.root;switch(e.type){case"nothing":g=d.construct(b),g.eachNode(function(a){a.eachAdjacency(function(a){d.graph.addAdjacence(a.nodeFrom,a.nodeTo,a.data)})});break;case"replot":d.refresh(!0),this.sum(b,{type:"nothing"}),d.refresh(!0);break;case"fade:seq":case"fade":case"fade:con":that=this,g=d.construct(b);var h=this.preprocessSum(g),i=h?["node-property:alpha","edge-property:alpha"]:["node-property:alpha"];d.reposition(),e.type!="fade:con"?d.fx.animate(a.merge(e,{modes:["linear"],onComplete:function(){d.fx.animate(a.merge(e,{modes:i,onComplete:function(){e.onComplete()}}))}})):(d.graph.eachNode(function(a){a.id!=f&&a.pos.getp().equals(k.KER)&&(a.pos.set(a.endPos),a.startPos.set(a.endPos))}),d.fx.animate(a.merge(e,{modes:["linear"].concat(i)})));break;default:this.doError()}},morph:function(b,c,d){var e=this.viz,f=a.merge(this.options,e.controller,c),g=e.root,h;e.root=c.id||e.root;switch(f.type){case"nothing":h=e.construct(b),h.eachNode(function(a){var b=e.graph.hasNode(a.id);a.eachAdjacency(function(a){var b=!!e.graph.getAdjacence(a.nodeFrom.id,a.nodeTo.id);e.graph.addAdjacence(a.nodeFrom,a.nodeTo,a.data);if(b){var c=e.graph.getAdjacence(a.nodeFrom.id,a.nodeTo.id);for(var d in a.data||{})c.data[d]=a.data[d]}});if(b){var c=e.graph.getNode(a.id);for(var d in a.data||{})c.data[d]=a.data[d]}}),e.graph.eachNode(function(a){a.eachAdjacency(function(a){h.getAdjacence(a.nodeFrom.id,a.nodeTo.id)||e.graph.removeAdjacence(a.nodeFrom.id,a.nodeTo.id)}),h.hasNode(a.id)||e.graph.removeNode(a.id)});break;case"replot":e.labels.clearLabels(!0),this.morph(b,{type:"nothing"}),e.refresh(!0),e.refresh(!0);break;case"fade:seq":case"fade":case"fade:con":that=this,h=e.construct(b);var i=d&&"node-property"in d&&a.map(a.splat(d["node-property"]),function(a){return"$"+a});e.graph.eachNode(function(b){var c=h.getNode(b.id);if(c){var d=c.data;for(var e in d)i&&a.indexOf(i,e)>-1?b.endData[e]=d[e]:b.data[e]=d[e]}else b.setData("alpha",1),b.setData("alpha",1,"start"),b.setData("alpha",0,"end"),b.ignore=!0}),e.graph.eachNode(function(a){a.ignore||a.eachAdjacency(function(a){if(!a.nodeFrom.ignore&&!a.nodeTo.ignore){var b=h.getNode(a.nodeFrom.id),c=h.getNode(a.nodeTo.id);if(!b.adjacentTo(c)){var a=e.graph.getAdjacence(b.id,c.id);j=!0,a.setData("alpha",1),a.setData("alpha",1,"start"),a.setData("alpha",0,"end")}}})});var j=this.preprocessSum(h),l=j?["node-property:alpha","edge-property:alpha"]:["node-property:alpha"];l[0]=l[0]+(d&&"node-property"in d?":"+a.splat(d["node-property"]).join(":"):""),l[1]=(l[1]||"edge-property:alpha")+(d&&"edge-property"in d?":"+a.splat(d["edge-property"]).join(":"):""),d&&"label-property"in d&&l.push("label-property:"+a.splat(d["label-property"]).join(":")),e.reposition(),e.graph.eachNode(function(a){a.id!=g&&a.pos.getp().equals(k.KER)&&(a.pos.set(a.endPos),a.startPos.set(a.endPos))}),e.fx.animate(a.merge(f,{modes:["polar"].concat(l),onComplete:function(){e.graph.eachNode(function(a){a.ignore&&e.graph.removeNode(a.id)}),e.graph.eachNode(function(a){a.eachAdjacency(function(a){a.ignore&&e.graph.removeAdjacence(a.nodeFrom.id,a.nodeTo.id)})}),f.onComplete()}}));break;default:}},contract:function(b,c){var d=this.viz;!b.collapsed&&b.anySubnode(a.lambda(!0))&&(c=a.merge(this.options,d.config,c||{},{modes:["node-property:alpha:span","linear"]}),b.collapsed=!0,function e(a){a.eachSubnode(function(a){a.ignore=!0,a.setData("alpha",0,c.type=="animate"?"end":"current"),e(a)})}(b),c.type=="animate"?(d.compute("end"),d.rotated&&d.rotate(d.rotated,"none",{property:"end"}),function e(a){a.eachSubnode(function(a){a.setPos(b.getPos("end"),"end"),e(a)})}(b),d.fx.animate(c)):c.type=="replot"&&d.refresh())},expand:function(b,c){if("collapsed"in b){var d=this.viz;c=a.merge(this.options,d.config,c||{},{modes:["node-property:alpha:span","linear"]}),delete b.collapsed,function e(a){a.eachSubnode(function(a){delete a.ignore,a.setData("alpha",1,c.type=="animate"?"end":"current"),e(a)})}(b),c.type=="animate"?(d.compute("end"),d.rotated&&d.rotate(d.rotated,"none",{property:"end"}),d.fx.animate(c)):c.type=="replot"&&d.refresh()}},preprocessSum:function(a){var b=this.viz;a.eachNode(function(a){if(!b.graph.hasNode(a.id)){b.graph.addNode(a);var c=b.graph.getNode(a.id);c.setData("alpha",0),c.setData("alpha",0,"start"),c.setData("alpha",1,"end")}});var c=!1;a.eachNode(function(a){a.eachAdjacency(function(a){var d=b.graph.getNode(a.nodeFrom.id),e=b.graph.getNode(a.nodeTo.id);if(!d.adjacentTo(e)){var a=b.graph.addAdjacence(d,e,a.data);d.startAlpha==d.endAlpha&&e.startAlpha==e.endAlpha&&(c=!0,a.setData("alpha",0),a.setData("alpha",0,"start"),a.setData("alpha",1,"end"))}})});return c}};var q={none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(a,b,c,d){var e=d.getCtx();e.beginPath(),e.arc(b.x,b.y,c,0,Math.PI*2,!0),e.closePath(),e[a]()},contains:function(a,b,c){var d=a.x-b.x,e=a.y-b.y,f=d*d+e*e;return f<=c*c}},ellipse:{render:function(a,b,c,d,e){var f=e.getCtx();d/=2,c/=2,f.save(),f.scale(c/d,d/c),f.beginPath(),f.arc(b.x*(d/c),b.y*(c/d),d,0,Math.PI*2,!0),f.closePath(),f[a](),f.restore()},contains:function(a,b,c,d){c/=2,d/=2;var e=(c+d)/2,f=a.x-b.x,g=a.y-b.y,h=f*f+g*g;return h<=e*e}},square:{render:function(a,b,c,d){d.getCtx()[a+"Rect"](b.x-c,b.y-c,2*c,2*c)},contains:function(a,b,c){return Math.abs(b.x-a.x)<=c&&Math.abs(b.y-a.y)<=c}},rectangle:{render:function(a,b,c,d,e){e.getCtx()[a+"Rect"](b.x-c/2,b.y-d/2,c,d)},contains:function(a,b,c,d){return Math.abs(b.x-a.x)<=c/2&&Math.abs(b.y-a.y)<=d/2}},triangle:{render:function(a,b,c,d){var e=d.getCtx(),f=b.x,g=b.y-c,h=f-c,i=b.y+c,j=f+c,k=i;e.beginPath(),e.moveTo(f,g),e.lineTo(h,i),e.lineTo(j,k),e.closePath(),e[a]()},contains:function(a,b,c){return q.circle.contains(a,b,c)}},star:{render:function(a,b,c,d){var e=d.getCtx(),f=Math.PI/5;e.save(),e.translate(b.x,b.y),e.beginPath(),e.moveTo(c,0);for(var g=0;g<9;g++)e.rotate(f),g%2==0?e.lineTo(c/.525731*.200811,0):e.lineTo(c,0);e.closePath(),e[a](),e.restore()},contains:function(a,b,c){return q.circle.contains(a,b,c)}}},r={line:{render:function(a,b,c){var d=c.getCtx();d.beginPath(),d.moveTo(a.x,a.y),d.lineTo(b.x,b.y),d.stroke()},contains:function(a,b,c,d){var e=Math.min,f=Math.max,g=e(a.x,b.x),h=f(a.x,b.x),i=e(a.y,b.y),j=f(a.y,b.y);if(c.x>=g&&c.x<=h&&c.y>=i&&c.y<=j){if(Math.abs(b.x-a.x)<=d)return!0;var k=(b.y-a.y)/(b.x-a.x)*(c.x-a.x)+a.y;return Math.abs(k-c.y)<=d}return!1}},arrow:{render:function(a,b,c,d,e){var f=e.getCtx();if(d){var g=a;a=b,b=g}var h=new m(b.x-a.x,b.y-a.y);h.$scale(c/h.norm());var i=new m(b.x-h.x,b.y-h.y),j=new m(-h.y/2,h.x/2),k=i.add(j),l=i.$add(j.$scale(-1));f.beginPath(),f.moveTo(a.x,a.y),f.lineTo(b.x,b.y),f.stroke(),f.beginPath(),f.moveTo(k.x,k.y),f.lineTo(l.x,l.y),f.lineTo(b.x,b.y),f.closePath(),f.fill()},contains:function(a,b,c,d){return r.line.contains(a,b,c,d)}},hyperline:{render:function(a,b,c,d){function i(a,b){return a<b?a+Math.PI>b?!1:!0:b+Math.PI>a?!0:!1}function j(a,b){var c=a.x*b.y-a.y*b.x,d=c,e=a.squaredNorm(),f=b.squaredNorm();if(c==0)return{x:0,y:0,ratio:-1};var g=(a.y*f-b.y*e+a.y-b.y)/c,h=(b.x*e-a.x*f+b.x-a.x)/d,i=-g/2,j=-h/2,k=(g*g+h*h)/4-1;if(k<0)return{x:0,y:0,ratio:-1};var l=Math.sqrt(k),m={x:i,y:j,ratio:l>1e3?-1:l,a:g,b:h};return m}var e=d.getCtx(),f=j(a,b);if(f.a>1e3||f.b>1e3||f.ratio<0)e.beginPath(),e.moveTo(a.x*c,a.y*c),e.lineTo(b.x*c,b.y*c),e.stroke();else{var g=Math.atan2(b.y-f.y,b.x-f.x),h=Math.atan2(a.y-f.y,a.x-f.x),i=i(g,h);e.beginPath(),e.arc(f.x*c,f.y*c,f.ratio*c,g,h,i),e.stroke()}},contains:a.lambda(!1)}};o.Plot={initialize:function(a,b){this.viz=a,this.config=a.config,this.node=a.config.Node,this.edge=a.config.Edge,this.animation=new d,this.nodeTypes=new b.Plot.NodeTypes,this.edgeTypes=new b.Plot.EdgeTypes,this.labels=a.labels},nodeHelper:q,edgeHelper:r,Interpolator:{map:{border:"color",color:"color",width:"number",height:"number",dim:"number",alpha:"number",lineWidth:"number",angularWidth:"number",span:"number",valueArray:"array-number",dimArray:"array-number"},canvas:{globalAlpha:"number",fillStyle:"color",strokeStyle:"color",lineWidth:"number",shadowBlur:"number",shadowColor:"color",shadowOffsetX:"number",shadowOffsetY:"number",miterLimit:"number"},label:{size:"number",color:"color"},compute:function(a,b,c){return a+(b-a)*c},moebius:function(a,b,c,d){var e=d.scale(-c);if(e.norm()<1){var f=e.x,g=e.y,h=a.startPos.getc().moebiusTransformation(e);a.pos.setc(h.x,h.y),e.x=f,e.y=g}},linear:function(a,b,c){var d=a.startPos.getc(!0),e=a.endPos.getc(!0);a.pos.setc(this.compute(d.x,e.x,c),this.compute(d.y,e.y,c))},polar:function(a,b,c){var d=a.startPos.getp(!0),e=a.endPos.getp(),f=e.interpolate(d,c);a.pos.setp(f.theta,f.rho)},number:function(a,b,c,d,e){var f=a[d](b,"start"),g=a[d](b,"end");a[e](b,this.compute(f,g,c))},color:function(b,c,d,e,f){var g=a.hexToRgb(b[e](c,"start")),h=a.hexToRgb(b[e](c,"end")),i=this.compute,j=a.rgbToHex([parseInt(i(g[0],h[0],d)),parseInt(i(g[1],h[1],d)),parseInt(i(g[2],h[2],d))]);b[f](c,j)},"array-number":function(a,b,c,d,e){var f=a[d](b,"start"),g=a[d](b,"end"),h=[];for(var i=0,j=f.length;i<j;i++){var k=f[i],l=g[i];if(k.length){for(var m=0,n=k.length,o=[];m<n;m++)o.push(this.compute(k[m],l[m],c));h.push(o)}else h.push(this.compute(k,l,c))}a[e](b,h)},node:function(a,b,c,d,e,f){d=this[d];if(b){var g=b.length;for(var h=0;h<g;h++){var i=b[h];this[d[i]](a,i,c,e,f)}}else for(var i in d)this[d[i]](a,i,c,e,f)},edge:function(a,b,c,d,e,f){var g=a.adjacencies;for(var h in g)this.node(g[h],b,c,d,e,f)},"node-property":function(a,b,c){this.node(a,b,c,"map","getData","setData")},"edge-property":function(a,b,c){this.edge(a,b,c,"map","getData","setData")},"label-property":function(a,b,c){this.node(a,b,c,"label","getLabelData","setLabelData")},"node-style":function(a,b,c){this.node(a,b,c,"canvas","getCanvasStyle","setCanvasStyle")},"edge-style":function(a,b,c){this.edge(a,b,c,"canvas","getCanvasStyle","setCanvasStyle")}},sequence:function(b){var c=this;b=a.merge({condition:a.lambda(!1),step:a.empty,onComplete:a.empty,duration:200},b||{});var d=setInterval(function(){b.condition()?b.step():(clearInterval(d),b.onComplete()),c.viz.refresh(!0)},b.duration)},prepare:function(b){var c=this.viz.graph,d={"node-property":{getter:"getData",setter:"setData"},"edge-property":{getter:"getData",setter:"setData"},"node-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"},"edge-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"}},e={};if(a.type(b)=="array")for(var f=0,g=b.length;f<g;f++){var h=b[f].split(":");e[h.shift()]=h}else for(var i in b)i=="position"?e[b.position]=[]:e[i]=a.splat(b[i]);c.eachNode(function(b){b.startPos.set(b.pos),a.each(["node-property","node-style"],function(a){if(a in e){var c=e[a];for(var f=0,g=c.length;f<g;f++)b[d[a].setter](c[f],b[d[a].getter](c[f]),"start")}}),a.each(["edge-property","edge-style"],function(a){if(a in e){var c=e[a];b.eachAdjacency(function(b){for(var e=0,f=c.length;e<f;e++)b[d[a].setter](c[e],b[d[a].getter](c[e]),"start")})}})});return e},animate:function(b,c){b=a.merge(this.viz.config,b||{});var d=this,e=this.viz,f=e.graph,g=this.Interpolator,h=b.type==="nodefx"?this.nodeFxAnimation:this.animation,i=this.prepare(b.modes);b.hideLabels&&this.labels.hideLabels(!0),h.setOptions(a.merge(b,{$animating:!1,compute:function(a){f.eachNode(function(b){for(var d in i)g[d](b,i[d],a,c)}),d.plot(b,this.$animating,a),this.$animating=!0},complete:function(){b.hideLabels&&d.labels.hideLabels(!1),d.plot(b),b.onComplete(),b.onAfterCompute()}})).start()},nodeFx:function(b){var c=this.viz,d=c.graph,e=this.nodeFxAnimation,f=a.merge(this.viz.config,{elements:{id:!1,properties:{}},reposition:!1});b=a.merge(f,b||{},{onBeforeCompute:a.empty,onAfterCompute:a.empty}),e.stopTimer();var g=b.elements.properties;if(b.elements.id){var h=a.splat(b.elements.id);a.each(h,function(a){var b=d.getNode(a);if(b)for(var c in g)b.setData(c,g[c],"end")})}else d.eachNode(function(a){for(var b in g)a.setData(b,g[b],"end")});var i=[];for(var j in g)i.push(j);var k=["node-property:"+i.join(":")];b.reposition&&(k.push("linear"),c.compute("end")),this.animate(a.merge(b,{modes:k,type:"nodefx"}))},plot:function(a,b){var c=this.viz,d=c.graph,e=c.canvas,f=c.root,g=this,h=e.getCtx(),i=Math.min,a=a||this.viz.controller;a.clearCanvas&&e.clear();var j=d.getNode(f);if(j){var k=!!j.visited;d.eachNode(function(c){var d=c.getData("alpha");c.eachAdjacency(function(f){var j=f.nodeTo;!!j.visited===k&&c.drawn&&j.drawn&&(!b&&a.onBeforePlotLine(f),h.save(),h.globalAlpha=i(d,j.getData("alpha"),f.getData("alpha")),g.plotLine(f,e,b),h.restore(),!b&&a.onAfterPlotLine(f))}),h.save(),c.drawn&&(!b&&a.onBeforePlotNode(c),g.plotNode(c,e,b),!b&&a.onAfterPlotNode(c)),!g.labelsHidden&&a.withLabels&&(c.drawn&&d>=.95?g.labels.plotLabel(e,c,a):g.labels.hideLabel(c,!1)),h.restore(),c.visited=!k})}},plotTree:function(a,b,c){var d=this,e=this.viz,f=e.canvas,g=this.config,h=f.getCtx(),i=a.getData("alpha");a.eachSubnode(function(e){if(b.plotSubtree(a,e)&&e.exist&&e.drawn){var g=a.getAdjacency(e.id);!c&&b.onBeforePlotLine(g),h.globalAlpha=Math.min(i,e.getData("alpha")),d.plotLine(g,f,c),!c&&b.onAfterPlotLine(g),d.plotTree(e,b,c)}}),a.drawn?(!c&&b.onBeforePlotNode(a),this.plotNode(a,f,c),!c&&b.onAfterPlotNode(a),b.hideLabels||!b.withLabels||i<.95?this.labels.hideLabel(a,!1):this.labels.plotLabel(f,a,b)):this.labels.hideLabel(a,!0)},plotNode:function(a,b,c){var d=a.getData("type"),e=this.node.CanvasStyles;if(d!="none"){var f=a.getData("lineWidth"),g=a.getData("color"),h=a.getData("alpha"),i=b.getCtx();i.lineWidth=f,i.fillStyle=i.strokeStyle=g,i.globalAlpha=h;for(var j in e)i[j]=a.getCanvasStyle(j);this.nodeTypes[d].render.call(this,a,b,c)}},plotLine:function(a,b,c){var d=a.getData("type"),e=this.edge.CanvasStyles;if(d!="none"){var f=a.getData("lineWidth"),g=a.getData("color"),h=b.getCtx();h.lineWidth=f,h.fillStyle=h.strokeStyle=g;for(var i in e)h[i]=a.getCanvasStyle(i);this.edgeTypes[d].render.call(this,a,b,c)}}},o.Label={},o.Label.Native=new b({plotLabel:function(a,b,c){var d=a.getCtx(),e=b.pos.getc(!0);d.font=b.getLabelData("style")+" "+b.getLabelData("size")+"px "+b.getLabelData("family"),d.textAlign=b.getLabelData("textAlign"),d.fillStyle=d.strokeStyle=b.getLabelData("color"),d.textBaseline=b.getLabelData("textBaseline"),this.renderLabel(a,b,c)},renderLabel:function(a,b,c){var d=a.getCtx(),e=b.pos.getc(!0);d.fillText(b.name,e.x,e.y+b.getData("height")/2)},hideLabel:a.empty,hideLabels:a.empty}),o.Label.DOM=new b({labelsHidden:!1,labelContainer:!1,labels:{},getLabelContainer:function(){return this.labelContainer?this.labelContainer:this.labelContainer=document.getElementById(this.viz.config.labelContainer)},getLabel:function(a){return a in this.labels&&this.labels[a]!=null?this.labels[a]:this.labels[a]=document.getElementById(a)},hideLabels:function(a){var b=this.getLabelContainer();a?b.style.display="none":b.style.display="",this.labelsHidden=a},clearLabels:function(a){for(var b in this.labels)if(a||!this.viz.graph.hasNode(b))this.disposeLabel(b),delete this.labels[b]},disposeLabel:function(a){var b=this.getLabel(a);b&&b.parentNode&&b.parentNode.removeChild(b)},hideLabel:function(b,c){b=a.splat(b);var d=c?"":"none",e,f=this;a.each(b,function(a){var b=f.getLabel(a.id);b&&(b.style.display=d)})},fitsInCanvas:function(a,b){var c=b.getSize();if(a.x>=c.width||a.x<0||a.y>=c.height||a.y<0)return!1;return!0}}),o.Label.HTML=new b({Implements:o.Label.DOM,plotLabel:function(a,b,c){var d=b.id,e=this.getLabel(d);if(!e&&!(e=document.getElementById(d))){e=document.createElement("div");var f=this.getLabelContainer();e.id=d,e.className="node",e.style.position="absolute",c.onCreateLabel(e,b),f.appendChild(e),this.labels[b.id]=e}this.placeLabel(e,b,c)}}),o.Label.SVG=new b({Implements:o.Label.DOM,plotLabel:function(a,b,c){var d=b.id,e=this.getLabel(d);if(!e&&!(e=document.getElementById(d))){var f="http://www.w3.org/2000/svg";e=document.createElementNS(f,"svg:text");var g=document.createElementNS(f,"svg:tspan");e.appendChild(g);var h=this.getLabelContainer();e.setAttribute("id",d),e.setAttribute("class","node"),h.appendChild(e),c.onCreateLabel(e,b),this.labels[b.id]=e}this.placeLabel(e,b,c)}}),o.Geom=new b({initialize:function(a){this.viz=a,this.config=a.config,this.node=a.config.Node,this.edge=a.config.Edge},translate:function(b,c){c=a.splat(c),this.viz.graph.eachNode(function(d){a.each(c,function(a){d.getPos(a).$add(b)})})},setRightLevelToShow:function(b,c,d){var e=this.getRightLevelToShow(b,c),f=this.viz.labels,g=a.merge({execShow:!0,execHide:!0,onHide:a.empty,onShow:a.empty},d||{});b.eachLevel(0,this.config.levelsToShow,function(a){var c=a._depth-b._depth;c>e?(g.onHide(a),g.execHide&&(a.drawn=!1,a.exist=!1,f.hideLabel(a,!1))):(g.onShow(a),g.execShow&&(a.exist=!0))}),b.drawn=!0},getRightLevelToShow:function(a,b){var c=this.config,d=c.levelsToShow,e=c.constrained;if(!e)return d;while(!this.treeFitsInCanvas(a,b,d)&&d>1)d--;return d}});var s={construct:function(b){var c=a.type(b)=="array",d=new o(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);c?function(b,c){var d=function(a){for(var d=0,e=c.length;d<e;d++)if(c[d].id==a)return c[d];var f={id:a,name:a};return b.addNode(f)};for(var e=0,f=c.length;e<f;e++){b.addNode(c[e]);var g=c[e].adjacencies;if(g)for(var h=0,i=g.length;h<i;h++){var j=g[h],k={};typeof g[h]!="string"&&(k=a.merge(j.data,{}),j=j.nodeTo),b.addAdjacence(c[e],d(j),k)}}}(d,b):function(a,b){a.addNode(b);if(b.children)for(var c=0,d=b.children;c<d.length;c++)a.addAdjacence(b,d[c]),arguments.callee(a,d[c])}(d,b);return d},loadJSON:function(b,c){this.json=b,this.labels&&this.labels.clearLabels&&this.labels.clearLabels(!0),this.graph=this.construct(b),a.type(b)!="array"?this.root=b.id:this.root=b[c?c:0].id},toJSON:function(a){a=a||"tree";if(a=="tree"){var b={},c=this.graph.getNode(this.root),b=function d(a){var b={};b.id=a.id,b.name=a.name,b.data=a.data;var c=[];a.eachSubnode(function(a){c.push(d(a))}),b.children=c;return b}(c);return b}var b=[],e=!!this.graph.getNode(this.root).visited;this.graph.eachNode(function(a){var c={};c.id=a.id,c.name=a.name,c.data=a.data;var d=[];a.eachAdjacency(function(a){var b=a.nodeTo;if(!!b.visited===e){var c={};c.nodeTo=b.id,c.data=a.data,d.push(c)}}),c.adjacencies=d,b.push(c),a.visited=!e});return b}},t=$jit.Layouts={},u={label:null,compute:function(b,c,d){this.initializeLabel(d);var e=this.label,f=e.style;b.eachNode(function(b){var c=b.getData("autoWidth"),d=b.getData("autoHeight");if(c||d){delete b.data.$width,delete b.data.$height,delete b.data.$dim;var g=b.getData("width"),h=b.getData("height");f.width=c?"auto":g+"px",f.height=d?"auto":h+"px",e.innerHTML=b.name;var i=e.offsetWidth,j=e.offsetHeight,k=b.getData("type");if(a.indexOf(["circle","square","triangle","star"],k)===-1)b.setData("width",i),b.setData("height",j);else{var l=i>j?i:j;b.setData("width",l),b.setData("height",l),b.setData("dim",l)}}})},initializeLabel:function(a){this.label||(this.label=document.createElement("div"),document.body.appendChild(this.label)),this.setLabelStyles(a)},setLabelStyles:function(b){a.extend(this.label.style,{visibility:"hidden",position:"absolute",width:"auto",height:"auto"}),this.label.className="jit-autoadjust-label"}};t.Tree=function(){function m(a,b,c,g,i){function x(b,k,m){var n=b.getData(r,c),q=k||b.getData(s,c),y=[],A=[],C=!1,E=q+g.levelDistance;b.eachSubnode(function(b){if(b.exist&&(!j||"$orn"in b.data&&b.data.$orn==i)){C||(C=d(a,g,b._depth,i,c));var e=x(b,C[s],m+E);y.push(e.tree),A.push(e.extent)}});var F=l(A,u,t,v);for(var J=0,N=[],Q=[];J<y.length;J++)e(y[J],c,F[J],i),Q.push(f(A[J],F[J]));var R=[[-n/2,n/2]].concat(h(Q));b.getPos(c)[o]=0,i=="top"||i=="left"?b.getPos(c)[p]=m:b.getPos(c)[p]=-m;return{tree:b,extent:R}}var j=g.multitree,k=["x","y"],m=["width","height"],n=+(i=="left"||i=="right"),o=k[n],p=k[1-n],q=g.Node,r=m[n],s=m[1-n],t=g.siblingOffset,u=g.subtreeOffset,v=g.align;x(b,!1,0)}function l(a,b,c,d){var e=j(a,b,c),f=k(a,b,c);d=="left"?f=e:d=="right"&&(e=f);for(var g=0,h=[];g<e.length;g++)h[g]=(e[g]+f[g])/2;return h}function k(a,b,d){function e(a,c,h){if(c.length<=h)return[];var j=c[h],k=-i(j,a,b,d,0);return[k].concat(e(g(f(j,k),a),c,++h))}a=c.call(a);var h=e([],a.reverse(),0);return h.reverse()}function j(a,b,c){function d(a,e,h){if(e.length<=h)return[];var j=e[h],k=i(a,j,b,c,0);return[k].concat(d(g(a,f(j,k)),e,++h))}return d([],a,0)}function i(a,b,c,d,e){if(a.length<=e||b.length<=e)return 0;var f=a[e][1],g=b[e][0];return Math.max(i(a,b,c,d,++e)+c,f-g+d)}function h(a,b){b=b||[];if(a.length==0)return b;var c=a.pop();return h(a,g(c,b))}function g(a,b){if(a.length==0)return b;if(b.length==0)return a;var c=a.shift(),d=b.shift();return[[c[0],d[1]]].concat(g(a,b))}function f(b,d){var e=[];a.each(b,function(a){a=c.call(a),a[0]+=d,a[1]+=d,e.push(a)});return e}function e(a,b,c,d){var e=d=="left"||d=="right"?"y":"x";a.getPos(b)[e]+=c}function d(a,b,c,d,e){var f=b.Node,g=b.multitree;if(f.overridable){var h=-1,i=-1;a.eachNode(function(a){if(a._depth==c&&(!g||"$orn"in a.data&&a.data.$orn==d)){var b=a.getData("width",e),f=a.getData("height",e);h=h<b?b:h,i=i<f?f:i}});return{width:h<0?f.width:h,height:i<0?f.height:i}}return f}var c=Array.prototype.slice;return new b({compute:function(b,c){var d=b||"start",e=this.graph.getNode(this.root);a.extend(e,{drawn:!0,exist:!0,selected:!0}),u.compute(this.graph,d,this.config),(!!c||!("_depth"in e))&&this.graph.computeLevels(this.root,0,"ignore"),this.computePositions(e,d)},computePositions:function(b,c){var d=this.config,e=d.multitree,f=d.align,g=f!=="center"&&d.indent,h=d.orientation,i=e?["top","right","bottom","left"]:[h],j=this;a.each(i,function(a){m(j.graph,b,c,j.config,a,c);var d=["x","y"][+(a=="left"||a=="right")];(function h(b){b.eachSubnode(function(i){i.exist&&(!e||"$orn"in i.data&&i.data.$orn==a)&&(i.getPos(c)[d]+=b.getPos(c)[d],g&&(i.getPos(c)[d]+=f=="left"?g:-g),h(i))})})(b)})}})}(),$jit.ST=function(){function f(a){var b=[],c=this.config;a=a||this.clickedNode,this.clickedNode.eachLevel(0,c.levelsToShow,function(a){!c.multitree||"$orn"in a.data||!a.anySubnode(function(a){return a.exist&&!a.drawn})?a.drawn&&!a.anySubnode("drawn")&&b.push(a):b.push(a)});return b}function d(a){a=a||this.clickedNode;if(!this.config.constrained)return[];var b=this.geom,d=this.graph,e=this.canvas,f=a._depth,g=[];d.eachNode(function(b){b.exist&&!b.selected&&(b.isDescendantOf(a.id)?b._depth<=f&&g.push(b):g.push(b))});var h=b.getRightLevelToShow(a,e);a.eachLevel(h,h,function(a){a.exist&&!a.selected&&g.push(a)});for(var i=0;i<c.length;i++){var j=this.graph.getNode(c[i]);j.isDescendantOf(a.id)||g.push(j)}return g}var c=[];return new b({Implements:[s,i,t.Tree],initialize:function(b){var c=$jit.ST,d={levelsToShow:2,levelDistance:30,constrained:!0,Node:{type:"rectangle"},duration:700,offsetX:0,offsetY:0};this.controller=this.config=a.merge(e("Canvas","Fx","Tree","Node","Edge","Controller","Tips","NodeStyles","Events","Navigation","Label"),d,b);var f=this.config;f.useCanvas?(this.canvas=f.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(f.background&&(f.background=a.merge({type:"Circles"},f.background)),this.canvas=new j(this,f),this.config.labelContainer=(typeof f.injectInto=="string"?f.injectInto:f.injectInto.id)+"-label"),this.graphOptions={complex:!0},this.graph=new o(this.graphOptions,this.config.Node,this.config.Edge),this.labels=new c.Label[f.Label.type](this),this.fx=new c.Plot(this,c),this.op=new c.Op(this),this.group=new c.Group(this),this.geom=new c.Geom(this),this.clickedNode=null,this.initializeExtras()},plot:function(){this.fx.plot(this.controller)},switchPosition:function(a,b,c){var d=this.geom,e=this.fx,f=this;e.busy||(e.busy=!0,this.contract({onComplete:function(){d.switchOrientation(a),f.compute("end",!1),e.busy=!1,b=="animate"?f.onClick(f.clickedNode.id,c):b=="replot"&&f.select(f.clickedNode.id,c)}},a))},switchAlignment:function(a,b,c){this.config.align=a,b=="animate"?this.select(this.clickedNode.id,c):b=="replot"&&this.onClick(this.clickedNode.id,c)},addNodeInPath:function(a){c.push(a),this.select(this.clickedNode&&this.clickedNode.id||this.root)},clearNodesInPath:function(a){c.length=0,this.select(this.clickedNode&&this.clickedNode.id||this.root)},refresh:function(){this.reposition(),this.select(this.clickedNode&&this.clickedNode.id||this.root)},reposition:function(){this.graph.computeLevels(this.root,0,"ignore"),this.geom.setRightLevelToShow(this.clickedNode,this.canvas),this.graph.eachNode(function(a){a.exist&&(a.drawn=!0)}),this.compute("end")},requestNodes:function(b,c){var d=a.merge(this.controller,c),e=this.config.levelsToShow;if(d.request){var f=[],g=b._depth;b.eachLevel(0,e,function(a){a.drawn&&!a.anySubnode()&&(f.push(a),a._level=e-(a._depth-g))}),this.group.requestNodes(f,d)}else d.onComplete()},contract:function(b,c){var e=this.config.orientation,f=this.geom,g=this.group;c&&f.switchOrientation(c);var h=d.call(this);c&&f.switchOrientation(e),g.contract(h,a.merge(this.controller,b))},move:function(b,c){this.compute("end",!1);var d=c.Move,e={x:d.offsetX,y:d.offsetY};d.enable&&this.geom.translate(b.endPos.add(e).$scale(-1),"end"),this.fx.animate(a.merge(this.controller,{modes:["linear"]},c))},expand:function(b,c){var d=f.call(this,b);this.group.expand(d,a.merge(this.controller,c))},selectPath:function(b){function e(b){if(b!=null&&!b.selected){b.selected=!0,a.each(d.group.getSiblings([b])[b.id],function(a){a.exist=!0,a.drawn=!0});var c=b.getParents();c=c.length>0?c[0]:null,e(c)}}var d=this;this.graph.eachNode(function(a){a.selected=!1});for(var f=0,g=[b.id].concat(c);f<g.length;f++)e(this.graph.getNode(g[f]))},setRoot:function(a,b,c){function h(){if(this.config.multitree&&g.data.$orn){var b=g.data.$orn,h=({left:"right",right:"left",top:"bottom",bottom:"top"})[b];f.data.$orn=h,function i(b){b.eachSubnode(function(b){b.id!=a&&(b.data.$orn=h,i(b))})}(f),delete g.data.$orn}this.root=a,this.clickedNode=g,this.graph.computeLevels(this.root,0,"ignore"),this.geom.setRightLevelToShow(g,e,{execHide:!1,onShow:function(a){a.drawn||(a.drawn=!0,a.setData("alpha",1,"end"),a.setData("alpha",0),a.pos.setc(g.pos.x,g.pos.y))}}),this.compute("end"),this.busy=!0,this.fx.animate({modes:["linear","node-property:alpha"],onComplete:function(){d.busy=!1,d.onClick(a,{onComplete:function(){c&&c.onComplete()}})}})}if(!this.busy){this.busy=!0;var d=this,e=this.canvas,f=this.graph.getNode(this.root),g=this.graph.getNode(a);delete f.data.$orns,b=="animate"?(h.call(this),d.selectPath(g)):b=="replot"&&(h.call(this),this.select(this.root))}},addSubtree:function(b,c,d){c=="replot"?this.op.sum(b,a.extend({type:"replot"},d||{})):c=="animate"&&this.op.sum(b,a.extend({type:"fade:seq"},d||{}))},removeSubtree:function(b,c,d,e){var f=this.graph.getNode(b),g=[];f.eachLevel(+!c,!1,function(a){g.push(a.id)}),d=="replot"?this.op.removeNode(g,a.extend({type:"replot"},e||{})):d=="animate"&&this.op.removeNode(g,a.extend({type:"fade:seq"},e||{}))},select:function(b,c){var e=this.group,g=this.geom,h=this.graph.getNode(b),i=this.canvas,j=this.graph.getNode(this.root),k=a.merge(this.controller,c),l=this;k.onBeforeCompute(h),this.selectPath(h),this.clickedNode=h,this.requestNodes(h,{onComplete:function(){e.hide(e.prepare(d.call(l)),k),g.setRightLevelToShow(h,i),l.compute("current"),l.graph.eachNode(function(a){var b=a.pos.getc(!0);a.startPos.setc(b.x,b.y),a.endPos.setc(b.x,b.y),a.visited=!1});var a={x:k.offsetX,y:k.offsetY};l.geom.translate(h.endPos.add(a).$scale(-1),["start","current","end"]),e.show(f.call(l)),l.plot(),k.onAfterCompute(l.clickedNode),k.onComplete()}})},onClick:function(b,c){var d=this.canvas,e=this,f=this.geom,g=this.config,h={Move:{enable:!0,offsetX:g.offsetX||0,offsetY:g.offsetY||0},setRightLevelToShowConfig:!1,onBeforeRequest:a.empty,onBeforeContract:a.empty,onBeforeMove:a.empty,onBeforeExpand:a.empty},i=a.merge(this.controller,h,c);if(!this.busy){this.busy=!0;var j=this.graph.getNode(b);this.selectPath(j,this.clickedNode),this.clickedNode=j,i.onBeforeCompute(j),i.onBeforeRequest(j),this.requestNodes(j,{onComplete:function(){i.onBeforeContract(j),e.contract({onComplete:function(){f.setRightLevelToShow(j,d,i.setRightLevelToShowConfig),i.onBeforeMove(j),e.move(j,{Move:i.Move,onComplete:function(){i.onBeforeExpand(j),e.expand(j,{onComplete:function(){e.busy=!1,i.onAfterCompute(b),i.onComplete()}})}})}})}})}}})}(),$jit.ST.$extend=!0,$jit.ST.Op=new b({Implements:o.Op}),$jit.ST.Group=new b({initialize:function(a){this.viz=a,this.canvas=a.canvas,this.config=a.config,this.animation=new d,this.nodes=null},requestNodes:function(a,b){var c=0,d=a.length,e={},f=function(){b.onComplete()},g=this.viz;d==0&&f();for(var h=0;h<d;h++)e[a[h].id]=a[h],b.request(a[h].id,a[h]._level,{onComplete:function(a,b){b&&b.children&&(b.id=a,g.op.sum(b,{type:"nothing"})),++c==d&&(g.graph.computeLevels(g.root,0),f())}})},contract:function(b,c){var d=this.viz,e=this;b=this.prepare(b),this.animation.setOptions(a.merge(c,{$animating:!1,compute:function(a){a==1&&(a=.99),e.plotStep(1-a,c,this.$animating),this.$animating="contract"},complete:function(){e.hide(b,c)}})).start()},hide:function(b,c){var d=this.viz;for(var e=0;e<b.length;e++)if(0&&c&&c.request){var f=[];b[e].eachLevel(1,!1,function(a){f.push(a.id)}),d.op.removeNode(f,{type:"nothing"}),d.labels.clearLabels()}else b[e].eachLevel(1,!1,function(b){b.exist&&a.extend(b,{drawn:!1,exist:!1})});c.onComplete()},expand:function(b,c){var d=this;this.show(b),this.animation.setOptions(a.merge(c,{$animating:!1,compute:function(a){d.plotStep(a,c,this.$animating),this.$animating="expand"},complete:function(){d.plotStep(undefined,c,!1),c.onComplete()}})).start()},show:function(b){var c=this.config;this.prepare(b),a.each(b,function(a){if(c.multitree&&!("$orn"in a.data)){delete a.data.$orns;var b=" ";a.eachSubnode(function(a){"$orn"in a.data&&b.indexOf(a.data.$orn)<0&&a.exist&&!a.drawn&&(b+=a.data.$orn+" ")}),a.data.$orns=b}a.eachLevel(0,c.levelsToShow,function(a){a.exist&&(a.drawn=!0)})})},prepare:function(a){this.nodes=this.getNodesWithChildren(a);return this.nodes},getNodesWithChildren:function(a){var b=[],c=this.config,d=this.viz.root;a.sort(function(a,b){return(a._depth<=b._depth)-(a._depth>=b._depth)});for(var e=0;e<a.length;e++)if(a[e].anySubnode("exist")){for(var f=e+1,g=!1;!g&&f<a.length;f++)if(!c.multitree||"$orn"in a[f].data)g=g||a[e].isDescendantOf(a[f].id);g||b.push(a[e])}return b},plotStep:function(b,c,d){var e=this.viz,f=this.config,g=e.canvas,h=g.getCtx(),i=this.nodes,j,k,l={};for(j=0;j<i.length;j++){k=i[j],l[k.id]=[];var m=f.multitree&&!("$orn"in k.data),n=m&&k.data.$orns;k.eachSubgraph(function(a){m&&n&&n.indexOf(a.data.$orn)>0&&a.drawn?(a.drawn=!1,l[k.id].push(a)):(!m||!n)&&a.drawn&&(a.drawn=!1,l[k.id].push(a))}),k.drawn=!0}i.length>0&&e.fx.plot();for(j in l)a.each(l[j],function(a){a.drawn=!0});for(j=0;j<i.length;j++)k=i[j],h.save(),e.fx.plotSubtree(k,c,b,d),h.restore()},getSiblings:function(b){var c={};a.each(b,function(a){var b=a.getParents();if(b.length==0)c[a.id]=[a];else{var d=[];b[0].eachSubnode(function(a){d.push(a)}),c[a.id]=d}});return c}}),$jit.ST.Geom=new b({Implements:o.Geom,switchOrientation:function(a){this.config.orientation=a},dispatch:function(){var a=Array.prototype.slice.call(arguments),b=a.shift(),c=a.length,d=function(a){return typeof a=="function"?a():a};if(c==2)return b=="top"||b=="bottom"?d(a[0]):d(a[1]);if(c==4)switch(b){case"top":return d(a[0]);case"right":return d(a[1]);case"bottom":return d(a[2]);case"left":return d(a[3])}return undefined},getSize:function(a,b){var c=a.data,d=this.config,e=d.siblingOffset,f=d.multitree&&"$orn"in c&&c.$orn||d.orientation,g=a.getData("width")+e,h=a.getData("height")+e;return b?this.dispatch(f,g,h):this.dispatch(f,h,g)},getTreeBaseSize:function(a,b,c){var d=this.getSize(a,!0),e=0,f=this;if(c(b,a))return d;if(b===0)return 0;a.eachSubnode(function(a){e+=f.getTreeBaseSize(a,b-1,c)});return(d>e?d:e)+this.config.subtreeOffset},getEdge:function(a,b,c){var d=function(b,c){return function(){return a.pos.add(new m(b,c))}},e=this.node,f=a.getData("width"),g=a.getData("height");if(b=="begin"){if(e.align=="center")return this.dispatch(c,d(0,g/2),d(-f/2,0),d(0,-g/2),d(f/2,0));if(e.align=="left")return this.dispatch(c,d(0,g),d(0,0),d(0,0),d(f,0));if(e.align=="right")return this.dispatch(c,d(0,0),d(-f,0),d(0,-g),d(0,0));throw"align: not implemented"}if(b=="end"){if(e.align=="center")return this.dispatch(c,d(0,-g/2),d(f/2,0),d(0,g/2),d(-f/2,0));if(e.align=="left")return this.dispatch(c,d(0,0),d(f,0),d(0,g),d(0,0));if(e.align=="right")return this.dispatch(c,d(0,-g),d(0,0),d(0,0),d(-f,0));throw"align: not implemented"}},getScaledTreePosition:function(a,b){var c=this.node,d=a.getData("width"),e=a.getData("height"),f=this.config.multitree&&"$orn"in a.data&&a.data.$orn||this.config.orientation,g=function(c,d){return function(){return a.pos.add(new m(c,d)).$scale(1-b)}};if(c.align=="left")return this.dispatch(f,g(0,e),g(0,0),g(0,0),g(d,0));if(c.align=="center")return this.dispatch(f,g(0,e/2),g(-d/2,0),g(0,-e/2),g(d/2,0));if(c.align=="right")return this.dispatch(f,g(0,0),g(-d,0),g(0,-e),g(0,0));throw"align: not implemented"},treeFitsInCanvas:function(a,b,c){var d=b.getSize(),e=this.config.multitree&&"$orn"in a.data&&a.data.$orn||this.config.orientation,f=this.dispatch(e,d.width,d.height),g=this.getTreeBaseSize(a,c,function(a,b){return a===0||!b.anySubnode()});return g<f}}),$jit.ST.Plot=new b({Implements:o.Plot,plotSubtree:function(b,c,d,e){var f=this.viz,g=f.canvas,h=f.config;d=Math.min(Math.max(.001,d),1);if(d>=0){b.drawn=!1;var i=g.getCtx(),j=f.geom.getScaledTreePosition(b,d);i.translate(j.x,j.y),i.scale(d,d)}this.plotTree(b,a.merge(c,{withLabels:!0,hideLabels:!!d,plotSubtree:function(a,c){var d=h.multitree&&!("$orn"in b.data),e=d&&b.getData("orns");return!d||e.indexOf(elem.getData("orn"))>-1}}),e),d>=0&&(b.drawn=!0)},getAlignedPos:function(a,b,c){var d=this.node,e,f;if(d.align=="center")e={x:a.x-b/2,y:a.y-c/2};else if(d.align=="left")f=this.config.orientation,f=="bottom"||f=="top"?e={x:a.x-b/2,y:a.y}:e={x:a.x,y:a.y-c/2};else if(d.align=="right")f=this.config.orientation,f=="bottom"||f=="top"?e={x:a.x-b/2,y:a.y-c}:e={x:a.x-b,y:a.y-c/2};else throw"align: not implemented";return e},getOrientation:function(a){var b=this.config,c=b.orientation;if(b.multitree){var d=a.nodeFrom,e=a.nodeTo;c="$orn"in d.data&&d.data.$orn||"$orn"in e.data&&e.data.$orn}return c}}),$jit.ST.Label={},$jit.ST.Label.Native=new b({Implements:o.Label.Native,renderLabel:function(a,b,c){var d=a.getCtx(),e=b.pos.getc(!0);d.fillText(b.name,e.x,e.y)}}),$jit.ST.Label.DOM=new b({Implements:o.Label.DOM,placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.config,f=e.Node,g=this.viz.canvas,h=b.getData("width"),i=b.getData("height"),j=g.getSize(),k,l,m=g.translateOffsetX,n=g.translateOffsetY,o=g.scaleOffsetX,p=g.scaleOffsetY,q=d.x*o+m,r=d.y*p+n;if(f.align=="center")k={x:Math.round(q-h/2+j.width/2),y:Math.round(r-i/2+j.height/2)};else if(f.align=="left")l=e.orientation,l=="bottom"||l=="top"?k={x:Math.round(q-h/2+j.width/2),y:Math.round(r+j.height/2)}:k={x:Math.round(q+j.width/2),y:Math.round(r-i/2+j.height/2)};else if(f.align=="right")l=e.orientation,l=="bottom"||l=="top"?k={x:Math.round(q-h/2+j.width/2),y:Math.round(r-i+j.height/2)}:k={x:Math.round(q-h+j.width/2),y:Math.round(r-i/2+j.height/2)};else throw"align: not implemented";var s=a.style;s.left=k.x+"px",s.top=k.y+"px",s.display=this.fitsInCanvas(k,g)?"":"none",c.onPlaceLabel(a,b)}}),$jit.ST.Label.SVG=new b({Implements:[$jit.ST.Label.DOM,o.Label.SVG],initialize:function(a){this.viz=a}}),$jit.ST.Label.HTML=new b({Implements:[$jit.ST.Label.DOM,o.Label.HTML],initialize:function(a){this.viz=a}}),$jit.ST.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(a,b){var c=a.getData("dim"),d=this.getAlignedPos(a.pos.getc(!0),c,c),e=c/2;this.nodeHelper.circle.render("fill",{x:d.x+e,y:d.y+e},e,b)},contains:function(a,b){var c=a.getData("dim"),d=this.getAlignedPos(a.pos.getc(!0),c,c),e=c/2;this.nodeHelper.circle.contains({x:d.x+e,y:d.y+e},e)}},square:{render:function(a,b){var c=a.getData("dim"),d=c/2,e=this.getAlignedPos(a.pos.getc(!0),c,c);this.nodeHelper.square.render("fill",{x:e.x+d,y:e.y+d},d,b)},contains:function(a,b){var c=a.getData("dim"),d=this.getAlignedPos(a.pos.getc(!0),c,c),e=c/2;this.nodeHelper.square.contains({x:d.x+e,y:d.y+e},e)}},ellipse:{render:function(a,b){var c=a.getData("width"),d=a.getData("height"),e=this.getAlignedPos(a.pos.getc(!0),c,d);this.nodeHelper.ellipse.render("fill",{x:e.x+c/2,y:e.y+d/2},c,d,b)},contains:function(a,b){var c=a.getData("width"),d=a.getData("height"),e=this.getAlignedPos(a.pos.getc(!0),c,d);this.nodeHelper.ellipse.contains({x:e.x+c/2,y:e.y+d/2},c,d,canvas)}},rectangle:{render:function(a,b){var c=a.getData("width"),d=a.getData("height"),e=this.getAlignedPos(a.pos.getc(!0),c,d);this.nodeHelper.rectangle.render("fill",{x:e.x+c/2,y:e.y+d/2},c,d,b)},contains:function(a,b){var c=a.getData("width"),d=a.getData("height"),e=this.getAlignedPos(a.pos.getc(!0),c,d);this.nodeHelper.rectangle.contains({x:e.x+c/2,y:e.y+d/2},c,d,canvas)}}}),$jit.ST.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,b){var c=this.getOrientation(a),d=a.nodeFrom,e=a.nodeTo,f=d._depth<e._depth,g=this.viz.geom.getEdge(f?d:e,"begin",c),h=this.viz.geom.getEdge(f?e:d,"end",c);this.edgeHelper.line.render(g,h,b)},contains:function(a,b){var c=this.getOrientation(a),d=a.nodeFrom,e=a.nodeTo,f=d._depth<e._depth,g=this.viz.geom.getEdge(f?d:e,"begin",c),h=this.viz.geom.getEdge(f?e:d,"end",c);return this.edgeHelper.line.contains(g,h,b,this.edge.epsilon)}},arrow:{render:function(a,b){var c=this.getOrientation(a),d=a.nodeFrom,e=a.nodeTo,f=a.getData("dim"),g=this.viz.geom.getEdge(d,"begin",c),h=this.viz.geom.getEdge(e,"end",c),i=a.data.$direction,j=i&&i.length>1&&i[0]!=d.id;this.edgeHelper.arrow.render(g,h,f,j,b)},contains:function(a,b){var c=this.getOrientation(a),d=a.nodeFrom,e=a.nodeTo,f=d._depth<e._depth,g=this.viz.geom.getEdge(f?d:e,"begin",c),h=this.viz.geom.getEdge(f?e:d,"end",c);return this.edgeHelper.arrow.contains(g,h,b,this.edge.epsilon)}},"quadratic:begin":{render:function(a,b){var c=this.getOrientation(a),d=a.nodeFrom,e=a.nodeTo,f=d._depth<e._depth,g=this.viz.geom.getEdge(f?d:e,"begin",c),h=this.viz.geom.getEdge(f?e:d,"end",c),i=a.getData("dim"),j=b.getCtx();j.beginPath(),j.moveTo(g.x,g.y);switch(c){case"left":j.quadraticCurveTo(g.x+i,g.y,h.x,h.y);break;case"right":j.quadraticCurveTo(g.x-i,g.y,h.x,h.y);break;case"top":j.quadraticCurveTo(g.x,g.y+i,h.x,h.y);break;case"bottom":j.quadraticCurveTo(g.x,g.y-i,h.x,h.y)}j.stroke()}},"quadratic:end":{render:function(a,b){var c=this.getOrientation(a),d=a.nodeFrom,e=a.nodeTo,f=d._depth<e._depth,g=this.viz.geom.getEdge(f?d:e,"begin",c),h=this.viz.geom.getEdge(f?e:d,"end",c),i=a.getData("dim"),j=b.getCtx();j.beginPath(),j.moveTo(g.x,g.y);switch(c){case"left":j.quadraticCurveTo(h.x-i,h.y,h.x,h.y);break;case"right":j.quadraticCurveTo(h.x+i,h.y,h.x,h.y);break;case"top":j.quadraticCurveTo(h.x,h.y-i,h.x,h.y);break;case"bottom":j.quadraticCurveTo(h.x,h.y+i,h.x,h.y)}j.stroke()}},bezier:{render:function(a,b){var c=this.getOrientation(a),d=a.nodeFrom,e=a.nodeTo,f=d._depth<e._depth,g=this.viz.geom.getEdge(f?d:e,"begin",c),h=this.viz.geom.getEdge(f?e:d,"end",c),i=a.getData("dim"),j=b.getCtx();j.beginPath(),j.moveTo(g.x,g.y);switch(c){case"left":j.bezierCurveTo(g.x+i,g.y,h.x-i,h.y,h.x,h.y);break;case"right":j.bezierCurveTo(g.x-i,g.y,h.x+i,h.y,h.x,h.y);break;case"top":j.bezierCurveTo(g.x,g.y+i,h.x,h.y-i,h.x,h.y);break;case"bottom":j.bezierCurveTo(g.x,g.y-i,h.x,h.y+i,h.x,h.y)}j.stroke()}}}),$jit.ST.Plot.NodeTypes.implement({"areachart-stacked":{render:function(b,c){var d=b.pos.getc(!0),e=b.getData("width"),f=b.getData("height"),g=this.getAlignedPos(d,e,f),h=g.x,i=g.y,j=b.getData("stringArray"),k=b.getData("dimArray"),l=b.getData("valueArray"),m=a.reduce(l,function(a,b){return a+b[0]},0),n=a.reduce(l,function(a,b){return a+b[1]},0),o=b.getData("colorArray"),p=o.length,q=b.getData("config"),r=b.getData("gradient"),s=q.showLabels,t=q.showAggregates,u=q.Label,v=b.getData("prev"),w=c.getCtx(),x=b.getData("border");if(o&&k&&j){for(var y=0,z=k.length,A=0,B=0,C=0;y<z;y++){w.fillStyle=w.strokeStyle=o[y%p],w.save();if(r&&(k[y][0]>0||k[y][1]>0)){var D=A+k[y][0],E=B+k[y][1],F=Math.atan((E-D)/e),G=55,H=w.createLinearGradient(h+e/2,i-(D+E)/2,h+e/2+G*Math.sin(F),i-(D+E)/2+G*Math.cos(F)),I=a.rgbToHex(a.map(a.hexToRgb(o[y%p].slice(1)),function(a){return a*.85>>0}));H.addColorStop(0,o[y%p]),H.addColorStop(1,I),w.fillStyle=H}w.beginPath(),w.moveTo(h,i-A),w.lineTo(h+e,i-B),w.lineTo(h+e,i-B-k[y][1]),w.lineTo(h,i-A-k[y][0]),w.lineTo(h,i-A),w.fill(),w.restore();if(x){var J=x.name==j[y],K=J?.7:.8,I=a.rgbToHex(a.map(a.hexToRgb(o[y%p].slice(1)),function(a){return a*K>>0}));w.strokeStyle=I,w.lineWidth=J?4:1,w.save(),w.beginPath(),x.index===0?(w.moveTo(h,i-A),w.lineTo(h,i-A-k[y][0])):(w.moveTo(h+e,i-B),w.lineTo(h+e,i-B-k[y][1])),w.stroke(),w.restore()}A+=k[y][0]||0,B+=k[y][1]||0,k[y][0]>0&&(C+=l[y][0]||0)}v&&u.type=="Native"&&(w.save(),w.beginPath(),w.fillStyle=w.strokeStyle=u.color,w.font=u.style+" "+u.size+"px "+u.family,w.textAlign="center",w.textBaseline="middle",t(b.name,m,n,b)&&w.fillText(C,h,i-A-q.labelOffset-u.size/2,e),s(b.name,m,n,b)&&w.fillText(b.name,h,i+u.size/2+q.labelOffset),w.restore())}},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height"),f=this.getAlignedPos(c,d,e),g=f.x,h=f.y,i=a.getData("dimArray"),j=b.x-g;if(b.x<g||b.x>g+d||b.y>h||b.y<h-e)return!1;for(var k=0,l=i.length,m=h,n=h;k<l;k++){var o=i[k];m-=o[0],n-=o[1];var p=m+(n-m)*j/d;if(b.y>=p){var q=+(j>d/2);return{name:a.getData("stringArray")[k],color:a.getData("colorArray")[k],value:a.getData("valueArray")[k][q],index:q}}}return!1}}}),$jit.AreaChart=new b({st:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:!1,initialize:function(b){this.controller=this.config=a.merge(e("Canvas","Margin","Label","AreaChart"),{Label:{type:"Native"}},b);var c=this.config.showLabels,d=a.type(c),f=this.config.showAggregates,g=a.type(f);this.config.showLabels=d=="function"?c:a.lambda(c),this.config.showAggregates=g=="function"?f:a.lambda(f),this.initializeViz()},initializeViz:function(){var b=this.config,c=this,d=b.type.split(":")[0],e={},f=new $jit.ST({injectInto:b.injectInto,orientation:"bottom",levelDistance:0,siblingOffset:0,subtreeOffset:0,withLabels:b.Label.type!="Native",useCanvas:b.useCanvas,Label:{type:b.Label.type},Node:{overridable:!0,type:"areachart-"+d,align:"left",width:1,height:1},Edge:{type:"none"},Tips:{enable:b.Tips.enable,type:"Native",force:!0,onShow:function(a,c,d){var e=d;b.Tips.onShow(a,e,c)}},Events:{enable:!0,type:"Native",onClick:function(a,d,e){if(b.filterOnClick||b.Events.enable){var f=d.getContains();f&&(b.filterOnClick&&c.filter(f.name)),b.Events.enable&&b.Events.onClick(f,d,e)}},onRightClick:function(a,d,e){b.restoreOnRightClick&&c.restore()},onMouseMove:function(a,d,e){if(b.selectOnHover)if(a){var f=d.getContains();c.select(a.id,f.name,f.index)}else c.select(!1,!1,!1)}},onCreateLabel:function(c,d){var f=b.Label,g=d.getData("valueArray"),h=a.reduce(g,function(a,b){return a+b[0]},0),i=a.reduce(g,function(a,b){return a+b[1]},0);if(d.getData("prev")){var j={wrapper:document.createElement("div"),aggregate:document.createElement("div"),label:document.createElement("div")},k=j.wrapper,l=j.label,m=j.aggregate,n=k.style,o=l.style,p=m.style;e[d.id]=j,k.appendChild(l),k.appendChild(m),b.showLabels(d.name,h,i,d)||(l.style.display="none"),b.showAggregates(d.name,h,i,d)||(m.style.display="none"),n.position="relative",n.overflow="visible",n.fontSize=f.size+"px",n.fontFamily=f.family,n.color=f.color,n.textAlign="center",p.position=o.position="absolute",c.style.width=d.getData("width")+"px",c.style.height=d.getData("height")+"px",l.innerHTML=d.name,c.appendChild(k)}},onPlaceLabel:function(c,d){if(d.getData("prev")){var f=e[d.id],g=f.wrapper.style,h=f.label.style,i=f.aggregate.style,j=d.getData("width"),k=d.getData("height"),l=d.getData("dimArray"),m=d.getData("valueArray"),n=a.reduce(m,function(a,b){return a+b[0]},0),o=a.reduce(m,function(a,b){return a+b[1]},0),p=parseInt(g.fontSize,10),q=c.style;if(l&&m){b.showLabels(d.name,n,o,d)?h.display="":h.display="none",b.showAggregates(d.name,n,o,d)?i.display="":i.display="none",g.width=i.width=h.width=c.style.width=j+"px",i.left=h.left=-j/2+"px";for(var r=0,s=m.length,t=0,u=0;r<s;r++)l[r][0]>0&&(t+=m[r][0],u+=l[r][0]);i.top=-p-b.labelOffset+"px",h.top=b.labelOffset+u+"px",c.style.top=parseInt(c.style.top,10)-u+"px",c.style.height=g.height=u+"px",f.aggregate.innerHTML=t}}}}),g=f.canvas.getSize(),h=b.Margin;f.config.offsetY=-g.height/2+h.bottom+(b.showLabels&&b.labelOffset+b.Label.size),f.config.offsetX=(h.right-h.left)/2,this.st=f,this.canvas=this.st.canvas},loadJSON:function(b){var c=a.time(),d=[],e=this.st,f=a.splat(b.label),g=a.splat(b.color||this.colors),h=this.config,i=!!h.type.split(":")[1],j=h.animate;for(var k=0,l=b.values,m=l.length;k<m-1;k++){var n=l[k],o=l[k-1],p=l[k+1],q=a.splat(l[k].values),r=a.splat(l[k+1].values),s=a.zip(q,r),t=0,u=0;d.push({id:c+n.label,name:n.label,data:{value:s,$valueArray:s,$colorArray:g,$stringArray:f,$next:p.label,$prev:o?o.label:!1,$config:h,$gradient:i},children:[]})}var v={id:c+"$root",name:"",data:{$type:"none",$width:1,$height:1},children:d};e.loadJSON(v),this.normalizeDims(),e.compute(),e.select(e.root),j&&e.fx.animate({modes:["node-property:height:dimArray"],duration:1500})},updateJSON:function(b,c){if(!this.busy){this.busy=!0;var d=this.st,e=d.graph,f=b.label&&a.splat(b.label),g=b.values,h=this.config.animate,i=this;a.each(g,function(b){var c=e.getByName(b.label);if(c){b.values=a.splat(b.values);var d=c.getData("stringArray"),g=c.getData("valueArray");a.each(g,function(a,c){a[0]=b.values[c],f&&(d[c]=f[c])}),c.setData("valueArray",g);var h=c.getData("prev"),i=c.getData("next"),j=e.getByName(i);if(h){var k=e.getByName(h);if(k){var g=k.getData("valueArray");a.each(g,function(a,c){a[1]=b.values[c]})}}if(!j){var g=c.getData("valueArray");a.each(g,function(a,c){a[1]=b.values[c]})}}}),this.normalizeDims(),d.compute(),d.select(d.root),h&&d.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){i.busy=!1,c&&c.onComplete()}})}},filter:function(){if(!this.busy){this.busy=!0,this.config.Tips.enable&&this.st.tips.hide(),this.select(!1,!1,!1);var b=Array.prototype.slice.call(arguments),c=this.st.graph.getNode(this.st.root),d=this;c.eachAdjacency(function(c){var d=c.nodeTo,e=d.getData("dimArray"),f=d.getData("stringArray");d.setData("dimArray",a.map(e,function(c,d){return a.indexOf(b,f[d])>-1?c:[0,0]}),"end")}),this.st.fx.animate({modes:["node-property:dimArray"],duration:1500,onComplete:function(){d.busy=!1}})}},restore:function(){if(!this.busy){this.busy=!0,this.config.Tips.enable&&this.st.tips.hide(),this.select(!1,!1,!1),this.normalizeDims();var a=this;this.st.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){a.busy=!1}})}},select:function(a,b,c){if(this.config.selectOnHover){var d=this.selected;if(d.id!=a||d.name!=b||d.index!=c){d.id=a,d.name=b,d.index=c,this.st.graph.eachNode(function(a){a.setData("border",!1)});if(a){var e=this.st.graph.getNode(a);e.setData("border",d);var f=c===0?"prev":"next";f=e.getData(f),f&&(e=this.st.graph.getByName(f),e&&e.setData("border",{name:b,index:1-c}))}this.st.plot()}}},getLegend:function(){var b={},c;this.st.graph.getNode(this.st.root).eachAdjacency(function(a){c=a.nodeTo});var d=c.getData("colorArray"),e=d.length;a.each(c.getData("stringArray"),function(a,c){b[a]=d[c%e]});return b},getMaxValue:function(){var b=0;this.st.graph.eachNode(function(c){var d=c.getData("valueArray"),e=0,f=0;a.each(d,function(a){e+=+a[0],f+=+a[1]});var g=f>e?f:e;b=b>g?b:g});return b},normalizeDims:function(){var b=this.st.graph.getNode(this.st.root),c=0;b.eachAdjacency(function(){c++});var d=this.getMaxValue()||1,e=this.st.canvas.getSize(),f=this.config,g=f.Margin,h=f.labelOffset+f.Label.size,i=(e.width-(g.left+g.right))/c,j=f.animate,k=e.height-(g.top+g.bottom)-(f.showAggregates&&h)-(f.showLabels&&h);this.st.graph.eachNode(function(b){var c=0,e=0,f=[];a.each(b.getData("valueArray"),function(a){c+=+a[0],e+=+a[1],f.push([0,0])});var g=e>c?e:c;b.setData("width",i);if(j){b.setData("height",g*k/d,"end"),b.setData("dimArray",a.map(b.getData("valueArray"),function(a){return[a[0]*k/d,a[1]*k/d]}),"end");var h=b.getData("dimArray");h||b.setData("dimArray",f)}else b.setData("height",g*k/d),b.setData("dimArray",a.map(b.getData("valueArray"),function(a){return[a[0]*k/d,a[1]*k/d]}))})}}),e.BarChart={$extend:!0,animate:!0,type:"stacked",labelOffset:3,barsOffset:0,hoveredColor:"#9fd4ff",orientation:"horizontal",showAggregates:!0,showLabels:!0,Tips:{enable:!1,onShow:a.empty,onHide:a.empty},Events:{enable:!1,onClick:a.empty}},$jit.ST.Plot.NodeTypes.implement({"barchart-stacked":{render:function(b,c){var d=b.pos.getc(!0),e=b.getData("width"),f=b.getData("height"),g=this.getAlignedPos(d,e,f),h=g.x,i=g.y,j=b.getData("dimArray"),k=b.getData("valueArray"),l=b.getData("colorArray"),m=l.length,n=b.getData("stringArray"),o=c.getCtx(),p={},q=b.getData("border"),r=b.getData("gradient"),s=b.getData("config"),t=s.orientation=="horizontal",u=s.showAggregates,v=s.showLabels,w=s.Label;if(l&&j&&n){for(var x=0,y=j.length,z=0,A=0;x<y;x++){o.fillStyle=o.strokeStyle=l[x%m];if(r){var B;t?B=o.createLinearGradient(h+z+j[x]/2,i,h+z+j[x]/2,i+f):B=o.createLinearGradient(h,i-z-j[x]/2,h+e,i-z-j[x]/2);var C=a.rgbToHex(a.map(a.hexToRgb(l[x%m].slice(1)),function(a){return a*.5>>0}));B.addColorStop(0,C),B.addColorStop(.5,l[x%m]),B.addColorStop(1,C),o.fillStyle=B}t?o.fillRect(h+z,i,j[x],f):o.fillRect(h,i-z-j[x],e,j[x]),q&&q.name==n[x]&&(p.acum=z,p.dimValue=j[x]),z+=j[x]||0,A+=k[x]||0}q&&(o.save(),o.lineWidth=2,o.strokeStyle=q.color,t?o.strokeRect(h+p.acum+1,i+1,p.dimValue-2,f-2):o.strokeRect(h+1,i-p.acum-p.dimValue+1,e-2,p.dimValue-2),o.restore()),w.type=="Native"&&(o.save(),o.fillStyle=o.strokeStyle=w.color,o.font=w.style+" "+w.size+"px "+w.family,o.textBaseline="middle",u(b.name,A)&&(t?(o.textAlign="right",o.fillText(A,h+z-s.labelOffset,i+f/2)):(o.textAlign="center",o.fillText(A,h+e/2,i-f-w.size/2-s.labelOffset))),v(b.name,A,b)&&(t?(o.textAlign="center",o.translate(h-s.labelOffset-w.size/2,i+f/2),o.rotate(Math.PI/2),o.fillText(b.name,0,0)):(o.textAlign="center",o.fillText(b.name,h+e/2,i+w.size/2+s.labelOffset))),o.restore())}},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height"),f=this.getAlignedPos(c,d,e),g=f.x,h=f.y,i=a.getData("dimArray"),j=a.getData("config"),k=b.x-g,l=j.orientation=="horizontal";if(l){if(b.x<g||b.x>g+d||b.y>h+e||b.y<h)return!1}else if(b.x<g||b.x>g+d||b.y>h||b.y<h-e)return!1;for(var m=0,n=i.length,o=l?g:h;m<n;m++){var p=i[m];if(l){o+=p;var q=o;if(b.x<=q)return{name:a.getData("stringArray")[m],color:a.getData("colorArray")[m],value:a.getData("valueArray")[m],label:a.name}}else{o-=p;var q=o;if(b.y>=q)return{name:a.getData("stringArray")[m],color:a.getData("colorArray")[m],value:a.getData("valueArray")[m],label:a.name}}}return!1}},"barchart-grouped":{render:function(b,c){var d=b.pos.getc(!0),e=b.getData("width"),f=b.getData("height"),g=this.getAlignedPos(d,e,f),h=g.x,i=g.y,j=b.getData("dimArray"),k=b.getData("valueArray"),l=k.length,m=b.getData("colorArray"),n=m.length,o=b.getData("stringArray"),p=c.getCtx(),q={},r=b.getData("border"),s=b.getData("gradient"),t=b.getData("config"),u=t.orientation=="horizontal",v=t.showAggregates,w=t.showLabels,x=t.Label,y=(u?f:e)/l;if(m&&j&&o){for(var z=0,A=l,B=0,C=0;z<A;z++){p.fillStyle=p.strokeStyle=m[z%n];if(s){var D;u?D=p.createLinearGradient(h+j[z]/2,i+y*z,h+j[z]/2,i+y*(z+1)):D=p.createLinearGradient(h+y*z,i-j[z]/2,h+y*(z+1),i-j[z]/2);var E=a.rgbToHex(a.map(a.hexToRgb(m[z%n].slice(1)),function(a){return a*.5>>0}));D.addColorStop(0,E),D.addColorStop(.5,m[z%n]),D.addColorStop(1,E),p.fillStyle=D}u?p.fillRect(h,i+y*z,j[z],y):p.fillRect(h+y*z,i-j[z],y,j[z]),r&&r.name==o[z]&&(q.acum=y*z,q.dimValue=j[z]),B+=j[z]||0,C+=k[z]||0}r&&(p.save(),p.lineWidth=2,p.strokeStyle=r.color,u?p.strokeRect(h+1,i+q.acum+1,q.dimValue-2,y-2):p.strokeRect(h+q.acum+1,i-q.dimValue+1,y-2,q.dimValue-2),p.restore()),x.type=="Native"&&(p.save(),p.fillStyle=p.strokeStyle=x.color,p.font=x.style+" "+x.size+"px "+x.family,p.textBaseline="middle",v(b.name,C)&&(u?(p.textAlign="right",p.fillText(C,h+Math.max.apply(null,j)-t.labelOffset,i+f/2)):(p.textAlign="center",p.fillText(C,h+e/2,i-Math.max.apply(null,j)-x.size/2-t.labelOffset))),w(b.name,C,b)&&(u?(p.textAlign="center",p.translate(h-t.labelOffset-x.size/2,i+f/2),p.rotate(Math.PI/2),p.fillText(b.name,0,0)):(p.textAlign="center",p.fillText(b.name,h+e/2,i+x.size/2+t.labelOffset))),p.restore())}},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height"),f=this.getAlignedPos(c,d,e),g=f.x,h=f.y,i=a.getData("dimArray"),j=i.length,k=a.getData("config"),l=b.x-g,m=k.orientation=="horizontal",n=(m?e:d)/j;if(m){if(b.x<g||b.x>g+d||b.y>h+e||b.y<h)return!1}else if(b.x<g||b.x>g+d||b.y>h||b.y<h-e)return!1;for(var o=0,p=i.length;o<p;o++){var q=i[o];if(m){var r=h+n*o;if(b.x<=g+q&&b.y>=r&&b.y<=r+n)return{name:a.getData("stringArray")[o],color:a.getData("colorArray")[o],value:a.getData("valueArray")[o],label:a.name}}else{var r=g+n*o;if(b.x>=r&&b.x<=r+n&&b.y>=h-q)return{name:a.getData("stringArray")[o],color:a.getData("colorArray")[o],value:a.getData("valueArray")[o],label:a.name}}}return!1}}}),$jit.BarChart=new b({st:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:!1,initialize:function(b){this.controller=this.config=a.merge(e("Canvas","Margin","Label","BarChart"),{Label:{type:"Native"}},b);var c=this.config.showLabels,d=a.type(c),f=this.config.showAggregates,g=a.type(f);this.config.showLabels=d=="function"?c:a.lambda(c),this.config.showAggregates=g=="function"?f:a.lambda(f),this.initializeViz()},initializeViz:function(){var b=this.config,c=this,d=b.type.split(":")[0],e=b.orientation=="horizontal",f={},g=new $jit.ST({injectInto:b.injectInto,orientation:e?"left":"bottom",levelDistance:0,siblingOffset:b.barsOffset,subtreeOffset:0,withLabels:b.Label.type!="Native",useCanvas:b.useCanvas,Label:{type:b.Label.type},Node:{overridable:!0,type:"barchart-"+d,align:"left",width:1,height:1},Edge:{type:"none"},Tips:{enable:b.Tips.enable,type:"Native",force:!0,onShow:function(a,c,d){var e=d;b.Tips.onShow(a,e,c)}},Events:{enable:!0,type:"Native",onClick:function(a,c,d){if(b.Events.enable){var e=c.getContains();b.Events.onClick(e,c,d)}},onMouseMove:function(a,d,e){if(b.hoveredColor)if(a){var f=d.getContains();c.select(a.id,f.name,f.index)}else c.select(!1,!1,!1)}},onCreateLabel:function(c,d){var e=b.Label,g=d.getData("valueArray"),h=a.reduce(g,function(a,b){return a+b},0),i={wrapper:document.createElement("div"),aggregate:document.createElement("div"),label:document.createElement("div")},j=i.wrapper,k=i.label,l=i.aggregate,m=j.style,n=k.style,o=l.style;f[d.id]=i,j.appendChild(k),j.appendChild(l),b.showLabels(d.name,h,d)||(n.display="none"),b.showAggregates(d.name,h,d)||(o.display="none"),m.position="relative",m.overflow="visible",m.fontSize=e.size+"px",m.fontFamily=e.family,m.color=e.color,m.textAlign="center",o.position=n.position="absolute",c.style.width=d.getData("width")+"px",c.style.height=d.getData("height")+"px",o.left=n.left="0px",k.innerHTML=d.name,c.appendChild(j)},onPlaceLabel:function(a,c){if(f[c.id]){var d=f[c.id],e=d.wrapper.style,g=d.label.style,h=d.aggregate.style,i=b.type.split(":")[0]=="grouped",j=b.orientation=="horizontal",k=c.getData("dimArray"),l=c.getData("valueArray"),m=i&&j?Math.max.apply(null,k):c.getData("width"),n=i&&!j?Math.max.apply(null,k):c.getData("height"),o=parseInt(e.fontSize,10),p=a.style;if(k&&l){e.width=h.width=g.width=a.style.width=m+"px";for(var q=0,r=l.length,s=0;q<r;q++)k[q]>0&&(s+=l[q]);b.showLabels(c.name,s,c)?g.display="":g.display="none",b.showAggregates(c.name,s,c)?h.display="":h.display="none",b.orientation=="horizontal"?(h.textAlign="right",g.textAlign="left",g.textIndex=h.textIndent=b.labelOffset+"px",h.top=g.top=(n-o)/2+"px",a.style.height=e.height=n+"px"):(h.top=-o-b.labelOffset+"px",g.top=b.labelOffset+n+"px",a.style.top=parseInt(a.style.top,10)-n+"px",a.style.height=e.height=n+"px"),d.aggregate.innerHTML=s}}}}),h=g.canvas.getSize(),i=b.Margin;e?(g.config.offsetX=h.width/2-i.left-(b.showLabels&&b.labelOffset+b.Label.size),g.config.offsetY=(i.bottom-i.top)/2):(g.config.offsetY=-h.height/2+i.bottom+(b.showLabels&&b.labelOffset+b.Label.size),g.config.offsetX=(i.right-i.left)/2),this.st=g,this.canvas=this.st.canvas},loadJSON:function(b){if(!this.busy){this.busy=!0;var c=a.time(),d=[],e=this.st,f=a.splat(b.label),g=a.splat(b.color||this.colors),h=this.config,i=!!h.type.split(":")[1],j=h.animate,k=h.orientation=="horizontal",l=this;for(var m=0,n=b.values,o=n.length;m<o;m++){var p=n[m],q=a.splat(n[m].values),r=0;d.push({id:c+p.label,name:p.label,data:{value:q,$valueArray:q,$colorArray:g,$stringArray:f,$gradient:i,$config:h},children:[]})}var s={id:c+"$root",name:"",data:{$type:"none",$width:1,$height:1},children:d};e.loadJSON(s),this.normalizeDims(),e.compute(),e.select(e.root),j?k?e.fx.animate({modes:["node-property:width:dimArray"],duration:1500,onComplete:function(){l.busy=!1}}):e.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){l.busy=!1}}):this.busy=!1}},updateJSON:function(b,c){if(!this.busy){this.busy=!0;var d=this.st,e=d.graph,f=b.values,g=this.config.animate,h=this,i=this.config.orientation=="horizontal";a.each(f,function(c){var d=e.getByName(c.label);d&&(d.setData("valueArray",a.splat(c.values)),b.label&&d.setData("stringArray",a.splat(b.label)))}),this.normalizeDims(),d.compute(),d.select(d.root),g&&(i?d.fx.animate({modes:["node-property:width:dimArray"],duration:1500,onComplete:function(){h.busy=!1,c&&c.onComplete()}}):d.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){h.busy=!1,c&&c.onComplete()}}))}},select:function(a,b){if(this.config.hoveredColor){var c=this.selected;if(c.id!=a||c.name!=b)c.id=a,c.name=b,c.color=this.config.hoveredColor,this.st.graph.eachNode(function(b){a==b.id?b.setData("border",c):b.setData("border",!1)}),this.st.plot()}},getLegend:function(){var b={},c;this.st.graph.getNode(this.st.root).eachAdjacency(function(a){c=a.nodeTo});var d=c.getData("colorArray"),e=d.length;a.each(c.getData("stringArray"),function(a,c){b[a]=d[c%e]});return b},getMaxValue:function(){var b=0,c=this.config.type.split(":")[0]=="stacked";this.st.graph.eachNode(function(d){var e=d.getData("valueArray"),f=0;e&&(c?a.each(e,function(a){f+=+a}):f=Math.max.apply(null,e),b=b>f?b:f)});return b},setBarType:function(a){this.config.type=a,this.st.config.Node.type="barchart-"+a.split(":")[0]},normalizeDims:function(){var b=this.st.graph.getNode(this.st.root),c=0;b.eachAdjacency(function(){c++});var d=this.getMaxValue()||1,e=this.st.canvas.getSize(),f=this.config,g=f.Margin,h=g.left+g.right,i=g.top+g.bottom,j=f.orientation=="horizontal",k=(e[j?"height":"width"]-(j?i:h)-(c-1)*f.barsOffset)/c,l=f.animate,m=e[j?"width":"height"]-(j?h:i)-(!j&&f.showAggregates&&f.Label.size+f.labelOffset)-(f.showLabels&&f.Label.size+f.labelOffset),n=j?"height":"width",o=j?"width":"height";this.st.graph.eachNode(function(b){var c=0,e=[];a.each(b.getData("valueArray"),function(a){c+=+a,e.push(0)}),b.setData(n,k);if(l){b.setData(o,c*m/d,"end"),b.setData("dimArray",a.map(b.getData("valueArray"),function(a){return a*m/d}),"end");var f=b.getData("dimArray");f||b.setData("dimArray",e)}else b.setData(o,c*m/d),b.setData("dimArray",a.map(b.getData("valueArray"),function(a){return a*m/d}))})}}),e.PieChart={$extend:!0,animate:!0,offset:25,sliceOffset:0,labelOffset:3,type:"stacked",hoveredColor:"#9fd4ff",Events:{enable:!1,onClick:a.empty},Tips:{enable:!1,onShow:a.empty,onHide:a.empty},showLabels:!0,resizeLabels:!1,updateHeights:!1},t.Radial=new b({compute:function(b){var c=a.splat(b||["current","start","end"]);u.compute(this.graph,c,this.config),this.graph.computeLevels(this.root,0,"ignore");var d=this.createLevelDistanceFunc();this.computeAngularWidths(c),this.computePositions(c,d)},computePositions:function(a,b){var c=a,d=this.graph,e=d.getNode(this.root),f=this.parent,g=this.config;for(var h=0,i=c.length;h<i;h++){var j=c[h];e.setPos(l(0,0),j),e.setData("span",Math.PI*2,j)}e.angleSpan={begin:0,end:2*Math.PI},d.eachBFS(this.root,function(a){var d=a.angleSpan.end-a.angleSpan.begin,e=a.angleSpan.begin,g=b(a),h=0,i=[],j={};a.eachSubnode(function(a){h+=a._treeAngularWidth;for(var b=0,d=c.length;b<d;b++){var e=c[b],f=a.getData("dim",e);j[e]=e in j?f>j[e]?f:j[e]:f}i.push(a)},"ignore"),f&&f.id==a.id&&i.length>0&&i[0].dist&&i.sort(function(a,b){return(a.dist>=b.dist)-(a.dist<=b.dist)});for(var k=0,m=i.length;k<m;k++){var n=i[k];if(!n._flag){var o=n._treeAngularWidth/h*d,p=e+o/2;for(var q=0,r=c.length;q<r;q++){var s=c[q];n.setPos(l(p,g),s),n.setData("span",o,s),n.setData("dim-quotient",n.getData("dim",s)/j[s],s)}n.angleSpan={begin:e,end:e+o},e+=o}}},"ignore")},setAngularWidthForNodes:function(a){this.graph.eachBFS(this.root,function(b,c){var d=b.getData("angularWidth",a[0])||5;b._angularWidth=d/c},"ignore")},setSubtreesAngularWidth:function(){var a=this;this.graph.eachNode(function(b){a.setSubtreeAngularWidth(b)},"ignore")},setSubtreeAngularWidth:function(a){var b=this,c=a._angularWidth,d=0;a.eachSubnode(function(a){b.setSubtreeAngularWidth(a),d+=a._treeAngularWidth},"ignore"),a._treeAngularWidth=Math.max(c,d)},computeAngularWidths:function(a){this.setAngularWidthForNodes(a),this.setSubtreesAngularWidth()}}),$jit.Sunburst=new b({Implements:[s,i,t.Radial],initialize:function(b){var c=$jit.Sunburst,d={interpolation:"linear",levelDistance:100,Node:{type:"multipie",height:0},Edge:{type:"none"},Label:{textAlign:"start",textBaseline:"middle"}};this.controller=this.config=a.merge(e("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),d,b);var f=this.config;f.useCanvas?(this.canvas=f.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(f.background&&(f.background=a.merge({type:"Circles"},f.background)),this.canvas=new j(this,f),this.config.labelContainer=(typeof f.injectInto=="string"?f.injectInto:f.injectInto.id)+"-label"),this.graphOptions={complex:!1,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new o(this.graphOptions,this.config.Node,this.config.Edge),this.labels=new c.Label[f.Label.type](this),this.fx=new c.Plot(this,c),this.op=new c.Op(this),this.json=null,this.root=null,this.rotated=null,this.busy=!1,this.initializeExtras()},createLevelDistanceFunc:function(){var a=this.config.levelDistance;return function(b){return(b._depth+1)*a}},refresh:function(){this.compute(),this.plot()},reposition:function(){this.compute("end")},rotate:function(a,b,c){var d=a.getPos(c.property||"current").getp(!0).theta;this.rotated=a,this.rotateAngle(-d,b,c)},rotateAngle:function(b,c,d){var e=this,f=a.merge(this.config,d||{},{modes:["polar"]}),g=d.property||(c==="animate"?"end":"current");c==="animate"&&this.fx.animation.pause(),this.graph.eachNode(function(a){var c=a.getPos(g);c.theta+=b,c.theta<0&&(c.theta+=Math.PI*2)}),c=="animate"?this.fx.animate(f):c=="replot"&&(this.fx.plot(),this.busy=!1)},plot:function(){this.fx.plot()}}),$jit.Sunburst.$extend=!0,function(c){c.Op=new b({Implements:o.Op}),c.Plot=new b({Implements:o.Plot}),c.Label={},c.Label.Native=new b({Implements:o.Label.Native,initialize:function(a){this.viz=a,this.label=a.config.Label,this.config=a.config},renderLabel:function(a,b,c){var d=b.getData("span");if(d>=Math.PI/2||Math.tan(d)*this.config.levelDistance*b._depth>=10){var e=a.getCtx(),f=e.measureText(b.name);if(b.id==this.viz.root)var g=-f.width/2,h=0,i=0,j=0;else{var k=5,j=c.levelDistance-k,l=b.pos.clone();l.rho+=k;var m=l.getp(!0),n=l.getc(!0),g=n.x,h=n.y,o=Math.PI,p=m.theta>o/2&&m.theta<3*o/2,i=p?m.theta+o:m.theta;p?(g-=Math.abs(Math.cos(m.theta)*f.width),h+=Math.sin(m.theta)*f.width):b.id==this.viz.root&&(g-=f.width/2)}e.save(),e.translate(g,h),e.rotate(i),e.fillText(b.name,0,0),e.restore()}}}),c.Label.SVG=new b({Implements:o.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz,f=this.viz.canvas,g=f.getSize(),h={x:Math.round(d.x+g.width/2),y:Math.round(d.y+g.height/2)};a.setAttribute("x",h.x),a.setAttribute("y",h.y);var i=a.getBBox();if(i){var j=a.getAttribute("x"),k=a.getAttribute("y"),l=b.pos.getp(!0),m=Math.PI,n=l.theta>m/2&&l.theta<3*m/2;n?(a.setAttribute("x",j-i.width),a.setAttribute("y",k-i.height)):b.id==e.root&&a.setAttribute("x",j-i.width/2);var o=n?l.theta+m:l.theta;b._depth&&a.setAttribute("transform","rotate("+o*360/(2*m)+" "+j+" "+k+")")}c.onPlaceLabel(a,b)}}),c.Label.HTML=new b({Implements:o.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.clone(),e=this.viz.canvas,f=b.getData("height"),g=(f||b._depth==0?f:this.viz.config.levelDistance)/2,h=e.getSize();d.rho+=g,d=d.getc(!0);var i={x:Math.round(d.x+h.width/2),y:Math.round(d.y+h.height/2)},j=a.style;j.left=i.x+"px",j.top=i.y+"px",j.display=this.fitsInCanvas(i,e)?"":"none",c.onPlaceLabel(a,b)}}),c.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1),anglecontains:function(a,b){var c=a.getData("span")/2,d=a.pos.theta,e=d-c,f=d+c;e<0&&(e+=Math.PI*2);var g=Math.atan2(b.y,b.x);g<0&&(g+=Math.PI*2);return e>f?g>e&&g<=Math.PI*2||g<f:g>e&&g<f}},pie:{render:function(a,b){var c=a.getData("span")/2,d=a.pos.theta,e=d-c,f=d+c,g=a.pos.getp(!0),h=new k(g.rho,e),i=h.getc(!0);h.theta=f;var j=h.getc(!0),l=b.getCtx();l.beginPath(),l.moveTo(0,0),l.lineTo(i.x,i.y),l.moveTo(0,0),l.lineTo(j.x,j.y),l.moveTo(0,0),l.arc(0,0,g.rho*a.getData("dim-quotient"),e,f,!1),l.fill()},contains:function(a,b){if(this.nodeTypes.none.anglecontains.call(this,a,b)){var c=Math.sqrt(b.x*b.x+b.y*b.y),d=this.config.levelDistance,e=a._depth;return c<=d*e}return!1}},multipie:{render:function(a,b){var c=a.getData("height"),d=c?c:this.config.levelDistance,e=a.getData("span")/2,f=a.pos.theta,g=f-e,h=f+e,i=a.pos.getp(!0),j=new k(i.rho,g),l=j.getc(!0);j.theta=h;var m=j.getc(!0);j.rho+=d;var n=j.getc(!0);j.theta=g;var o=j.getc(!0),p=b.getCtx();p.moveTo(0,0),p.beginPath(),p.arc(0,0,i.rho,g,h,!1),p.arc(0,0,i.rho+d,h,g,!0),p.moveTo(l.x,l.y),p.lineTo(o.x,o.y),p.moveTo(m.x,m.y),p.lineTo(n.x,n.y),p.fill(),a.collapsed&&(p.save(),p.lineWidth=2,p.moveTo(0,0),p.beginPath(),p.arc(0,0,i.rho+d+5,h-.01,g+.01,!0),p.stroke(),p.restore())},contains:function(a,b){if(this.nodeTypes.none.anglecontains.call(this,a,b)){var c=Math.sqrt(b.x*b.x+b.y*b.y),d=a.getData("height"),e=d?d:this.config.levelDistance,f=this.config.levelDistance,g=a._depth;return c>=f*g&&c<=f*g+e}return!1}},"gradient-multipie":{render:function(b,c){var d=c.getCtx(),e=b.getData("height"),f=e?e:this.config.levelDistance,g=d.createRadialGradient(0,0,b.getPos().rho,0,0,b.getPos().rho+f),h=a.hexToRgb(b.getData("color")),i=[];a.each(h,function(a){i.push(parseInt(a*.5,10))});var j=a.rgbToHex(i);g.addColorStop(0,j),g.addColorStop(1,b.getData("color")),d.fillStyle=g,this.nodeTypes.multipie.render.call(this,b,c)},contains:function(a,b){return this.nodeTypes.multipie.contains.call(this,a,b)}},"gradient-pie":{render:function(b,c){var d=c.getCtx(),e=d.createRadialGradient(0,0,0,0,0,b.getPos().rho),f=a.hexToRgb(b.getData("color")),g=[];a.each(f,function(a){g.push(parseInt(a*.5,10))});var h=a.rgbToHex(g);e.addColorStop(1,h),e.addColorStop(0,b.getData("color")),d.fillStyle=e,this.nodeTypes.pie.render.call(this,b,c)},contains:function(a,b){return this.nodeTypes.pie.contains.call(this,a,b)}}}),c.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);this.edgeHelper.line.render(c,d,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.line.contains(c,d,b,this.edge.epsilon)}},arrow:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0),e=a.getData("dim"),f=a.data.$direction,g=f&&f.length>1&&f[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render(c,d,e,g,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.arrow.contains(c,d,b,this.edge.epsilon)}},hyperline:{render:function(a,b){var c=a.nodeFrom.pos.getc(),d=a.nodeTo.pos.getc(),e=Math.max(c.norm(),d.norm());this.edgeHelper.hyperline.render(c.$scale(1/e),d.$scale(1/e),e,b)},contains:a.lambda(!1)}})}($jit.Sunburst),$jit.Sunburst.Plot.NodeTypes.implement({"piechart-stacked":{render:function(b,c){var d=b.pos.getp(!0),e=b.getData("dimArray"),f=b.getData("valueArray"),g=b.getData("colorArray"),h=g.length,i=b.getData("stringArray"),j=b.getData("span")/2,l=b.pos.theta,m=l-j,n=l+j,o=new k,p=c.getCtx(),q={},r=b.getData("gradient"),s=b.getData("border"),t=b.getData("config"),u=t.showLabels,v=t.resizeLabels,w=t.Label,x=t.sliceOffset*Math.cos((m+n)/2),y=t.sliceOffset*Math.sin((m+n)/2);if(g&&e&&i){for(var z=0,A=e.length,B=0,C=0;z<A;z++){var D=e[z],E=g[z%h];if(D<=0)continue;p.fillStyle=p.strokeStyle=E;if(r&&D){var F=p.createRadialGradient(x,y,B+t.sliceOffset,x,y,B+D+t.sliceOffset),G=a.hexToRgb(E),H=a.map(G,function(a){return a*.8>>0}),I=a.rgbToHex(H);F.addColorStop(0,E),F.addColorStop(.5,E),F.addColorStop(1,I),p.fillStyle=F}o.rho=B+t.sliceOffset,o.theta=m;var J=o.getc(!0);o.theta=n;var K=o.getc(!0);o.rho+=D;var L=o.getc(!0);o.theta=m;var M=o.getc(!0);p.beginPath(),p.arc(x,y,B+.01,m,n,!1),p.arc(x,y,B+D+.01,n,m,!0),p.fill(),s&&s.name==i[z]&&(q.acum=B,q.dimValue=e[z],q.begin=m,q.end=n),B+=D||0,C+=f[z]||0}if(s){p.save(),p.globalCompositeOperation="source-over",p.lineWidth=2,p.strokeStyle=s.color;var N=m<n?1:-1;p.beginPath(),p.arc(x,y,q.acum+.01+1,q.begin,q.end,!1),p.arc(x,y,q.acum+q.dimValue+.01-1,q.end,q.begin,!0),p.closePath(),p.stroke(),p.restore()}if(u&&w.type=="Native"){p.save(),p.fillStyle=p.strokeStyle=w.color;var O=v?b.getData("normalizedDim"):1,P=w.size*O>>0;P=P<+v?+v:P,p.font=w.style+" "+P+"px "+w.family,p.textBaseline="middle",p.textAlign="center",o.rho=B+t.labelOffset+t.sliceOffset,o.theta=b.pos.theta;var Q=o.getc(!0);p.fillText(b.name,Q.x,Q.y),p.restore()}}},contains:function(a,b){if(this.nodeTypes.none.anglecontains.call(this,a,b)){var c=Math.sqrt(b.x*b.x+b.y*b.y),d=this.config.levelDistance,e=a._depth,f=a.getData("config");if(c<=d*e+f.sliceOffset){var g=a.getData("dimArray");for(var h=0,i=g.length,j=f.sliceOffset;h<i;h++){var k=g[h];if(c>=j&&c<=j+k)return{name:a.getData("stringArray")[h],color:a.getData("colorArray")[h],value:a.getData("valueArray")[h],label:a.name};j+=k}}return!1}return!1}}}),$jit.PieChart=new b({sb:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:!1,initialize:function(b){this.controller=this.config=a.merge(e("Canvas","PieChart","Label"),{Label:{type:"Native"}},b),this.initializeViz()},initializeViz:function(){var a=this.config,b=this,c=a.type.split(":")[0],d=new $jit.Sunburst({injectInto:a.injectInto,useCanvas:a.useCanvas,withLabels:a.Label.type!="Native",Label:{type:a.Label.type},Node:{overridable:!0,type:"piechart-"+c,width:1,height:1},Edge:{type:"none"},Tips:{enable:a.Tips.enable,type:"Native",force:!0,onShow:function(b,c,d){var e=d;a.Tips.onShow(b,e,c)}},Events:{enable:!0,type:"Native",onClick:function(b,c,d){if(a.Events.enable){var e=c.getContains();a.Events.onClick(e,c,d)}},onMouseMove:function(c,d,e){if(a.hoveredColor)if(c){var f=d.getContains();b.select(c.id,f.name,f.index)}else b.select(!1,!1,!1)}},onCreateLabel:function(b,c){var d=a.Label;if(a.showLabels){var e=b.style;e.fontSize=d.size+"px",e.fontFamily=d.family,e.color=d.color,e.textAlign="center",b.innerHTML=c.name}},onPlaceLabel:function(c,d){if(a.showLabels){var e=d.pos.getp(!0),f=d.getData("dimArray"),g=d.getData("span")/2,h=d.pos.theta,i=h-g,j=h+g,l=new k,m=a.showLabels,n=a.resizeLabels,o=a.Label;if(f){for(var p=0,q=f.length,r=0;p<q;p++)r+=f[p];var s=n?d.getData("normalizedDim"):1,t=o.size*s>>0;t=t<+n?+n:t,c.style.fontSize=t+"px",l.rho=r+a.labelOffset+a.sliceOffset,l.theta=(i+j)/2;var e=l.getc(!0),u=b.canvas.getSize(),v={x:Math.round(e.x+u.width/2),y:Math.round(e.y+u.height/2)};c.style.left=v.x+"px",c.style.top=v.y+"px"}}}}),e=d.canvas.getSize(),f=Math.min;d.config.levelDistance=f(e.width,e.height)/2-a.offset-a.sliceOffset,this.sb=d,this.canvas=this.sb.canvas,this.canvas.getCtx().globalCompositeOperation="lighter"},loadJSON:function(b){var c=a.time(),d=[],e=this.sb,f=a.splat(b.label),g=f.length,h=a.splat(b.color||this.colors),i=h.length,j=this.config,k=!!j.type.split(":")[1],l=j.animate,m=g==1;for(var n=0,o=b.values,p=o.length;n<p;n++){var q=o[n],r=a.splat(q.values);d.push({id:c+q.label,name:q.label,data:{value:r,$valueArray:r,$colorArray:m?a.splat(h[n%i]):h,$stringArray:f,$gradient:k,$config:j,$angularWidth:a.reduce(r,function(a,b){return a+b})},children:[]})}var s={id:c+"$root",name:"",data:{$type:"none",$width:1,$height:1},children:d};e.loadJSON(s),this.normalizeDims(),e.refresh(),l&&e.fx.animate({modes:["node-property:dimArray"],duration:1500})},updateJSON:function(b,c){if(!this.busy){this.busy=!0;var d=this.sb,e=d.graph,f=b.values,g=this.config.animate,h=this;a.each(f,function(c){var d=e.getByName(c.label),f=a.splat(c.values);d&&(d.setData("valueArray",f),d.setData("angularWidth",a.reduce(f,function(a,b){return a+b})),b.label&&d.setData("stringArray",a.splat(b.label)))}),this.normalizeDims(),g?(d.compute("end"),d.fx.animate({modes:["node-property:dimArray:span","linear"],duration:1500,onComplete:function(){h.busy=!1,c&&c.onComplete()}})):d.refresh()}},select:function(a,b){if(this.config.hoveredColor){var c=this.selected;if(c.id!=a||c.name!=b)c.id=a,c.name=b,c.color=this.config.hoveredColor,this.sb.graph.eachNode(function(b){a==b.id?b.setData("border",c):b.setData("border",!1)}),this.sb.plot()}},getLegend:function(){var b={},c;this.sb.graph.getNode(this.sb.root).eachAdjacency(function(a){c=a.nodeTo});var d=c.getData("colorArray"),e=d.length;a.each(c.getData("stringArray"),function(a,c){b[a]=d[c%e]});return b},getMaxValue:function(){var b=0;this.sb.graph.eachNode(function(c){var d=c.getData("valueArray"),e=0;a.each(d,function(a){e+=+a}),b=b>e?b:e});return b},normalizeDims:function(){var b=this.sb.graph.getNode(this.sb.root),c=0;b.eachAdjacency(function(){c++});var d=this.getMaxValue()||1,e=this.config,f=e.animate,g=this.sb.config.levelDistance;this.sb.graph.eachNode(function(b){var c=0,h=[];a.each(b.getData("valueArray"),function(a){c+=+a,h.push(1)});var i=h.length==1&&!e.updateHeights;if(f){b.setData("dimArray",a.map(b.getData("valueArray"),function(a){return i?g:a*g/d}),"end");var j=b.getData("dimArray");j||b.setData("dimArray",h)}else b.setData("dimArray",a.map(b.getData("valueArray"),function(a){return i?g:a*g/d}));b.setData("normalizedDim",c/d)})}}),t.TM={},t.TM.SliceAndDice=new b({compute:function(a){var b=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(b);var c=this.canvas.getSize(),d=this.config,e=c.width,f=c.height;this.graph.computeLevels(this.root,0,"ignore"),b.getPos(a).setc(-e/2,-f/2),b.setData("width",e,a),b.setData("height",f+d.titleHeight,a),this.computePositions(b,b,this.layout.orientation,a),this.controller.onAfterCompute(b)},computePositions:function(a,b,c,d){var e=0;a.eachSubnode(function(a){e+=a.getData("area",d)});var f=this.config,g=f.offset,h=a.getData("width",d),i=a.getData("height",d)-f.titleHeight,j=a==b?1:b.getData("area",d)/e,k,l,m,n,o,p,q,r=c=="h";r?(c="v",k=i,l=h*j,m="height",n="y",o="x",p=f.titleHeight,q=0):(c="h",k=i*j,l=h,m="width",n="x",o="y",p=0,q=f.titleHeight);var s=b.getPos(d);b.setData("width",l,d),b.setData("height",k,d);var t=0,u=this;b.eachSubnode(function(a){var e=a.getPos(d);e[n]=t+s[n]+p,e[o]=s[o]+q,u.computePositions(b,a,c,d),t+=a.getData(m,d)})}}),t.TM.Area={compute:function(a){a=a||"current";var b=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(b);var c=this.config,d=this.canvas.getSize(),e=d.width,f=d.height,g=c.offset,h=e-g,i=f-g;this.graph.computeLevels(this.root,0,"ignore"),b.getPos(a).setc(-e/2,-f/2),b.setData("width",e,a),b.setData("height",f,a);var j={top:-f/2+c.titleHeight,left:-e/2,width:h,height:i-c.titleHeight};this.computePositions(b,j,a),this.controller.onAfterCompute(b)},computeDim:function(a,b,c,d,e,f){if(a.length+b.length==1){var g=a.length==1?a:b;this.layoutLast(g,c,d,f)}else{a.length>=2&&b.length==0&&(b=[a.shift()]);if(a.length==0){b.length>0&&this.layoutRow(b,c,d,f);return}var h=a[0];if(e(b,c)<e([h].concat(b),c)){var i=this.layoutRow(b,c,d,f);this.computeDim(a,[],i.dim,i,e,f)}else this.computeDim(a.slice(1),b.concat([h]),c,d,e,f)}},worstAspectRatio:function(a,b){if(!a||a.length==0)return Number.MAX_VALUE;var c=0,d=0,e=Number.MAX_VALUE;for(var f=0,g=a.length;f<g;f++){var h=a[f]._area;c+=h,e=e<h?e:h,d=d>h?d:h}var i=b*b,j=c*c;return Math.max(i*d/j,j/(i*e))},avgAspectRatio:function(a,b){if(!a||a.length==0)return Number.MAX_VALUE;var c=0;for(var d=0,e=a.length;d<e;d++){var f=a[d]._area,g=f/b;c+=b>g?b/g:g/b}return c/e},layoutLast:function(a,b,c,d){var e=a[0];e.getPos(d).setc(c.left,c.top),e.setData("width",c.width,d),e.setData("height",c.height,d)}},t.TM.Squarified=new b({Implements:t.TM.Area,computePositions:function(a,b,c){var d=this.config;b.width<b.height?this.layout.orientation="v":this.layout.orientation="h";var e=a.getSubnodes([1,1],"ignore");if(e.length>0){this.processChildrenLayout(a,e,b,c);for(var f=0,g=e.length;f<g;f++){var h=e[f],i=d.offset,j=h.getData("height",c)-i-d.titleHeight,k=h.getData("width",c)-i,l=h.getPos(c);b={width:k,height:j,top:l.y+d.titleHeight,left:l.x},this.computePositions(h,b,c)}}},processChildrenLayout:function(a,b,c,d){var e=c.width*c.height,f,g=b.length,h=0,i=[];for(f=0;f<g;f++)i[f]=parseFloat(b[f].getData("area",d)),h+=i[f];for(f=0;f<g;f++)b[f]._area=e*i[f]/h;var j=this.layout.horizontal()?c.height:c.width;b.sort(function(a,b){var c=b._area-a._area;return c?c:b.id==a.id?0:b.id<a.id?1:-1});var k=[b[0]],l=b.slice(1);this.squarify(l,k,j,c,d)},squarify:function(a,b,c,d,e){this.computeDim(a,b,c,d,this.worstAspectRatio,e)},layoutRow:function(a,b,c,d){return this.layout.horizontal()?this.layoutV(a,b,c,d):this.layoutH(a,b,c,d)},layoutV:function(b,c,d,e){var f=0,g=function(a){return a};a.each(b,function(a){f+=a._area});var h=g(f/c),i=0;for(var j=0,k=b.length;j<k;j++){var l=g(b[j]._area/h),m=b[j];m.getPos(e).setc(d.left,d.top+i),m.setData("width",h,e),m.setData("height",l,e),i+=l}var n={height:d.height,width:d.width-h,top:d.top,left:d.left+h};n.dim=Math.min(n.width,n.height),n.dim!=n.height&&this.layout.change();return n},layoutH:function(b,c,d,e){var f=0;a.each(b,function(a){f+=a._area});var g=f/c,h=d.top,i=0;for(var j=0,k=b.length;j<k;j++){var l=b[j],c=l._area/g;l.getPos(e).setc(d.left+i,h),l.setData("width",c,e),l.setData("height",g,e),i+=c}var m={height:d.height-g,width:d.width,top:d.top+g,left:d.left};m.dim=Math.min(m.width,m.height),m.dim!=m.width&&this.layout.change();return m}}),t.TM.Strip=new b({Implements:t.TM.Area,computePositions:function(a,b,c){var d=a.getSubnodes([1,1],"ignore"),e=this.config;if(d.length>0){this.processChildrenLayout(a,d,b,c);for(var f=0,g=d.length;f<g;f++){var h=d[f],i=e.offset,j=h.getData("height",c)-i-e.titleHeight,k=h.getData("width",c)-i,l=h.getPos(c);b={width:k,height:j,top:l.y+e.titleHeight,left:l.x},this.computePositions(h,b,c)}}},processChildrenLayout:function(a,b,c,d){var e=c.width*c.height,f,g=b.length,h=0,i=[];for(f=0;f<g;f++)i[f]=+b[f].getData("area",d),h+=i[f];for(f=0;f<g;f++)b[f]._area=e*i[f]/h;var j=this.layout.horizontal()?c.width:c.height,k=[b[0]],l=b.slice(1);this.stripify(l,k,j,c,d)},stripify:function(a,b,c,d,e){this.computeDim(a,b,c,d,this.avgAspectRatio,e)},layoutRow:function(a,b,c,d){return this.layout.horizontal()?this.layoutH(a,b,c,d):this.layoutV(a,b,c,d)},layoutV:function(b,c,d,e){var f=0;a.each(b,function(a){f+=a._area});var g=f/c,h=0;for(var i=0,j=b.length;i<j;i++){var k=b[i],l=k._area/g;k.getPos(e).setc(d.left,d.top+(c-l-h)),k.setData("width",g,e),k.setData("height",l,e),h+=l}return{height:d.height,width:d.width-g,top:d.top,left:d.left+g,dim:c}},layoutH:function(b,c,d,e){var f=0;a.each(b,function(a){f+=a._area});var g=f/c,h=d.height-g,i=0;for(var j=0,k=b.length;j<k;j++){var l=b[j],m=l._area/g;l.getPos(e).setc(d.left+i,d.top+h),l.setData("width",m,e),l.setData("height",g,e),i+=m}return{height:d.height-g,width:d.width,top:d.top,left:d.left,dim:c}}}),t.Icicle=new b({compute:function(a){a=a||"current";var b=this.graph.getNode(this.root),c=this.config,d=this.canvas.getSize(),e=d.width,f=d.height,g=c.offset,h=c.constrained?c.levelsToShow:Number.MAX_VALUE;this.controller.onBeforeCompute(b),o.Util.computeLevels(this.graph,b.id,0,"ignore");var i=0;o.Util.eachLevel(b,0,!1,function(a,b){b>i&&(i=b)});var j=this.graph.getNode(this.clickedNode&&this.clickedNode.id||b.id),k=Math.min(i,h-1),l=j._depth;this.layout.horizontal()?this.computeSubtree(j,-e/2,-f/2,e/(k+1),f,l,k,a):this.computeSubtree(j,-e/2,-f/2,e,f/(k+1),l,k,a)},computeSubtree:function(b,c,d,e,f,g,h,i){b.getPos(i).setc(c,d),b.setData("width",e,i),b.setData("height",f,i);var j,k=0,l=0,m=o.Util.getSubnodes(b,[1,1]);if(m.length){a.each(m,function(a){l+=a.getData("dim")});for(var n=0,p=m.length;n<p;n++)this.layout.horizontal()?(j=f*m[n].getData("dim")/l,this.computeSubtree(m[n],c+e,d,e,j,g,h,i),d+=j):(j=e*m[n].getData("dim")/l,this.computeSubtree(m[n],c,d+f,j,f,g,h,i),c+=j)}}}),$jit.Icicle=new b({Implements:[s,i,t.Icicle],layout:{orientation:"h",vertical:function(){return this.orientation=="v"},horizontal:function(){return this.orientation=="h"},change:function(){this.orientation=this.vertical()?"h":"v"}},initialize:function(b){var c={animate:!1,orientation:"h",offset:2,levelsToShow:Number.MAX_VALUE,constrained:!1,Node:{type:"rectangle",overridable:!0},Edge:{type:"none"},Label:{type:"Native"},duration:700,fps:45},d=e("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label");this.controller=this.config=a.merge(d,c,b),this.layout.orientation=this.config.orientation;var f=this.config;f.useCanvas?(this.canvas=f.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(this.canvas=new j(this,f),this.config.labelContainer=(typeof f.injectInto=="string"?f.injectInto:f.injectInto.id)+"-label"),this.graphOptions={complex:!0,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new o(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label),this.labels=new $jit.Icicle.Label[this.config.Label.type](this),this.fx=new $jit.Icicle.Plot(this,$jit.Icicle),this.op=new $jit.Icicle.Op(this),this.group=new $jit.Icicle.Group(this),this.clickedNode=null,this.initializeExtras()},refresh:function(){var a=this.config.Label.type;if(a!="Native"){var b=this;this.graph.eachNode(function(a){b.labels.hideLabel(a,!1)})}this.compute(),this.plot()},plot:function(){this.fx.plot(this.config)},enter:function(a){if(!this.busy){this.busy=!0;var b=this,c=this.config,d={onComplete:function(){c.request&&b.compute(),c.animate?(b.graph.nodeList.setDataset(["current","end"],{alpha:[1,0]}),o.Util.eachSubgraph(a,function(a){a.setData("alpha",1,"end")},"ignore"),b.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){b.clickedNode=a,b.compute("end"),b.fx.animate({modes:["linear","node-property:width:height"],duration:1e3,onComplete:function(){b.busy=!1,b.clickedNode=a}})}})):(b.clickedNode=a,b.busy=!1,b.refresh())}};c.request?this.requestNodes(clickedNode,d):d.onComplete()}},out:function(){if(!this.busy){var a=this,b=o.Util,c=this.config,d=this.graph,e=b.getParents(d.getNode(this.clickedNode&&this.clickedNode.id||this.root)),f=e[0],g=f,h=this.clickedNode;this.busy=!0,this.events.hoveredNode=!1;if(!f){this.busy=!1;return}callback={onComplete:function(){a.clickedNode=f,c.request?a.requestNodes(f,{onComplete:function(){a.compute(),a.plot(),a.busy=!1}}):(a.compute(),a.plot(),a.busy=!1)}},c.animate?(this.clickedNode=g,this.compute("end"),this.clickedNode=h,this.fx.animate({modes:["linear","node-property:width:height"],duration:1e3,onComplete:function(){a.clickedNode=g,d.nodeList.setDataset(["current","end"],{alpha:[0,1]}),b.eachSubgraph(h,function(a){a.setData("alpha",1)},"ignore"),a.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){callback.onComplete()}})}})):callback.onComplete()}},requestNodes:function(b,c){var d=a.merge(this.controller,c),e=this.config.constrained?this.config.levelsToShow:Number.MAX_VALUE;if(d.request){var f=[],g=b._depth;o.Util.eachLevel(b,0,e,function(a){a.drawn&&!o.Util.anySubnode(a)&&(f.push(a),a._level=a._depth-g,this.config.constrained&&(a._level=e-a._level))}),this.group.requestNodes(f,d)}else d.onComplete()}}),$jit.Icicle.Op=new b({Implements:o.Op}),$jit.Icicle.Group=new b({initialize:function(a){this.viz=a,this.canvas=a.canvas,this.config=a.config},requestNodes:function(a,b){var c=0,d=a.length,e={},f=function(){b.onComplete()},g=this.viz;d==0&&f();for(var h=0;h<d;h++)e[a[h].id]=a[h],b.request(a[h].id,a[h]._level,{onComplete:function(a,b){b&&b.children&&(b.id=a,g.op.sum(b,{type:"nothing"})),++c==d&&(o.Util.computeLevels(g.graph,g.root,0),f())}})}}),$jit.Icicle.Plot=new b({Implements:o.Plot,plot:function(b,c){b=b||this.viz.controller;var d=this.viz,e=d.graph,f=e.getNode(d.clickedNode&&d.clickedNode.id||d.root),g=f._depth;d.canvas.clear(),this.plotTree(f,a.merge(b,{withLabels:!0,hideLabels:!1,plotSubtree:function(a,b){return!d.config.constrained||b._depth-g<d.config.levelsToShow}}),c)}}),$jit.Icicle.Label={},$jit.Icicle.Label.Native=new b({Implements:o.Label.Native,renderLabel:function(a,b,c){var d=a.getCtx(),e=b.getData("width"),f=b.getData("height"),g=b.getLabelData("size"),h=d.measureText(b.name);if(f>=g*1.5&&e>=h.width){var i=b.pos.getc(!0);d.fillText(b.name,i.x+e/2,i.y+f/2)}}}),$jit.Icicle.Label.SVG=new b({Implements:o.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.getSize(),g={x:Math.round(d.x+f.width/2),y:Math.round(d.y+f.height/2)};a.setAttribute("x",g.x),a.setAttribute("y",g.y),c.onPlaceLabel(a,b)}}),$jit.Icicle.Label.HTML=new b({Implements:o.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.getSize(),g={x:Math.round(d.x+f.width/2),y:Math.round(d.y+f.height/2)},h=a.style;h.left=g.x+"px",h.top=g.y+"px",h.display="",c.onPlaceLabel(a,b)}}),$jit.Icicle.Plot.NodeTypes=new b({none:{render:a.empty},rectangle:{render:function(b,c,d){var e=this.viz.config,f=e.offset,g=b.getData("width"),h=b.getData("height"),i=b.getData("border"),j=b.pos.getc(!0),k=j.x+f/2,l=j.y+f/2,m=c.getCtx();if(g-f>=2&&h-f>=2){if(e.cushion){var n=b.getData("color"),o=m.createRadialGradient(k+(g-f)/2,l+(h-f)/2,1,k+(g-f)/2,l+(h-f)/2,g<h?h:g),p=a.rgbToHex(a.map(a.hexToRgb(n),function(a){return a*.3>>0}));o.addColorStop(0,n),o.addColorStop(1,p),m.fillStyle=o}i&&(m.strokeStyle=i,m.lineWidth=3),m.fillRect(k,l,Math.max(0,g-f),Math.max(0,h-f)),i&&m.strokeRect(j.x,j.y,g,h)}},contains:function(a,b){if(this.viz.clickedNode&&!$jit.Graph.Util.isDescendantOf(a,this.viz.clickedNode.id))return!1;var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");return this.nodeHelper.rectangle.contains({x:c.x+d/2,y:c.y+e/2},b,d,e)}}}),$jit.Icicle.Plot.EdgeTypes=new b({none:a.empty}),t.ForceDirected=new b({getOptions:function(a){var b=this.canvas.getSize(),c=b.width,d=b.height,e=0;this.graph.eachNode(function(a){e++});var f=c*d/e,g=Math.sqrt(f),h=this.config.levelDistance;return{width:c,height:d,tstart:c*.1,nodef:function(a){return f/(a||1)},edgef:function(a){return g*(a-h)}}},compute:function(b,c){var d=a.splat(b||["current","start","end"]),e=this.getOptions();u.compute(this.graph,d,this.config),this.graph.computeLevels(this.root,0,"ignore"),this.graph.eachNode(function(b){a.each(d,function(c){var f=b.getPos(c);f.equals(m.KER)&&(f.x=e.width/5*(Math.random()-.5),f.y=e.height/5*(Math.random()-.5)),b.disp={},a.each(d,function(a){b.disp[a]=n(0,0)})})}),this.computePositions(d,e,c)},computePositions:function(a,b,c){var d=this.config.iterations,e=0,f=this;if(c)(function g(){for(var h=c.iter,i=0;i<h;i++){b.t=b.tstart*(1-e++/(d-1)),f.computePositionStep(a,b);if(e>=d){c.onComplete();return}}c.onStep(Math.round(e/(d-1)*100)),setTimeout(g,1)})();else for(;e<d;e++)b.t=b.tstart*(1-e/(d-1)),this.computePositionStep(a,b)},computePositionStep:function(b,c){var d=this.graph,e=Math.min,f=Math.max,g=n(0,0);d.eachNode(function(e){a.each(b,function(a){e.disp[a].x=0,e.disp[a].y=0}),d.eachNode(function(d){d.id!=e.id&&a.each(b,function(a){var b=e.getPos(a),f=d.getPos(a);g.x=b.x-f.x,g.y=b.y-f.y;var h=g.norm()||1;e.disp[a].$add(g.$scale(c.nodef(h)/h))})})});var h=!!d.getNode(this.root).visited;d.eachNode(function(d){d.eachAdjacency(function(e){var f=e.nodeTo;!!f.visited===h&&a.each(b,function(a){var b=d.getPos(a),e=f.getPos(a);g.x=b.x-e.x,g.y=b.y-e.y;var h=g.norm()||1;d.disp[a].$add(g.$scale(-c.edgef(h)/h)),f.disp[a].$add(g.$scale(-1))})}),d.visited=!h});var i=c.t,j=c.width/2,k=c.height/2;d.eachNode(function(c){a.each(b,function(a){var b=c.disp[a],d=b.norm()||1,a=c.getPos(a);a.$add(n(b.x*e(Math.abs(b.x),i)/d,b.y*e(Math.abs(b.y),i)/d)),a.x=e(j,f(-j,a.x)),a.y=e(k,f(-k,a.y))})})}}),$jit.ForceDirected=new b({Implements:[s,i,t.ForceDirected],initialize:function(b){var c=$jit.ForceDirected,d={iterations:50,levelDistance:50};this.controller=this.config=a.merge(e("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),d,b);var f=this.config;f.useCanvas?(this.canvas=f.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(f.background&&(f.background=a.merge({type:"Circles"},f.background)),this.canvas=new j(this,f),this.config.labelContainer=(typeof f.injectInto=="string"?f.injectInto:f.injectInto.id)+"-label"),this.graphOptions={complex:!0,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new o(this.graphOptions,this.config.Node,this.config.Edge),this.labels=new c.Label[f.Label.type](this),this.fx=new c.Plot(this,c),this.op=new c.Op(this),this.json=null,this.busy=!1,this.initializeExtras()},refresh:function(){this.compute(),this.plot()},reposition:function(){this.compute("end")},computeIncremental:function(b){b=a.merge({iter:20,property:"end",onStep:a.empty,onComplete:a.empty},b||{}),this.config.onBeforeCompute(this.graph.getNode(this.root)),this.compute(b.property,b)},plot:function(){this.fx.plot()},animate:function(b){this.fx.animate(a.merge({modes:["linear"]},b||{}))}}),$jit.ForceDirected.$extend=!0,function(c){c.Op=new b({Implements:o.Op}),c.Plot=new b({Implements:o.Plot}),c.Label={},c.Label.Native=new b({Implements:o.Label.Native}),c.Label.SVG=new b({Implements:o.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k={x:Math.round(d.x*h+f+j.width/2),y:Math.round(d.y*i+g+j.height/2)};a.setAttribute("x",k.x),a.setAttribute("y",k.y),c.onPlaceLabel(a,b)}}),c.Label.HTML=new b({Implements:o.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k={x:Math.round(d.x*h+f+j.width/2),y:Math.round(d.y*i+g+j.height/2)},l=a.style;l.left=k.x+"px",l.top=k.y+"px",l.display=this.fitsInCanvas(k,e)?"":"none",c.onPlaceLabel(a,b)}}),c.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.circle.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.circle.contains(c,b,d)}},ellipse:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");this.nodeHelper.ellipse.render("fill",c,d,e,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");return this.nodeHelper.ellipse.contains(c,b,d,e)}},square:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.square.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.square.contains(c,b,d)}},rectangle:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");this.nodeHelper.rectangle.render("fill",c,d,e,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");return this.nodeHelper.rectangle.contains(c,b,d,e)}},triangle:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.triangle.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.triangle.contains(c,b,d)}},star:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.star.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.star.contains(c,b,d)}}}),c.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);this.edgeHelper.line.render(c,d,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.line.contains(c,d,b,this.edge.epsilon)}},arrow:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0),e=a.getData("dim"),f=a.data.$direction,g=f&&f.length>1&&f[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render(c,d,e,g,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.arrow.contains(c,d,b,this.edge.epsilon)}}})}($jit.ForceDirected),$jit.TM={};var v=$jit.TM;$jit.TM.$extend=!0,v.Base={layout:{orientation:"h",vertical:function(){return this.orientation=="v"},horizontal:function(){return this.orientation=="h"},change:function(){this.orientation=this.vertical()?"h":"v"}},initialize:function(b){var c={orientation:"h",titleHeight:13,offset:2,levelsToShow:0,constrained:!1,animate:!1,Node:{type:"rectangle",overridable:!0,width:3,height:3,color:"#444"},Label:{textAlign:"center",textBaseline:"top"},Edge:{type:"none"},duration:700,fps:45};this.controller=this.config=a.merge(e("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),c,b),this.layout.orientation=this.config.orientation;var d=this.config;d.useCanvas?(this.canvas=d.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(d.background&&(d.background=a.merge({type:"Circles"},d.background)),this.canvas=new j(this,d),this.config.labelContainer=(typeof d.injectInto=="string"?d.injectInto:d.injectInto.id)+"-label"),this.graphOptions={complex:!0,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new o(this.graphOptions,this.config.Node,this.config.Edge),this.labels=new v.Label[d.Label.type](this),this.fx=new v.Plot(this),this.op=new v.Op(this),this.group=new v.Group(this),this.geom=new v.Geom(this),this.clickedNode=null,this.busy=!1,this.initializeExtras()},refresh:function(){if(!this.busy){this.busy=!0;var b=this;if(this.config.animate)this.compute("end"),this.config.levelsToShow>0&&this.geom.setRightLevelToShow(this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root)),this.fx.animate(a.merge(this.config,{modes:["linear","node-property:width:height"],onComplete:function(){b.busy=!1}}));else{var c=this.config.Label.type;if(c!="Native"){var b=this;this.graph.eachNode(function(a){b.labels.hideLabel(a,!1)})}this.busy=!1,this.compute(),this.config.levelsToShow>0&&this.geom.setRightLevelToShow(this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root)),this.plot()}}},plot:function(){this.fx.plot()},leaf:function(a){return a.getSubnodes([1,1],"ignore").length==0},enter:function(a){if(!this.busy){this.busy=!0;var b=this,c=this.config,d=this.graph,e=a,f=this.clickedNode,g={onComplete:function(){c.levelsToShow>0&&b.geom.setRightLevelToShow(a),(c.levelsToShow>0||c.request)&&b.compute(),c.animate?(d.nodeList.setData("alpha",0,"end"),a.eachSubgraph(function(a){a.setData("alpha",1,"end")},"ignore"),b.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){b.clickedNode=e,b.compute("end"),b.clickedNode=f,b.fx.animate({modes:["linear","node-property:width:height"],duration:1e3,onComplete:function(){b.busy=!1,b.clickedNode=e}})}})):(b.busy=!1,b.clickedNode=a,b.refresh())}};c.request?this.requestNodes(e,g):g.onComplete()}},out:function(){if(!this.busy){this.busy=!0,this.events.hoveredNode=!1;var a=this,b=this.config,c=this.graph,d=c.getNode(this.clickedNode&&this.clickedNode.id||this.root).getParents(),e=d[0],f=e,g=this.clickedNode;if(!e){this.busy=!1;return}callback={onComplete:function(){a.clickedNode=e,b.request?a.requestNodes(e,{onComplete:function(){a.compute(),a.plot(),a.busy=!1}}):(a.compute(),a.plot(),a.busy=!1)}},b.levelsToShow>0&&this.geom.setRightLevelToShow(e),b.animate?(this.clickedNode=f,this.compute("end"),this.clickedNode=g,this.fx.animate({modes:["linear","node-property:width:height"],duration:1e3,onComplete:function(){a.clickedNode=f,c.eachNode(function(a){a.setDataset(["current","end"],{alpha:[0,1]})},"ignore"),g.eachSubgraph(function(a){a.setData("alpha",1)},"ignore"),a.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){callback.onComplete()}})}})):callback.onComplete()}},requestNodes:function(b,c){var d=a.merge(this.controller,c),e=this.config.levelsToShow;if(d.request){var f=[],g=b._depth;b.eachLevel(0,e,function(a){var b=e-(a._depth-g);a.drawn&&!a.anySubnode()&&b>0&&(f.push(a),a._level=b)}),this.group.requestNodes(f,d)}else d.onComplete()}},v.Op=new b({Implements:o.Op,initialize:function(a){this.viz=a}}),v.Geom=new b({Implements:o.Geom,getRightLevelToShow:function(){return this.viz.config.levelsToShow},setRightLevelToShow:function(a){var b=this.getRightLevelToShow(),c=this.viz.labels;a.eachLevel(0,b+1,function(d){var e=d._depth-a._depth;e>b?(d.drawn=!1,d.exist=!1,d.ignore=!0,c.hideLabel(d,!1)):(d.drawn=!0,d.exist=!0,delete d.ignore)}),a.drawn=!0,delete a.ignore}}),v.Group=new b({initialize:function(a){this.viz=a,this.canvas=a.canvas,this.config=a.config},requestNodes:function(a,b){var c=0,d=a.length,e={},f=function(){b.onComplete()},g=this.viz;d==0&&f();for(var h=0;h<d;h++)e[a[h].id]=a[h],b.request(a[h].id,a[h]._level,{onComplete:function(a,b){b&&b.children&&(b.id=a,g.op.sum(b,{type:"nothing"})),++c==d&&(g.graph.computeLevels(g.root,0),f())}})}}),v.Plot=new b({Implements:o.Plot,initialize:function(a){this.viz=a,this.config=a.config,this.node=this.config.Node,this.edge=this.config.Edge,this.animation=new d,this.nodeTypes=new v.Plot.NodeTypes,this.edgeTypes=new v.Plot.EdgeTypes,this.labels=a.labels},plot:function(b,c){var d=this.viz,e=d.graph;d.canvas.clear(),this.plotTree(e.getNode(d.clickedNode&&d.clickedNode.id||d.root),a.merge(d.config,b||{},{withLabels:!0,hideLabels:!1,plotSubtree:function(a,b){return a.anySubnode("exist")}}),c)}}),v.Label={},v.Label.Native=new b({Implements:o.Label.Native,initialize:function(a){this.config=a.config,this.leaf=a.leaf},renderLabel:function(a,b,c){if(this.leaf(b)||this.config.titleHeight){var d=b.pos.getc(!0),e=a.getCtx(),f=b.getData("width"),g=b.getData("height"),h=d.x+f/2,i=d.y;e.fillText(b.name,h,i,f)}}}),v.Label.SVG=new b({Implements:o.Label.SVG,initialize:function(a){this.viz=a,this.leaf=a.leaf,this.config=a.config},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k={x:Math.round(d.x*h+f+j.width/2),y:Math.round(d.y*i+g+j.height/2)};a.setAttribute("x",k.x),a.setAttribute("y",k.y),!this.leaf(b)&&!this.config.titleHeight&&(a.style.display="none"),c.onPlaceLabel(a,b)}}),v.Label.HTML=new b({Implements:o.Label.HTML,initialize:function(a){this.viz=a,this.leaf=a.leaf,this.config=a.config},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k={x:Math.round(d.x*h+f+j.width/2),y:Math.round(d.y*i+g+j.height/2)},l=a.style;l.left=k.x+"px",l.top=k.y+"px",l.width=b.getData("width")*h+"px",l.height=b.getData("height")*i+"px",l.zIndex=b._depth*100,l.display="",!this.leaf(b)&&!this.config.titleHeight&&(a.style.display="none"),c.onPlaceLabel(a,b)}}),v.Plot.NodeTypes=new b({none:{render:a.empty},rectangle:{render:function(b,c,d){var e=this.viz.leaf(b),f=this.config,g=f.offset,h=f.titleHeight,i=b.pos.getc(!0),j=b.getData("width"),k=b.getData("height"),l=b.getData("border"),m=c.getCtx(),n=i.x+g/2,o=i.y+g/2;if(j>g&&k>g)if(e){if(f.cushion){var p=m.createRadialGradient(n+(j-g)/2,o+(k-g)/2,1,n+(j-g)/2,o+(k-g)/2,j<k?k:j),q=b.getData("color"),r=a.rgbToHex(a.map(a.hexToRgb(q),function(a){return a*.2>>0}));p.addColorStop(0,q),p.addColorStop(1,r),m.fillStyle=p}m.fillRect(n,o,j-g,k-g),l&&(m.save(),m.strokeStyle=l,m.strokeRect(n,o,j-g,k-g),m.restore())}else h>0&&(m.fillRect(i.x+g/2,i.y+g/2,j-g,h-g),l&&(m.save(),m.strokeStyle=l,m.strokeRect(i.x+g/2,i.y+g/2,j-g,k-g),m.restore()))},contains:function(a,b){if(this.viz.clickedNode&&!a.isDescendantOf(this.viz.clickedNode.id)||a.ignore)return!1;var c=a.pos.getc(!0),d=a.getData("width"),e=this.viz.leaf(a),f=e?a.getData("height"):this.config.titleHeight;return this.nodeHelper.rectangle.contains({x:c.x+d/2,y:c.y+f/2},b,d,f)}}}),v.Plot.EdgeTypes=new b({none:a.empty}),v.SliceAndDice=new b({Implements:[s,i,v.Base,t.TM.SliceAndDice]}),v.Squarified=new b({Implements:[s,i,v.Base,t.TM.Squarified]}),v.Strip=new b({Implements:[s,i,v.Base,t.TM.Strip]}),$jit.RGraph=new b({Implements:[s,i,t.Radial],initialize:function(b){var c=$jit.RGraph,d={interpolation:"linear",levelDistance:100};this.controller=this.config=a.merge(e("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),d,b);var f=this.config;f.useCanvas?(this.canvas=f.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(f.background&&(f.background=a.merge({type:"Circles"},f.background)),this.canvas=new j(this,f),this.config.labelContainer=(typeof f.injectInto=="string"?f.injectInto:f.injectInto.id)+"-label"),this.graphOptions={complex:!1,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new o(this.graphOptions,this.config.Node,this.config.Edge),this.labels=new c.Label[f.Label.type](this),this.fx=new c.Plot(this,c),this.op=new c.Op(this),this.json=null,this.root=null,this.busy=!1,this.parent=!1,this.initializeExtras()},createLevelDistanceFunc:function(){var a=this.config.levelDistance;return function(b){return(b._depth+1)*a}},refresh:function(){this.compute(),this.plot()},reposition:function(){this.compute("end")},plot:function(){this.fx.plot()},getNodeAndParentAngle:function(a){var b=!1,c=this.graph.getNode(a),d=c.getParents(),e=d.length>0?d[0]:!1;if(e){var f=e.pos.getc(),g=c.pos.getc(),h=f.add(g.scale(-1));b=Math.atan2(h.y,h.x),b<0&&(b+=2*Math.PI)}return{parent:e,theta:b}},tagChildren:function(a,b){if(a.angleSpan){var c=[];a.eachAdjacency(function(a){c.push(a.nodeTo)},"ignore");var d=c.length;for(var e=0;e<d&&b!=c[e].id;e++){}for(var f=(e+1)%d,g=0;b!=c[f].id;f=(f+1)%d)c[f].dist=g++}},onClick:function(b,c){if(this.root!=b&&!this.busy){this.busy=!0,this.root=b,that=this,this.controller.onBeforeCompute(this.graph.getNode(b));var d=this.getNodeAndParentAngle(b);this.tagChildren(d.parent,b),this.parent=d.parent,this.compute("end");var e=d.theta-d.parent.endPos.theta;this.graph.eachNode(function(a){a.endPos.set(a.endPos.getp().add(l(e,0)))});var f=this.config.interpolation;c=a.merge({onComplete:a.empty},c||{}),this.fx.animate(a.merge({hideLabels:!0,modes:[f]},c,{onComplete:function(){that.busy=!1,c.onComplete()}}))}}}),$jit.RGraph.$extend=!0,function(c){c.Op=new b({Implements:o.Op}),c.Plot=new b({Implements:o.Plot}),c.Label={},c.Label.Native=new b({Implements:o.Label.Native}),c.Label.SVG=new b({Implements:o.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k={x:Math.round(d.x*h+f+j.width/2),y:Math.round(d.y*i+g+j.height/2)};a.setAttribute("x",k.x),a.setAttribute("y",k.y),c.onPlaceLabel(a,b)}}),c.Label.HTML=new b({Implements:o.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k={x:Math.round(d.x*h+f+j.width/2),y:Math.round(d.y*i+g+j.height/2)},l=a.style;l.left=k.x+"px",l.top=k.y+"px",l.display=this.fitsInCanvas(k,e)?"":"none",c.onPlaceLabel(a,b)}}),c.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.circle.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.circle.contains(c,b,d)}},ellipse:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");this.nodeHelper.ellipse.render("fill",c,d,e,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");return this.nodeHelper.ellipse.contains(c,b,d,e)}},square:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.square.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.square.contains(c,b,d)}},rectangle:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");this.nodeHelper.rectangle.render("fill",c,d,e,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("width"),e=a.getData("height");return this.nodeHelper.rectangle.contains(c,b,d,e)}},triangle:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.triangle.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.triangle.contains(c,b,d)}},star:{render:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");this.nodeHelper.star.render("fill",c,d,b)},contains:function(a,b){var c=a.pos.getc(!0),d=a.getData("dim");return this.nodeHelper.star.contains(c,b,d)}}}),c.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);this.edgeHelper.line.render(c,d,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.line.contains(c,d,b,this.edge.epsilon)}},arrow:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0),e=a.getData("dim"),f=a.data.$direction,g=f&&f.length>1&&f[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render(c,d,e,g,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0);return this.edgeHelper.arrow.contains(c,d,b,this.edge.epsilon)}}})}($jit.RGraph),m.prototype.moebiusTransformation=function(a){var b=this.add(a),c=a.$conjugate().$prod(this);c.x++;return b.$div(c)},o.Util.moebiusTransformation=function(a,b,c,d,e){this.eachNode(a,function(a){for(var e=0;e<c.length;e++){var f=b[e].scale(-1),g=d?d:c[e];a.getPos(c[e]).set(a.getPos(g).getc().moebiusTransformation(f))}},e)},$jit.Hypertree=new b({Implements:[s,i,t.Radial],initialize:function(b){var c=$jit.Hypertree,d={radius:"auto",offset:0,Edge:{type:"hyperline"},duration:1500,fps:35};this.controller=this.config=a.merge(e("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),d,b);var f=this.config;f.useCanvas?(this.canvas=f.useCanvas,this.config.labelContainer=this.canvas.id+"-label"):(f.background&&(f.background=a.merge({type:"Circles"},f.background)),this.canvas=new j(this,f),this.config.labelContainer=(typeof f.injectInto=="string"?f.injectInto:f.injectInto.id)+"-label"),this.graphOptions={complex:!1,Node:{selected:!1,exist:!0,drawn:!0}},this.graph=new o(this.graphOptions,this.config.Node,this.config.Edge),this.labels=new c.Label[f.Label.type](this),this.fx=new c.Plot(this,c),this.op=new c.Op(this),this.json=null,this.root=null,this.busy=!1,this.initializeExtras()},createLevelDistanceFunc:function(){var a=this.getRadius(),b=0,c=Math.max,d=this.config;this.graph.eachNode(function(a){b=c(a._depth,b)},"ignore"),b++;var e=function(b){return function(c){c.scale=a;var e=c._depth+1,f=0,g=Math.pow;while(e)f+=g(b,e--);return f-d.offset}};for(var f=.51;f<=1;f+=.01){var g=(1-Math.pow(f,b))/(1-f);if(g>=2)return e(f-.01)}return e(.75)},getRadius:function(){var a=this.config.radius;if(a!=="auto")return a;var b=this.canvas.getSize();return Math.min(b.width,b.height)/2},refresh:function(a){a?(this.reposition(),this.graph.eachNode(function(a){a.startPos.rho=a.pos.rho=a.endPos.rho,a.startPos.theta=a.pos.theta=a.endPos.theta})):this.compute(),this.plot()},reposition:function(){this.compute("end");var a=this.graph.getNode(this.root).pos.getc().scale(-1);o.Util.moebiusTransformation(this.graph,[a],["end"],"end","ignore"),this.graph.eachNode(function(a){a.ignore&&(a.endPos.rho=a.pos.rho,a.endPos.theta=a.pos.theta)})},plot:function(){this.fx.plot()},onClick:function(a,b){var c=this.graph.getNode(a).pos.getc(!0);this.move(c,b)},move:function(b,c){var d=n(b.x,b.y);if(this.busy===!1&&d.norm()<1){this.busy=!0;var e=this.graph.getClosestNodeToPos(d),f=this;this.graph.computeLevels(e.id,0),this.controller.onBeforeCompute(e),c=a.merge({onComplete:a.empty},c||{}),this.fx.animate(a.merge({modes:["moebius"],hideLabels:!0},c,{onComplete:function(){f.busy=!1,c.onComplete()}}),d)}}}),$jit.Hypertree.$extend=!0,function(c){c.Op=new b({Implements:o.Op}),c.Plot=new b({Implements:o.Plot}),c.Label={},c.Label.Native=new b({Implements:o.Label.Native,initialize:function(a){this.viz=a},renderLabel:function(a,b,c){var d=a.getCtx(),e=b.pos.getc(!0),f=this.viz.getRadius();d.fillText(b.name,e.x*f,e.y*f)}}),c.Label.SVG=new b({Implements:o.Label.SVG,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k=this.viz.getRadius(),l={x:Math.round(d.x*h*k+f+j.width/2),y:Math.round(d.y*i*k+g+j.height/2)};a.setAttribute("x",l.x),a.setAttribute("y",l.y),c.onPlaceLabel(a,b)}}),c.Label.HTML=new b({Implements:o.Label.HTML,initialize:function(a){this.viz=a},placeLabel:function(a,b,c){var d=b.pos.getc(!0),e=this.viz.canvas,f=e.translateOffsetX,g=e.translateOffsetY,h=e.scaleOffsetX,i=e.scaleOffsetY,j=e.getSize(),k=this.viz.getRadius(),l={x:Math.round(d.x*h*k+f+j.width/2),y:Math.round(d.y*i*k+g+j.height/2)},m=a.style;m.left=l.x+"px",m.top=l.y+"px",m.display=this.fitsInCanvas(l,e)?"":"none",c.onPlaceLabel(a,b)}}),c.Plot.NodeTypes=new b({none:{render:a.empty,contains:a.lambda(!1)},circle:{render:function(a,b){var c=this.node,d=a.getData("dim"),e=a.pos.getc();d=c.transform?d*(1-e.squaredNorm()):d,e.$scale(a.scale),d>.2&&this.nodeHelper.circle.render("fill",e,d,b)},contains:function(a,b){var c=a.getData("dim"),d=a.pos.getc().$scale(a.scale);return this.nodeHelper.circle.contains(d,b,c)}},ellipse:{render:function(a,b){var c=a.pos.getc().$scale(a.scale),d=a.getData("width"),e=a.getData("height");this.nodeHelper.ellipse.render("fill",c,d,e,b)},contains:function(a,b){var c=a.getData("width"),d=a.getData("height"),e=a.pos.getc().$scale(a.scale);return this.nodeHelper.circle.contains(e,b,c,d)}},square:{render:function(a,b){var c=this.node,d=a.getData("dim"),e=a.pos.getc();d=c.transform?d*(1-e.squaredNorm()):d,e.$scale(a.scale),d>.2&&this.nodeHelper.square.render("fill",e,d,b)},contains:function(a,b){var c=a.getData("dim"),d=a.pos.getc().$scale(a.scale);return this.nodeHelper.square.contains(d,b,c)}},rectangle:{render:function(a,b){var c=this.node,d=a.getData("width"),e=a.getData("height"),f=a.pos.getc();d=c.transform?d*(1-f.squaredNorm()):d,e=c.transform?e*(1-f.squaredNorm()):e,f.$scale(a.scale),d>.2&&e>.2&&this.nodeHelper.rectangle.render("fill",f,d,e,b)},contains:function(a,b){var c=a.getData("width"),d=a.getData("height"),e=a.pos.getc().$scale(a.scale);return this.nodeHelper.square.contains(e,b,c,d)}},triangle:{render:function(a,b){var c=this.node,d=a.getData("dim"),e=a.pos.getc();d=c.transform?d*(1-e.squaredNorm()):d,e.$scale(a.scale),d>.2&&this.nodeHelper.triangle.render("fill",e,d,b)},contains:function(a,b){var c=a.getData("dim"),d=a.pos.getc().$scale(a.scale);return this.nodeHelper.triangle.contains(d,b,c)}},star:{render:function(a,b){var c=this.node,d=a.getData("dim"),e=a.pos.getc();d=c.transform?d*(1-e.squaredNorm()):d,e.$scale(a.scale),d>.2&&this.nodeHelper.star.render("fill",e,d,b)},contains:function(a,b){var c=a.getData("dim"),d=a.pos.getc().$scale(a.scale);return this.nodeHelper.star.contains(d,b,c)}}}),c.Plot.EdgeTypes=new b({none:a.empty,line:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0),e=a.nodeFrom.scale;this.edgeHelper.line.render({x:c.x*e,y:c.y*e},{x:d.x*e,y:d.y*e},b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0),e=a.nodeFrom.scale;this.edgeHelper.line.contains({x:c.x*e,y:c.y*e},{x:d.x*e,y:d.y*e},b,this.edge.epsilon)}},arrow:{render:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0),e=a.nodeFrom.scale,f=a.getData("dim"),g=a.data.$direction,h=g&&g.length>1&&g[0]!=a.nodeFrom.id;this.edgeHelper.arrow.render({x:c.x*e,y:c.y*e},{x:d.x*e,y:d.y*e},f,h,b)},contains:function(a,b){var c=a.nodeFrom.pos.getc(!0),d=a.nodeTo.pos.getc(!0),e=a.nodeFrom.scale;this.edgeHelper.arrow.contains({x:c.x*e,y:c.y*e},{x:d.x*e,y:d.y*e},b,this.edge.epsilon)}},hyperline:{render:function(a,b){var c=a.nodeFrom.pos.getc(),d=a.nodeTo.pos.getc(),e=this.viz.getRadius();this.edgeHelper.hyperline.render(c,d,e,b)},contains:a.lambda(!1)}})}($jit.Hypertree)}(),define("lib/tools/jit",function(){}),function(){function b(b){var c=b.currentTarget||b.srcElement,i;if(b.type==="load"||d.test(c.readyState)){b=c.getAttribute("data-requiremodule"),f[b]=!0;for(b=0;i=e[b];b++)if(f[i.name])a(i.name,i.req,i.onLoad);else break;b>0&&e.splice(0,b),setTimeout(function(){c.parentNode.removeChild(c)},15)}}function a(a,b,c){b([a],function(a){c(function(){return a})})}var c=typeof document!=="undefined"&&typeof window!=="undefined"&&(document.createElement("script").async||window.opera&&Object.prototype.toString.call(window.opera)==="[object Opera]"||"MozAppearance"in document.documentElement.style),d=/^(complete|loaded)$/,e=[],f={};define("order",{version:"0.24.0",load:function(d,f,h,i){var k=f.nameToUrl(d,null);i.isBuild?a(d,f,h):(require.s.skipAsync[k]=!0,c?f([d],function(a){h(function(){return a})}):f.isDefined(d)?f([d],function(a){h(function(){return a})}):(e.push({name:d,req:f,onLoad:h}),require.attach(k,"",d,b,"script/cache")))}})}(),function(a,b){function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){c=b.parentNode,e=c.name;if(!b.href||!e||c.nodeName.toLowerCase()!=="map")return!1;b=a("img[usemap=#"+e+"]")[0];return!!b&&d(b)}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}a.ui=a.ui||{},a.ui.version||(a.extend(a.ui,{version:"1.8.13",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return typeof b==="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;b=a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){c=a(this[0]);for(var d;c.length&&c[0]!==document;){d=c.css("position");if(d==="absolute"||d==="relative"||d==="fixed"){d=parseInt(c.css("zIndex"),10);if(!isNaN(d)&&d!==0)return d}c=c.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function e(b,c,d,e){a.each(f,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),e&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)});return c}var f=d==="Width"?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){if(c===b)return h["inner"+d].call(this);return this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){if(typeof b!=="number")return h["outer"+d].call(this,b);return this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){b=a.ui[b].prototype;for(var e in d)b.plugins[e]=b.plugins[e]||[],b.plugins[e].push([c,d[e]])},call:function(a,b,c){if((b=a.plugins[b])&&a.element[0].parentNode)for(var d=0;d<b.length;d++)a.options[b[d][0]]&&b[d][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;c=c&&c==="left"?"scrollLeft":"scrollTop";var d=!1;if(b[c]>0)return!0;b[c]=1,d=b[c]>0,b[c]=0;return d},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}}))}(jQuery),function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)a(e).triggerHandler("remove");c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){a(this).triggerHandler("remove")});return d.call(a(this),b,c)})}}a.widget=function(b,c,d){var e=b.split(".")[0],f;b=b.split(".")[1],f=e+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][f]=function(c){return!!a.data(c,b)},a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)},c=new c,c.options=a.extend(!0,{},c.options),a[e][b].prototype=a.extend(!0,c,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},d),a.widget.bridge(b,a[e][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e==="string",g=Array.prototype.slice.call(arguments,1),h=this;e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):e;if(f&&e.charAt(0)==="_")return h;f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b){h=f;return!1}}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))});return h}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this),this.element=a(c),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var e=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c==="string"){if(d===b)return this.options[c];e={},e[c]=d}this._setOptions(e);return this},_setOptions:function(b){var c=this;a.each(b,function(a,b){c._setOption(a,b)});return this},_setOption:function(a,b){this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",b);return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var e=this.options[b];c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),d=d||{};if(c.originalEvent){b=a.event.props.length;for(var f;b;)f=a.event.props[--b],c[f]=c.originalEvent[f]}this.element.trigger(c,d);return!(a.isFunction(e)&&e.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}}(jQuery),function(a){var b=!1;a(document).mousedown(function(){b=!1}),a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent")){a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation();return!1}}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var e=this,f=c.which==1,g=typeof this.options.cancel=="string"?a(c.target).parents().add(c.target).filter(this.options.cancel).length:!1;if(!f||g||!this._mouseCapture(c))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(c)&&this._mouseDelayMet(c)){this._mouseStarted=this._mouseStart(c)!==!1;if(!this._mouseStarted){c.preventDefault();return!0}}!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return e._mouseMove(a)},this._mouseUpDelegate=function(a){return e._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault();return b=!0}},_mouseMove:function(b){if(a.browser.msie&&document.documentMode<9&&!b.button)return this._mouseUp(b);if(this._mouseStarted){this._mouseDrag(b);return b.preventDefault()}this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&((this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1)?this._mouseDrag(b):this._mouseUp(b));return!this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b));return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a){a.ui=a.ui||{};var b=/left|center|right/,c=/top|center|bottom/,d=a.fn.position,e=a.fn.offset;a.fn.position=function(e){if(!e||!e.of)return d.apply(this,arguments);e=a.extend({},e);var f=a(e.of),g=f[0],h=(e.collision||"flip").split(" "),i=e.offset?e.offset.split(" "):[0,0],j,k,l;g.nodeType===9?(j=f.width(),k=f.height(),l={top:0,left:0}):g.setTimeout?(j=f.width(),k=f.height(),l={top:f.scrollTop(),left:f.scrollLeft()}):g.preventDefault?(e.at="left top",j=k=0,l={top:e.of.pageY,left:e.of.pageX}):(j=f.outerWidth(),k=f.outerHeight(),l=f.offset()),a.each(["my","at"],function(){var a=(e[this]||"").split(" ");a.length===1&&(a=b.test(a[0])?a.concat(["center"]):c.test(a[0])?["center"].concat(a):["center","center"]),a[0]=b.test(a[0])?a[0]:"center",a[1]=c.test(a[1])?a[1]:"center",e[this]=a}),h.length===1&&(h[1]=h[0]),i[0]=parseInt(i[0],10)||0,i.length===1&&(i[1]=i[0]),i[1]=parseInt(i[1],10)||0,e.at[0]==="right"?l.left+=j:e.at[0]==="center"&&(l.left+=j/2),e.at[1]==="bottom"?l.top+=k:e.at[1]==="center"&&(l.top+=k/2),l.left+=i[0],l.top+=i[1];return this.each(function(){var b=a(this),c=b.outerWidth(),d=b.outerHeight(),f=parseInt(a.curCSS(this,"marginLeft",!0))||0,g=parseInt(a.curCSS(this,"marginTop",!0))||0,m=c+f+(parseInt(a.curCSS(this,"marginRight",!0))||0),n=d+g+(parseInt(a.curCSS(this,"marginBottom",!0))||0),o=a.extend({},l),p;e.my[0]==="right"?o.left-=c:e.my[0]==="center"&&(o.left-=c/2),e.my[1]==="bottom"?o.top-=d:e.my[1]==="center"&&(o.top-=d/2),o.left=Math.round(o.left),o.top=Math.round(o.top),p={left:o.left-f,top:o.top-g},a.each(["left","top"],function(b,f){a.ui.position[h[b]]&&a.ui.position[h[b]][f](o,{targetWidth:j,targetHeight:k,elemWidth:c,elemHeight:d,collisionPosition:p,collisionWidth:m,collisionHeight:n,offset:i,my:e.my,at:e.at})}),a.fn.bgiframe&&b.bgiframe(),b.offset(a.extend(o,{using:e.using}))})},a.ui.position={fit:{left:function(b,c){var d=a(window);d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),b.left=d>0?b.left-d:Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=a(window);d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),b.top=d>0?b.top-d:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]!=="center"){var d=a(window);d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();var e=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,f=c.at[0]==="left"?c.targetWidth:-c.targetWidth,g=-2*c.offset[0];b.left+=c.collisionPosition.left<0?e+f+g:d>0?e+f+g:0}},top:function(b,c){if(c.at[1]!=="center"){var d=a(window);d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();var e=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,f=c.at[1]==="top"?c.targetHeight:-c.targetHeight,g=-2*c.offset[1];b.top+=c.collisionPosition.top<0?e+f+g:d>0?e+f+g:0}}}},a.offset.setOffset||(a.offset.setOffset=function(b,c){/static/.test(a.curCSS(b,"position"))&&(b.style.position="relative");var d=a(b),e=d.offset(),f=parseInt(a.curCSS(b,"top",!0),10)||0,g=parseInt(a.curCSS(b,"left",!0),10)||0;e={top:c.top-e.top+f,left:c.left-e.left+g},"using"in c?c.using.call(b,e):d.css(e)},a.fn.offset=function(b){var c=this[0];if(!c||!c.ownerDocument)return null;if(b)return this.each(function(){a.offset.setOffset(this,b)});return e.call(this)})}(jQuery),function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy();return this}},_mouseCapture:function(b){var c=this.options;if(this.helper||c.disabled||a(b.target).is(".ui-resizable-handle"))return!1;this.handle=this._getHandle(b);if(!this.handle)return!1;a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")});return!0},_mouseStart:function(b){var c=this.options;this.helper=this._createHelper(b),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment();if(this._trigger("start",b)===!1){this._clear();return!1}this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(b,!0);return!0},_mouseDrag:function(b,c){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute");if(!c){c=this._uiHash();if(this._trigger("drag",b,c)===!1){this._mouseUp({});return!1}this.position=c.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,b);return!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b)),this.dropped&&(c=this.dropped,this.dropped=!1);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return!1;if(this.options.revert=="invalid"&&!c||this.options.revert=="valid"&&c||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var e=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){e._trigger("stop",b)!==!1&&e._clear()})}else this._trigger("stop",b)!==!1&&this._clear();return!1},_mouseUp:function(b){this.options.iframeFix===!0&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});return a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)});return c},_createHelper:function(b){var c=this.options;b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):c.helper=="clone"?this.element.clone().removeAttr("id"):this.element,b.parents("body").length||b.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo),b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute");return b},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[(b.containment=="document"?0:a(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(b.containment=="document"?0:a(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:a(window).scrollLeft())+a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?0:a(window).scrollTop())+(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(/^(document|window|parent)$/.test(b.containment)||b.containment.constructor==Array)b.containment.constructor==Array&&(this.containment=b.containment);else{b=a(b.containment);var c=b[0];if(c){b.offset();var e=a(c).css("overflow")!="hidden";this.containment=[(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0),(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0),(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=b}}},_convertPositionTo:function(b,c){c||(c=this.position),b=b=="absolute"?1:-1;var e=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*b+this.offset.parent.top*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop())*b),left:c.left+this.offset.relative.left*b+this.offset.parent.left*b-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*b)}},_generatePosition:function(b){var c=this.options,e=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName),g=b.pageX,h=b.pageY;if(this.originalPosition){var i;this.containment&&(this.relative_container?(i=this.relative_container.offset(),i=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):i=this.containment,b.pageX-this.offset.click.left<i[0]&&(g=i[0]+this.offset.click.left),b.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),b.pageX-this.offset.click.left>i[2]&&(g=i[2]+this.offset.click.left),b.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),c.grid&&(h=this.originalPageY+Math.round((h-this.originalPageY)/c.grid[1])*c.grid[1],h=i?h-this.offset.click.top>=i[1]&&h-this.offset.click.top<=i[3]?h:h-this.offset.click.top>=i[1]?h-c.grid[1]:h+c.grid[1]:h,g=this.originalPageX+Math.round((g-this.originalPageX)/c.grid[0])*c.grid[0],g=i?g-this.offset.click.left>=i[0]&&g-this.offset.click.left<=i[2]?g:g-this.offset.click.left>=i[0]?g-c.grid[0]:g+c.grid[0]:g)}return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop()),left:g-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,e){e=e||this._uiHash(),a.ui.plugin.call(this,b,[c,e]),b=="drag"&&(this.positionAbs=this._convertPositionTo("absolute"));return a.Widget.prototype._trigger.call(this,b,c,e)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.extend(a.ui.draggable,{version:"1.8.13"}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var e=a(this).data("draggable"),f=e.options,g=a.extend({},c,{item:e.element});e.sortables=[],a(f.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(e.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,g))})},stop:function(b,c){var e=a(this).data("draggable"),f=a.extend({},c,{item:e.element});a.each(e.sortables,function(){this.instance.isOver?(this.instance.isOver=0,e.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,e.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,f))})},drag:function(b,c){var e=a(this).data("draggable"),f=this;a.each(e.sortables,function(){this.instance.positionAbs=e.positionAbs,this.instance.helperProportions=e.helperProportions,this.instance.offset.click=e.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(f).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=e.offset.click.top,this.instance.offset.click.left=e.offset.click.left,this.instance.offset.parent.left-=e.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=e.offset.parent.top-this.instance.offset.parent.top,e._trigger("toSortable",b),e.dropped=this.instance.element,e.currentItem=e.element,this.instance.fromOutside=e),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),e._trigger("fromSortable",b),e.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){b=a(c.helper),c=a(this).data("draggable").options,b.css("opacity")&&(c._opacity=b.css("opacity")),b.css("opacity",c.opacity)},stop:function(b,c){b=a(this).data("draggable").options,b._opacity&&a(c.helper).css("opacity",b._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("draggable");b.scrollParent[0]!=document&&b.scrollParent[0].tagName!="HTML"&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("draggable"),e=c.options,f=!1;if(c.scrollParent[0]!=document&&c.scrollParent[0].tagName!="HTML"){if(!e.axis||e.axis!="x")c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?c.scrollParent[0].scrollTop=f=c.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-c.overflowOffset.top<e.scrollSensitivity&&(c.scrollParent[0].scrollTop=f=c.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||e.axis!="y")c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?c.scrollParent[0].scrollLeft=f=c.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-c.overflowOffset.left<e.scrollSensitivity&&(c.scrollParent[0].scrollLeft=f=c.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||e.axis!="x")b.pageY-a(document).scrollTop()<e.scrollSensitivity?f=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<e.scrollSensitivity&&(f=a(document).scrollTop(a(document).scrollTop()+e.scrollSpeed));if(!e.axis||e.axis!="y")b.pageX-a(document).scrollLeft()<e.scrollSensitivity?f=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<e.scrollSensitivity&&(f=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed))}f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var c=a(this),e=c.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:e.top,left:e.left})})},drag:function(b,c){for(var e=a(this).data("draggable"),f=e.options,g=f.snapTolerance,h=c.offset.left,i=h+e.helperProportions.width,j=c.offset.top,k=j+e.helperProportions.height,l=e.snapElements.length-1;l>=0;l--){var m=e.snapElements[l].left,n=m+e.snapElements[l].width,o=e.snapElements[l].top,p=o+e.snapElements[l].height;if(m-g<h&&h<n+g&&o-g<j&&j<p+g||m-g<h&&h<n+g&&o-g<k&&k<p+g||m-g<i&&i<n+g&&o-g<j&&j<p+g||m-g<i&&i<n+g&&o-g<k&&k<p+g){if(f.snapMode!="inner"){var q=Math.abs(o-k)<=g,r=Math.abs(p-j)<=g,s=Math.abs(m-i)<=g,t=Math.abs(n-h)<=g;q&&(c.position.top=e._convertPositionTo("relative",{top:o-e.helperProportions.height,left:0}).top-e.margins.top),r&&(c.position.top=e._convertPositionTo("relative",{top:p,left:0}).top-e.margins.top),s&&(c.position.left=e._convertPositionTo("relative",{top:0,left:m-e.helperProportions.width}).left-e.margins.left),t&&(c.position.left=e._convertPositionTo("relative",{top:0,left:n}).left-e.margins.left)}var u=q||r||s||t;f.snapMode!="outer"&&(q=Math.abs(o-j)<=g,r=Math.abs(p-k)<=g,s=Math.abs(m-h)<=g,t=Math.abs(n-i)<=g,q&&(c.position.top=e._convertPositionTo("relative",{top:o,left:0}).top-e.margins.top),r&&(c.position.top=e._convertPositionTo("relative",{top:p-e.helperProportions.height,left:0}).top-e.margins.top),s&&(c.position.left=e._convertPositionTo("relative",{top:0,left:m}).left-e.margins.left),t&&(c.position.left=e._convertPositionTo("relative",{top:0,left:n-e.helperProportions.width}).left-e.margins.left)),!e.snapElements[l].snapping&&(q||r||s||t||u)&&(e.options.snap.snap&&e.options.snap.snap.call(e.element,b,a.extend(e._uiHash(),{snapItem:e.snapElements[l].item}))),e.snapElements[l].snapping=q||r||s||t||u}else e.snapElements[l].snapping&&e.options.snap.release&&e.options.snap.release.call(e.element,b,a.extend(e._uiHash(),{snapItem:e.snapElements[l].item})),e.snapElements[l].snapping=!1}}}),a.ui.plugin.add("draggable","stack",{start:function(){var b=a(this).data("draggable").options;b=a.makeArray(a(b.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(b.length){var c=parseInt(b[0].style.zIndex)||0;a(b).each(function(a){this.style.zIndex=c+a}),this[0].style.zIndex=c+b.length}}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){b=a(c.helper),c=a(this).data("draggable").options,b.css("zIndex")&&(c._zIndex=b.css("zIndex")),b.css("zIndex",c.zIndex)},stop:function(b,c){b=a(this).data("draggable").options,b._zIndex&&a(c.helper).css("zIndex",b._zIndex)}})}(jQuery),function(a){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,c=b.accept;this.isover=0,this.isout=1,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var b=a.ui.ddmanager.droppables[this.options.scope],c=0;c<b.length;c++)b[c]==this&&b.splice(c,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(b,c){b=="accept"&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!=this.element[0]&&(this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c))))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!=this.element[0]&&(this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c))))},_drop:function(b,c){var e=c||a.ui.ddmanager.current;if(!e||(e.currentItem||e.element)[0]==this.element[0])return!1;var f=!1;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==e.options.scope&&b.accept.call(b.element[0],e.currentItem||e.element)&&a.ui.intersect(e,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)){f=!0;return!1}});if(f)return!1;if(this.accept.call(this.element[0],e.currentItem||e.element)){this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(e));return this.element}return!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.extend(a.ui.droppable,{version:"1.8.13"}),a.ui.intersect=function(b,c,e){if(!c.offset)return!1;var f=(b.positionAbs||b.position.absolute).left,g=f+b.helperProportions.width,h=(b.positionAbs||b.position.absolute).top,i=h+b.helperProportions.height,j=c.offset.left,k=j+c.proportions.width,l=c.offset.top,m=l+c.proportions.height;switch(e){case"fit":return j<=f&&g<=k&&l<=h&&i<=m;case"intersect":return j<f+b.helperProportions.width/2&&g-b.helperProportions.width/2<k&&l<h+b.helperProportions.height/2&&i-b.helperProportions.height/2<m;case"pointer":return a.ui.isOver((b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,l,j,c.proportions.height,c.proportions.width);case"touch":return(h>=l&&h<=m||i>=l&&i<=m||h<l&&i>m)&&(f>=j&&f<=k||g>=j&&g<=k||f<j&&g>k);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var e=a.ui.ddmanager.droppables[b.options.scope]||[],f=c?c.type:null,g=(b.currentItem||b.element).find(":data(droppable)").andSelf(),h=0;a:for(;h<e.length;h++)if(!(e[h].options.disabled||b&&!e[h].accept.call(e[h].element[0],b.currentItem||b.element))){for(var i=0;i<g.length;i++)if(g[i]==e[h].element[0]){e[h].proportions.height=0;continue a}e[h].visible=e[h].element.css("display")!="none",e[h].visible&&(f=="mousedown"&&e[h]._activate.call(e[h],c),e[h].offset=e[h].element.offset(),e[h].proportions={width:e[h].element[0].offsetWidth,height:e[h].element[0].offsetHeight})}},drop:function(b,c){var e=!1;a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(e=e||this._drop.call(this,c)),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,c)))});return e},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var e=a.ui.intersect(b,this,this.options.tolerance);if(e=!e&&this.isover==1?"isout":e&&this.isover==0?"isover":null){var f;if(this.options.greedy){var g=this.element.parents(":data(droppable):eq(0)");g.length&&(f=a.data(g[0],"droppable"),f.greedyChild=e=="isover"?1:0)}f&&e=="isover"&&(f.isover=0,f.isout=1,f._out.call(f,c)),this[e]=1,this[e=="isout"?"isover":"isout"]=0,this[e=="isover"?"_over":"_out"].call(this,c),f&&e=="isout"&&(f.isout=0,f.isover=1,f._over.call(f,c))}}})}}}(jQuery),function(a){a.widget("ui.resizable",a.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var b=this,c=this.options;this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!c.aspectRatio,aspectRatio:c.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:c.helper||c.ghost||c.animate?c.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(/relative/.test(this.element.css("position"))&&a.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"}),this.element.wrap(a('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=c.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var d=this.handles.split(",");this.handles={};for(var f=0;f<d.length;f++){var g=a.trim(d[f]),h=a('<div class="ui-resizable-handle '+("ui-resizable-"+g)+'"></div>');/sw|se|ne|nw/.test(g)&&h.css({zIndex:++c.zIndex}),"se"==g&&h.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[g]=".ui-resizable-"+g,this.element.append(h)}}this._renderAxis=function(b){b=b||this.element;for(var c in this.handles){this.handles[c].constructor==String&&(this.handles[c]=a(this.handles[c],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var d=a(this.handles[c],this.element),f=0;f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),d=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(d,f),this._proportionallyResize()}a(this.handles[c])}},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!b.resizing){if(this.className)var a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=a&&a[1]?a[1]:"se"}}),c.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").hover(function(){c.disabled||(a(this).removeClass("ui-resizable-autohide"),b._handles.show())},function(){c.disabled||(b.resizing||(a(this).addClass("ui-resizable-autohide"),b._handles.hide()))})),this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){b(this.element);var c=this.element;c.after(this.originalElement.css({position:c.css("position"),width:c.outerWidth(),height:c.outerHeight(),top:c.css("top"),left:c.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement);return this},_mouseCapture:function(b){var c=!1;for(var d in this.handles)a(this.handles[d])[0]==b.target&&(c=!0);return!this.options.disabled&&c},_mouseStart:function(c){var d=this.options,f=this.element.position(),g=this.element;this.resizing=!0,this.documentScroll={top:a(document).scrollTop(),left:a(document).scrollLeft()},(g.is(".ui-draggable")||/absolute/.test(g.css("position")))&&g.css({position:"absolute",top:f.top,left:f.left}),a.browser.opera&&/relative/.test(g.css("position"))&&g.css({position:"relative",top:"auto",left:"auto"}),this._renderProxy(),f=b(this.helper.css("left"));var h=b(this.helper.css("top"));d.containment&&(f+=a(d.containment).scrollLeft()||0,h+=a(d.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:f,top:h},this.size=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()},this.originalSize=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()},this.originalPosition={left:f,top:h},this.sizeDiff={width:g.outerWidth()-g.width(),height:g.outerHeight()-g.height()},this.originalMousePosition={left:c.pageX,top:c.pageY},this.aspectRatio=typeof d.aspectRatio=="number"?d.aspectRatio:this.originalSize.width/this.originalSize.height||1,d=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor",d=="auto"?this.axis+"-resize":d),g.addClass("ui-resizable-resizing"),this._propagate("start",c);return!0},_mouseDrag:function(a){var b=this.helper,c=this.originalMousePosition,d=this._change[this.axis];if(!d)return!1;c=d.apply(this,[a,a.pageX-c.left||0,a.pageY-c.top||0]);if(this._aspectRatio||a.shiftKey)c=this._updateRatio(c,a);c=this._respectSize(c,a),this._propagate("resize",a),b.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(c),this._trigger("resize",a,this.ui());return!1},_mouseStop:function(b){this.resizing=!1;var c=this.options,d=this;if(this._helper){var f=this._proportionallyResizeElements,g=f.length&&/textarea/i.test(f[0].nodeName);f=g&&a.ui.hasScroll(f[0],"left")?0:d.sizeDiff.height,g=g?0:d.sizeDiff.width,g={width:d.helper.width()-g,height:d.helper.height()-f},f=parseInt(d.element.css("left"),10)+(d.position.left-d.originalPosition.left)||null;var h=parseInt(d.element.css("top"),10)+(d.position.top-d.originalPosition.top)||null;c.animate||this.element.css(a.extend(g,{top:h,left:f})),d.helper.height(d.size.height),d.helper.width(d.size.width),this._helper&&!c.animate&&this._proportionallyResize()}a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove();return!1},_updateCache:function(a){this.offset=this.helper.offset(),c(a.left)&&(this.position.left=a.left),c(a.top)&&(this.position.top=a.top),c(a.height)&&(this.size.height=a.height),c(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,c=this.size,d=this.axis;a.height?a.width=c.height*this.aspectRatio:a.width&&(a.height=c.width/this.aspectRatio),d=="sw"&&(a.left=b.left+(c.width-a.width),a.top=null),d=="nw"&&(a.top=b.top+(c.height-a.height),a.left=b.left+(c.width-a.width));return a},_respectSize:function(a){var b=this.options,d=this.axis,e=c(a.width)&&b.maxWidth&&b.maxWidth<a.width,f=c(a.height)&&b.maxHeight&&b.maxHeight<a.height,g=c(a.width)&&b.minWidth&&b.minWidth>a.width,h=c(a.height)&&b.minHeight&&b.minHeight>a.height;g&&(a.width=b.minWidth),h&&(a.height=b.minHeight),e&&(a.width=b.maxWidth),f&&(a.height=b.maxHeight);var i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,k=/sw|nw|w/.test(d);d=/nw|ne|n/.test(d),g&&k&&(a.left=i-b.minWidth),e&&k&&(a.left=i-b.maxWidth),h&&d&&(a.top=j-b.minHeight),f&&d&&(a.top=j-b.maxHeight),(b=!a.width&&!a.height)&&!a.left&&a.top?a.top=null:b&&!a.top&&a.left&&(a.left=null);return a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=this.helper||this.element,c=0;c<this._proportionallyResizeElements.length;c++){var d=this._proportionallyResizeElements[c];if(!this.borderDif){var f=[d.css("borderTopWidth"),d.css("borderRightWidth"),d.css("borderBottomWidth"),d.css("borderLeftWidth")],g=[d.css("paddingTop"),d.css("paddingRight"),d.css("paddingBottom"),d.css("paddingLeft")];this.borderDif=a.map(f,function(a,b){a=parseInt(a,10)||0,b=parseInt(g[b],10)||0;return a+b})}a.browser.msie&&(a(b).is(":hidden")||a(b).parents(":hidden").length)||d.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||a('<div style="overflow:hidden;"></div>');var c=a.browser.msie&&a.browser.version<7,d=c?1:0;c=c?2:-1,this.helper.addClass(this._helper).css({width:this.element.outerWidth()+c,height:this.element.outerHeight()+c,position:"absolute",left:this.elementOffset.left-d+"px",top:this.elementOffset.top-d+"px",zIndex:++b.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){return{left:this.originalPosition.left+b,width:this.originalSize.width-b}},n:function(a,b,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),b!="resize"&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.extend(a.ui.resizable,{version:"1.8.13"}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("resizable").options,c=function(b){a(b).each(function(){var b=a(this);b.data("resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10),position:b.css("position")})})};typeof b.alsoResize!="object"||b.alsoResize.parentNode?c(b.alsoResize):b.alsoResize.length?(b.alsoResize=b.alsoResize[0],c(b.alsoResize)):a.each(b.alsoResize,function(a){c(a)})},resize:function(b,c){var d=a(this).data("resizable");b=d.options;var f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,f){a(b).each(function(){var b=a(this),g=a(this).data("resizable-alsoresize"),i={},k=f&&f.length?f:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(k,function(a,b){(a=(g[b]||0)+(h[b]||0))&&a>=0&&(i[b]=a||null)}),a.browser.opera&&/relative/.test(b.css("position"))&&(d._revertToRelativePosition=!0,b.css({position:"absolute",top:"auto",left:"auto"})),b.css(i)})};typeof b.alsoResize=="object"&&!b.alsoResize.nodeType?a.each(b.alsoResize,function(a,b){i(a,b)}):i(b.alsoResize)},stop:function(){var b=a(this).data("resizable"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.css({position:b.data("resizable-alsoresize").position})})};b._revertToRelativePosition&&(b._revertToRelativePosition=!1,typeof c.alsoResize=="object"&&!c.alsoResize.nodeType?a.each(c.alsoResize,function(a){d(a)}):d(c.alsoResize)),a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).data("resizable"),d=c.options,f=c._proportionallyResizeElements,g=f.length&&/textarea/i.test(f[0].nodeName),h=g&&a.ui.hasScroll(f[0],"left")?0:c.sizeDiff.height;g={width:c.size.width-(g?0:c.sizeDiff.width),height:c.size.height-h},h=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null;var i=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(g,i&&h?{top:i,left:h}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};f&&f.length&&a(f[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var c=a(this).data("resizable"),d=c.element,f=c.options.containment;if(d=f instanceof a?f.get(0):/parent/.test(f)?d.parent().get(0):f){c.containerElement=a(d);if(/document/.test(f)||f==document)c.containerOffset={left:0,top:0},c.containerPosition={left:0,top:0},c.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight};else{var g=a(d),h=[];a(["Top","Right","Left","Bottom"]).each(function(a,c){h[a]=b(g.css("padding"+c))}),c.containerOffset=g.offset(),c.containerPosition=g.position(),c.containerSize={height:g.innerHeight()-h[3],width:g.innerWidth()-h[1]},f=c.containerOffset;var i=c.containerSize.height,j=c.containerSize.width;j=a.ui.hasScroll(d,"left")?d.scrollWidth:j,i=a.ui.hasScroll(d)?d.scrollHeight:i,c.parentData={element:d,left:f.left,top:f.top,width:j,height:i}}}},resize:function(b){var c=a(this).data("resizable"),d=c.options,f=c.containerOffset,g=c.position;b=c._aspectRatio||b.shiftKey;var h={top:0,left:0},i=c.containerElement;i[0]!=document&&/static/.test(i.css("position"))&&(h=f),g.left<(c._helper?f.left:0)&&(c.size.width+=c._helper?c.position.left-f.left:c.position.left-h.left,b&&(c.size.height=c.size.width/d.aspectRatio),c.position.left=d.helper?f.left:0),g.top<(c._helper?f.top:0)&&(c.size.height+=c._helper?c.position.top-f.top:c.position.top,b&&(c.size.width=c.size.height*d.aspectRatio),c.position.top=c._helper?f.top:0),c.offset.left=c.parentData.left+c.position.left,c.offset.top=c.parentData.top+c.position.top,d=Math.abs((c._helper?c.offset.left-h.left:c.offset.left-h.left)+c.sizeDiff.width),f=Math.abs((c._helper?c.offset.top-h.top:c.offset.top-f.top)+c.sizeDiff.height),g=c.containerElement.get(0)==c.element.parent().get(0),h=/relative|absolute/.test(c.containerElement.css("position")),g&&h&&(d-=c.parentData.left),d+c.size.width>=c.parentData.width&&(c.size.width=c.parentData.width-d,b&&(c.size.height=c.size.width/c.aspectRatio)),f+c.size.height>=c.parentData.height&&(c.size.height=c.parentData.height-f,b&&(c.size.width=c.size.height*c.aspectRatio))},stop:function(){var b=a(this).data("resizable"),c=b.options,d=b.containerOffset,f=b.containerPosition,g=b.containerElement,h=a(b.helper),i=h.offset(),j=h.outerWidth()-b.sizeDiff.width;h=h.outerHeight()-b.sizeDiff.height,b._helper&&!c.animate&&/relative/.test(g.css("position"))&&a(this).css({left:i.left-f.left-d.left,width:j,height:h}),b._helper&&!c.animate&&/static/.test(g.css("position"))&&a(this).css({left:i.left-f.left-d.left,width:j,height:h})}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("resizable"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof c.ghost=="string"?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b=a(this).data("resizable"),c=b.options,d=b.size,f=b.originalSize,g=b.originalPosition,h=b.axis;c.grid=typeof c.grid=="number"?[c.grid,c.grid]:c.grid;var i=Math.round((d.width-f.width)/(c.grid[0]||1))*(c.grid[0]||1);c=Math.round((d.height-f.height)/(c.grid[1]||1))*(c.grid[1]||1),/^(se|s|e)$/.test(h)?(b.size.width=f.width+i,b.size.height=f.height+c):/^(ne)$/.test(h)?(b.size.width=f.width+i,b.size.height=f.height+c,b.position.top=g.top-c):(/^(sw)$/.test(h)?(b.size.width=f.width+i,b.size.height=f.height+c):(b.size.width=f.width+i,b.size.height=f.height+c,b.position.top=g.top-c),b.position.left=g.left-i)}});var b=function(a){return parseInt(a,10)||0},c=function(a){return!isNaN(parseInt(a,10))}}(jQuery),function(a){a.widget("ui.selectable",a.ui.mouse,{options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var b=this;this.element.addClass("ui-selectable"),this.dragged=!1;var c;this.refresh=function(){c=a(b.options.filter,b.element[0]),c.each(function(){var b=a(this),c=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=c.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable"),this._mouseDestroy();return this},_mouseStart:function(b){var c=this;this.opos=[b.pageX,b.pageY];if(!this.options.disabled){var d=this.options;this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.clientX,top:b.clientY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,b.metaKey||(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().andSelf().each(function(){var d=a.data(this,"selectable-item");if(d){var g=!b.metaKey||!d.$element.hasClass("ui-selected");d.$element.removeClass(g?"ui-unselecting":"ui-selected").addClass(g?"ui-selecting":"ui-unselecting"),d.unselecting=!g,d.selecting=g,(d.selected=g)?c._trigger("selecting",b,{selecting:d.element}):c._trigger("unselecting",b,{unselecting:d.element});return!1}})}},_mouseDrag:function(b){var c=this;this.dragged=!0;if(!this.options.disabled){var d=this.options,f=this.opos[0],g=this.opos[1],h=b.pageX,i=b.pageY;if(f>h){var j=h;h=f,f=j}g>i&&(j=i,i=g,g=j),this.helper.css({left:f,top:g,width:h-f,height:i-g}),this.selectees.each(function(){var j=a.data(this,"selectable-item");if(j&&j.element!=c.element[0]){var k=!1;d.tolerance=="touch"?k=!(j.left>h||j.right<f||j.top>i||j.bottom<g):d.tolerance=="fit"&&(k=j.left>f&&j.right<h&&j.top>g&&j.bottom<i),k?(j.selected&&(j.$element.removeClass("ui-selected"),j.selected=!1),j.unselecting&&(j.$element.removeClass("ui-unselecting"),j.unselecting=!1),j.selecting||(j.$element.addClass("ui-selecting"),j.selecting=!0,c._trigger("selecting",b,{selecting:j.element}))):(j.selecting&&(b.metaKey&&j.startselected?(j.$element.removeClass("ui-selecting"),j.selecting=!1,j.$element.addClass("ui-selected"),j.selected=!0):(j.$element.removeClass("ui-selecting"),j.selecting=!1,j.startselected&&(j.$element.addClass("ui-unselecting"),j.unselecting=!0),c._trigger("unselecting",b,{unselecting:j.element}))),j.selected&&(!b.metaKey&&!j.startselected&&(j.$element.removeClass("ui-selected"),j.selected=!1,j.$element.addClass("ui-unselecting"),j.unselecting=!0,c._trigger("unselecting",b,{unselecting:j.element}))))}});return!1}},_mouseStop:function(b){var c=this;this.dragged=!1,a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove();return!1}}),a.extend(a.ui.selectable,{version:"1.8.13"})}(jQuery),function(a){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?a.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData("sortable-item");return this},_setOption:function(b,c){b==="disabled"?(this.options[b]=c,this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(b);var e=null,f=this;a(b.target).parents().each(function(){if(a.data(this,"sortable-item")==f){e=a(this);return!1}}),a.data(b.target,"sortable-item")==f&&(e=a(b.target));if(!e)return!1;if(this.options.handle&&!c){var g=!1;a(this.options.handle,e).find("*").andSelf().each(function(){this==b.target&&(g=!0)});if(!g)return!1}this.currentItem=e,this._removeCurrentsFromItems();return!0},_mouseStart:function(b,c,e){c=this.options;var f=this;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),c.containment&&this._setContainment(),c.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",c.cursor)),c.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",c.opacity)),c.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",c.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!e)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,f._uiHash(this));a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b);return!0},_mouseDrag:function(b){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var c=this.options,e=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity?this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop+c.scrollSpeed:b.pageY-this.overflowOffset.top<c.scrollSensitivity&&(this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop-c.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity?this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft+c.scrollSpeed:b.pageX-this.overflowOffset.left<c.scrollSensitivity&&(this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft-c.scrollSpeed)):(b.pageY-a(document).scrollTop()<c.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed))),e!==!1&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(c=this.items.length-1;c>=0;c--){e=this.items[c];var f=e.item[0],g=this._intersectsWithPointer(e);if(g)if(f!=this.currentItem[0]&&this.placeholder[g==1?"next":"prev"]()[0]!=f&&!a.ui.contains(this.placeholder[0],f)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],f):!0)){this.direction=g==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(e))this._rearrange(b,e);else break;this._trigger("change",b,this._uiHash());break}}this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(b,c){if(b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var e=this;c=e.placeholder.offset(),e.reverting=!0,a(this.helper).animate({left:c.left-this.offset.parent.left-e.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:c.top-this.offset.parent.top-e.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){e._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){var b=this;if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var c=this.containers.length-1;c>=0;c--)this.containers[c]._trigger("deactivate",null,b._uiHash(this)),this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",null,b._uiHash(this)),this.containers[c].containerCache.over=0)}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),e=[];b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&e.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!e.length&&b.key&&e.push(b.key+"=");return e.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),e=[];b=b||{},c.each(function(){e.push(a(b.item||this).attr(b.attribute||"id")||"")});return e},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left;j=d+j>h&&d+j<i&&b+k>f&&b+k<g;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?j:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height);b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),c=c&&b,b=this._getDragVerticalDirection();var e=this._getDragHorizontalDirection();if(!c)return!1;return this.floating?e&&e=="right"||b=="down"?2:1:b&&(b=="down"?2:1)},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height);b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width);var e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?f=="right"&&b||f=="left"&&!b:e&&(e=="down"&&c||e=="up"&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},refresh:function(a){this._refreshItems(a),this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=[],e=[],f=this._connectWith();if(f&&b)for(b=f.length-1;b>=0;b--)for(var g=a(f[b]),h=g.length-1;h>=0;h--){var i=a.data(g[h],"sortable");i&&i!=this&&!i.options.disabled&&e.push([a.isFunction(i.options.items)?i.options.items.call(i.element):a(i.options.items,i.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),i])}e.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(b=e.length-1;b>=0;b--)e[b][0].each(function(){c.push(this)});return a(c)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data(sortable-item)"),b=0;b<this.items.length;b++)for(var c=0;c<a.length;c++)a[c]==this.items[b].item[0]&&this.items.splice(b,1)},_refreshItems:function(b){this.items=[],this.containers=[this];var c=this.items,e=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],f=this._connectWith();if(f)for(var g=f.length-1;g>=0;g--)for(var h=a(f[g]),i=h.length-1;i>=0;i--){var j=a.data(h[i],"sortable");j&&j!=this&&!j.options.disabled&&(e.push([a.isFunction(j.options.items)?j.options.items.call(j.element[0],b,{item:this.currentItem}):a(j.options.items,j.element),j]),this.containers.push(j))}for(g=e.length-1;g>=0;g--){b=e[g][1],f=e[g][0],i=0;for(h=f.length;i<h;i++)j=a(f[i]),j.data("sortable-item",b),c.push({item:j,instance:b,width:0,height:0,left:0,top:0})}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var c=this.items.length-1;c>=0;c--){var e=this.items[c];if(e.instance==this.currentContainer||!this.currentContainer||e.item[0]==this.currentItem[0]){var f=this.options.toleranceElement?a(this.options.toleranceElement,e.item):e.item;b||(e.width=f.outerWidth(),e.height=f.outerHeight()),f=f.offset(),e.left=f.left,e.top=f.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){var c=b||this,e=c.options;if(!e.placeholder||e.placeholder.constructor==String){var f=e.placeholder;e.placeholder={element:function(){var b=a(document.createElement(c.currentItem[0].nodeName)).addClass(f||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];f||(b.style.visibility="hidden");return b},update:function(a,b){if(!f||e.forcePlaceholderSize)b.height()||b.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),b.width()||b.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}c.placeholder=a(e.placeholder.element.call(c.element,c.currentItem)),c.currentItem.after(c.placeholder),e.placeholder.update(c,c.placeholder)},_contactContainers:function(b){for(var c=null,e=null,f=this.containers.length-1;f>=0;f--)if(!a.ui.contains(this.currentItem[0],this.containers[f].element[0]))if(this._intersectsWith(this.containers[f].containerCache)){if(!c||!a.ui.contains(this.containers[f].element[0],c.element[0]))c=this.containers[f],e=f}else this.containers[f].containerCache.over&&(this.containers[f]._trigger("out",b,this._uiHash(this)),this.containers[f].containerCache.over=0);if(c)if(this.containers.length===1)this.containers[e]._trigger("over",b,this._uiHash(this)),this.containers[e].containerCache.over=1;else if(this.currentContainer!=this.containers[e]){c=1e4,f=null;for(var g=this.positionAbs[this.containers[e].floating?"left":"top"],h=this.items.length-1;h>=0;h--)if(a.ui.contains(this.containers[e].element[0],this.items[h].item[0])){var i=this.items[h][this.containers[e].floating?"left":"top"];Math.abs(i-g)<c&&(c=Math.abs(i-g),f=this.items[h])}if(f||this.options.dropOnEmpty)this.currentContainer=this.containers[e],f?this._rearrange(b,f,null,!0):this._rearrange(b,null,this.containers[e].element,!0),this._trigger("change",b,this._uiHash()),this.containers[e]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[e]._trigger("over",b,this._uiHash(this)),this.containers[e].containerCache.over=1}},_createHelper:function(b){var c=this.options;b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):c.helper=="clone"?this.currentItem.clone():this.currentItem,b.parents("body").length||a(c.appendTo!="parent"?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(b[0]),b[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(b[0].style.width==""||c.forceHelperSize)&&b.width(this.currentItem.width()),(b[0].style.height==""||c.forceHelperSize)&&b.height(this.currentItem.height());return b},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0];b=a(b.containment).offset();var e=a(c).css("overflow")!="hidden";this.containment=[b.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,b.left+(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){c||(c=this.position),b=b=="absolute"?1:-1;var e=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*b+this.offset.parent.top*b-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop())*b),left:c.left+this.offset.relative.left*b+this.offset.parent.left*b-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*b)}},_generatePosition:function(b){var c=this.options,e=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var g=b.pageX,h=b.pageY;this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(g=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(h=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(g=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(h=this.containment[3]+this.offset.click.top)),c.grid&&(h=this.originalPageY+Math.round((h-this.originalPageY)/c.grid[1])*c.grid[1],h=this.containment?h-this.offset.click.top>=this.containment[1]&&h-this.offset.click.top<=this.containment[3]?h:h-this.offset.click.top>=this.containment[1]?h-c.grid[1]:h+c.grid[1]:h,g=this.originalPageX+Math.round((g-this.originalPageX)/c.grid[0])*c.grid[0],g=this.containment?g-this.offset.click.left>=this.containment[0]&&g-this.offset.click.left<=this.containment[2]?g:g-this.offset.click.left>=this.containment[0]?g-c.grid[0]:g+c.grid[0]:g));return{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop()),left:g-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this,f=this.counter;window.setTimeout(function(){f==e.counter&&e.refreshPositions(!d)},0)},_clear:function(b,c){this.reverting=!1;var e=[];!this._noFinalSort&&this.currentItem[0].parentNode&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var f in this._storedCSS)if(this._storedCSS[f]=="auto"||this._storedCSS[f]=="static")this._storedCSS[f]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&e.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],this.currentItem[0])){c||e.push(function(a){this._trigger("remove",a,this._uiHash())});for(f=this.containers.length-1;f>=0;f--)a.ui.contains(this.containers[f].element[0],this.currentItem[0])&&!c&&(e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[f])),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.containers[f])))}for(f=this.containers.length-1;f>=0;f--)c||e.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over&&(e.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[f])),this.containers[f].containerCache.over=0);this._storedCursor&&a("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",b,this._uiHash());for(f=0;f<e.length;f++)e[f].call(this,b);this._trigger("stop",b,this._uiHash())}return!1}c||this._trigger("beforeStop",b,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!c){for(f=0;f<e.length;f++)e[f].call(this,b);this._trigger("stop",b,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}}),a.extend(a.ui.sortable,{version:"1.8.13"})}(jQuery),function(a){a.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:!0,clearStyle:!1,collapsible:!1,event:"click",fillSpace:!1,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var b=this,d=b.options;b.running=0,b.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix"),b.headers=b.element.find(d.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){d.disabled||a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){d.disabled||a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){d.disabled||a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){d.disabled||a(this).removeClass("ui-state-focus")}),b.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(d.navigation){var e=b.element.find("a").filter(d.navigationFilter).eq(0);if(e.length){var f=e.closest(".ui-accordion-header");b.active=f.length?f:e.closest(".ui-accordion-content").prev()}}b.active=b._findActive(b.active||d.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top"),b.active.next().addClass("ui-accordion-content-active"),b._createIcons(),b.resize(),b.element.attr("role","tablist"),b.headers.attr("role","tab").bind("keydown.accordion",function(a){return b._keydown(a)}).next().attr("role","tabpanel"),b.headers.not(b.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide(),b.active.length?b.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):b.headers.eq(0).attr("tabIndex",0),a.browser.safari||b.headers.find("a").attr("tabIndex",-1),d.event&&b.headers.bind(d.event.split(" ").join(".accordion ")+".accordion",function(a){b._clickHandler.call(b,a,this),a.preventDefault()})},_createIcons:function(){var b=this.options;b.icons&&(a("<span></span>").addClass("ui-icon "+b.icons.header).prependTo(this.headers),this.active.children(".ui-icon").toggleClass(b.icons.header).toggleClass(b.icons.headerSelected),this.element.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.children(".ui-icon").remove(),this.element.removeClass("ui-accordion-icons")},destroy:function(){var b=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex"),this.headers.find("a").removeAttr("tabIndex"),this._destroyIcons();var d=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");(b.autoHeight||b.fillHeight)&&d.css("height","");return a.Widget.prototype.destroy.call(this)},_setOption:function(b,d){a.Widget.prototype._setOption.apply(this,arguments),b=="active"&&this.activate(d),b=="icons"&&(this._destroyIcons(),d&&this._createIcons()),b=="disabled"&&this.headers.add(this.headers.next())[d?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")},_keydown:function(b){if(!(this.options.disabled||b.altKey||b.ctrlKey)){var d=a.ui.keyCode,e=this.headers.length,f=this.headers.index(b.target),g=!1;switch(b.keyCode){case d.RIGHT:case d.DOWN:g=this.headers[(f+1)%e];break;case d.LEFT:case d.UP:g=this.headers[(f-1+e)%e];break;case d.SPACE:case d.ENTER:this._clickHandler({target:b.target},b.target),b.preventDefault()}if(g){a(b.target).attr("tabIndex",-1),a(g).attr("tabIndex",0),g.focus();return!1}return!0}},resize:function(){var b=this.options,d;if(b.fillSpace){if(a.browser.msie){var e=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}d=this.element.parent().height(),a.browser.msie&&this.element.parent().css("overflow",e),this.headers.each(function(){d-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,d-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else b.autoHeight&&(d=0,this.headers.next().each(function(){d=Math.max(d,a(this).height("").height())}).height(d));return this},activate:function(a){this.options.active=a,a=this._findActive(a)[0],this._clickHandler({target:a},a);return this},_findActive:function(b){return b?typeof b==="number"?this.headers.filter(":eq("+b+")"):this.headers.not(this.headers.not(b)):b===!1?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(b,d){var e=this.options;if(!e.disabled)if(b.target){b=a(b.currentTarget||d),d=b[0]===this.active[0],e.active=e.collapsible&&d?!1:this.headers.index(b);if(!(this.running||!e.collapsible&&d)){var f=this.active;j=b.next(),h=this.active.next(),i={options:e,newHeader:d&&e.collapsible?a([]):b,oldHeader:this.active,newContent:d&&e.collapsible?a([]):j,oldContent:h};var g=this.headers.index(this.active[0])>this.headers.index(b[0]);this.active=d?a([]):b,this._toggle(j,h,i,d,g),f.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(e.icons.headerSelected).addClass(e.icons.header),d||(b.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(e.icons.header).addClass(e.icons.headerSelected),b.next().addClass("ui-accordion-content-active"))}}else if(e.collapsible){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(e.icons.headerSelected).addClass(e.icons.header),this.active.next().addClass("ui-accordion-content-active");var h=this.active.next(),i={options:e,newHeader:a([]),oldHeader:e.active,newContent:a([]),oldContent:h},j=this.active=a([]);this._toggle(j,h,i)}},_toggle:function(b,d,e,f,g){var h=this,i=h.options;h.toShow=b,h.toHide=d,h.data=e;var j=function(){if(h)return h._completed.apply(h,arguments)};h._trigger("changestart",null,h.data),h.running=d.size()===0?b.size():d.size();if(i.animated){e={},e=i.collapsible&&f?{toShow:a([]),toHide:d,complete:j,down:g,autoHeight:i.autoHeight||i.fillSpace}:{toShow:b,toHide:d,complete:j,down:g,autoHeight:i.autoHeight||i.fillSpace},i.proxied||(i.proxied=i.animated),i.proxiedDuration||(i.proxiedDuration=i.duration),i.animated=a.isFunction(i.proxied)?i.proxied(e):i.proxied,i.duration=a.isFunction(i.proxiedDuration)?i.proxiedDuration(e):i.proxiedDuration,f=a.ui.accordion.animations;var k=i.duration,l=i.animated;l&&!f[l]&&!a.easing[l]&&(l="slide"),f[l]||(f[l]=function(a){this.slide(a,{easing:l,duration:k||700})}),f[l](e)}else i.collapsible&&f?b.toggle():(d.hide(),b.show()),j(!0);d.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur(),b.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(a){this.running=a?0:--this.running,this.running||(this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""}),this.toHide.removeClass("ui-accordion-content-active"),this.toHide.length&&(this.toHide.parent()[0].className=this.toHide.parent()[0].className),this._trigger("change",null,this.data))}}),a.extend(a.ui.accordion,{version:"1.8.13",animations:{slide:function(b,d){b=a.extend({easing:"swing",duration:300},b,d);if(b.toHide.size())if(b.toShow.size()){var e=b.toShow.css("overflow"),f=0,g={},h={},i;d=b.toShow,i=d[0].style.width,d.width(parseInt(d.parent().width(),10)-parseInt(d.css("paddingLeft"),10)-parseInt(d.css("paddingRight"),10)-(parseInt(d.css("borderLeftWidth"),10)||0)-(parseInt(d.css("borderRightWidth"),10)||0)),a.each(["height","paddingTop","paddingBottom"],function(d,e){h[e]="hide",d=(""+a.css(b.toShow[0],e)).match(/^([\d+-.]+)(.*)$/),g[e]={value:d[1],unit:d[2]||"px"}}),b.toShow.css({height:0,overflow:"hidden"}).show(),b.toHide.filter(":hidden").each(b.complete).end().filter(":visible").animate(h,{step:function(a,c){c.prop=="height"&&(f=c.end-c.start===0?0:(c.now-c.start)/(c.end-c.start)),b.toShow[0].style[c.prop]=f*g[c.prop].value+g[c.prop].unit},duration:b.duration,easing:b.easing,complete:function(){b.autoHeight||b.toShow.css("height",""),b.toShow.css({width:i,overflow:e}),b.complete()}})}else b.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},b);else b.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},b)},bounceslide:function(a){this.slide(a,{easing:a.down?"easeOutBounce":"swing",duration:a.down?1e3:200})}}})}(jQuery),function(a){var b=0;a.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var b=this,c=this.element[0].ownerDocument,e;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(!b.options.disabled&&!b.element.attr("readonly")){e=!1;var f=a.ui.keyCode;switch(c.keyCode){case f.PAGE_UP:b._move("previousPage",c);break;case f.PAGE_DOWN:b._move("nextPage",c);break;case f.UP:b._move("previous",c),c.preventDefault();break;case f.DOWN:b._move("next",c),c.preventDefault();break;case f.ENTER:case f.NUMPAD_ENTER:b.menu.active&&(e=!0,c.preventDefault());case f.TAB:if(!b.menu.active)return;b.menu.select(c);break;case f.ESCAPE:b.element.val(b.term),b.close(c);break;default:clearTimeout(b.searching),b.searching=setTimeout(function(){b.term!=b.element.val()&&(b.selectedItem=null,b.search(null,c))},b.options.delay)}}}).bind("keypress.autocomplete",function(a){e&&(e=!1,a.preventDefault())}).bind("focus.autocomplete",function(){b.options.disabled||(b.selectedItem=null,b.previous=b.element.val())}).bind("blur.autocomplete",function(a){b.options.disabled||(clearTimeout(b.searching),b.closing=setTimeout(function(){b.close(a),b._change(a)},150))}),this._initSource(),this.response=function(){return b._response.apply(b,arguments)},this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",c)[0]).mousedown(function(c){var e=b.menu.element[0];a(c.target).closest(".ui-menu-item").length||setTimeout(function(){a(document).one("mousedown",function(c){c.target!==b.element[0]&&c.target!==e&&!a.ui.contains(e,c.target)&&b.close()})},1),setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(a,c){c=c.item.data("item.autocomplete"),!1!==b._trigger("focus",a,{item:c})&&/^key/.test(a.originalEvent.type)&&b.element.val(c.value)},selected:function(a,d){var e=d.item.data("item.autocomplete"),f=b.previous;b.element[0]!==c.activeElement&&(b.element.focus(),b.previous=f,setTimeout(function(){b.previous=f,b.selectedItem=e},1)),!1!==b._trigger("select",a,{item:e})&&b.element.val(e.value),b.term=b.element.val(),b.close(a),b.selectedItem=e},blur:function(){b.menu.element.is(":visible")&&b.element.val()!==b.term&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu"),a.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"),this.menu.element.remove(),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b==="source"&&this._initSource(),b==="appendTo"&&this.menu.element.appendTo(a(c||"body",this.element[0].ownerDocument)[0]),b==="disabled"&&c&&this.xhr&&this.xhr.abort()},_initSource:function(){var c=this,f,g;a.isArray(this.options.source)?(f=this.options.source,this.source=function(b,c){c(a.ui.autocomplete.filter(f,b.term))}):typeof this.options.source==="string"?(g=this.options.source,this.source=function(f,h){c.xhr&&c.xhr.abort(),c.xhr=a.ajax({url:g,data:f,dataType:"json",autocompleteRequest:++b,success:function(a){this.autocompleteRequest===b&&h(a)},error:function(){this.autocompleteRequest===b&&h([])}})}):this.source=this.options.source},search:function(a,b){a=a!=null?a:this.element.val(),this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);if(this._trigger("search",b)!==!1)return this._search(a)},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.source({term:a},this.response)},_response:function(a){!this.options.disabled&&a&&a.length?(a=this._normalize(a),this._suggest(a),this._trigger("open")):this.close(),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",a))},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){if(b.length&&b[0].label&&b[0].value)return b;return a.map(b,function(b){if(typeof b==="string")return{label:b,value:b};return a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,b),this.menu.deactivate(),this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(new a.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(b,c){var e=this;a.each(c,function(a,c){e._renderItem(b,c)})},_renderItem:function(b,c){return a("<li></li>").data("item.autocomplete",c).append(a("<a></a>").text(c.label)).appendTo(b)},_move:function(a,b){this.menu.element.is(":visible")?this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)?(this.element.val(this.term),this.menu.deactivate()):this.menu[a](b):this.search(null,b)},widget:function(){return this.menu.element}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(b,c){var e=new RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return e.test(a.label||a.value||a)})}})}(jQuery),function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){a(c.target).closest(".ui-menu-item a").length&&(c.preventDefault(),b.select(c))}),this.refresh()},refresh:function(){var b=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(c){b.activate(c,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(a,b){this.deactivate();if(this.hasScroll()){var c=b.offset().top-this.element.offset().top,d=this.element.scrollTop(),e=this.element.height();c<0?this.element.scrollTop(d+c):c>=e&&this.element.scrollTop(d+c-e+b.height())}this.active=b.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end(),this._trigger("focus",a,{item:b})},deactivate:function(){this.active&&(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null)},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(a,b,c){this.active?(a=this.active[a+"All"](".ui-menu-item").eq(0),a.length?this.activate(c,a):this.activate(c,this.element.children(b))):this.activate(c,this.element.children(b))},nextPage:function(b){if(this.hasScroll())if(!this.active||this.last())this.activate(b,this.element.children(".ui-menu-item:first"));else{var c=this.active.offset().top,e=this.element.height(),f=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c-e+a(this).height();return b<10&&b>-10});f.length||(f=this.element.children(".ui-menu-item:last")),this.activate(b,f)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(b){if(this.hasScroll())if(!this.active||this.first())this.activate(b,this.element.children(".ui-menu-item:last"));else{var c=this.active.offset().top,e=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c+e-a(this).height();return b<10&&b>-10}),result.length||(result=this.element.children(".ui-menu-item:first")),this.activate(b,result)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[a.fn.prop?"prop":"attr"]("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})}(jQuery),function(a){var b,c=function(b){a(":ui-button",b.target.form).each(function(){var b=a(this).data("button");setTimeout(function(){b.refresh()},1)})},d=function(b){var c=b.name,d=b.form,e=a([]);c&&(e=d?a(d).find("[name='"+c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form}));return e};a.widget("ui.button",{options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",c),typeof this.options.disabled!=="boolean"&&(this.options.disabled=this.element.attr("disabled")),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,f=this.options,j=this.type==="checkbox"||this.type==="radio",k="ui-state-hover"+(j?"":" ui-state-active");f.label===null&&(f.label=this.buttonElement.html()),this.element.is(":disabled")&&(f.disabled=!0),this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",function(){f.disabled||(a(this).addClass("ui-state-hover"),this===b&&a(this).addClass("ui-state-active"))}).bind("mouseleave.button",function(){f.disabled||a(this).removeClass(k)}).bind("focus.button",function(){a(this).addClass("ui-state-focus")}).bind("blur.button",function(){a(this).removeClass("ui-state-focus")}).bind("click.button",function(a){f.disabled&&a.stopImmediatePropagation()}),j&&this.element.bind("change.button",function(){e.refresh()}),this.type==="checkbox"?this.buttonElement.bind("click.button",function(){if(f.disabled)return!1;a(this).toggleClass("ui-state-active"),e.buttonElement.attr("aria-pressed",e.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click.button",function(){if(f.disabled)return!1;a(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed",!0);var b=e.element[0];d(b).not(b).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",!1)}):(this.buttonElement.bind("mousedown.button",function(){if(f.disabled)return!1;a(this).addClass("ui-state-active"),b=this,a(document).one("mouseup",function(){b=null})}).bind("mouseup.button",function(){if(f.disabled)return!1;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(b){if(f.disabled)return!1;(b.keyCode==a.ui.keyCode.SPACE||b.keyCode==a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",f.disabled)},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if(this.type==="checkbox"||this.type==="radio"){var a=this.element.parents().filter(":last"),b="label[for="+this.element.attr("id")+"]";this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),(a=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.attr("aria-pressed",a)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title"),a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments),b==="disabled"&&(c?this.element.attr("disabled",!0):this.element.removeAttr("disabled")),this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b),this.type==="radio"?d(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed",!0):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",!1)}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed",!0):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",!1))},_resetButton:function(){if(this.type==="input")this.options.label&&this.element.val(this.options.label);else{var b=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),c=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",c))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}}),a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(b,c){b==="disabled"&&this.buttons.button("option",b,c),a.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass("ui-corner-left").end().filter(":last").addClass("ui-corner-right").end().end()},destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy"),a.Widget.prototype.destroy.call(this)}})}(jQuery),function(a,b){var c={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},d={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},e=a.attrFn||{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0,click:!0};a.widget("ui.dialog",{options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",collision:"fit",using:function(b){var c=a(this).css(b).offset().top;c<0&&a(this).css("top",b.top-c)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),typeof this.originalTitle!=="string"&&(this.originalTitle=""),this.options.title=this.options.title||this.originalTitle;var b=this,c=b.options,d=c.title||"&#160;",e=a.ui.dialog.getTitleId(b.element),f=(b.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c.dialogClass).css({zIndex:c.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(d){c.closeOnEscape&&d.keyCode&&d.keyCode===a.ui.keyCode.ESCAPE&&(b.close(d),d.preventDefault())}).attr({role:"dialog","aria-labelledby":e}).mousedown(function(a){b.moveToTop(!1,a)});b.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(f);var g=(b.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(f),h=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){h.addClass("ui-state-hover")},function(){h.removeClass("ui-state-hover")}).focus(function(){h.addClass("ui-state-focus")}).blur(function(){h.removeClass("ui-state-focus")}).click(function(a){b.close(a);return!1}).appendTo(g);(b.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(c.closeText).appendTo(h),a("<span></span>").addClass("ui-dialog-title").attr("id",e).html(d).prependTo(g),a.isFunction(c.beforeclose)&&!a.isFunction(c.beforeClose)&&(c.beforeClose=c.beforeclose),g.find("*").add(g).disableSelection(),c.draggable&&a.fn.draggable&&b._makeDraggable(),c.resizable&&a.fn.resizable&&b._makeResizable(),b._createButtons(c.buttons),b._isOpen=!1,a.fn.bgiframe&&f.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var a=this;a.overlay&&a.overlay.destroy(),a.uiDialog.hide(),a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),a.uiDialog.remove(),a.originalTitle&&a.element.attr("title",a.originalTitle);return a},widget:function(){return this.uiDialog},close:function(b){var c=this,d,e;if(!1!==c._trigger("beforeClose",b)){c.overlay&&c.overlay.destroy(),c.uiDialog.unbind("keypress.ui-dialog"),c._isOpen=!1,c.options.hide?c.uiDialog.hide(c.options.hide,function(){c._trigger("close",b)}):(c.uiDialog.hide(),c._trigger("close",b)),a.ui.dialog.overlay.resize(),c.options.modal&&(d=0,a(".ui-dialog").each(function(){this!==c.uiDialog[0]&&(e=a(this).css("z-index"),isNaN(e)||(d=Math.max(d,e)))}),a.ui.dialog.maxZ=d);return c}},isOpen:function(){return this._isOpen},moveToTop:function(b,c){var d=this,e=d.options;if(e.modal&&!b||!e.stack&&!e.modal)return d._trigger("focus",c);e.zIndex>a.ui.dialog.maxZ&&(a.ui.dialog.maxZ=e.zIndex),d.overlay&&(a.ui.dialog.maxZ+=1,d.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ)),b={scrollTop:d.element.attr("scrollTop"),scrollLeft:d.element.attr("scrollLeft")},a.ui.dialog.maxZ+=1,d.uiDialog.css("z-index",a.ui.dialog.maxZ),d.element.attr(b),d._trigger("focus",c);return d},open:function(){if(!this._isOpen){var b=this,c=b.options,d=b.uiDialog;b.overlay=c.modal?new a.ui.dialog.overlay(b):null,b._size(),b._position(c.position),d.show(c.show),b.moveToTop(!0),c.modal&&d.bind("keypress.ui-dialog",function(b){if(b.keyCode===a.ui.keyCode.TAB){var c=a(":tabbable",this),d=c.filter(":first");c=c.filter(":last");if(b.target===c[0]&&!b.shiftKey){d.focus(1);return!1}if(b.target===d[0]&&b.shiftKey){c.focus(1);return!1}}}),a(b.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus(),b._isOpen=!0,b._trigger("open");return b}},_createButtons:function(b){var c=this,d=!1,f=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),g=a("<div></div>").addClass("ui-dialog-buttonset").appendTo(f);c.uiDialog.find(".ui-dialog-buttonpane").remove(),typeof b==="object"&&b!==null&&a.each(b,function(){return!(d=!0)}),d&&(a.each(b,function(b,d){d=a.isFunction(d)?{click:d,text:b}:d;var f=a('<button type="button"></button>').click(function(){d.click.apply(c.element[0],arguments)}).appendTo(g);a.each(d,function(a,b){a!=="click"&&(a in e?f[a](b):f.attr(a,b))}),a.fn.button&&f.button()}),f.appendTo(c.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=c.options,e=a(document),f;c.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,h){f=d.height==="auto"?"auto":a(this).height(),a(this).height(a(this).height()).addClass("ui-dialog-dragging"),c._trigger("dragStart",e,b(h))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(h,i){d.position=[i.position.left-e.scrollLeft(),i.position.top-e.scrollTop()],a(this).removeClass("ui-dialog-dragging").height(f),c._trigger("dragStop",h,b(i)),a.ui.dialog.overlay.resize()}})},_makeResizable:function(c){function d(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}c=c===b?this.options.resizable:c;var e=this,f=e.options,g=e.uiDialog.css("position");c=typeof c==="string"?c:"n,e,s,w,se,sw,ne,nw",e.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:e.element,maxWidth:f.maxWidth,maxHeight:f.maxHeight,minWidth:f.minWidth,minHeight:e._minHeight(),handles:c,start:function(b,c){a(this).addClass("ui-dialog-resizing"),e._trigger("resizeStart",b,d(c))},resize:function(a,b){e._trigger("resize",a,d(b))},stop:function(b,c){a(this).removeClass("ui-dialog-resizing"),f.height=a(this).height(),f.width=a(this).width(),e._trigger("resizeStop",b,d(c)),a.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var c=[],d=[0,0],e;if(b){if(typeof b==="string"||typeof b==="object"&&"0"in b)c=b.split?b.split(" "):[b[0],b[1]],c.length===1&&(c[1]=c[0]),a.each(["left","top"],function(a,b){+c[a]===c[a]&&(d[a]=c[a],c[a]=b)}),b={my:c.join(" "),at:c.join(" "),offset:d.join(" ")};b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;(e=this.uiDialog.is(":visible"))||this.uiDialog.show(),this.uiDialog.css({top:0,left:0}).position(a.extend({of:window},b)),e||this.uiDialog.hide()},_setOptions:function(b){var e=this,f={},g=!1;a.each(b,function(a,b){e._setOption(a,b),a in c&&(g=!0),a in d&&(f[a]=b)}),g&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",f)},_setOption:function(b,c){var d=this,e=d.uiDialog;switch(b){case"beforeclose":b="beforeClose";break;case"buttons":d._createButtons(c);break;case"closeText":d.uiDialogTitlebarCloseText.text(""+c);break;case"dialogClass":e.removeClass(d.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c);break;case"disabled":c?e.addClass("ui-dialog-disabled"):e.removeClass("ui-dialog-disabled");break;case"draggable":var f=e.is(":data(draggable)");f&&!c&&e.draggable("destroy"),!f&&c&&d._makeDraggable();break;case"position":d._position(c);break;case"resizable":(f=e.is(":data(resizable)"))&&!c&&e.resizable("destroy"),f&&typeof c==="string"&&e.resizable("option","handles",c),!f&&c!==!1&&d._makeResizable(c);break;case"title":a(".ui-dialog-title",d.uiDialogTitlebar).html(""+(c||"&#160;"))}a.Widget.prototype._setOption.apply(d,arguments)},_size:function(){var b=this.options,c,d,e=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),b.minWidth>b.width&&(b.width=b.minWidth),c=this.uiDialog.css({height:"auto",width:b.width}).height(),d=Math.max(0,b.minHeight-c),b.height==="auto"?a.support.minHeight?this.element.css({minHeight:d,height:"auto"}):(this.uiDialog.show(),b=this.element.css("height","auto").height(),e||this.uiDialog.hide(),this.element.height(Math.max(b,d))):this.element.height(Math.max(b.height-c,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),a.extend(a.ui.dialog,{version:"1.8.13",uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id"),a||(this.uuid+=1,a=this.uuid);return"ui-dialog-title-"+a},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}}),a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(b){this.instances.length===0&&(setTimeout(function(){a.ui.dialog.overlay.instances.length&&a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return!1})},1),a(document).bind("keydown.dialog-overlay",function(c){b.options.closeOnEscape&&c.keyCode&&c.keyCode===a.ui.keyCode.ESCAPE&&(b.close(c),c.preventDefault())}),a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize));var c=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});a.fn.bgiframe&&c.bgiframe(),this.instances.push(c);return c},destroy:function(b){var c=a.inArray(b,this.instances);c!=-1&&this.oldInstances.push(this.instances.splice(c,1)[0]),this.instances.length===0&&a([document,window]).unbind(".dialog-overlay"),b.remove();var d=0;a.each(this.instances,function(){d=Math.max(d,this.css("z-index"))}),this.maxZ=d},height:function(){var b,c;if(a.browser.msie&&a.browser.version<7){b=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return b<c?a(window).height()+"px":b+"px"}return a(document).height()+"px"},width:function(){var b,c;if(a.browser.msie&&a.browser.version<7){b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);return b<c?a(window).width()+"px":b+"px"}return a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=b.add(this)}),b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}}),a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b=this,c=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=c.values&&c.values.length||1,g=[];this._mouseSliding=this._keySliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(c.disabled?" ui-slider-disabled ui-disabled":"")),this.range=a([]),c.range&&(c.range===!0&&(c.values||(c.values=[this._valueMin(),this._valueMin()]),c.values.length&&c.values.length!==2&&(c.values=[c.values[0],c.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(c.range==="min"||c.range==="max"?" ui-slider-range-"+c.range:"")));for(var h=e.length;h<f;h+=1)g.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=e.add(a(g.join("")).appendTo(b.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){c.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){c.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")}),this.handles.each(function(b){a(this).data("index.ui-slider-handle",b)}),this.handles.keydown(function(c){var e=!0,f=a(this).data("index.ui-slider-handle"),g,h,i;if(!b.options.disabled){switch(c.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:e=!1;if(!b._keySliding){b._keySliding=!0,a(this).addClass("ui-state-active"),g=b._start(c,f);if(g===!1)return}}i=b.options.step,g=b.options.values&&b.options.values.length?h=b.values(f):h=b.value();switch(c.keyCode){case a.ui.keyCode.HOME:h=b._valueMin();break;case a.ui.keyCode.END:h=b._valueMax();break;case a.ui.keyCode.PAGE_UP:h=b._trimAlignValue(g+(b._valueMax()-b._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:h=b._trimAlignValue(g-(b._valueMax()-b._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(g===b._valueMax())return;h=b._trimAlignValue(g+i);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(g===b._valueMin())return;h=b._trimAlignValue(g-i)}b._slide(c,f,h);return e}}).keyup(function(c){var e=a(this).data("index.ui-slider-handle");b._keySliding&&(b._keySliding=!1,b._stop(c,e),b._change(c,e),a(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy();return this},_mouseCapture:function(b){var c=this.options,e,f,g,h,i;if(c.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),e=this._normValueFromMouse({x:b.pageX,y:b.pageY}),f=this._valueMax()-this._valueMin()+1,h=this,this.handles.each(function(b){var c=Math.abs(e-h.values(b));f>c&&(f=c,g=a(this),i=b)}),c.range===!0&&this.values(1)===c.min&&(i+=1,g=a(this.handles[i]));if(this._start(b,i)===!1)return!1;this._mouseSliding=!0,h._handleIndex=i,g.addClass("ui-state-active").focus(),c=g.offset(),this._clickOffset=a(b.target).parents().andSelf().is(".ui-slider-handle")?{left:b.pageX-c.left-g.width()/2,top:b.pageY-c.top-g.height()/2-(parseInt(g.css("borderTopWidth"),10)||0)-(parseInt(g.css("borderBottomWidth"),10)||0)+(parseInt(g.css("marginTop"),10)||0)}:{left:0,top:0},this.handles.hasClass("ui-state-hover")||this._slide(b,i,e);return this._animateOff=!0},_mouseStart:function(){return!0},_mouseDrag:function(a){var b=this._normValueFromMouse({x:a.pageX,y:a.pageY});this._slide(a,this._handleIndex,b);return!1},_mouseStop:function(a){this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(a){var b;this.orientation==="horizontal"?(b=this.elementSize.width,a=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,a=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),b=a/b,b>1&&(b=1),b<0&&(b=0),this.orientation==="vertical"&&(b=1-b),a=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+b*a)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());return this._trigger("start",a,c)},_slide:function(a,b,c){var d;this.options.values&&this.options.values.length?(d=this.values(b?0:1),this.options.values.length===2&&this.options.range===!0&&(b===0&&c>d||b===1&&c<d)&&(c=d),c!==this.values(b)&&(d=this.values(),d[b]=c,a=this._trigger("slide",a,{handle:this.handles[b],value:c,values:d}),this.values(b?0:1),a!==!1&&this.values(b,c,!0))):c!==this.value()&&(a=this._trigger("slide",a,{handle:this.handles[b],value:c}),a!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("change",a,c)}},value:function(a){if(arguments.length)this.options.value=this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(b,c){var e,f,g;if(arguments.length>1)this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),this._change(null,b);else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();e=this.options.values,f=arguments[0];for(g=0;g<e.length;g+=1)e[g]=this._trimAlignValue(f[g]),this._change(null,g);this._refreshValue()}},_setOption:function(b,c){var e,f=0;a.isArray(this.options.values)&&(f=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments);switch(b){case"disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.attr("disabled","disabled"),this.element.addClass("ui-disabled")):(this.handles.removeAttr("disabled"),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(e=0;e<f;e+=1)this._change(null,e);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c;if(arguments.length){b=this.options.values[a];return b=this._trimAlignValue(b)}b=this.options.values.slice();for(c=0;c<b.length;c+=1)b[c]=this._trimAlignValue(b[c]);return b},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b;alignValue=a-c,Math.abs(c)*2>=b&&(alignValue+=c>0?b:-b);return parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b=this.options.range,c=this.options,e=this,f=this._animateOff?!1:c.animate,g,h={},i,j,k,l;this.options.values&&this.options.values.length?this.handles.each(function(b){g=(e.values(b)-e._valueMin())/(e._valueMax()-e._valueMin())*100,h[e.orientation==="horizontal"?"left":"bottom"]=g+"%",a(this).stop(1,1)[f?"animate":"css"](h,c.animate),e.options.range===!0&&(e.orientation==="horizontal"?(b===0&&e.range.stop(1,1)[f?"animate":"css"]({left:g+"%"},c.animate),b===1&&e.range[f?"animate":"css"]({width:g-i+"%"},{queue:!1,duration:c.animate})):(b===0&&e.range.stop(1,1)[f?"animate":"css"]({bottom:g+"%"},c.animate),b===1&&e.range[f?"animate":"css"]({height:g-i+"%"},{queue:!1,duration:c.animate}))),i=g}):(j=this.value(),k=this._valueMin(),l=this._valueMax(),g=l!==k?(j-k)/(l-k)*100:0,h[e.orientation==="horizontal"?"left":"bottom"]=g+"%",this.handle.stop(1,1)[f?"animate":"css"](h,c.animate),b==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[f?"animate":"css"]({width:g+"%"},c.animate),b==="max"&&this.orientation==="horizontal"&&this.range[f?"animate":"css"]({width:100-g+"%"},{queue:!1,duration:c.animate}),b==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[f?"animate":"css"]({height:g+"%"},c.animate),b==="max"&&this.orientation==="vertical"&&this.range[f?"animate":"css"]({height:100-g+"%"},{queue:!1,duration:c.animate}))}}),a.extend(a.ui.slider,{version:"1.8.13"})}(jQuery),function(a,b){function d(){return++f}function c(){return++e}var e=0,f=0;a.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:!1,cookie:null,collapsible:!1,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(!0)},_setOption:function(a,b){a=="selected"?this.options.collapsible&&b==this.options.selected||this.select(b):(this.options[a]=b,this._tabify())},_tabId:function(a){return a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+c()},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+d());return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var b=a(this);b.html(b.data("label.tabs")).removeData("label.tabs")})},_tabify:function(c){function d(b,c){b.css("display",""),!a.support.opacity&&c.opacity&&b[0].style.removeAttribute("filter")}var e=this,f=this.options,g=/^#.+/;this.list=this.element.find("ol,ul").eq(0),this.lis=a(" > li:has(a[href])",this.list),this.anchors=this.lis.map(function(){return a("a",this)[0]}),this.panels=a([]),this.anchors.each(function(b,c){var d=a(c).attr("href"),h=d.split("#")[0],i;h&&(h===location.toString().split("#")[0]||(i=a("base")[0])&&h===i.href)&&(d=c.hash,c.href=d),g.test(d)?e.panels=e.panels.add(e.element.find(e._sanitizeSelector(d))):d&&d!=="#"?(a.data(c,"href.tabs",d),a.data(c,"load.tabs",d.replace(/#.*$/,"")),d=e._tabId(c),c.href="#"+d,c=e.element.find("#"+d),c.length||(c=a(f.panelTemplate).attr("id",d).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(e.panels[b-1]||e.list),c.data("destroy.tabs",!0)),e.panels=e.panels.add(c)):f.disabled.push(b)}),c?(this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.lis.addClass("ui-state-default ui-corner-top"),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"),f.selected===b?(location.hash&&this.anchors.each(function(a,b){if(b.hash==location.hash){f.selected=a;return!1}}),typeof f.selected!=="number"&&f.cookie&&(f.selected=parseInt(e._cookie(),10)),typeof f.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length&&(f.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))),f.selected=f.selected||(this.lis.length?0:-1)):f.selected===null&&(f.selected=-1),f.selected=f.selected>=0&&this.anchors[f.selected]||f.selected<0?f.selected:0,f.disabled=a.unique(f.disabled.concat(a.map(this.lis.filter(".ui-state-disabled"),function(a){return e.lis.index(a)}))).sort(),a.inArray(f.selected,f.disabled)!=-1&&f.disabled.splice(a.inArray(f.selected,f.disabled),1),this.panels.addClass("ui-tabs-hide"),this.lis.removeClass("ui-tabs-selected ui-state-active"),f.selected>=0&&this.anchors.length&&(e.element.find(e._sanitizeSelector(e.anchors[f.selected].hash)).removeClass("ui-tabs-hide"),this.lis.eq(f.selected).addClass("ui-tabs-selected ui-state-active"),e.element.queue("tabs",function(){e._trigger("show",null,e._ui(e.anchors[f.selected],e.element.find(e._sanitizeSelector(e.anchors[f.selected].hash))[0]))}),this.load(f.selected)),a(window).bind("unload",function(){e.lis.add(e.anchors).unbind(".tabs"),e.lis=e.anchors=e.panels=null})):f.selected=this.lis.index(this.lis.filter(".ui-tabs-selected")),this.element[f.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible"),f.cookie&&this._cookie(f.selected,f.cookie),c=0;for(var h;h=this.lis[c];c++)a(h)[a.inArray(c,f.disabled)!=-1&&!a(h).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");f.cache===!1&&this.anchors.removeData("cache.tabs"),this.lis.add(this.anchors).unbind(".tabs");if(f.event!=="mouseover"){var i=function(a,b){b.is(":not(.ui-state-disabled)")&&b.addClass("ui-state-"+a)},j=function(a,b){b.removeClass("ui-state-"+a)};this.lis.bind("mouseover.tabs",function(){i("hover",a(this))}),this.lis.bind("mouseout.tabs",function(){j("hover",a(this))}),this.anchors.bind("focus.tabs",function(){i("focus",a(this).closest("li"))}),this.anchors.bind("blur.tabs",function(){j("focus",a(this).closest("li"))})}var k,l;f.fx&&(a.isArray(f.fx)?(k=f.fx[0],l=f.fx[1]):k=l=f.fx);var m=l?function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.hide().removeClass("ui-tabs-hide").animate(l,l.duration||"normal",function(){d(c,l),e._trigger("show",null,e._ui(b,c[0]))})}:function(b,c){a(b).closest("li").addClass("ui-tabs-selected ui-state-active"),c.removeClass("ui-tabs-hide"),e._trigger("show",null,e._ui(b,c[0]))},n=k?function(a,b){b.animate(k,k.duration||"normal",function(){e.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),d(b,k),e.element.dequeue("tabs")})}:function(a,b){e.lis.removeClass("ui-tabs-selected ui-state-active"),b.addClass("ui-tabs-hide"),e.element.dequeue("tabs")};this.anchors.bind(f.event+".tabs",function(){var b=this,c=a(b).closest("li"),d=e.panels.filter(":not(.ui-tabs-hide)"),g=e.element.find(e._sanitizeSelector(b.hash));if(c.hasClass("ui-tabs-selected")&&!f.collapsible||c.hasClass("ui-state-disabled")||c.hasClass("ui-state-processing")||e.panels.filter(":animated").length||e._trigger("select",null,e._ui(this,g[0]))===!1){this.blur();return!1}f.selected=e.anchors.index(this),e.abort();if(f.collapsible){if(c.hasClass("ui-tabs-selected")){f.selected=-1,f.cookie&&e._cookie(f.selected,f.cookie),e.element.queue("tabs",function(){n(b,d)}).dequeue("tabs"),this.blur();return!1}if(!d.length){f.cookie&&e._cookie(f.selected,f.cookie),e.element.queue("tabs",function(){m(b,g)}),e.load(e.anchors.index(this)),this.blur();return!1}}f.cookie&&e._cookie(f.selected,f.cookie);if(g.length)d.length&&e.element.queue("tabs",function(){n(b,d)}),e.element.queue("tabs",function(){m(b,g)}),e.load(e.anchors.index(this));else throw"jQuery UI Tabs: Mismatching fragment identifier.";a.browser.msie&&this.blur()}),this.anchors.bind("click.tabs",function(){return!1})},_getIndex:function(a){typeof a=="string"&&(a=this.anchors.index(this.anchors.filter("[href$="+a+"]")));return a},destroy:function(){var b=this.options;this.abort(),this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs"),this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.anchors.each(function(){var b=a.data(this,"href.tabs");b&&(this.href=b);var c=a(this).unbind(".tabs");a.each(["href","load","cache"],function(a,b){c.removeData(b+".tabs")})}),this.lis.unbind(".tabs").add(this.panels).each(function(){a.data(this,"destroy.tabs")?a(this).remove():a(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")}),b.cookie&&this._cookie(null,b.cookie);return this},add:function(c,d,e){e===b&&(e=this.anchors.length);var f=this,g=this.options;d=a(g.tabTemplate.replace(/#\{href\}/g,c).replace(/#\{label\}/g,d)),c=c.indexOf("#")?this._tabId(a("a",d)[0]):c.replace("#",""),d.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);var h=f.element.find("#"+c);h.length||(h=a(g.panelTemplate).attr("id",c).data("destroy.tabs",!0)),h.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"),e<this.lis.length?(d.insertBefore(this.lis[e]),h.insertBefore(this.panels[e])):(d.appendTo(this.list),h.appendTo(this.list[0].parentNode)),g.disabled=a.map(g.disabled,function(a){return a>=e?++a:a}),this._tabify(),this.anchors.length==1&&(g.selected=0,d.addClass("ui-tabs-selected ui-state-active"),h.removeClass("ui-tabs-hide"),this.element.queue("tabs",function(){f._trigger("show",null,f._ui(f.anchors[0],f.panels[0]))}),this.load(0)),this._trigger("add",null,this._ui(this.anchors[e],this.panels[e]));return this},remove:function(b){b=this._getIndex(b);var c=this.options,d=this.lis.eq(b).remove(),e=this.panels.eq(b).remove();d.hasClass("ui-tabs-selected")&&this.anchors.length>1&&this.select(b+(b+1<this.anchors.length?1:-1)),c.disabled=a.map(a.grep(c.disabled,function(a){return a!=b}),function(a){return a>=b?--a:a}),this._tabify(),this._trigger("remove",null,this._ui(d.find("a")[0],e[0]));return this},enable:function(b){b=this._getIndex(b);var c=this.options;if(a.inArray(b,c.disabled)!=-1){this.lis.eq(b).removeClass("ui-state-disabled"),c.disabled=a.grep(c.disabled,function(a){return a!=b}),this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b]));return this}},disable:function(a){a=this._getIndex(a);var b=this.options;a!=b.selected&&(this.lis.eq(a).addClass("ui-state-disabled"),b.disabled.push(a),b.disabled.sort(),this._trigger("disable",null,this._ui(this.anchors[a],this.panels[a])));return this},select:function(a){a=this._getIndex(a);if(a==-1)if(this.options.collapsible&&this.options.selected!=-1)a=this.options.selected;else return this;this.anchors.eq(a).trigger(this.options.event+".tabs");return this},load:function(b){b=this._getIndex(b);var c=this,d=this.options,e=this.anchors.eq(b)[0],f=a.data(e,"load.tabs");this.abort();if(!f||this.element.queue("tabs").length!==0&&a.data(e,"cache.tabs"))this.element.dequeue("tabs");else{this.lis.eq(b).addClass("ui-state-processing");if(d.spinner){var g=a("span",e);g.data("label.tabs",g.html()).html(d.spinner)}this.xhr=a.ajax(a.extend({},d.ajaxOptions,{url:f,success:function(f,g){c.element.find(c._sanitizeSelector(e.hash)).html(f),c._cleanup(),d.cache&&a.data(e,"cache.tabs",!0),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.success(f,g)}catch(h){}},error:function(a,f){c._cleanup(),c._trigger("load",null,c._ui(c.anchors[b],c.panels[b]));try{d.ajaxOptions.error(a,f,b,e)}catch(g){}}})),c.element.dequeue("tabs");return this}},abort:function(){this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("tabs",this.element.queue("tabs").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._cleanup();return this},url:function(a,b){this.anchors.eq(a).removeData("cache.tabs").data("load.tabs",b);return this},length:function(){return this.anchors.length}}),a.extend(a.ui.tabs,{version:"1.8.13"}),a.extend(a.ui.tabs.prototype,{rotation:null,rotate:function(a,b){var c=this,d=this.options,e=c._rotate||(c._rotate=function(b){clearTimeout(c.rotation),c.rotation=setTimeout(function(){var a=d.selected;c.select(++a<c.anchors.length?a:0)},a),b&&b.stopPropagation()});b=c._unrotate||(c._unrotate=b?function(){t=d.selected,e()}:function(a){a.clientX&&c.rotate(null)}),a?(this.element.bind("tabsshow",e),this.anchors.bind(d.event+".tabs",b),e()):(clearTimeout(c.rotation),this.element.unbind("tabsshow",e),this.anchors.unbind(d.event+".tabs",b),delete this._rotate,delete this._unrotate);return this}})}(jQuery),function(d,B){function H(a,b){d.extend(a,b);for(var c in b)if(b[c]==null||b[c]==B)a[c]=b[c];return a}function N(a){return a.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseout",function(){d(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!=-1&&d(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!=-1&&d(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){d.datepicker._isDisabledDatepicker(J.inline?a.parent()[0]:J.input[0])||(d(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),d(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!=-1&&d(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!=-1&&d(this).addClass("ui-datepicker-next-hover"))})}function M(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._inDialog=this._datepickerShowing=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1},d.extend(this._defaults,this.regional[""]),this.dpDiv=N(d('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}d.extend(d.ui,{datepicker:{version:"1.8.13"}});var z=(new Date).getTime(),J;d.extend(M.prototype,{markerClassName:"hasDatepicker",log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){H(this._defaults,a||{});return this},_attachDatepicker:function(a,b){var c=null;for(var e in this._defaults){var f=a.getAttribute("date:"+e);if(f){c=c||{};try{c[e]=eval(f)}catch(h){c[e]=f}}}e=a.nodeName.toLowerCase(),f=e=="div"||e=="span",a.id||(this.uuid+=1,a.id="dp"+this.uuid);var i=this._newInst(d(a),f);i.settings=d.extend({},b||{},c||{}),e=="input"?this._connectDatepicker(a,i):f&&this._inlineDatepicker(a,i)},_newInst:function(a,b){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:b?N(d('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(a,b){var c=d(a);b.append=d([]),b.trigger=d([]),c.hasClass(this.markerClassName)||(this._attachments(c,b),c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),this._autoSize(b),d.data(a,"datepicker",b))},_attachments:function(a,b){var c=this._get(b,"appendText"),e=this._get(b,"isRTL");b.append&&b.append.remove(),c&&(b.append=d('<span class="'+this._appendClass+'">'+c+"</span>"),a[e?"before":"after"](b.append)),a.unbind("focus",this._showDatepicker),b.trigger&&b.trigger.remove(),c=this._get(b,"showOn"),(c=="focus"||c=="both")&&a.focus(this._showDatepicker);if(c=="button"||c=="both"){c=this._get(b,"buttonText");var f=this._get(b,"buttonImage");b.trigger=d(this._get(b,"buttonImageOnly")?d("<img/>").addClass(this._triggerClass).attr({src:f,alt:c,title:c}):d('<button type="button"></button>').addClass(this._triggerClass).html(f==""?c:d("<img/>").attr({src:f,alt:c,title:c}))),a[e?"before":"after"](b.trigger),b.trigger.click(function(){d.datepicker._datepickerShowing&&d.datepicker._lastInput==a[0]?d.datepicker._hideDatepicker():d.datepicker._showDatepicker(a[0]);return!1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var d=function(a){for(var b=0,c=0,d=0;d<a.length;d++)a[d].length>b&&(b=a[d].length,c=d);return c};b.setMonth(d(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort"))),b.setDate(d(this._get(a,c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=d(a);c.hasClass(this.markerClassName)||(c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),d.data(a,"datepicker",b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.dpDiv.show())},_dialogDatepicker:function(a,b,c,e,f){a=this._dialogInst,a||(this.uuid+=1,this._dialogInput=d('<input type="text" id="'+("dp"+this.uuid)+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'),this._dialogInput.keydown(this._doKeyDown),d("body").append(this._dialogInput),a=this._dialogInst=this._newInst(this._dialogInput,!1),a.settings={},d.data(this._dialogInput[0],"datepicker",a)),H(a.settings,e||{}),b=b&&b.constructor==Date?this._formatDate(a,b):b,this._dialogInput.val(b),this._pos=f?f.length?f:[f.pageX,f.pageY]:null,this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),a.settings.onSelect=c,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),d.blockUI&&d.blockUI(this.dpDiv),d.data(this._dialogInput[0],"datepicker",a);return this},_destroyDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();d.removeData(a,"datepicker"),e=="input"?(c.append.remove(),c.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(e=="div"||e=="span")&&b.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if(e=="input")a.disabled=!1,c.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(e=="div"||e=="span")b=b.children("."+this._inlineClass),b.children().removeClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled");this._disabledInputs=d.map(this._disabledInputs,function(b){return b==a?null:b})}},_disableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if(e=="input")a.disabled=!0,c.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(e=="div"||e=="span")b=b.children("."+this._inlineClass),b.children().addClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled");this._disabledInputs=d.map(this._disabledInputs,function(b){return b==a?null:b}),this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(a){try{return d.data(a,"datepicker")}catch(b){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(a,b,c){var e=this._getInst(a);if(arguments.length==2&&typeof b=="string")return b=="defaults"?d.extend({},d.datepicker._defaults):e?b=="all"?d.extend({},e.settings):this._get(e,b):null;var f=b||{};typeof b=="string"&&(f={},f[b]=c);if(e){this._curInst==e&&this._hideDatepicker();var g=this._getDateDatepicker(a,!0),h=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max");H(e.settings,f),h!==null&&f.dateFormat!==B&&f.minDate===B&&(e.settings.minDate=this._formatDate(e,h)),i!==null&&f.dateFormat!==B&&f.maxDate===B&&(e.settings.maxDate=this._formatDate(e,i)),this._attachments(d(a),e),this._autoSize(e),this._setDate(e,g),this._updateAlternate(e),this._updateDatepicker(e)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){if(a=this._getInst(a))this._setDate(a,b),this._updateDatepicker(a),this._updateAlternate(a)},_getDateDatepicker:function(a,b){(a=this._getInst(a))&&!a.inline&&this._setDateFromField(a,b);return a?this._getDate(a):null},_doKeyDown:function(a){var b=d.datepicker._getInst(a.target),c=!0,e=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if(d.datepicker._datepickerShowing)switch(a.keyCode){case 9:d.datepicker._hideDatepicker(),c=!1;break;case 13:c=d("td."+d.datepicker._dayOverClass+":not(."+d.datepicker._currentClass+")",b.dpDiv),c[0]?d.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,c[0]):d.datepicker._hideDatepicker();return!1;case 27:d.datepicker._hideDatepicker();break;case 33:d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 34:d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&d.datepicker._clearDate(a.target),c=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&d.datepicker._gotoToday(a.target),c=a.ctrlKey||a.metaKey;break;case 37:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,e?+1:-1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,-7,"D"),c=a.ctrlKey||a.metaKey;break;case 39:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,e?-1:+1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,+7,"D"),c=a.ctrlKey||a.metaKey;break;default:c=!1}else a.keyCode==36&&a.ctrlKey?d.datepicker._showDatepicker(this):c=!1;c&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(a){var b=d.datepicker._getInst(a.target);if(d.datepicker._get(b,"constrainInput")){b=d.datepicker._possibleChars(d.datepicker._get(b,"dateFormat"));var c=String.fromCharCode(a.charCode==B?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||c<" "||!b||b.indexOf(c)>-1}},_doKeyUp:function(a){a=d.datepicker._getInst(a.target);if(a.input.val()!=a.lastVal)try{d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,d.datepicker._getFormatConfig(a))&&(d.datepicker._setDateFromField(a),d.datepicker._updateAlternate(a),d.datepicker._updateDatepicker(a))}catch(b){d.datepicker.log(b)}return!0},_showDatepicker:function(a){a=a.target||a,a.nodeName.toLowerCase()!="input"&&(a=d("input",a.parentNode)[0]);if(!d.datepicker._isDisabledDatepicker(a)&&d.datepicker._lastInput!=a){var b=d.datepicker._getInst(a);d.datepicker._curInst&&d.datepicker._curInst!=b&&d.datepicker._curInst.dpDiv.stop(!0,!0);var c=d.datepicker._get(b,"beforeShow");H(b.settings,c?c.apply(a,[a,b]):{}),b.lastVal=null,d.datepicker._lastInput=a,d.datepicker._setDateFromField(b),d.datepicker._inDialog&&(a.value=""),d.datepicker._pos||(d.datepicker._pos=d.datepicker._findPos(a),d.datepicker._pos[1]+=a.offsetHeight);var e=!1;d(a).parents().each(function(){e|=d(this).css("position")=="fixed";return!e}),e&&d.browser.opera&&(d.datepicker._pos[0]-=document.documentElement.scrollLeft,d.datepicker._pos[1]-=document.documentElement.scrollTop),c={left:d.datepicker._pos[0],top:d.datepicker._pos[1]},d.datepicker._pos=null,b.dpDiv.empty(),b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),d.datepicker._updateDatepicker(b),c=d.datepicker._checkOffset(b,c,e),b.dpDiv.css({position:d.datepicker._inDialog&&d.blockUI?"static":e?"fixed":"absolute",display:"none",left:c.left+"px",top:c.top+"px"});if(!b.inline){c=d.datepicker._get(b,"showAnim");var f=d.datepicker._get(b,"duration"),g=function(){var a=b.dpDiv.find("iframe.ui-datepicker-cover");if(a.length){var c=d.datepicker._getBorders(b.dpDiv);a.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex(d(a).zIndex()+1),d.datepicker._datepickerShowing=!0,d.effects&&d.effects[c]?b.dpDiv.show(c,d.datepicker._get(b,"showOptions"),f,g):b.dpDiv[c||"show"](c?f:null,g),(!c||!f)&&g(),b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus(),d.datepicker._curInst=b}}},_updateDatepicker:function(a){var b=d.datepicker._getBorders(a.dpDiv);J=a,a.dpDiv.empty().append(this._generateHTML(a));var c=a.dpDiv.find("iframe.ui-datepicker-cover");c.length&&c.css({left:-b[0],top:-b[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()}),a.dpDiv.find("."+this._dayOverClass+" a").mouseover(),b=this._getNumberOfMonths(a),c=b[1],a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),c>1&&a.dpDiv.addClass("ui-datepicker-multi-"+c).css("width",17*c+"em"),a.dpDiv[(b[0]!=1||b[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),a==d.datepicker._curInst&&d.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=document.activeElement&&a.input.focus();if(a.yearshtml){var e=a.yearshtml;setTimeout(function(){e===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml),e=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return({thin:1,medium:2,thick:3})[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var e=a.dpDiv.outerWidth(),f=a.dpDiv.outerHeight(),g=a.input?a.input.outerWidth():0,h=a.input?a.input.outerHeight():0,i=document.documentElement.clientWidth+d(document).scrollLeft(),j=document.documentElement.clientHeight+d(document).scrollTop();b.left-=this._get(a,"isRTL")?e-g:0,b.left-=c&&b.left==a.input.offset().left?d(document).scrollLeft():0,b.top-=c&&b.top==a.input.offset().top+h?d(document).scrollTop():0,b.left-=Math.min(b.left,b.left+e>i&&i>e?Math.abs(b.left+e-i):0),b.top-=Math.min(b.top,b.top+f>j&&j>f?Math.abs(f+h):0);return b},_findPos:function(a){for(var b=this._get(this._getInst(a),"isRTL");a&&(a.type=="hidden"||a.nodeType!=1||d.expr.filters.hidden(a));)a=a[b?"previousSibling":"nextSibling"];a=d(a).offset();return[a.left,a.top]},_hideDatepicker:function(a){var b=this._curInst;if(b&&(!a||b==d.data(a,"datepicker")))if(this._datepickerShowing){a=this._get(b,"showAnim");var c=this._get(b,"duration"),e=function(){d.datepicker._tidyDialog(b),this._curInst=null};d.effects&&d.effects[a]?b.dpDiv.hide(a,d.datepicker._get(b,"showOptions"),c,e):b.dpDiv[a=="slideDown"?"slideUp":a=="fadeIn"?"fadeOut":"hide"](a?c:null,e),a||e(),(a=this._get(b,"onClose"))&&a.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]),this._datepickerShowing=!1,this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),d.blockUI&&(d.unblockUI(),d("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){d.datepicker._curInst&&(a=d(a.target),a[0].id!=d.datepicker._mainDivId&&a.parents("#"+d.datepicker._mainDivId).length==0&&!a.hasClass(d.datepicker.markerClassName)&&!a.hasClass(d.datepicker._triggerClass)&&d.datepicker._datepickerShowing&&(!d.datepicker._inDialog||!d.blockUI)&&d.datepicker._hideDatepicker())},_adjustDate:function(a,b,c){a=d(a);var e=this._getInst(a[0]);this._isDisabledDatepicker(a[0])||(this._adjustInstDate(e,b+(c=="M"?this._get(e,"showCurrentAtPos"):0),c),this._updateDatepicker(e))},_gotoToday:function(a){a=d(a);var b=this._getInst(a[0]);if(this._get(b,"gotoCurrent")&&b.currentDay)b.selectedDay=b.currentDay,b.drawMonth=b.selectedMonth=b.currentMonth,b.drawYear=b.selectedYear=b.currentYear;else{var c=new Date;b.selectedDay=c.getDate(),b.drawMonth=b.selectedMonth=c.getMonth(),b.drawYear=b.selectedYear=c.getFullYear()}this._notifyChange(b),this._adjustDate(a)},_selectMonthYear:function(a,b,c){a=d(a);var e=this._getInst(a[0]);e._selectingMonthYear=!1,e["selected"+(c=="M"?"Month":"Year")]=e["draw"+(c=="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),this._notifyChange(e),this._adjustDate(a)},_clickMonthYear:function(a){var b=this._getInst(d(a)[0]);b.input&&b._selectingMonthYear&&setTimeout(function(){b.input.focus()},0),b._selectingMonthYear=!b._selectingMonthYear},_selectDay:function(a,b,c,e){var f=d(a);!d(e).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(f[0])&&(f=this._getInst(f[0]),f.selectedDay=f.currentDay=d("a",e).html(),f.selectedMonth=f.currentMonth=b,f.selectedYear=f.currentYear=c,this._selectDate(a,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(a){a=d(a),this._getInst(a[0]),this._selectDate(a,"")},_selectDate:function(a,b){a=this._getInst(d(a)[0]),b=b!=null?b:this._formatDate(a),a.input&&a.input.val(b),this._updateAlternate(a);var c=this._get(a,"onSelect");c?c.apply(a.input?a.input[0]:null,[b,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],typeof a.input[0]!="object"&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),e=this._getDate(a),f=this.formatDate(c,e,this._getFormatConfig(a));d(b).each(function(){d(this).val(f)})}},noWeekends:function(a){a=a.getDay();return[a>0&&a<6,""]},iso8601Week:function(a){a=new Date(a.getTime()),a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();a.setMonth(0),a.setDate(1);return Math.floor(Math.round((b-a)/864e5)/7)+1},parseDate:function(a,b,c){if(a==null||b==null)throw"Invalid arguments";b=typeof b=="object"?b.toString():b+"";if(b=="")return null;var e=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff;e=typeof e!="string"?e:(new Date).getFullYear()%100+parseInt(e,10);for(var f=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,g=(c?c.dayNames:null)||this._defaults.dayNames,h=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,i=(c?c.monthNames:null)||this._defaults.monthNames,j=c=-1,k=-1,l=-1,m=!1,n=function(b){(b=s+1<a.length&&a.charAt(s+1)==b)&&s++;return b},o=function(a){var c=n(a);a=new RegExp("^\\d{1,"+(a=="@"?14:a=="!"?20:a=="y"&&c?4:a=="o"?3:2)+"}"),a=b.substring(r).match(a);if(!a)throw"Missing number at position "+r;r+=a[0].length;return parseInt(a[0],10)},p=function(a,c,e){a=d.map(n(a)?e:c,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});var f=-1;d.each(a,function(a,c){a=c[1];if(b.substr(r,a.length).toLowerCase()==a.toLowerCase()){f=c[0],r+=a.length;return!1}});if(f!=-1)return f+1;throw"Unknown name at position "+r},q=function(){if(b.charAt(r)!=a.charAt(s))throw"Unexpected literal at position "+r;r++},r=0,s=0;s<a.length;s++)if(m)a.charAt(s)!="'"||n("'")?q():m=!1;else switch(a.charAt(s)){case"d":k=o("d");break;case"D":p("D",f,g);break;case"o":l=o("o");break;case"m":j=o("m");break;case"M":j=p("M",h,i);break;case"y":c=o("y");break;case"@":var t=new Date(o("@"));c=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"!":t=new Date((o("!")-this._ticksTo1970)/1e4),c=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"'":n("'")?q():m=!0;break;default:q()}c==-1?c=(new Date).getFullYear():c<100&&(c+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c<=e?0:-100));if(l>-1){j=1,k=l;do{e=this._getDaysInMonth(c,j-1);if(k<=e)break;j++,k-=e}while(1)}t=this._daylightSavingAdjust(new Date(c,j-1,k));if(t.getFullYear()!=c||t.getMonth()+1!=j||t.getDate()!=k)throw"Invalid date";return t},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(a,b,c){if(!b)return"";var d=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,e=(c?c.dayNames:null)||this._defaults.dayNames,f=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort;c=(c?c.monthNames:null)||this._defaults.monthNames;var g=function(b){(b=l+1<a.length&&a.charAt(l+1)==b)&&l++;return b},h=function(a,b,c){b=""+b;if(g(a))for(;b.length<c;)b="0"+b;return b},i=function(a,b,c,d){return g(a)?d[b]:c[b]},j="",k=!1;if(b)for(var l=0;l<a.length;l++)if(k)a.charAt(l)!="'"||g("'")?j+=a.charAt(l):k=!1;else switch(a.charAt(l)){case"d":j+=h("d",b.getDate(),2);break;case"D":j+=i("D",b.getDay(),d,e);break;case"o":j+=h("o",(b.getTime()-(new Date(b.getFullYear(),0,0)).getTime())/864e5,3);break;case"m":j+=h("m",b.getMonth()+1,2);break;case"M":j+=i("M",b.getMonth(),f,c);break;case"y":j+=g("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case"@":j+=b.getTime();break;case"!":j+=b.getTime()*1e4+this._ticksTo1970;break;case"'":g("'")?j+="'":k=!0;break;default:j+=a.charAt(l)}return j},_possibleChars:function(a){for(var b="",c=!1,d=function(b){(b=e+1<a.length&&a.charAt(e+1)==b)&&e++;return b},e=0;e<a.length;e++)if(c)a.charAt(e)!="'"||d("'")?b+=a.charAt(e):c=!1;else switch(a.charAt(e)){case"d":case"m":case"y":case"@":b+="0123456789";break;case"D":case"M":return null;case"'":d("'")?b+="'":c=!0;break;default:b+=a.charAt(e)}return b},_get:function(a,b){return a.settings[b]!==B?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e,f;e=f=this._getDefaultDate(a);var g=this._getFormatConfig(a);try{e=this.parseDate(c,d,g)||f}catch(h){this.log(h),d=b?"":d}a.selectedDay=e.getDate(),a.drawMonth=a.selectedMonth=e.getMonth(),a.drawYear=a.selectedYear=e.getFullYear(),a.currentDay=d?e.getDate():0,a.currentMonth=d?e.getMonth():0,a.currentYear=d?e.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){var e=function(a){var b=new Date;b.setDate(b.getDate()+a);return b},f=function(b){try{return d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),b,d.datepicker._getFormatConfig(a))}catch(c){}var e=(b.toLowerCase().match(/^c/)?d.datepicker._getDate(a):null)||new Date,f=e.getFullYear(),g=e.getMonth();e=e.getDate();for(var h=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,i=h.exec(b);i;){switch(i[2]||"d"){case"d":case"D":e+=parseInt(i[1],10);break;case"w":case"W":e+=parseInt(i[1],10)*7;break;case"m":case"M":g+=parseInt(i[1],10),e=Math.min(e,d.datepicker._getDaysInMonth(f,g));break;case"y":case"Y":f+=parseInt(i[1],10),e=Math.min(e,d.datepicker._getDaysInMonth(f,g))}i=h.exec(b)}return new Date(f,g,e)};if(b=(b=b==null||b===""?c:typeof b=="string"?f(b):typeof b=="number"?isNaN(b)?c:e(b):new Date(b.getTime()))&&b.toString()=="Invalid Date"?c:b)b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0);return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(a.getHours()>12?a.getHours()+2:0);return a},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear;b=this._restrictMinMax(a,this._determineDate(a,b,new Date)),a.selectedDay=a.currentDay=b.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth(),a.drawYear=a.selectedYear=a.currentYear=b.getFullYear(),(e!=a.selectedMonth||f!=a.selectedYear)&&!c&&this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&a.input.val()==""?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_generateHTML:function(a){var b=new Date;b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate()));var c=this._get(a,"isRTL"),e=this._get(a,"showButtonPanel"),f=this._get(a,"hideIfNoPrevNext"),g=this._get(a,"navigationAsDateFormat"),h=this._getNumberOfMonths(a),i=this._get(a,"showCurrentAtPos"),j=this._get(a,"stepMonths"),k=h[0]!=1||h[1]!=1,l=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),m=this._getMinMaxDate(a,"min"),n=this._getMinMaxDate(a,"max");i=a.drawMonth-i;var o=a.drawYear;i<0&&(i+=12,o--);if(n){var p=this._daylightSavingAdjust(new Date(n.getFullYear(),n.getMonth()-h[0]*h[1]+1,n.getDate()));for(p=m&&p<m?m:p;this._daylightSavingAdjust(new Date(o,i,1))>p;)i--,i<0&&(i=11,o--)}a.drawMonth=i,a.drawYear=o,p=this._get(a,"prevText"),p=g?this.formatDate(p,this._daylightSavingAdjust(new Date(o,i-j,1)),this._getFormatConfig(a)):p,p=this._canAdjustMonth(a,-1,o,i)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+z+".datepicker._adjustDate('#"+a.id+"', -"+j+", 'M');\" title=\""+p+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+p+"</span></a>":f?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+p+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+p+"</span></a>";var q=this._get(a,"nextText");q=g?this.formatDate(q,this._daylightSavingAdjust(new Date(o,i+j,1)),this._getFormatConfig(a)):q,f=this._canAdjustMonth(a,+1,o,i)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+z+".datepicker._adjustDate('#"+a.id+"', +"+j+", 'M');\" title=\""+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+q+"</span></a>":f?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+q+"</span></a>",j=this._get(a,"currentText"),q=this._get(a,"gotoCurrent")&&a.currentDay?l:b,j=g?this.formatDate(j,q,this._getFormatConfig(a)):j,g=a.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+z+'.datepicker._hideDatepicker();">'+this._get(a,"closeText")+"</button>",e=e?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?g:"")+(this._isInRange(a,q)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+z+".datepicker._gotoToday('#"+a.id+"');\">"+j+"</button>":"")+(c?"":g)+"</div>":"",g=parseInt(this._get(a,"firstDay"),10),g=isNaN(g)?0:g,j=this._get(a,"showWeek"),q=this._get(a,"dayNames"),this._get(a,"dayNamesShort");var r=this._get(a,"dayNamesMin"),s=this._get(a,"monthNames"),t=this._get(a,"monthNamesShort"),u=this._get(a,"beforeShowDay"),v=this._get(a,"showOtherMonths"),w=this._get(a,"selectOtherMonths");this._get(a,"calculateWeek");for(var x=this._getDefaultDate(a),y="",A=0;A<h[0];A++){for(var B="",C=0;C<h[1];C++){var D=this._daylightSavingAdjust(new Date(o,i,a.selectedDay)),E=" ui-corner-all",F="";if(k){F+='<div class="ui-datepicker-group';if(h[1]>1)switch(C){case 0:F+=" ui-datepicker-group-first",E=" ui-corner-"+(c?"right":"left");break;case h[1]-1:F+=" ui-datepicker-group-last",E=" ui-corner-"+(c?"left":"right");break;default:F+=" ui-datepicker-group-middle",E=""}F+='">'}F+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+E+'">'+(/all|left/.test(E)&&A==0?c?f:p:"")+(/all|right/.test(E)&&A==0?c?p:f:"")+this._generateMonthYearHeader(a,i,o,m,n,A>0||C>0,s,t)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var G=j?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"";for(E=0;E<7;E++){var H=(E+g)%7;G+="<th"+((E+g+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+q[H]+'">'+r[H]+"</span></th>"}F+=G+"</tr></thead><tbody>",G=this._getDaysInMonth(o,i),o==a.selectedYear&&i==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,G)),E=(this._getFirstDayOfMonth(o,i)-g+7)%7,G=k?6:Math.ceil((E+G)/7),H=this._daylightSavingAdjust(new Date(o,i,1-E));for(var I=0;I<G;I++){F+="<tr>";var J=j?'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(H)+"</td>":"";for(E=0;E<7;E++){var K=u?u.apply(a.input?a.input[0]:null,[H]):[!0,""],L=H.getMonth()!=i,M=L&&!w||!K[0]||m&&H<m||n&&H>n;J+='<td class="'+((E+g+6)%7>=5?" ui-datepicker-week-end":"")+(L?" ui-datepicker-other-month":"")+(H.getTime()==D.getTime()&&i==a.selectedMonth&&a._keyEvent||x.getTime()==H.getTime()&&x.getTime()==D.getTime()?" "+this._dayOverClass:"")+(M?" "+this._unselectableClass+" ui-state-disabled":"")+(L&&!v?"":" "+K[1]+(H.getTime()==l.getTime()?" "+this._currentClass:"")+(H.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!L||v)&&K[2]?' title="'+K[2]+'"':"")+(M?"":' onclick="DP_jQuery_'+z+".datepicker._selectDay('#"+a.id+"',"+H.getMonth()+","+H.getFullYear()+', this);return false;"')+">"+(L&&!v?"&#xa0;":M?'<span class="ui-state-default">'+H.getDate()+"</span>":'<a class="ui-state-default'+(H.getTime()==b.getTime()?" ui-state-highlight":"")+(H.getTime()==l.getTime()?" ui-state-active":"")+(L?" ui-priority-secondary":"")+'" href="#">'+H.getDate()+"</a>")+"</td>",H.setDate(H.getDate()+1),H=this._daylightSavingAdjust(H)}F+=J+"</tr>"}i++,i>11&&(i=0,o++),F+="</tbody></table>"+(k?"</div>"+(h[0]>0&&C==h[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),B+=F}y+=B}y+=e+(d.browser.msie&&parseInt(d.browser.version,10)<7&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),a._keyEvent=!1;return y},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i=this._get(a,"changeMonth"),j=this._get(a,"changeYear"),k=this._get(a,"showMonthAfterYear"),l='<div class="ui-datepicker-title">',m="";if(f||!i)m+='<span class="ui-datepicker-month">'+g[b]+"</span>";else{g=d&&d.getFullYear()==c;var n=e&&e.getFullYear()==c;m+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+z+".datepicker._selectMonthYear('#"+a.id+"', this, 'M');\" onclick=\"DP_jQuery_"+z+".datepicker._clickMonthYear('#"+a.id+"');\">";for(var o=0;o<12;o++)(!g||o>=d.getMonth())&&(!n||o<=e.getMonth())&&(m+='<option value="'+o+'"'+(o==b?' selected="selected"':"")+">"+h[o]+"</option>");m+="</select>"}k||(l+=m+(f||(!i||!j)?"&#xa0;":""));if(!a.yearshtml){a.yearshtml="";if(f||!j)l+='<span class="ui-datepicker-year">'+c+"</span>";else{h=this._get(a,"yearRange").split(":");var p=(new Date).getFullYear();g=function(a){a=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?p+parseInt(a,10):parseInt(a,10);return isNaN(a)?p:a},b=g(h[0]),h=Math.max(b,g(h[1]||"")),b=d?Math.max(b,d.getFullYear()):b,h=e?Math.min(h,e.getFullYear()):h;for(a.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+z+".datepicker._selectMonthYear('#"+a.id+"', this, 'Y');\" onclick=\"DP_jQuery_"+z+".datepicker._clickMonthYear('#"+a.id+"');\">";b<=h;b++)a.yearshtml+='<option value="'+b+'"'+(b==c?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>",l+=a.yearshtml,a.yearshtml=null}}l+=this._get(a,"yearSuffix"),k&&(l+=(f||(!i||!j)?"&#xa0;":"")+m),l+="</div>";return l},_adjustInstDate:function(a,b,c){var d=a.drawYear+(c=="Y"?b:0),e=a.drawMonth+(c=="M"?b:0);b=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+(c=="D"?b:0),d=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,b))),a.selectedDay=d.getDate(),a.drawMonth=a.selectedMonth=d.getMonth(),a.drawYear=a.selectedYear=d.getFullYear(),(c=="M"||c=="Y")&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min");a=this._getMinMaxDate(a,"max"),b=c&&b<c?c:b;return b=a&&b>a?a:b},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,"numberOfMonths");return a==null?[1,1]:typeof a=="number"?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a);c=this._daylightSavingAdjust(new Date(c,d+(b<0?b:e[0]*e[1]),1)),b<0&&c.setDate(this._getDaysInMonth(c.getFullYear(),c.getMonth()));return this._isInRange(a,c)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min");a=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!a||b.getTime()<=a.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");b=typeof b!="string"?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear),b=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}}),d.fn.datepicker=function(a){if(!this.length)return this;d.datepicker.initialized||(d(document).mousedown(d.datepicker._checkExternalClick).find("body").append(d.datepicker.dpDiv),d.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);if(typeof a=="string"&&(a=="isDisabled"||a=="getDate"||a=="widget"))return d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b));if(a=="option"&&arguments.length==2&&typeof arguments[1]=="string")return d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b));return this.each(function(){typeof a=="string"?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this].concat(b)):d.datepicker._attachDatepicker(this,a)})},d.datepicker=new M,d.datepicker.initialized=!1,d.datepicker.uuid=(new Date).getTime(),d.datepicker.version="1.8.13",window["DP_jQuery_"+z]=d}(jQuery),function(a,b){a.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove(),a.Widget.prototype.destroy.apply(this,arguments)},value:function(a){if(a===b)return this._value();this._setOption("value",a);return this},_setOption:function(b,c){b==="value"&&(this.options.value=c,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var a=this.options.value;typeof a!=="number"&&(a=0);return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var a=this.value(),b=this._percentage();this.oldValue!==a&&(this.oldValue=a,this._trigger("change")),this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(b.toFixed(0)+"%"),this.element.attr("aria-valuenow",a)}}),a.extend(a.ui.progressbar,{version:"1.8.13"})}(jQuery),jQuery.effects||function(a,b){function i(b){if(!b||typeof b==="number"||a.fx.speeds[b])return!0;if(typeof b==="string"&&!a.effects[b])return!0;return!1}function h(b,c,d,e){typeof b=="object"&&(e=c,d=null,c=b,b=c.effect),a.isFunction(c)&&(e=c,d=null,c={});if(typeof c=="number"||a.fx.speeds[c])e=d,d=c,c={};a.isFunction(d)&&(e=d,d=null),c=c||{},d=d||c.duration,d=a.fx.off?0:typeof d=="number"?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,e=e||c.complete;return[b,c,d,e]}function g(a,b){var c={_:0},d;for(d in b)a[d]!=b[d]&&(c[d]=b[d]);return c}function f(b){var c,d;for(c in b)d=b[c],(d==null||a.isFunction(d)||c in l||/scrollbar/.test(c)||!/color/i.test(c)&&isNaN(parseFloat(d)))&&delete b[c];return b}function e(){var a=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,b={},c,d;if(a&&a.length&&a[0]&&a[a[0]])for(var e=a.length;e--;)c=a[e],typeof a[c]=="string"&&(d=c.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),b[d]=a[c]);else for(c in a)typeof a[c]==="string"&&(b[c]=a[c]);return b}function d(b,d){var e;do{e=a.curCSS(b,d);if(e!=""&&e!="transparent"||a.nodeName(b,"body"))break;d="backgroundColor"}while(b=b.parentNode);return c(e)}function c(b){var c;if(b&&b.constructor==Array&&b.length==3)return b;if(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))return[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)];if(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))return[parseFloat(c[1])*2.55,parseFloat(c[2])*2.55,parseFloat(c[3])*2.55];if(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)];if(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)];if(/rgba\(0, 0, 0, 0\)/.exec(b))return j.transparent;return j[a.trim(b).toLowerCase()]}a.effects={},a.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(b,e){a.fx.step[e]=function(a){a.colorInit||(a.start=d(a.elem,e),a.end=c(a.end),a.colorInit=!0),a.elem.style[e]="rgb("+Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)+")"}});var j={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},k=["add","remove","toggle"],l={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.effects.animateClass=function(b,c,d,h){a.isFunction(d)&&(h=d,d=null);return this.queue(function(){var i=a(this),j=i.attr("style")||" ",l=f(e.call(this)),m,n=i.attr("class");a.each(k,function(a,c){b[c]&&i[c+"Class"](b[c])}),m=f(e.call(this)),i.attr("class",n),i.animate(g(l,m),{queue:!1,duration:c,easding:d,complete:function(){a.each(k,function(a,c){b[c]&&i[c+"Class"](b[c])}),typeof i.attr("style")=="object"?(i.attr("style").cssText="",i.attr("style").cssText=j):i.attr("style",j),h&&h.apply(this,arguments),a.dequeue(this)}})})},a.fn.extend({_addClass:a.fn.addClass,addClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{add:b},c,d,e]):this._addClass(b)},_removeClass:a.fn.removeClass,removeClass:function(b,c,d,e){return c?a.effects.animateClass.apply(this,[{remove:b},c,d,e]):this._removeClass(b)},_toggleClass:a.fn.toggleClass,toggleClass:function(c,d,e,f,g){return typeof d=="boolean"||d===b?e?a.effects.animateClass.apply(this,[d?{add:c}:{remove:c},e,f,g]):this._toggleClass(c,d):a.effects.animateClass.apply(this,[{toggle:c},d,e,f])},switchClass:function(b,c,d,e,f){return a.effects.animateClass.apply(this,[{add:c,remove:b},d,e,f])}}),a.extend(a.effects,{version:"1.8.13",save:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.data("ec.storage."+b[c],a[0].style[b[c]])},restore:function(a,b){for(var c=0;c<b.length;c++)b[c]!==null&&a.css(b[c],a.data("ec.storage."+b[c]))},setMode:function(a,b){b=="toggle"&&(b=a.is(":hidden")?"show":"hide");return b},getBaseline:function(a,b){var c;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":a=0;break;case"center":a=.5;break;case"right":a=1;break;default:a=a[1]/b.width}return{x:a,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});b.wrap(d),d=b.parent(),b.css("position")=="static"?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"}));return d.css(c).show()},removeWrapper:function(a){if(a.parent().is(".ui-effects-wrapper"))return a.parent().replaceWith(a);return a},setTransition:function(b,c,d,e){e=e||{},a.each(c,function(a,c){unit=b.cssUnit(c),unit[0]>0&&(e[c]=unit[0]*d+unit[1])});return e}}),a.fn.extend({effect:function(b){var c=h.apply(this,arguments),d={options:c[1],duration:c[2],callback:c[3]};c=d.options.mode;var e=a.effects[b];if(a.fx.off||!e)return c?this[c](d.duration,d.callback):this.each(function(){d.callback&&d.callback.call(this)});return e.call(this,d)},_show:a.fn.show,show:function(a){if(i(a))return this._show.apply(this,arguments);var b=h.apply(this,arguments);b[1].mode="show";return this.effect.apply(this,b)},_hide:a.fn.hide,hide:function(a){if(i(a))return this._hide.apply(this,arguments);var b=h.apply(this,arguments);b[1].mode="hide";return this.effect.apply(this,b)},__toggle:a.fn.toggle,toggle:function(b){if(i(b)||typeof b==="boolean"||a.isFunction(b))return this.__toggle.apply(this,arguments);var c=h.apply(this,arguments);c[1].mode="toggle";return this.effect.apply(this,c)},cssUnit:function(b){var c=this.css(b),d=[];a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])});return d}}),a.easing.jswing=a.easing.swing,a.extend(a.easing,{def:"easeOutQuad",swing:function(b,c,d,e,f){return a.easing[a.easing.def](b,c,d,e,f)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b+c;return-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b+c;return d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b*b+c;return-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b*b*b+c;return d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){if(b==0)return c;if(b==e)return c+d;if((b/=e/2)<1)return d/2*Math.pow(2,10*(b-1))+c;return d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){if((b/=e/2)<1)return-d/2*(Math.sqrt(1-b*b)-1)+c;return d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){a=1.70158;var f=0,g=d;if(b==0)return c;if((b/=e)==1)return c+d;f||(f=e*.3),g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return-(g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f))+c},easeOutElastic:function(a,b,c,d,e){a=1.70158;var f=0,g=d;if(b==0)return c;if((b/=e)==1)return c+d;f||(f=e*.3),g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*b)*Math.sin((b*e-a)*2*Math.PI/f)+d+c},easeInOutElastic:function(a,b,c,d,e){a=1.70158;var f=0,g=d;if(b==0)return c;if((b/=e/2)==2)return c+d;f||(f=e*.3*1.5),g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);if(b<1)return-.5*g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)+c;return g*Math.pow(2,-10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)*.5+d+c},easeInBack:function(a,c,d,e,f,g){g==b&&(g=1.70158);return e*(c/=f)*c*((g+1)*c-g)+d},easeOutBack:function(a,c,d,e,f,g){g==b&&(g=1.70158);return e*((c=c/f-1)*c*((g+1)*c+g)+1)+d},easeInOutBack:function(a,c,d,e,f,g){g==b&&(g=1.70158);if((c/=f/2)<1)return e/2*c*c*(((g*=1.525)+1)*c-g)+d;return e/2*((c-=2)*c*(((g*=1.525)+1)*c+g)+2)+d},easeInBounce:function(b,c,d,e,f){return e-a.easing.easeOutBounce(b,f-c,0,e,f)+d},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(b,c,d,e,f){if(c<f/2)return a.easing.easeInBounce(b,c*2,0,e,f)*.5+d;return a.easing.easeOutBounce(b,c*2-f,0,e,f)*.5+e*.5+d}})}(jQuery),function(a){a.effects.blind=function(c){return this.queue(function(){var d=a(this),e=["position","top","bottom","left","right"],f=a.effects.setMode(d,c.options.mode||"hide"),g=c.options.direction||"vertical";a.effects.save(d,e),d.show();var h=a.effects.createWrapper(d).css({overflow:"hidden"}),i=g=="vertical"?"height":"width";g=g=="vertical"?h.height():h.width(),f=="show"&&h.css(i,0);var j={};j[i]=f=="show"?g:0,h.animate(j,c.duration,c.options.easing,function(){f=="hide"&&d.hide(),a.effects.restore(d,e),a.effects.removeWrapper(d),c.callback&&c.callback.apply(d[0],arguments),d.dequeue()})})}}(jQuery),function(a){a.effects.bounce=function(b){return this.queue(function(){var c=a(this),d=["position","top","bottom","left","right"],f=a.effects.setMode(c,b.options.mode||"effect"),g=b.options.direction||"up",h=b.options.distance||20,i=b.options.times||5,j=b.duration||250;/show|hide/.test(f)&&d.push("opacity"),a.effects.save(c,d),c.show(),a.effects.createWrapper(c);var k=g=="up"||g=="down"?"top":"left";g=g=="up"||g=="left"?"pos":"neg",h=b.options.distance||(k=="top"?c.outerHeight({margin:!0})/3:c.outerWidth({margin:!0})/3),f=="show"&&c.css("opacity",0).css(k,g=="pos"?-h:h),f=="hide"&&(h/=i*2),f!="hide"&&i--;if(f=="show"){var l={opacity:1};l[k]=(g=="pos"?"+=":"-=")+h,c.animate(l,j/2,b.options.easing),h/=2,i--}for(l=0;l<i;l++){var m={},n={};m[k]=(g=="pos"?"-=":"+=")+h,n[k]=(g=="pos"?"+=":"-=")+h,c.animate(m,j/2,b.options.easing).animate(n,j/2,b.options.easing),h=f=="hide"?h*2:h/2}f=="hide"?(l={opacity:0},l[k]=(g=="pos"?"-=":"+=")+h,c.animate(l,j/2,b.options.easing,function(){c.hide(),a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)})):(m={},n={},m[k]=(g=="pos"?"-=":"+=")+h,n[k]=(g=="pos"?"+=":"-=")+h,c.animate(m,j/2,b.options.easing).animate(n,j/2,b.options.easing,function(){a.effects.restore(c,d),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)})),c.queue("fx",function(){c.dequeue()}),c.dequeue()})}}(jQuery),function(a){a.effects.clip=function(c){return this.queue(function(){var d=a(this),f=["position","top","bottom","left","right","height","width"],g=a.effects.setMode(d,c.options.mode||"hide"),h=c.options.direction||"vertical";a.effects.save(d,f),d.show();var i=a.effects.createWrapper(d).css({overflow:"hidden"});i=d[0].tagName=="IMG"?i:d;var j={size:h=="vertical"?"height":"width",position:h=="vertical"?"top":"left"};h=h=="vertical"?i.height():i.width(),g=="show"&&(i.css(j.size,0),i.css(j.position,h/2));var k={};k[j.size]=g=="show"?h:0,k[j.position]=g=="show"?0:h/2,i.animate(k,{queue:!1,duration:c.duration,easing:c.options.easing,complete:function(){g=="hide"&&d.hide(),a.effects.restore(d,f),a.effects.removeWrapper(d),c.callback&&c.callback.apply(d[0],arguments),d.dequeue()}})})}}(jQuery),function(a){a.effects.drop=function(b){return this.queue(function(){var e=a(this),f=["position","top","bottom","left","right","opacity"],g=a.effects.setMode(e,b.options.mode||"hide"),h=b.options.direction||"left";a.effects.save(e,f),e.show(),a.effects.createWrapper(e);var i=h=="up"||h=="down"?"top":"left";h=h=="up"||h=="left"?"pos":"neg";var j=b.options.distance||(i=="top"?e.outerHeight({margin:!0})/2:e.outerWidth({margin:!0})/2);g=="show"&&e.css("opacity",0).css(i,h=="pos"?-j:j);var k={opacity:g=="show"?1:0};k[i]=(g=="show"?h=="pos"?"+=":"-=":h=="pos"?"-=":"+=")+j,e.animate(k,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){g=="hide"&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),b.callback&&b.callback.apply(this,arguments),e.dequeue()}})})}}(jQuery),function(a){a.effects.explode=function(b){return this.queue(function(){var c=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3,d=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3;b.options.mode=b.options.mode=="toggle"?a(this).is(":visible")?"hide":"show":b.options.mode;var e=a(this).show().css("visibility","hidden"),f=e.offset();f.top-=parseInt(e.css("marginTop"),10)||0,f.left-=parseInt(e.css("marginLeft"),10)||0;for(var g=e.outerWidth(!0),h=e.outerHeight(!0),i=0;i<c;i++)for(var k=0;k<d;k++)e.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-k*(g/d),top:-i*(h/c)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:g/d,height:h/c,left:f.left+k*(g/d)+(b.options.mode=="show"?(k-Math.floor(d/2))*(g/d):0),top:f.top+i*(h/c)+(b.options.mode=="show"?(i-Math.floor(c/2))*(h/c):0),opacity:b.options.mode=="show"?0:1}).animate({left:f.left+k*(g/d)+(b.options.mode=="show"?0:(k-Math.floor(d/2))*(g/d)),top:f.top+i*(h/c)+(b.options.mode=="show"?0:(i-Math.floor(c/2))*(h/c)),opacity:b.options.mode=="show"?1:0},b.duration||500);setTimeout(function(){b.options.mode=="show"?e.css({visibility:"visible"}):e.css({visibility:"visible"}).hide(),b.callback&&b.callback.apply(e[0]),e.dequeue(),a("div.ui-effects-explode").remove()},b.duration||500)})}}(jQuery),function(a){a.effects.fade=function(c){return this.queue(function(){var d=a(this),e=a.effects.setMode(d,c.options.mode||"hide");d.animate({opacity:e},{queue:!1,duration:c.duration,easing:c.options.easing,complete:function(){c.callback&&c.callback.apply(this,arguments),d.dequeue()}})})}}(jQuery),function(a){a.effects.fold=function(b){return this.queue(function(){var d=a(this),e=["position","top","bottom","left","right"],f=a.effects.setMode(d,b.options.mode||"hide"),g=b.options.size||15,h=!!b.options.horizFirst,i=b.duration?b.duration/2:a.fx.speeds._default/2;a.effects.save(d,e),d.show();var j=a.effects.createWrapper(d).css({overflow:"hidden"}),k=f=="show"!=h,l=k?["width","height"]:["height","width"];k=k?[j.width(),j.height()]:[j.height(),j.width()];var m=/([0-9]+)%/.exec(g);m&&(g=parseInt(m[1],10)/100*k[f=="hide"?0:1]),f=="show"&&j.css(h?{height:0,width:g}:{height:g,width:0}),h={},m={},h[l[0]]=f=="show"?k[0]:g,m[l[1]]=f=="show"?k[1]:0,j.animate(h,i,b.options.easing).animate(m,i,b.options.easing,function(){f=="hide"&&d.hide(),a.effects.restore(d,e),a.effects.removeWrapper(d),b.callback&&b.callback.apply(d[0],arguments),d.dequeue()})})}}(jQuery),function(a){a.effects.highlight=function(c){return this.queue(function(){var d=a(this),e=["backgroundImage","backgroundColor","opacity"],f=a.effects.setMode(d,c.options.mode||"show"),g={backgroundColor:d.css("backgroundColor")};f=="hide"&&(g.opacity=0),a.effects.save(d,e),d.show().css({backgroundImage:"none",backgroundColor:c.options.color||"#ffff99"}).animate(g,{queue:!1,duration:c.duration,easing:c.options.easing,complete:function(){f=="hide"&&d.hide(),a.effects.restore(d,e),f=="show"&&!a.support.opacity&&this.style.removeAttribute("filter"),c.callback&&c.callback.apply(this,arguments),d.dequeue()}})})}}(jQuery),function(a){a.effects.pulsate=function(b){return this.queue(function(){var c=a(this),e=a.effects.setMode(c,b.options.mode||"show");times=(b.options.times||5)*2-1,duration=b.duration?b.duration/2:a.fx.speeds._default/2,isVisible=c.is(":visible"),animateTo=0,isVisible||(c.css("opacity",0).show(),animateTo=1),(e=="hide"&&isVisible||e=="show"&&!isVisible)&&times--;for(e=0;e<times;e++)c.animate({opacity:animateTo},duration,b.options.easing),animateTo=(animateTo+1)%2;c.animate({opacity:animateTo},duration,b.options.easing,function(){animateTo==0&&c.hide(),b.callback&&b.callback.apply(this,arguments)}),c.queue("fx",function(){c.dequeue()}).dequeue()})}}(jQuery),function(a){a.effects.puff=function(b){return this.queue(function(){var d=a(this),e=a.effects.setMode(d,b.options.mode||"hide"),f=parseInt(b.options.percent,10)||150,g=f/100,h={height:d.height(),width:d.width()};a.extend(b.options,{fade:!0,mode:e,percent:e=="hide"?f:100,from:e=="hide"?h:{height:h.height*g,width:h.width*g}}),d.effect("scale",b.options,b.duration,b.callback),d.dequeue()})},a.effects.scale=function(b){return this.queue(function(){var d=a(this),e=a.extend(!0,{},b.options),f=a.effects.setMode(d,b.options.mode||"effect"),g=parseInt(b.options.percent,10)||(parseInt(b.options.percent,10)==0?0:f=="hide"?0:100),h=b.options.direction||"both",i=b.options.origin;f!="effect"&&(e.origin=i||["middle","center"],e.restore=!0),i={height:d.height(),width:d.width()},d.from=b.options.from||(f=="show"?{height:0,width:0}:i),g={y:h!="horizontal"?g/100:1,x:h!="vertical"?g/100:1},d.to={height:i.height*g.y,width:i.width*g.x},b.options.fade&&(f=="show"&&(d.from.opacity=0,d.to.opacity=1),f=="hide"&&(d.from.opacity=1,d.to.opacity=0)),e.from=d.from,e.to=d.to,e.mode=f,d.effect("size",e,b.duration,b.callback),d.dequeue()})},a.effects.size=function(b){return this.queue(function(){var d=a(this),e=["position","top","bottom","left","right","width","height","overflow","opacity"],f=["position","top","bottom","left","right","overflow","opacity"],g=["width","height","overflow"],h=["fontSize"],i=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],j=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],k=a.effects.setMode(d,b.options.mode||"effect"),l=b.options.restore||!1,m=b.options.scale||"both",n=b.options.origin,o={height:d.height(),width:d.width()};d.from=b.options.from||o,d.to=b.options.to||o,n&&(n=a.effects.getBaseline(n,o),d.from.top=(o.height-d.from.height)*n.y,d.from.left=(o.width-d.from.width)*n.x,d.to.top=(o.height-d.to.height)*n.y,d.to.left=(o.width-d.to.width)*n.x);var p={from:{y:d.from.height/o.height,x:d.from.width/o.width},to:{y:d.to.height/o.height,x:d.to.width/o.width}};if(m=="box"||m=="both")p.from.y!=p.to.y&&(e=e.concat(i),d.from=a.effects.setTransition(d,i,p.from.y,d.from),d.to=a.effects.setTransition(d,i,p.to.y,d.to)),p.from.x!=p.to.x&&(e=e.concat(j),d.from=a.effects.setTransition(d,j,p.from.x,d.from),d.to=a.effects.setTransition(d,j,p.to.x,d.to));if(m=="content"||m=="both")p.from.y!=p.to.y&&(e=e.concat(h),d.from=a.effects.setTransition(d,h,p.from.y,d.from),d.to=a.effects.setTransition(d,h,p.to.y,d.to));a.effects.save(d,l?e:f),d.show(),a.effects.createWrapper(d),d.css("overflow","hidden").css(d.from);if(m=="content"||m=="both")i=i.concat(["marginTop","marginBottom"]).concat(h),j=j.concat(["marginLeft","marginRight"]),g=e.concat(i).concat(j),d.find("*[width]").each(function(){child=a(this),l&&a.effects.save(child,g);var d={height:child.height(),width:child.width()};child.from={height:d.height*p.from.y,width:d.width*p.from.x},child.to={height:d.height*p.to.y,width:d.width*p.to.x},p.from.y!=p.to.y&&(child.from=a.effects.setTransition(child,i,p.from.y,child.from),child.to=a.effects.setTransition(child,i,p.to.y,child.to)),p.from.x!=p.to.x&&(child.from=a.effects.setTransition(child,j,p.from.x,child.from),child.to=a.effects.setTransition(child,j,p.to.x,child.to)),child.css(child.from),child.animate(child.to,b.duration,b.options.easing,function(){l&&a.effects.restore(child,g)})});d.animate(d.to,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){d.to.opacity===0&&d.css("opacity",d.from.opacity),k=="hide"&&d.hide(),a.effects.restore(d,l?e:f),a.effects.removeWrapper(d),b.callback&&b.callback.apply(this,arguments),d.dequeue()}})})}}(jQuery),function(a){a.effects.shake=function(b){return this.queue(function(){var c=a(this),e=["position","top","bottom","left","right"];a.effects.setMode(c,b.options.mode||"effect");var f=b.options.direction||"left",g=b.options.distance||20,h=b.options.times||3,i=b.duration||b.options.duration||140;a.effects.save(c,e),c.show(),a.effects.createWrapper(c);var j=f=="up"||f=="down"?"top":"left",k=f=="up"||f=="left"?"pos":"neg";f={};var l={},m={};f[j]=(k=="pos"?"-=":"+=")+g,l[j]=(k=="pos"?"+=":"-=")+g*2,m[j]=(k=="pos"?"-=":"+=")+g*2,c.animate(f,i,b.options.easing);for(g=1;g<h;g++)c.animate(l,i,b.options.easing).animate(m,i,b.options.easing);c.animate(l,i,b.options.easing).animate(f,i/2,b.options.easing,function(){a.effects.restore(c,e),a.effects.removeWrapper(c),b.callback&&b.callback.apply(this,arguments)}),c.queue("fx",function(){c.dequeue()}),c.dequeue()})}}(jQuery),function(a){a.effects.slide=function(b){return this.queue(function(){var e=a(this),f=["position","top","bottom","left","right"],g=a.effects.setMode(e,b.options.mode||"show"),h=b.options.direction||"left";a.effects.save(e,f),e.show(),a.effects.createWrapper(e).css({overflow:"hidden"});var i=h=="up"||h=="down"?"top":"left";h=h=="up"||h=="left"?"pos":"neg";var j=b.options.distance||(i=="top"?e.outerHeight({margin:!0}):e.outerWidth({margin:!0}));g=="show"&&e.css(i,h=="pos"?isNaN(j)?"-"+j:-j:j);var k={};k[i]=(g=="show"?h=="pos"?"+=":"-=":h=="pos"?"-=":"+=")+j,e.animate(k,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){g=="hide"&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),b.callback&&b.callback.apply(this,arguments),e.dequeue()}})})}}(jQuery),function(a){a.effects.transfer=function(b){return this.queue(function(){var c=a(this),d=a(b.options.to),f=d.offset();d={top:f.top,left:f.left,height:d.innerHeight(),width:d.innerWidth()},f=c.offset();var g=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.options.className).css({top:f.top,left:f.left,height:c.innerHeight(),width:c.innerWidth(),position:"absolute"}).animate(d,b.duration,b.options.easing,function(){g.remove(),b.callback&&b.callback.apply(c[0],arguments),c.dequeue()})})}}(jQuery),define("lib/jquery/jquery.ui",function(){}),function(a){a.widget("ech.notify",{options:{speed:500,expires:5e3,stack:"below",custom:!1},_create:function(){var b=this;this.templates={},this.keys=[],this.element.addClass("ui-notify").children().addClass("ui-notify-message ui-notify-message-style").each(function(c){c=this.id||c,b.keys.push(c),b.templates[c]=a(this).removeAttr("id").wrap("<div></div>").parent().html()}).end().empty().show()},create:function(b,c,e){typeof b==="object"&&(e=c,c=b,b=null),b=this.templates[b||this.keys[0]],e&&e.custom&&(b=a(b).removeClass("ui-notify-message-style").wrap("<div></div>").parent().html());return(new a.ech.notify.instance(this))._create(c,a.extend({},this.options,e),b)}}),a.extend(a.ech.notify,{instance:function(a){this.parent=a,this.isOpen=!1}}),a.extend(a.ech.notify.instance.prototype,{_create:function(b,c,e){this.options=c;var f=this;e=e.replace(/#(?:\{|%7B)(.*?)(?:\}|%7D)/g,function(a,c){return c in b?b[c]:""}),e=this.element=a(e);var g=e.find(".ui-notify-close");typeof this.options.click==="function"&&e.addClass("ui-notify-click").bind("click",function(a){f._trigger("click",a,f)}),g.length&&g.bind("click",function(){f.close();return!1}),this.open(),typeof c.expires==="number"&&window.setTimeout(function(){f.close()},c.expires);return this},close:function(){var a=this,b=this.options.speed;this.isOpen=!1,this.element.fadeTo(b,0).slideUp(b,function(){a._trigger("close")});return this},open:function(){if(this.isOpen||this._trigger("beforeopen")===!1)return this;var a=this;this.isOpen=!0,this.element[this.options.stack==="above"?"prependTo":"appendTo"](this.parent.element).css({display:"none",opacity:""}).fadeIn(this.options.speed,function(){a._trigger("open")});return this},widget:function(){return this.element},_trigger:function(a,b,c){return this.parent._trigger.call(this,a,b,c)}})}(jQuery),define("lib/jquery/jquery.notify",function(){}),function(a){elFinder=function(b,c){function g(){f(null,d.dialog.height()-d.view.tlb.parent().height()-(a.browser.msie?47:32))}function f(a,b){a&&d.view.win.width(a),b&&d.view.nav.add(d.view.cwd).height(b)}var d=this,e;this.log=function(a){window.console&&window.console.log&&window.console.log(a)},this.options=a.extend({},this.options,c||{});if(this.options.url){this.id="",(e=a(b).attr("id"))?this.id=e:this.id="el-finder-"+Math.random().toString().substring(2),this.version="1.2",this.jquery=a.fn.jquery.split(".").join(""),this.cwd={},this.cdc={},this.buffer={},this.selected=[],this.history=[],this.locked=!1,this.zIndex=2,this.dialog=null,this.anchor=this.options.docked?a("<div/>").hide().insertBefore(b):null,this.params={dotFiles:!1,arc:"",uplMaxSize:""},this.vCookie="el-finder-view-"+this.id,this.pCookie="el-finder-places-"+this.id,this.lCookie="el-finder-last-"+this.id,this.view=new this.view(this,b),this.ui=new this.ui(this),this.eventsManager=new this.eventsManager(this),this.quickLook=new this.quickLook(this),this.cookie=function(b,c){if(typeof c=="undefined"){if(document.cookie&&document.cookie!=""){var d,e=document.cookie.split(";");b+="=";for(d=0;d<e.length;d++){e[d]=a.trim(e[d]);if(e[d].substring(0,b.length)==b)return decodeURIComponent(e[d].substring(b.length))}}return""}var f,g=a.extend({},this.options.cookie);c===null&&(c="",g.expires=-1),typeof g.expires=="number"&&(f=new Date,f.setTime(f.getTime()+g.expires*24*60*60*1e3),g.expires=f),document.cookie=b+"="+encodeURIComponent(c)+"; expires="+g.expires.toUTCString()+(g.path?"; path="+g.path:"")+(g.domain?"; domain="+g.domain:"")+(g.secure?"; secure":"")},this.lock=function(a){this.view.spinner(this.locked=a||!1),this.eventsManager.lock=this.locked},this.lockShortcuts=function(a){this.eventsManager.lock=a},this.setView=function(a){if(a=="list"||a=="icons")this.options.view=a,this.cookie(this.vCookie,a)},this.ajax=function(b,c,e){var f={url:this.options.url,async:!0,type:"GET",data:b,dataType:"json",cache:!1,lock:!0,force:!1,silent:!1};typeof e=="object"&&(f=a.extend({},f,e)),f.silent||(f.error=d.view.fatal),f.success=function(a){f.lock&&d.lock();if(a){a.debug&&d.log(a.debug);if(a.error){!f.silent&&d.view.error(a.error,a.errorData);if(!f.force)return}c(a),delete a}},f.lock&&this.lock(!0),a.ajax(f)},this.tmb=function(){this.ajax({cmd:"tmb",current:d.cwd.hash},function(b){if(d.options.view=="icons"&&b.images&&b.current==d.cwd.hash){for(var c in b.images)d.cdc[c]&&(d.cdc[c].tmb=b.images[c],a('div[key="'+c+'"]>p',d.view.cwd).css("background",' url("'+b.images[c]+'") 0 0 no-repeat'));b.tmb&&d.tmb()}},{lock:!1,silent:!0})},this.getPlaces=function(){var a=[],b=this.cookie(this.pCookie);b.length&&(b.indexOf(":")!=-1?a=b.split(":"):a.push(b));return a},this.addPlace=function(b){var c=this.getPlaces();if(a.inArray(b,c)==-1){c.push(b),this.savePlaces(c);return!0}},this.removePlace=function(b){var c=this.getPlaces();if(a.inArray(b,c)!=-1){this.savePlaces(a.map(c,function(a){return a==b?null:a}));return!0}},this.savePlaces=function(a){this.cookie(this.pCookie,a.join(":"))},this.reload=function(a){var b;this.cwd=a.cwd,this.cdc={};for(b=0;b<a.cdc.length;b++)a.cdc[b].hash&&a.cdc[b].name&&(this.cdc[a.cdc[b].hash]=a.cdc[b],this.cwd.size+=a.cdc[b].size);a.tree&&(this.view.renderNav(a.tree),this.eventsManager.updateNav()),this.updateCwd(),a.tmb&&!d.locked&&d.options.view=="icons"&&d.tmb();if(a.select&&a.select.length){var c=a.select.length;while(c--)this.cdc[a.select[c]]&&this.selectById(a.select[c])}this.lastDir(this.cwd.hash),this.options.autoReload>0&&(this.iID&&clearInterval(this.iID),this.iID=setInterval(function(){!d.locked&&d.ui.exec("reload")},this.options.autoReload*6e4))},this.updateCwd=function(){this.lockShortcuts(!0),this.selected=[],this.view.renderCwd(),this.eventsManager.updateCwd(),this.view.tree.find('a[key="'+this.cwd.hash+'"]').trigger("select"),this.lockShortcuts()},this.drop=function(b,c,e){if(c.helper.find('[key="'+e+'"]').length)return d.view.error("Unable to copy into itself");var f=[];c.helper.find('div:not(.noaccess):has(>label):not(:has(em[class="readonly"],em[class=""]))').each(function(){f.push(a(this).hide().attr("key"))}),c.helper.find("div:has(>label):visible").length||c.helper.hide(),f.length?(d.setBuffer(f,b.shiftKey?0:1,e),d.buffer.files&&setTimeout(function(){d.ui.exec("paste"),d.buffer={}},300)):a(this).removeClass("el-finder-droppable")},this.getSelected=function(a){var b,c=[];if(a>=0)return this.cdc[this.selected[a]]||{};for(b=0;b<this.selected.length;b++)this.cdc[this.selected[b]]&&c.push(this.cdc[this.selected[b]]);return c},this.select=function(b,c){c&&a(".ui-selected",d.view.cwd).removeClass("ui-selected"),b.addClass("ui-selected"),d.updateSelect()},this.selectById=function(b){var c=a('[key="'+b+'"]',this.view.cwd);c.length&&(this.select(c),this.checkSelectedPos())},this.unselect=function(a){a.removeClass("ui-selected"),d.updateSelect()},this.toggleSelect=function(a){a.toggleClass("ui-selected"),this.updateSelect()},this.selectAll=function(){a("[key]",d.view.cwd).addClass("ui-selected"),d.updateSelect()},this.unselectAll=function(){a(".ui-selected",d.view.cwd).removeClass("ui-selected"),d.updateSelect()},this.updateSelect=function(){d.selected=[],a(".ui-selected",d.view.cwd).each(function(){d.selected.push(a(this).attr("key"))}),d.view.selectedInfo(),d.ui.update(),d.quickLook.update()},this.checkSelectedPos=function(a){var b=d.view.cwd.find(".ui-selected:"+(a?"last":"first")).eq(0),c=b.position(),e=b.outerHeight(),f=d.view.cwd.height();c.top<0?d.view.cwd.scrollTop(c.top+d.view.cwd.scrollTop()-2):f-c.top<e&&d.view.cwd.scrollTop(c.top+e-f+d.view.cwd.scrollTop())},this.setBuffer=function(a,b,c){var d,e,f;this.buffer={src:this.cwd.hash,dst:c,files:[],names:[],cut:b||0};for(d=0;d<a.length;d++)e=a[d],f=this.cdc[e],f&&f.read&&f.type!="link"&&(this.buffer.files.push(f.hash),this.buffer.names.push(f.name));this.buffer.files.length||(this.buffer={})},this.isValidName=function(a){if(!this.cwd.dotFiles&&a.indexOf(".")==0)return!1;return a.match(/^[^\\\/\<\>:]+$/)},this.fileExists=function(a){for(var b in this.cdc)if(this.cdc[b].name==a)return b;return!1},this.uniqueName=function(a,b){a=d.i18n(a);var c=a,e=0,b=b||"";if(!this.fileExists(c+b))return c+b;while(e++<100)if(!this.fileExists(c+e+b))return c+e+b;return c.replace("100","")+Math.random()+b},this.lastDir=function(a){if(this.options.rememberLastDir)return a?this.cookie(this.lCookie,a):this.cookie(this.lCookie)},this.time=function(){return(new Date).getMilliseconds()},this.setView(this.cookie(this.vCookie)),f(d.options.width,d.options.height);if(this.options.dialog||this.options.docked)this.options.dialog=a.extend({width:570,dialogClass:"",minWidth:480,minHeight:330},this.options.dialog||{}),this.options.dialog.open=function(){setTimeout(function(){a('<input type="text" value="f"/>').appendTo(d.view.win).focus().select().remove()},200)},this.options.dialog.dialogClass+="el-finder-dialog",this.options.dialog.resize=g,this.options.docked?(this.options.dialog.close=function(){d.dock()},this.view.win.data("size",{width:this.view.win.width(),height:this.view.nav.height()})):(this.options.dialog.close=function(){d.destroy()},this.dialog=a("<div/>").append(this.view.win).dialog(this.options.dialog));this.ajax({cmd:"open",target:this.lastDir()||"",init:!0,tree:!0},function(b){b.cwd&&(d.eventsManager.init(),d.reload(b),a.extend(d.params,b.params||{}),a("*",document.body).each(function(){var b=parseInt(a(this).css("z-index"));b>=d.zIndex&&(d.zIndex=b+1)}),d.ui.init(b.disabled))},{force:!0}),this.open=function(){this.dialog?this.dialog.dialog("open"):this.view.win.show(),this.eventsManager.lock=!1},this.close=function(){this.quickLook.hide(),this.options.docked&&this.view.win.attr("undocked")?this.dock():this.dialog?this.dialog.dialog("close"):this.view.win.hide(),this.eventsManager.lock=!0},this.destroy=function(){this.eventsManager.lock=!0,this.quickLook.hide(),this.quickLook.win.remove(),this.dialog?(this.dialog.dialog("destroy"),this.view.win.parent().remove()):this.view.win.remove(),this.ui.menu.remove()},this.dock=function(){if(this.options.docked&&this.view.win.attr("undocked")){this.quickLook.hide();var a=this.view.win.data("size");this.view.win.insertAfter(this.anchor).removeAttr("undocked"),f(a.width,a.height),this.dialog.dialog("destroy"),this.dialog=null}},this.undock=function(){this.options.docked&&!this.view.win.attr("undocked")&&(this.quickLook.hide(),this.dialog=a("<div/>").append(this.view.win.css("width","100%").attr("undocked",!0).show()).dialog(this.options.dialog),g())}}else alert("Invalid configuration! You have to set URL option.")},elFinder.prototype.i18n=function(a){return this.options.i18n[this.options.lang]&&this.options.i18n[this.options.lang][a]?this.options.i18n[this.options.lang][a]:a},elFinder.prototype.options={url:"",lang:"en",cssClass:"",wrap:14,places:"Places",placesFirst:!0,editorCallback:null,cutURL:"",closeOnEditorCallback:!0,i18n:{},view:"icons",width:"",height:"",disableShortcuts:!1,rememberLastDir:!0,cookie:{expires:30,domain:"",path:"/",secure:!1},toolbar:[["back","reload"],["select","open"],["mkdir","mkfile","upload"],["copy","paste","rm"],["rename","edit"],["info","quicklook","resize"],["icons","list"],["help"]],contextmenu:{cwd:["reload","delim","mkdir","mkfile","upload","delim","paste","delim","info"],file:["select","open","quicklook","delim","copy","cut","rm","delim","duplicate","rename","edit","resize","archive","extract","delim","info"],group:["select","copy","cut","rm","delim","archive","extract","delim","info"]},dialog:null,docked:!1,autoReload:0,selectMultiple:!1},a.fn.elfinder=function(a){return this.each(function(){var b=typeof a=="string"?a:"";this.elfinder||(this.elfinder=new elFinder(this,typeof a=="object"?a:{}));switch(b){case"close":console.log("CLOSE?");break;case"hide":this.elfinder.close();break;case"open":break;case"show":this.elfinder.open();break;case"dock":this.elfinder.dock();break;case"undock":this.elfinder.undock();break;case"destroy":console.log("DESTROY?"),this.elfinder.destroy()}})}}(jQuery),function(a){elFinder.prototype.view=function(b,c){var d=this;this.fm=b,this.kinds={unknown:"Unknown",directory:"Folder",symlink:"Alias","symlink-broken":"Broken alias","application/x-empty":"Plain text","application/postscript":"Postscript document","application/octet-stream":"Application","application/vnd.ms-office":"Microsoft Office document","application/vnd.ms-word":"Microsoft Word document","application/vnd.ms-excel":"Microsoft Excel document","application/vnd.ms-powerpoint":"Microsoft Powerpoint presentation","application/pdf":"Portable Document Format (PDF)","application/vnd.oasis.opendocument.text":"Open Office document","application/x-shockwave-flash":"Flash application","application/xml":"XML document","application/x-bittorrent":"Bittorrent file","application/x-7z-compressed":"7z archive","application/x-tar":"TAR archive","application/x-gzip":"GZIP archive","application/x-bzip2":"BZIP archive","application/zip":"ZIP archive","application/x-rar":"RAR archive","application/javascript":"Javascript application","text/plain":"Plain text","text/x-php":"PHP source","text/html":"HTML document","text/javascript":"Javascript source","text/css":"CSS style sheet","text/rtf":"Rich Text Format (RTF)","text/rtfd":"RTF with attachments (RTFD)","text/x-c":"C source","text/x-c++":"C++ source","text/x-shellscript":"Unix shell script","text/x-python":"Python source","text/x-java":"Java source","text/x-ruby":"Ruby source","text/x-perl":"Perl script","text/xml":"XML document","image/x-ms-bmp":"BMP image","image/jpeg":"JPEG image","image/gif":"GIF Image","image/png":"PNG image","image/x-targa":"TGA image","image/tiff":"TIFF image","image/vnd.adobe.photoshop":"Adobe Photoshop image","audio/mpeg":"MPEG audio","audio/midi":"MIDI audio","audio/ogg":"Ogg Vorbis audio","audio/mp4":"MP4 audio","audio/wav":"WAV audio","video/x-dv":"DV video","video/mp4":"MP4 video","video/mpeg":"MPEG video","video/x-msvideo":"AVI video","video/quicktime":"Quicktime video","video/x-ms-wmv":"WM video","video/x-flv":"Flash video","video/x-matroska":"Matroska video"},this.tlb=a("<ul />"),this.nav=a('<div class="el-finder-nav"/>').resizable({handles:"e",autoHide:!0,minWidth:200,maxWidth:500}),this.cwd=a('<div class="el-finder-cwd"/>').attr("unselectable","on"),this.spn=a('<div class="el-finder-spinner"/>'),this.err=a('<p class="el-finder-err"><strong/></p>').click(function(){a(this).hide()}),this.nfo=a('<div class="el-finder-stat"/>'),this.pth=a('<div class="el-finder-path"/>'),this.sel=a('<div class="el-finder-sel"/>'),this.stb=a('<div class="el-finder-statusbar"/>').append(this.pth).append(this.nfo).append(this.sel),this.wrz=a('<div class="el-finder-workzone" />').append(this.nav).append(this.cwd).append(this.spn).append(this.err).append('<div style="clear:both" />'),this.win=a(c).empty().attr("id",this.fm.id).addClass("el-finder "+(b.options.cssClass||"")).append(a('<div class="el-finder-toolbar" />').append(this.tlb)).append(this.wrz).append(this.stb),this.tree=a('<ul class="el-finder-tree"></ul>').appendTo(this.nav),this.plc=a('<ul class="el-finder-places"><li><a href="#" class="el-finder-places-root"><div/>'+this.fm.i18n(this.fm.options.places)+"</a><ul/></li></ul>").hide(),this.nav[this.fm.options.placesFirst?"prepend":"append"](this.plc),this.spinner=function(a){this.win.toggleClass("el-finder-disabled",a),this.spn.toggle(a)},this.fatal=function(a){d.error(a.status!="404"?"Invalid backend configuration":"Unable to connect to backend")},this.error=function(a,b){this.fm.lock(),this.err.show().children("strong").html(this.fm.i18n(a)+"!"+this.formatErrorData(b)),setTimeout(function(){d.err.fadeOut("slow")},4e3)},this.renderNav=function(a){function d(a){var b,c,e,f='<ul style="display:none">';for(b=0;b<a.length;b++){if(!a[b].name||!a[b].hash)continue;e="",a[b].read||a[b].write?a[b].read?a[b].write||(e="readonly"):e="dropbox":e="noaccess",f+='<li><a href="#" class="'+e+'" key="'+a[b].hash+'"><div'+(a[b].dirs.length?' class="collapsed"':"")+"/>"+a[b].name+"</a>",a[b].dirs.length&&(f+=d(a[b].dirs)),f+="</li>"}return f+"</ul>"}var b=a.dirs.length?d(a.dirs):"",c='<li><a href="#" class="el-finder-tree-root" key="'+a.hash+'"><div'+(b?' class="collapsed expanded"':"")+"/>"+a.name+"</a>"+b+"</li>";this.tree.html(c),this.fm.options.places&&this.renderPlaces()},this.renderPlaces=function(){var b,c,e=this.fm.getPlaces(),f=this.plc.show().find("ul").empty().hide();a("div:first",this.plc).removeClass("collapsed expanded");if(e.length){e.sort(function(a,b){var c=d.tree.find('a[key="'+a+'"]').text()||"",e=d.tree.find('a[key="'+b+'"]').text()||"";return c.localeCompare(e)});for(b=0;b<e.length;b++)(c=this.tree.find('a[key="'+e[b]+'"]:not(.dropbox)').parent())&&c.length?f.append(c.clone().children("ul").remove().end().find("div").removeClass("collapsed expanded").end()):this.fm.removePlace(e[b]);f.children().length&&a("div:first",this.plc).addClass("collapsed")}},this.renderCwd=function(){this.cwd.empty();var a=0,c=0,d="";for(var e in this.fm.cdc)a++,c+=this.fm.cdc[e].size,d+=this.fm.options.view=="icons"?this.renderIcon(this.fm.cdc[e]):this.renderRow(this.fm.cdc[e],a%2);this.fm.options.view=="icons"?this.cwd.append(d):this.cwd.append('<table><tr><th colspan="2">'+this.fm.i18n("Name")+"</th><th>"+this.fm.i18n("Permissions")+"</th><th>"+this.fm.i18n("Modified")+'</th><th class="size">'+this.fm.i18n("Size")+"</th><th>"+this.fm.i18n("Kind")+"</th></tr>"+d+"</table>"),this.pth.text(b.cwd.rel),this.nfo.text(b.i18n("items")+": "+a+", "+this.formatSize(c)),this.sel.empty()},this.renderIcon=function(a){var b="<p"+(a.tmb?" style=\"background:url('"+a.tmb+"') 0 0 no-repeat\"":"")+"/><label>"+this.formatName(a.name)+"</label>";if(a.link||a.mime=="symlink-broken")b+="<em/>";a.read||a.write?a.read&&!a.write?b+='<em class="readonly"/>':!a.read&&a.write&&(b+='<em class="'+(a.mime=="directory"?"dropbox":"noread")+'" />'):b+='<em class="noaccess"/>';return'<div class="'+this.mime2class(a.mime)+'" key="'+a.hash+'">'+b+"</div>"},this.renderRow=function(a,b){var c=a.link||a.mime=="symlink-broken"?"<em/>":"";a.read||a.write?a.read&&!a.write?c+='<em class="readonly"/>':!a.read&&a.write&&(c+='<em class="'+(a.mime=="directory"?"dropbox":"noread")+'" />'):c+='<em class="noaccess"/>';return'<tr key="'+a.hash+'" class="'+d.mime2class(a.mime)+(b?" el-finder-row-odd":"")+'"><td class="icon"><p>'+c+"</p></td><td>"+a.name+"</td><td>"+d.formatPermissions(a.read,a.write,a.rm)+"</td><td>"+d.formatDate(a.date)+'</td><td class="size">'+d.formatSize(a.size)+"</td><td>"+d.mime2kind(a.link?"symlink":a.mime)+"</td></tr>"},this.updateFile=function(a){var b=this.cwd.find('[key="'+a.hash+'"]');b.replaceWith(b[0].nodeName=="DIV"?this.renderIcon(a):this.renderRow(a))},this.selectedInfo=function(){var a,b=0,c;if(d.fm.selected.length){c=this.fm.getSelected();for(a=0;a<c.length;a++)b+=c[a].size}this.sel.text(a>0?this.fm.i18n("selected items")+": "+c.length+", "+this.formatSize(b):"")},this.formatName=function(a){var b=d.fm.options.wrap;if(b>0){if(a.length>b*2)return a.substr(0,b)+"&shy;"+a.substr(b,b-5)+"&hellip;"+a.substr(a.length-3);if(a.length>b)return a.substr(0,b)+"&shy;"+a.substr(b)}return a},this.formatErrorData=function(a){var b,c="";if(typeof a=="object"){c="<br />";for(b in a)c+=b+" "+d.fm.i18n(a[b])+"<br />"}return c},this.mime2class=function(a){return a.replace("/"," ").replace(/\./g,"-")},this.formatDate=function(a){return a.replace(/([a-z]+)\s/i,function(a,b){return d.fm.i18n(b)+" "})},this.formatSize=function(a){var b=1,c="bytes";a>1073741824?(b=1073741824,c="Gb"):a>1048576?(b=1048576,c="Mb"):a>1024&&(b=1024,c="Kb");return Math.round(a/b)+" "+c},this.formatPermissions=function(a,b,c){var e=[];a&&e.push(d.fm.i18n("read")),b&&e.push(d.fm.i18n("write")),c&&e.push(d.fm.i18n("remove"));return e.join("/")},this.mime2kind=function(a){return this.fm.i18n(this.kinds[a]||"unknown")}}}(jQuery),function(a){elFinder.prototype.ui=function(b){var c=this;this.fm=b,this.cmd={},this.buttons={},this.menu=a('<div class="el-finder-contextmenu" />').appendTo(document.body).hide(),this.dockButton=a('<div class="el-finder-dock-button" title="'+c.fm.i18n("Dock/undock filemanager window")+'" />'),this.exec=function(b,c){if(this.cmd[b]){if(b!="open"&&!this.cmd[b].isAllowed())return this.fm.view.error("Command not allowed");this.fm.locked||(this.fm.quickLook.hide(),a(".el-finder-info").remove(),this.cmd[b].exec(c),this.update())}},this.cmdName=function(a){if(this.cmd[a]&&this.cmd[a].name)return a=="archive"&&this.fm.params.archives.length==1?this.fm.i18n("Create")+" "+this.fm.view.mime2kind(this.fm.params.archives[0]).toLowerCase():this.fm.i18n(this.cmd[a].name);return a},this.isCmdAllowed=function(a){return c.cmd[a]&&c.cmd[a].isAllowed()},this.execIfAllowed=function(a){this.isCmdAllowed(a)&&this.exec(a)},this.includeInCm=function(a,b){return this.isCmdAllowed(a)&&this.cmd[a].cm(b)},this.showMenu=function(b){function h(a){var b,d,e,f,g,h=c.fm.options.contextmenu[a]||[];for(b=0;b<h.length;b++)if(h[b]=="delim")c.menu.children().length&&!c.menu.children(":last").hasClass("delim")&&c.menu.append('<div class="delim" />');else if(c.fm.ui.includeInCm(h[b],a)){e=c.cmd[h[b]].argc(),f="";if(e.length){f='<span/><div class="el-finder-contextmenu-sub" style="z-index:'+(parseInt(c.menu.css("z-index"))+1)+'">';for(var d=0;d<e.length;d++)f+='<div name="'+h[b]+'" argc="'+e[d].argc+'" class="'+e[d]["class"]+'">'+e[d].text+"</div>";f+="</div>"}c.menu.append('<div class="'+h[b]+'" name="'+h[b]+'">'+f+c.cmdName(h[b])+"</div>")}}var d,e,f,g="";this.hideMenu(),c.fm.selected.length?c.fm.selected.length==1?d="file":d="group":d="cwd",h(d),e=a(window),f={height:e.height(),width:e.width(),sT:e.scrollTop(),cW:this.menu.width(),cH:this.menu.height()},this.menu.css({left:b.clientX+f.cW>f.width?b.clientX-f.cW:b.clientX,top:b.clientY+f.cH>f.height&&b.clientY>f.cH?b.clientY+f.sT-f.cH:b.clientY+f.sT}).show().find("div[name]").hover(function(){var b=a(this),c=b.children("div"),d;b.addClass("hover"),c.length&&(c.attr("pos")||(d=b.outerWidth(),c.css(a(window).width()-d-b.offset().left>c.width()?"left":"right",d-5).attr("pos",!0)),c.show())},function(){a(this).removeClass("hover").children("div").hide()}).click(function(b){b.stopPropagation();var d=a(this);d.children("div").length||(c.hideMenu(),c.exec(d.attr("name"),d.attr("argc")))})},this.hideMenu=function(){this.menu.hide().empty()},this.update=function(){for(var a in this.buttons)this.buttons[a].toggleClass("disabled",!this.cmd[a].isAllowed())},this.init=function(b){var d,e,f,g=!1,h=2,i,j=this.fm.options.toolbar;this.fm.options.editorCallback||b.push("select"),!this.fm.params.archives.length&&a.inArray("archive",b)==-1&&b.push("archive");for(d in this.commands)a.inArray(d,b)==-1&&(this.commands[d].prototype=this.command.prototype,this.cmd[d]=new this.commands[d](this.fm));for(d=0;d<j.length;d++){g&&this.fm.view.tlb.append('<li class="delim" />'),g=!1;for(e=0;e<j[d].length;e++)f=j[d][e],this.cmd[f]&&(g=!0,this.buttons[f]=a('<li class="'+f+'" title="'+this.cmdName(f)+'" name="'+f+'" />').appendTo(this.fm.view.tlb).click(function(a){a.stopPropagation()}).bind("click",function(b){return function(){!a(this).hasClass("disabled")&&b.exec(a(this).attr("name"))}}(this)).hover(function(){!a(this).hasClass("disabled")&&a(this).addClass("el-finder-tb-hover")},function(){a(this).removeClass("el-finder-tb-hover")}))}this.update(),this.menu.css("z-index",this.fm.zIndex),this.fm.options.docked&&this.dockButton.hover(function(){a(this).addClass("el-finder-dock-button-hover")},function(){a(this).removeClass("el-finder-dock-button-hover")}).click(function(){c.fm.view.win.attr("undocked")?c.fm.dock():c.fm.undock(),a(this).trigger("mouseout")}).prependTo(this.fm.view.tlb)}},elFinder.prototype.ui.prototype.command=function(a){},elFinder.prototype.ui.prototype.command.prototype.isAllowed=function(){return!0},elFinder.prototype.ui.prototype.command.prototype.cm=function(a){return!1},elFinder.prototype.ui.prototype.command.prototype.argc=function(a){return[]},elFinder.prototype.ui.prototype.commands={back:function(a){var b=this;this.name="Back",this.fm=a,this.exec=function(){this.fm.history.length&&this.fm.ajax({cmd:"open",target:this.fm.history.pop()},function(a){b.fm.reload(a)})},this.isAllowed=function(){return this.fm.history.length}},reload:function(a){var b=this;this.name="Reload",this.fm=a,this.exec=function(){this.fm.ajax({cmd:"open",target:this.fm.cwd.hash,tree:!0},function(a){b.fm.reload(a)})},this.cm=function(a){return a=="cwd"}},open:function(b){var c=this;this.name="Open",this.fm=b,this.exec=function(b){function f(a){var b,d="";a.dim&&(b=a.dim.split("x"),d="width="+(parseInt(b[0])+20)+",height="+(parseInt(b[1])+20)+","),window.open(a.url||c.fm.options.url+"?cmd=open&current="+(a.parent||c.fm.cwd.hash)+"&target="+(a.link||a.hash),!1,"top=50,left=50,"+d+"scrollbars=yes,resizable=yes")}function e(a){c.fm.history.push(c.fm.cwd.hash),c.fm.ajax({cmd:"open",target:a},function(a){c.fm.reload(a)})}var d=null;b?d={hash:a(b).attr("key"),mime:"directory",read:!a(b).hasClass("noaccess")&&!a(b).hasClass("dropbox")}:d=this.fm.getSelected(0);if(d.hash){if(!d.read)return this.fm.view.error("Access denied");if(d.type=="link"&&!d.link)return this.fm.view.error("Unable to open broken link");d.mime=="directory"?e(d.link||d.hash):f(d)}},this.isAllowed=function(){return this.fm.selected.length==1&&this.fm.getSelected(0).read},this.cm=function(a){return a=="file"}},select:function(b){this.name="Select file",this.fm=b,b.options.selectMultiple?this.exec=function(){var c=a(b.getSelected()).map(function(){return b.options.cutURL=="root"?this.url.substr(b.params.url.length):this.url.replace(new RegExp("^("+b.options.cutURL+")"),"")});b.options.editorCallback(c),b.options.closeOnEditorCallback&&(b.dock(),b.close(),this.fm.destroy(),this.fm.lockShortcuts(!0))}:(console.log("SINGLE"),this.exec=function(){var a=this.fm.getSelected(0);if(!a.url)return this.fm.view.error("File URL disabled by connector config");this.fm.options.editorCallback(this.fm.options.cutURL=="root"?a.url.substr(this.fm.params.url.length):a.url.replace(new RegExp("^("+this.fm.options.cutURL+")"),"")),this.fm.options.closeOnEditorCallback&&(this.fm.dock(),this.fm.close(),this.fm.destroy(),this.fm.lockShortcuts(!0))}),this.isAllowed=function(){return(this.fm.options.selectMultiple&&this.fm.selected.length>=1||this.fm.selected.length==1)&&!/(symlink\-broken|directory)/.test(this.fm.getSelected(0).mime)},this.cm=function(a){return a!="cwd"}},quicklook:function(a){var b=this;this.name="Preview with Quick Look",this.fm=a,this.exec=function(){b.fm.quickLook.toggle()},this.isAllowed=function(){return this.fm.selected.length==1},this.cm=function(){return!0}},info:function(b){var c=this;this.name="Get info",this.fm=b,this.exec=function(){function h(b){var d=["50%","50%"],h,i,j,k='<table cellspacing="0"><tr><td>'+c.fm.i18n("Name")+"</td><td>"+b.name+"</td></tr><tr><td>"+c.fm.i18n("Kind")+"</td><td>"+c.fm.view.mime2kind(b.link?"symlink":b.mime)+"</td></tr><tr><td>"+c.fm.i18n("Size")+"</td><td>"+c.fm.view.formatSize(b.size)+"</td></tr><tr><td>"+c.fm.i18n("Modified")+"</td><td>"+c.fm.view.formatDate(b.date)+"</td></tr><tr><td>"+c.fm.i18n("Permissions")+"</td><td>"+c.fm.view.formatPermissions(b.read,b.write,b.rm)+"</td></tr>";b.link&&(k+="<tr><td>"+c.fm.i18n("Link to")+"</td><td>"+b.linkTo+"</td></tr>"),b.dim&&(k+="<tr><td>"+c.fm.i18n("Dimensions")+"</td><td>"+b.dim+" px.</td></tr>"),b.url&&(k+="<tr><td>"+c.fm.i18n("URL")+'</td><td><a href="'+b.url+'" target="_blank">'+b.url+"</a></td></tr>"),e>1&&(j=a(".el-finder-dialog-info:last"),j.length?(h=j.offset().left+10,i=j.offset().top+10,d=[h<f-350?h:20,i<g-300?i:20]):(h=Math.round((f-350)/2-e*10),i=Math.round((g-300)/2-e*10),d=[h>20?h:20,i>20?i:20])),a("<div />").append(k+"</table>").dialog({dialogClass:"el-finder-dialog el-finder-dialog-info",width:390,position:d,title:c.fm.i18n(b.mime=="directory"?"Folder info":"File info"),close:function(){--e<=0&&c.fm.lockShortcuts(),a(this).dialog("destroy")},buttons:{Ok:function(){a(this).dialog("close")}}})}var b,d,e=this.fm.selected.length,f=a(window).width(),g=a(window).height();this.fm.lockShortcuts(!0),e?a.each(this.fm.getSelected(),function(){h(this)}):h(c.fm.cwd)},this.cm=function(a){return!0}},rename:function(b){var c=this;this.name="Rename",this.fm=b,this.exec=function(){function j(){if(!c.fm.locked){var a,b=f.val();if(g.name==f.val())return i();c.fm.isValidName(b)?c.fm.fileExists(b)&&(a="File or folder with the same name already exists"):a="Invalid name";if(a){c.fm.view.error(a),d.addClass("ui-selected"),c.fm.lockShortcuts(!0);return f.select().focus()}c.fm.ajax({cmd:"rename",current:c.fm.cwd.hash,target:g.hash,name:b},function(a){a.error?i():(g.mime=="directory"&&c.fm.removePlace(g.hash)&&c.fm.addPlace(a.target),c.fm.reload(a))},{force:!0})}}function i(){e.html(h),c.fm.lockShortcuts()}var b=this.fm.getSelected(),d,e,f,g,h;b.length==1&&(g=b[0],d=this.fm.view.cwd.find('[key="'+g.hash+'"]'),e=this.fm.options.view=="icons"?d.children("label"):d.find("td").eq(1),h=e.html(),f=a('<input type="text" />').val(g.name).appendTo(e.empty()).bind("change blur",j).keydown(function(b){b.stopPropagation(),b.keyCode==27?i():b.keyCode==13&&(g.name==f.val()?i():a(this).trigger("change"))}).click(function(a){a.stopPropagation()}).select().focus(),this.fm.lockShortcuts(!0))},this.isAllowed=function(){return this.fm.cwd.write&&this.fm.getSelected(0).write},this.cm=function(a){return a=="file"}},copy:function(a){this.name="Copy",this.fm=a,this.exec=function(){this.fm.setBuffer(this.fm.selected)},this.isAllowed=function(){if(this.fm.selected.length){var a=this.fm.getSelected(),b=a.length;while(b--)if(a[b].read)return!0}return!1},this.cm=function(a){return a!="cwd"}},cut:function(a){this.name="Cut",this.fm=a,this.exec=function(){this.fm.setBuffer(this.fm.selected,1)},this.isAllowed=function(){if(this.fm.selected.length){var a=this.fm.getSelected(),b=a.length;while(b--)if(a[b].read&&a[b].rm)return!0}return!1},this.cm=function(a){return a!="cwd"}},paste:function(a){var b=this;this.name="Paste",this.fm=a,this.exec=function(){var a,c,d,e,f="";this.fm.buffer.dst||(this.fm.buffer.dst=this.fm.cwd.hash),c=this.fm.view.tree.find('[key="'+this.fm.buffer.dst+'"]');if(!c.length||c.hasClass("noaccess")||c.hasClass("readonly"))return this.fm.view.error("Access denied");if(this.fm.buffer.src==this.fm.buffer.dst)return this.fm.view.error("Unable to copy into itself");var g={cmd:"paste",current:this.fm.cwd.hash,src:this.fm.buffer.src,dst:this.fm.buffer.dst,cut:this.fm.buffer.cut};this.fm.jquery>132?g.targets=this.fm.buffer.files:g["targets[]"]=this.fm.buffer.files,this.fm.ajax(g,function(a){a.cdc&&b.fm.reload(a)},{force:!0})},this.isAllowed=function(){return this.fm.buffer.files},this.cm=function(a){return a=="cwd"}},rm:function(b){var c=this;this.name="Remove",this.fm=b,this.exec=function(){var b,d=[],e=this.fm.getSelected();for(var b=0;b<e.length;b++){if(!e[b].rm)return this.fm.view.error(e[b].name+": "+this.fm.i18n("Access denied"));d.push(e[b].hash)}d.length&&(this.fm.lockShortcuts(!0),a('<div><div class="ui-state-error ui-corner-all"><span class="ui-icon ui-icon-alert"/><strong>'+this.fm.i18n("Are you sure you want to remove files?<br /> This cannot be undone!")+"</strong></div></div>").dialog({title:this.fm.i18n("Confirmation required"),dialogClass:"el-finder-dialog",width:350,close:function(){c.fm.lockShortcuts()},buttons:{Cancel:function(){a(this).dialog("close")},Ok:function(){a(this).dialog("close");var b={cmd:"rm",current:c.fm.cwd.hash};c.fm.jquery>132?b.targets=d:b["targets[]"]=d,c.fm.ajax(b,function(a){a.tree&&c.fm.reload(a)},{force:!0})}}}))},this.isAllowed=function(a){if(this.fm.selected.length){var b=this.fm.getSelected(),c=b.length;while(c--)if(b[c].rm)return!0}return!1},this.cm=function(a){return a!="cwd"}},mkdir:function(b){var c=this;this.name="New folder",this.fm=b,this.exec=function(){function d(){if(!c.fm.locked){var a,b=input.val();c.fm.isValidName(b)?c.fm.fileExists(b)&&(a="File or folder with the same name already exists"):a="Invalid name";if(a){c.fm.view.error(a),c.fm.lockShortcuts(!0),el.addClass("ui-selected");return input.select().focus()}c.fm.ajax({cmd:"mkdir",current:c.fm.cwd.hash,name:b},function(a){if(a.error){el.addClass("ui-selected");return input.select().focus()}c.fm.reload(a)},{force:!0})}}c.fm.unselectAll();var b=this.fm.uniqueName("untitled folder");input=a('<input type="text"/>').val(b),prev=this.fm.view.cwd.find(".directory:last"),f={name:b,hash:"",mime:"directory",read:!0,write:!0,date:"",size:0},el=this.fm.options.view=="list"?a(this.fm.view.renderRow(f)).children("td").eq(1).empty().append(input).end().end():a(this.fm.view.renderIcon(f)).children("label").empty().append(input).end(),el.addClass("directory ui-selected"),prev.length?el.insertAfter(prev):this.fm.options.view=="list"?el.insertAfter(this.fm.view.cwd.find("tr").eq(0)):el.prependTo(this.fm.view.cwd),c.fm.checkSelectedPos(),input.select().focus().click(function(a){a.stopPropagation()}).bind("change blur",d).keydown(function(a){a.stopPropagation(),a.keyCode==27?(el.remove(),c.fm.lockShortcuts()):a.keyCode==13&&d()}),c.fm.lockShortcuts(!0)},this.isAllowed=function(){return this.fm.cwd.write},this.cm=function(a){return a=="cwd"}},mkfile:function(b){var c=this;this.name="New text file",this.fm=b,this.exec=function(){function g(){if(!c.fm.locked){var a,b=d.val();c.fm.isValidName(b)?c.fm.fileExists(b)&&(a="File or folder with the same name already exists"):a="Invalid name";if(a){c.fm.view.error(a),c.fm.lockShortcuts(!0),f.addClass("ui-selected");return d.select().focus()}c.fm.ajax({cmd:"mkfile",current:c.fm.cwd.hash,name:b},function(a){if(a.error){f.addClass("ui-selected");return d.select().focus()}c.fm.reload(a)},{force:!0})}}c.fm.unselectAll();var b=this.fm.uniqueName("untitled file",".txt"),d=a('<input type="text"/>').val(b),e={name:b,hash:"",mime:"text/plain",read:!0,write:!0,date:"",size:0},f=this.fm.options.view=="list"?a(this.fm.view.renderRow(e)).children("td").eq(1).empty().append(d).end().end():a(this.fm.view.renderIcon(e)).children("label").empty().append(d).end();f.addClass("text ui-selected").appendTo(this.fm.options.view=="list"?c.fm.view.cwd.children("table"):c.fm.view.cwd),d.select().focus().bind("change blur",g).click(function(a){a.stopPropagation()}).keydown(function(a){a.stopPropagation(),a.keyCode==27?(f.remove(),c.fm.lockShortcuts()):a.keyCode==13&&g()}),c.fm.lockShortcuts(!0)},this.isAllowed=function(a){return this.fm.cwd.write},this.cm=function(a){return a=="cwd"}},upload:function(b){var c=this;this.name="Upload files",this.fm=b,this.exec=function(){function m(){function l(){c.fm.lock(),d.remove()}function k(){try{h=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;if(h.body==null||h.body.innerHTML==""){if(--f)return setTimeout(k,100);l();return c.fm.view.error("Unable to access iframe DOM after 50 tries")}i=a(h.body).html(),c.fm.jquery<141?/^[\],:{}\s]*$/.test(i.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?j=window.JSON&&window.JSON.parse?window.JSON.parse(i):(new Function("return "+i))():j={error:"Unable to parse server response"}:j=a.parseJSON(i)}catch(b){j={error:"Unable to parse server response"}}l(),j.error&&c.fm.view.error(j.error,j.errorData),j.cwd&&c.fm.reload(j),j.tmb&&c.fm.tmb()}var d=a('<iframe name="'+b+'" name="'+b+'" src="about:blank"/>'),e=d[0],f=50,h,i,j;d.css({position:"absolute",top:"-1000px",left:"-1000px"}).appendTo("body").bind("load",function(){d.unbind("load"),k()}),c.fm.lock(!0),g.submit()}function l(a){d.show().find("div").empty().text(a)}var b="el-finder-io-"+(new Date).getTime(),d=a('<div class="ui-state-error ui-corner-all"><span class="ui-icon ui-icon-alert"/><div/></div>'),e=this.fm.params.uplMaxSize?"<p>"+this.fm.i18n("Maximum allowed files size")+": "+this.fm.params.uplMaxSize+"</p>":"",f=a('<p class="el-finder-add-field"><span class="ui-state-default ui-corner-all"><em class="ui-icon ui-icon-circle-plus"/></span>'+this.fm.i18n("Add field")+"</p>").click(function(){a(this).before('<p><input type="file" name="upload[]"/></p>')}),g='<form method="post" enctype="multipart/form-data" action="'+c.fm.options.url+'" target="'+b+'"><input type="hidden" name="cmd" value="upload" /><input type="hidden" name="current" value="'+c.fm.cwd.hash+'" />',h=a("<div/>"),i=3;while(i--)g+='<p><input type="file" name="upload[]"/></p>';var j=a("meta[name=csrf-token]").attr("content"),k=a("meta[name=csrf-param]").attr("content");k!=null&&j!=null&&(g+='<input name="'+k+'" value="'+j+'" type="hidden" />'),g=a(g+"</form>"),h.append(g.append(d.hide()).prepend(e).append(f)).dialog({dialogClass:"el-finder-dialog",title:c.fm.i18n("Upload files"),modal:!0,resizable:!1,close:function(){c.fm.lockShortcuts(!0)},buttons:{Cancel:function(){a(this).dialog("close")},Ok:function(){if(!a(":file[value]",g).length)return l(c.fm.i18n("Select at least one file to upload"));setTimeout(function(){c.fm.lock(),a.browser.safari?a.ajax({url:c.fm.options.url,data:{cmd:"ping"},error:m,success:m}):m()}),a(this).dialog("close")}}}),c.fm.lockShortcuts(!0)},this.isAllowed=function(){return this.fm.cwd.write},this.cm=function(a){return a=="cwd"}},duplicate:function(a){var b=this;this.name="Duplicate",this.fm=a,this.exec=function(){this.fm.ajax({cmd:"duplicate",current:this.fm.cwd.hash,target:this.fm.selected[0]},function(a){b.fm.reload(a)})},this.isAllowed=function(){return this.fm.cwd.write&&this.fm.selected.length==1&&this.fm.getSelected()[0].read},this.cm=function(a){return a=="file"}},edit:function(b){var c=this;this.name="Edit text file",this.fm=b,this.exec=function(){var b=this.fm.getSelected(0);this.fm.lockShortcuts(!0),this.fm.ajax({cmd:"read",current:this.fm.cwd.hash,target:b.hash},function(d){c.fm.lockShortcuts(!0);var e=a("<textarea/>").val(d.content||"").keydown(function(b){b.stopPropagation();if(b.keyCode==9){b.preventDefault();if(a.browser.msie){var c=document.selection.createRange();c.text="\t"+c.text,this.focus()}else{var d=this.value.substr(0,this.selectionStart),e=this.value.substr(this.selectionEnd);this.value=d+"\t"+e,this.setSelectionRange(d.length+1,d.length+1)}}});a("<div/>").append(e).dialog({dialogClass:"el-finder-dialog",title:c.fm.i18n(c.name),modal:!0,width:500,close:function(){c.fm.lockShortcuts()},buttons:{Cancel:function(){a(this).dialog("close")},Ok:function(){var d=e.val();a(this).dialog("close"),c.fm.ajax({cmd:"edit",current:c.fm.cwd.hash,target:b.hash,content:d},function(a){a.target&&(c.fm.cdc[a.target.hash]=a.target,c.fm.view.updateFile(a.target),c.fm.selectById(a.target.hash))},{type:"POST"})}}})})},this.isAllowed=function(){if(c.fm.selected.length==1){var a=this.fm.getSelected()[0];return a.write&&a.read&&(a.mime.indexOf("text")==0||a.mime=="application/x-empty"||a.mime=="application/xml")}},this.cm=function(a){return a=="file"}},archive:function(b){var c=this;this.name="Create archive",this.fm=b,this.exec=function(b){var d={cmd:"archive",current:c.fm.cwd.hash,type:a.inArray(b,this.fm.params.archives)!=-1?b:this.fm.params.archives[0],name:c.fm.i18n("Archive")};this.fm.jquery>132?d.targets=c.fm.selected:d["targets[]"]=c.fm.selected,this.fm.ajax(d,function(a){c.fm.reload(a)})},this.isAllowed=function(){if(this.fm.cwd.write&&this.fm.selected.length){var a=this.fm.getSelected(),b=a.length;while(b--)if(a[b].read)return!0}return!1},this.cm=function(a){return a!="cwd"},this.argc=function(){var a,b=[];for(a=0;a<c.fm.params.archives.length;a++)b.push({"class":"archive",argc:c.fm.params.archives[a],text:c.fm.view.mime2kind(c.fm.params.archives[a])});return b}},extract:function(b){var c=this;this.name="Uncompress archive",this.fm=b,this.exec=function(){this.fm.ajax({cmd:"extract",current:this.fm.cwd.hash,target:this.fm.getSelected(0).hash},function(a){c.fm.reload(a)})},this.isAllowed=function(){var b=this.fm.params.extract,c=b&&b.length;return this.fm.cwd.write&&this.fm.selected.length==1&&this.fm.getSelected(0).read&&c&&a.inArray(this.fm.getSelected(0).mime,b)!=-1},this.cm=function(a){return a=="file"}},resize:function(b){var c=this;this.name="Resize image",this.fm=b,this.exec=function(){function j(){var a=parseInt(iw.val())||0,b=parseInt(ih.val())||0;a>0&&b>0?this==iw.get(0)?b=parseInt(a/h):a=parseInt(b*h):(a=e,b=g),iw.val(a),ih.val(b)}var b=this.fm.getSelected();if(b[0]&&b[0].write&&b[0].dim){var d=b[0].dim.split("x"),e=parseInt(d[0]),g=parseInt(d[1]),h=e/g;iw=a('<input type="text" size="9" value="'+e+'" name="width"/>'),ih=a('<input type="text" size="9" value="'+g+'" name="height"/>'),f=a("<form/>").append(iw).append(" x ").append(ih).append(" px"),iw.add(ih).bind("change",j),c.fm.lockShortcuts(!0);var i=a("<div/>").append(a("<div/>").text(c.fm.i18n("Dimensions")+":")).append(f).dialog({title:c.fm.i18n("Resize image"),dialogClass:"el-finder-dialog",width:230,modal:!0,close:function(){c.fm.lockShortcuts()},buttons:{Cancel:function(){a(this).dialog("close")},Ok:function(){var d=parseInt(iw.val())||0,f=parseInt(ih.val())||0;d>0&&d!=e&&f>0&&f!=g&&c.fm.ajax({cmd:"resize",current:c.fm.cwd.hash,target:b[0].hash,width:d,height:f},function(a){c.fm.reload(a)}),a(this).dialog("close")}}})}},this.isAllowed=function(){return this.fm.selected.length==1&&this.fm.cdc[this.fm.selected[0]].write&&this.fm.cdc[this.fm.selected[0]].read&&this.fm.cdc[this.fm.selected[0]].resize},this.cm=function(a){return a=="file"}},icons:function(b){this.name="View as icons",this.fm=b,this.exec=function(){this.fm.view.win.addClass("el-finder-disabled"),this.fm.setView("icons"),this.fm.updateCwd(),this.fm.view.win.removeClass("el-finder-disabled"),a("div.image",this.fm.view.cwd).length&&this.fm.tmb()},this.isAllowed=function(){return this.fm.options.view!="icons"},this.cm=function(a){return a=="cwd"}},list:function(a){this.name="View as list",this.fm=a,this.exec=function(){this.fm.view.win.addClass("el-finder-disabled"),this.fm.setView("list"),this.fm.updateCwd(),this.fm.view.win.removeClass("el-finder-disabled")},this.isAllowed=function(){return this.fm.options.view!="list"},this.cm=function(a){return a=="cwd"}},help:function(b){this.name="Help",this.fm=b,this.exec=function(){var b,c=this.fm.i18n("helpText"),d,e,f;b='<div class="el-finder-logo"/><strong>'+this.fm.i18n("elFinder: Web file manager")+"</strong><br/>"+this.fm.i18n("Version")+": "+this.fm.version+"<br/>jQuery/jQueryUI: "+a().jquery+"/"+a.ui.version+'<br clear="all"/><p><strong><a href="http://elrte.org/'+this.fm.options.lang+'/elfinder" target="_blank">'+this.fm.i18n("Donate to support project development")+'</a></strong></p><p><a href="http://elrte.org/redmine/projects/elfinder/wiki" target="_blank">'+this.fm.i18n("elFinder documentation")+"</a></p>",b+="<p>"+(c!="helpText"?c:"elFinder works similar to file manager on your computer. <br /> To make actions on files/folders use icons on top panel. If icon action it is not clear for you, hold mouse cursor over it to see the hint. <br /> Manipulations with existing files/folders can be done through the context menu (mouse right-click).<br/> To copy/delete a group of files/folders, select them using Shift/Alt(Command) + mouse left-click.")+"</p>",b+="<p><strong>"+this.fm.i18n("elFinder support following shortcuts")+":</strong><ul><li><kbd>Ctrl+A</kbd> - "+this.fm.i18n("Select all files")+"</li><li><kbd>Ctrl+C/Ctrl+X/Ctrl+V</kbd> - "+this.fm.i18n("Copy/Cut/Paste files")+"</li><li><kbd>Enter</kbd> - "+this.fm.i18n("Open selected file/folder")+"</li><li><kbd>Space</kbd> - "+this.fm.i18n("Open/close QuickLook window")+"</li><li><kbd>Delete/Cmd+Backspace</kbd> - "+this.fm.i18n("Remove selected files")+"</li><li><kbd>Ctrl+I</kbd> - "+this.fm.i18n("Selected files or current directory info")+"</li><li><kbd>Ctrl+N</kbd> - "+this.fm.i18n("Create new directory")+"</li><li><kbd>Ctrl+U</kbd> - "+this.fm.i18n("Open upload files form")+"</li><li><kbd>Left arrow</kbd> - "+this.fm.i18n("Select previous file")+"</li><li><kbd>Right arrow </kbd> - "+this.fm.i18n("Select next file")+"</li><li><kbd>Ctrl+Right arrow</kbd> - "+this.fm.i18n("Open selected file/folder")+"</li><li><kbd>Ctrl+Left arrow</kbd> - "+this.fm.i18n("Return into previous folder")+"</li><li><kbd>Shift+arrows</kbd> - "+this.fm.i18n("Increase/decrease files selection")+"</li></ul></p><p>"+this.fm.i18n("Contacts us if you need help integrating elFinder in you products")+": dev@std42.ru</p>",d='<div class="el-finder-help-std"/><p>'+this.fm.i18n("Javascripts/PHP programming: Dmitry (dio) Levashov, dio@std42.ru")+"</p><p>"+this.fm.i18n("Python programming, techsupport: Troex Nevelin, troex@fury.scancode.ru")+"</p><p>"+this.fm.i18n("Design: Valentin Razumnih")+"</p><p>"+this.fm.i18n("Chezh localization")+": Roman Matna, info@romanmatena.cz</p><p>"+this.fm.i18n("Chinese (traditional) localization")+": Tad, tad0616@gmail.com</p><p>"+this.fm.i18n("Dutch localization")+': Kurt Aerts, <a href="http://ilabsolutions.net/" target="_blank">http://ilabsolutions.net</a></p><p>'+this.fm.i18n("Greek localization")+": Panagiotis Skarvelis</p><p>"+this.fm.i18n("Hungarian localization")+": Viktor Tamas, tamas.viktor@totalstudio.hu</p><p>"+this.fm.i18n("Italian localization")+":  Ugo Punzolo, sadraczerouno@gmail.com</p><p>"+this.fm.i18n("Latvian localization")+":  Uldis Ploti, uldis.plotins@gmail.com</p><p>"+this.fm.i18n("Poland localization")+":  Darek Wapiski, darek@wapinski.us</p><p>"+this.fm.i18n("Spanish localization")+': Alex (xand) Vavilin, xand@xand.es, <a href="http://xand.es" target="_blank">http://xand.es</a></p><p>'+this.fm.i18n("Icons")+': <a href="http://pixelmixer.ru/" target="_blank">pixelmixer</a>,  <a href="http://www.famfamfam.com/lab/icons/silk/" target="_blank">Famfam silk icons</a>, <a href="http://www.fatcow.com/free-icons/" target="_blank">Fatcow icons</a></p><p>'+this.fm.i18n('Copyright: <a href="http://www.std42.ru" target="_blank">Studio 42 LTD</a>')+"</p><p>"+this.fm.i18n("License: BSD License")+"</p><p>"+this.fm.i18n('Web site: <a href="http://elrte.org/elfinder/" target="_blank">elrte.org/elfinder</a>')+"</p>",e='<div class="el-finder-logo"/><strong><a href="http://www.eldorado-cms.ru" target="_blank">ELDORADO.CMS</a></strong><br/>'+this.fm.i18n("Simple and usefull Content Management System")+"<hr/>"+this.fm.i18n("Support project development and we will place here info about you"),f='<ul><li><a href="#el-finder-help-h">'+this.fm.i18n("Help")+'</a></li><li><a href="#el-finder-help-a">'+this.fm.i18n("Authors")+'</a><li><a href="#el-finder-help-sp">'+this.fm.i18n("Sponsors")+'</a></li></ul><div id="el-finder-help-h"><p>'+b+'</p></div><div id="el-finder-help-a"><p>'+d+'</p></div><div id="el-finder-help-sp"><p>'+e+"</p></div>";var g=a("<div/>").html(f).dialog({width:617,title:this.fm.i18n("Help"),dialogClass:"el-finder-dialog",modal:!0,close:function(){g.tabs("destroy").dialog("destroy").remove()},buttons:{Ok:function(){a(this).dialog("close")}}}).tabs()},this.cm=function(a){return a=="cwd"}}}}(jQuery),function(a){elFinder.prototype.quickLook=function(b,c){function k(){var a=d.fm.getSelected(0);j(),d._hash=a.hash,d.title.text(a.name),d.win.addClass(d.fm.view.mime2class(a.mime)),d.name.text(a.name),d.kind.text(d.fm.view.mime2kind(a.link?"symlink":a.mime)),d.size.text(d.fm.view.formatSize(a.size)),d.date.text(d.fm.i18n("Modified")+": "+d.fm.view.formatDate(a.date)),a.dim&&d.add.append("<span>"+a.dim+" px</span>").show(),a.tmb&&d.ico.css("background",'url("'+a.tmb+'") 0 0 no-repeat');if(a.url){d.url.text(a.url).attr("href",a.url).show();for(var b in d.plugins)if(d.plugins[b].test&&d.plugins[b].test(a.mime,d.mimes,a.name)){d.plugins[b].show(d,a);return}}else d.url.hide();d.win.css({width:"420px",height:"auto"})}function j(){d.media.hide().empty(),d.win.attr("class","el-finder-ql").css("z-index",d.fm.zIndex),d.title.empty(),d.ico.attr("style","").show(),d.add.hide().empty(),d._hash=""}var d=this;this.fm=b,this._hash="",this.title=a("<strong/>"),this.ico=a("<p/>"),this.info=a("<label/>"),this.media=a('<div class="el-finder-ql-media"/>').hide(),this.name=a('<span class="el-finder-ql-name"/>'),this.kind=a('<span class="el-finder-ql-kind"/>'),this.size=a('<span class="el-finder-ql-size"/>'),this.date=a('<span class="el-finder-ql-date"/>'),this.url=a('<a href="#"/>').hide().click(function(b){b.preventDefault(),window.open(a(this).attr("href")),d.hide()}),this.add=a("<div/>"),this.content=a('<div class="el-finder-ql-content"/>'),this.win=a('<div class="el-finder-ql"/>').hide().append(a('<div class="el-finder-ql-drag-handle"/>').append(a('<span class="ui-icon ui-icon-circle-close"/>').click(function(){d.hide()})).append(this.title)).append(this.ico).append(this.media).append(this.content.append(this.name).append(this.kind).append(this.size).append(this.date).append(this.url).append(this.add)).appendTo("body").draggable({handle:".el-finder-ql-drag-handle"}).resizable({minWidth:420,minHeight:150,resize:function(){if(d.media.children().length){var a=d.media.children(":first");switch(a[0].nodeName){case"IMG":var b=a.width(),c=a.height(),e=d.win.width(),f=d.win.css("height")=="auto"?350:d.win.height()-d.content.height()-d.th,g=b>e||c>f?Math.min(Math.min(e,b)/b,Math.min(f,c)/c):Math.min(Math.max(e,b)/b,Math.max(f,c)/c);a.css({width:Math.round(a.width()*g),height:Math.round(a.height()*g)});break;case"IFRAME":case"EMBED":a.css("height",d.win.height()-d.content.height()-d.th);break;case"OBJECT":a.children("embed").css("height",d.win.height()-d.content.height()-d.th)}}}}),this.th=parseInt(this.win.children(":first").css("height"))||18,this.mimes={"image/jpeg":"jpg","image/gif":"gif","image/png":"png"};for(var e=0;e<navigator.mimeTypes.length;e++){var f=navigator.mimeTypes[e].type;f&&f!="*"&&(this.mimes[f]=navigator.mimeTypes[e].suffixes)}if(a.browser.safari&&navigator.platform.indexOf("Mac")!=-1||a.browser.msie)this.mimes["application/pdf"]="pdf";else for(var g=0;g<navigator.plugins.length;g++)for(var h=0;h<navigator.plugins[g].length;h++){var i=navigator.plugins[g][h].description.toLowerCase();if(i.substring(0,i.indexOf(" "))=="pdf"){this.mimes["application/pdf"]="pdf";break}}this.mimes["image/x-bmp"]&&(this.mimes["image/x-ms-bmp"]="bmp"),a.browser.msie&&!this.mimes["application/x-shockwave-flash"]&&(this.mimes["application/x-shockwave-flash"]="swf"),this.show=function(){if(this.win.is(":hidden")&&d.fm.selected.length==1){k();var b=d.fm.selected[0],c=d.fm.view.cwd.find('[key="'+b+'"]'),e=c.offset();d.fm.lockShortcuts(!0),this.win.css({width:c.width()-20,height:c.height(),left:e.left,top:e.top,opacity:0}).show().animate({width:420,height:150,opacity:1,top:Math.round(a(window).height()/5),left:a(window).width()/2-210},450,function(){d.win.css({height:"auto"}),d.fm.lockShortcuts()})}},this.hide=function(){if(this.win.is(":visible")){var a,b=d.fm.view.cwd.find('[key="'+this._hash+'"]');b?(a=b.offset(),this.media.hide(200),this.win.animate({width:b.width()-20,height:b.height(),left:a.left,top:a.top,opacity:0},350,function(){d.fm.lockShortcuts(),j(),d.win.hide().css("height","auto")})):(this.win.fadeOut(200),j(),d.fm.lockShortcuts())}},this.toggle=function(){this.win.is(":visible")?this.hide():this.show()},this.update=function(){this.fm.selected.length!=1?this.hide():this.win.is(":visible")&&this.fm.selected[0]!=this._hash&&k()},this.mediaHeight=function(){return this.win.is(":animated")||this.win.css("height")=="auto"?315:this.win.height()-this.content.height()-this.th}},elFinder.prototype.quickLook.prototype.plugins={image:new function(){this.test=function(a,b){return a.match(/^image\//)},this.show=function(b,c){function f(a){var c=a.width(),d=a.height(),e=b.win.is(":animated"),f=e?420:b.win.width(),g=e||b.win.css("height")=="auto"?315:b.win.height()-b.content.height()-b.th,h=c>f||d>g?Math.min(Math.min(f,c)/c,Math.min(g,d)/d):Math.min(Math.max(f,c)/c,Math.max(g,d)/d);b.fm.lockShortcuts(!0),b.ico.hide(),a.css({width:b.ico.width(),height:b.ico.height()}).show().animate({width:Math.round(h*c),height:Math.round(h*d)},450,function(){b.fm.lockShortcuts()})}var d,e;b.mimes[c.mime]&&c.hash==b._hash&&a("<img/>").hide().appendTo(b.media.show()).attr("src",c.url+(a.browser.msie||a.browser.opera?"?"+Math.random():"")).load(function(){e=a(this).unbind("load"),c.hash==b._hash&&(b.win.is(":animated")?setTimeout(function(){f(e)},330):f(e))})}},text:new function(){this.test=function(a,b){return a.indexOf("text")==0&&a.indexOf("rtf")==-1||a.match(/application\/(xml|javascript|json)/)},this.show=function(a,b){b.hash==a._hash&&(a.ico.hide(),a.media.append('<iframe src="'+b.url+'" style="height:'+a.mediaHeight()+'px" />').show())}},swf:new function(){this.test=function(a,b){return a=="application/x-shockwave-flash"&&b[a]},this.show=function(a,b){if(b.hash==a._hash){a.ico.hide();var c=a.media.append('<embed pluginspage="http://www.macromedia.com/go/getflashplayer" quality="high" src="'+b.url+'" style="width:100%;height:'+a.mediaHeight()+'px" type="application/x-shockwave-flash" />');a.win.is(":animated")?c.slideDown(450):c.show()}}},audio:new function(){this.test=function(a,b){return a.indexOf("audio")==0&&b[a]},this.show=function(a,b){if(b.hash==a._hash){a.ico.hide();var c=a.win.is(":animated")||a.win.css("height")=="auto"?100:a.win.height()-a.content.height()-a.th;a.media.append('<embed src="'+b.url+'" style="width:100%;height:'+c+'px" />').show()}}},video:new function(){this.test=function(a,b){return a.indexOf("video")==0&&b[a]},this.show=function(a,b){b.hash==a._hash&&(a.ico.hide(),a.media.append('<embed src="'+b.url+'" style="width:100%;height:'+a.mediaHeight()+'px" />').show())}},pdf:new function(){this.test=function(a,b){return a=="application/pdf"&&b[a]},this.show=function(a,b){b.hash==a._hash&&(a.ico.hide(),a.media.append('<embed src="'+b.url+'" style="width:100%;height:'+a.mediaHeight()+'px" />').show())}}}}(jQuery),function(a){elFinder.prototype.eventsManager=function(b,c){function e(b,c){var e,f,g;if(a("[key]",d.cwd).length){if(d.fm.selected.length==0)e=a("[key]:"+(b?"first":"last"),d.cwd),d.fm.select(e);else if(c)e=a(".ui-selected:"+(b?"last":"first"),d.cwd),f=e[b?"next":"prev"]("[key]"),f.length&&(e=f),d.fm.select(e,!0);else{d.pointer&&(g=a('[key="'+d.pointer+'"].ui-selected',d.cwd));if(!g||!g.length)g=a(".ui-selected:"+(b?"last":"first"),d.cwd);e=g[b?"next":"prev"]("[key]");if(e.length)if(e.hasClass("ui-selected"))if(g.hasClass("ui-selected")){f=g[b?"prev":"next"]("[key]");if(f.length&&f.hasClass("ui-selected")){while((f=b?e.next("[key]"):e.prev("[key]"))&&e.hasClass("ui-selected"))e=f;d.fm.select(e)}else d.fm.unselect(g)}else d.fm.unselect(e);else d.fm.select(e);else e=g}d.pointer=e.attr("key"),d.fm.checkSelectedPos(b)}}var d=this;this.lock=!1,this.fm=b,this.ui=b.ui,this.tree=b.view.tree,this.cwd=b.view.cwd,this.pointer="",this.init=function(){var b=this,c=!1;this.cwd.bind("click",function(c){var d=a(c.target);d.hasClass("ui-selected")?b.fm.unselectAll():(d.attr("key")||(d=d.parent("[key]")),c.ctrlKey||c.metaKey?b.fm.toggleSelect(d):b.fm.select(d,!0))}).bind(window.opera?"click":"contextmenu",function(d){if(!window.opera||d.ctrlKey){d.preventDefault(),d.stopPropagation();var e=a(d.target);a.browser.mozilla&&(c=!0),e.hasClass("el-finder-cwd")?b.fm.unselectAll():b.fm.select(e.attr("key")?e:e.parent("[key]")),b.fm.quickLook.hide(),b.fm.ui.showMenu(d)}}).selectable({filter:"[key]",delay:300,stop:function(){b.fm.updateSelect(),b.fm.log("mouseup")}}),a(document).bind("click",function(c){b.fm.ui.hideMenu(),a("input",b.cwd).trigger("change")}),this.tree.bind("select",function(c){b.tree.find("a").removeClass("selected"),a(c.target).addClass("selected").parents("li:has(ul)").children("ul").show().prev().children("div").addClass("expanded")}),this.fm.options.places&&(this.fm.view.plc.click(function(c){c.preventDefault();var d=a(c.target),e=d.attr("key"),f;if(e)e!=b.fm.cwd.hash&&b.ui.exec("open",c.target);else if(c.target.nodeName=="A"||c.target.nodeName=="DIV")f=b.fm.view.plc.find("ul"),f.children().length&&(f.toggle(300),b.fm.view.plc.children("li").find("div").toggleClass("expanded"))}),this.fm.view.plc.droppable({accept:"(div,tr).directory",tolerance:"pointer",over:function(){a(this).addClass("el-finder-droppable")},out:function(){a(this).removeClass("el-finder-droppable")},drop:function(c,d){a(this).removeClass("el-finder-droppable");var e=!1;d.helper.children(".directory:not(.noaccess,.dropbox)").each(function(){b.fm.addPlace(a(this).attr("key"))&&(e=!0,a(this).hide())}),e&&(b.fm.view.renderPlaces(),b.updatePlaces(),b.fm.view.plc.children("li").children("div").trigger("click")),d.helper.children("div:visible").length||d.helper.hide()}})),a(document).bind(a.browser.mozilla||a.browser.opera?"keypress":"keydown",function(a){var c=a.ctrlKey||a.metaKey;if(!b.lock)switch(a.keyCode){case 37:case 38:a.stopPropagation(),a.preventDefault(),a.keyCode==37&&c?b.ui.execIfAllowed("back"):e(!1,!a.shiftKey);break;case 39:case 40:a.stopPropagation(),a.preventDefault(),c?b.ui.execIfAllowed("open"):e(!0,!a.shiftKey)}}),a(document).bind(a.browser.opera?"keypress":"keydown",function(a){if(!b.lock)switch(a.keyCode){case 32:a.preventDefault(),a.stopPropagation(),b.fm.quickLook.toggle();break;case 27:b.fm.quickLook.hide()}}),this.fm.options.disableShortcuts||a(document).bind("keydown",function(a){var c=a.ctrlKey||a.metaKey;if(!b.lock)switch(a.keyCode){case 8:c&&b.ui.isCmdAllowed("rm")&&(a.preventDefault(),b.ui.exec("rm"));break;case 13:if(b.ui.isCmdAllowed("select"))return b.ui.exec("select");b.ui.execIfAllowed("open");break;case 46:b.ui.execIfAllowed("rm");break;case 65:c&&(a.preventDefault(),b.fm.selectAll());break;case 67:c&&b.ui.execIfAllowed("copy");break;case 73:c&&(a.preventDefault(),b.ui.exec("info"));break;case 78:c&&(a.preventDefault(),b.ui.execIfAllowed("mkdir"));break;case 85:c&&(a.preventDefault(),b.ui.execIfAllowed("upload"));break;case 86:c&&b.ui.execIfAllowed("paste");break;case 88:c&&b.ui.execIfAllowed("cut");break;case 113:b.ui.execIfAllowed("rename")}})},this.updateNav=function(){a("a",this.tree).click(function(b){b.preventDefault();var c=a(this),e;b.target.nodeName=="DIV"&&a(b.target).hasClass("collapsed")?a(b.target).toggleClass("expanded").parent().next("ul").toggle(300):c.attr("key")!=d.fm.cwd.hash?c.hasClass("noaccess")||c.hasClass("dropbox")?d.fm.view.error("Access denied"):d.ui.exec("open",c.trigger("select")[0]):(e=c.children(".collapsed"),e.length&&(e.toggleClass("expanded"),c.next("ul").toggle(300)))}),a("a:not(.noaccess,.readonly)",this.tree).droppable({tolerance:"pointer",accept:"div[key],tr[key]",over:function(){a(this).addClass("el-finder-droppable")},out:function(){a(this).removeClass("el-finder-droppable")},drop:function(b,c){a(this).removeClass("el-finder-droppable"),d.fm.drop(b,c,a(this).attr("key"))}}),this.fm.options.places&&this.updatePlaces()},this.updatePlaces=function(){this.fm.view.plc.children("li").find("li").draggable({scroll:!1,stop:function(){d.fm.removePlace(a(this).children("a").attr("key"))&&(a(this).remove(),a("li",d.fm.view.plc.children("li")).length||d.fm.view.plc.children("li").find("div").removeClass("collapsed expanded").end().children("ul").hide())}})},this.updateCwd=function(){a("[key]",this.cwd).bind("dblclick",function(b){d.fm.select(a(this),!0),d.ui.exec(d.ui.isCmdAllowed("select")?"select":"open")}).draggable({delay:3,addClasses:!1,appendTo:".el-finder-cwd",revert:!0,drag:function(a,b){b.helper.toggleClass("el-finder-drag-copy",a.shiftKey||a.ctrlKey)},helper:function(){var b=a(this),c=a('<div class="el-finder-drag-helper"/>'),e=0;!b.hasClass("ui-selected")&&d.fm.select(b,!0),d.cwd.find(".ui-selected").each(function(b){var f=d.fm.options.view=="icons"?a(this).clone().removeClass("ui-selected"):a(d.fm.view.renderIcon(d.fm.cdc[a(this).attr("key")]));(e++==0||e%12==0)&&f.css("margin-left",0),c.append(f)});return c.css("width",(e<=12?85+(e-1)*29:387)+"px")}}).filter(".directory").droppable({tolerance:"pointer",accept:"div[key],tr[key]",over:function(){a(this).addClass("el-finder-droppable")},out:function(){a(this).removeClass("el-finder-droppable")},drop:function(b,c){a(this).removeClass("el-finder-droppable"),d.fm.drop(b,c,a(this).attr("key"))}}),a.browser.msie&&a("*",this.cwd).attr("unselectable","on").filter("[key]").bind("dragstart",function(){d.cwd.selectable("disable").removeClass("ui-state-disabled ui-selectable-disabled")}).bind("dragstop",function(){d.cwd.selectable("enable")})}}}(jQuery),define("lib/jquery/jquery.elfinder",function(){}),define("modules/ui",["lib/jquery/jquery.misc","lib/tools/jit","order!lib/jquery/jquery.ui","order!lib/jquery/jquery.notify","order!lib/jquery/jquery.elfinder"],function(){function f(){$("button.btn").die("hover").live("hover",function(a){$(this).toggleClass("ui-state-hover")}),$("button.btn").die("mousedown").live("mousedown",function(){$(this).hasClass("ui-state-disabled")||($(this).parents(".btn-set-single:first").find(".btn.ui-state-active").removeClass("ui-state-active"),$(this).is(".ui-state-active.btn-toggleable, .btn-set-multi .ui-state-active")?$(this).removeClass("ui-state-active"):$(this).addClass("ui-state-active"))}),$("button.btn").die("mouseup").live("mouseup",function(){$(this).is(".btn-toggleable, .btn-set-single .btn, btn-set-multi .btn")||$(this).toggleClass("ui-state-active")}),$("body").undelegate(".btn","click").delegate(".btn","click",function(a){!$(this).hasClass("ui-state-disabled")&&!$(this).hasClass("action-icon-disabled")&&application.route_button($(this))}),$("body").undelegate(".menu-item","click").delegate(".menu-item","click",function(a){application.functions.ui.mark_menu();var b=$(this).data();"uri"in b&&(b.uri.indexOf("data")!=-1?application.route_uri_to_mod(b.uri,!1):application.route_uri_to_mod(b.uri,!0))}),$(document).unbind("USER_LOGIN USER_LOGOUT WS_ONLINE").bind("USER_LOGIN USER_LOGOUT WS_ONLINE",function(a){application.functions.ui.mark_menu()}),$("p:has(.ui-icon-info)").live("hover",function(){$(this).prev(".errorlist").toggleClass("errorlist-show")}),$("html").undelegate(".datatable tr","click").delegate(".datatable tr","click",function(a){$(a.target).is("td")&&(a.target.type!=="checkbox"&&($(":checkbox",this).is(":checked")?$(":checkbox",this).attr("checked",!1):$(":checkbox",this).attr("checked",!0),application.functions.ui.update_buttons()))}),$(":checkbox:not(#cb-all):visible").live("click",function(){application.functions.ui.update_buttons()}),$("#cb-all").live("click",function(a){$(this).attr("checked")=="checked"?$.each($(":checkbox:visible:not(#cb-all)"),function(a,b){$(this).attr("checked",!0)}):$.each($(":checkbox:visible:not(#cb-all)"),function(a,b){$(this).attr("checked",!1)}),application.functions.ui.update_buttons()}),$("body").bind("tabsshow",function(a,b){application.functions.ui.update_buttons()}),window.addEventListener("popstate",function(){application.route_uri_to_mod(location.pathname,!1)},!1),$("#notify-container").notify({speed:200,stack:"above",custom:!1}),$("html").undelegate("a","click").delegate("a","click",function(a){a.preventDefault();var b=application.settings.services.web_ui.uri.split(":")[0],c=$(a.target).attr("href");if(a.target.href.indexOf(b)==-1)window.open(a.target.href);else if(c.indexOf("docs")!=-1||c.indexOf("media")!=-1)window.open(a.target.href);else{if(c=="#")return;c.substr(-1)!="/"&&(c=c+"/"),$(this).attr("data-uri",c),application.route_button($(this))}}),$("body").ajaxComplete(function(a,b,c){if(typeof b!=="undefined"){var d=$.parseJSON(b.responseText);if(typeof d!=="undefined"&&typeof d.status!=="undefined"&&typeof d.status.code!=="undefined")switch(d.status.code){case"LOGIN":application.functions.login()}}})}function e(){application.functions.ui={route:function(a,b){typeof urls=="undefined"&&(urls=[]),application.route_uri_to_mod_function(a,urls,b)},update_buttons:function(a){application.params.cb_selected=0,checkboxes=$(":checkbox:not(#cb-all):visible").size(),$(":checkbox:not(#cb-all):visible").each(function(a,b){b.checked==!0&&(application.params.cb_selected+=1)}),application.params.cb_selected==1?($(".btn-active-one").removeClass("ui-state-disabled"),$(".btn-active-many").removeClass("ui-state-disabled")):application.params.cb_selected>1?($(".btn-active-many").removeClass("ui-state-disabled"),$(".btn-active-one").addClass("ui-state-disabled")):($(".btn-active-one").addClass("ui-state-disabled"),$(".btn-active-many").addClass("ui-state-disabled"))},add_widgets:function(a,b){$.each(a,function(a,b){$(".sidebar").append(b).hide().fadeIn("fast")})},transition:function(a,b,c){switch(c){case"fade":$(b).hide().html(a).fadeIn();break;case"FORM_INVALID":$(b).html(a);break;default:$(b).hide().html(a).fadeIn("fast")}},mark_menu:function(){$(".menu-item-selected").removeClass("menu-item-selected"),$(".menu-item").each(function(a,b){_data=$(this).data(),"uri"in _data&&location.pathname.indexOf(_data.uri)!=-1&&($(this).addClass("menu-item-selected"),$(this).parents("li").addClass("menu-item-selected"))})}}}var a,b,c,d="media/js/";return{init:function(a,b){e(),f();return"ui"},load:function(a,b){},clean_up:function(){unbind_events()}}});var CodeMirror=function(){function M(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;++c)if(a[c]==b)return c;return-1}function L(a,b){if(!b)return a?a.length:0;if(!a)return b.length;for(var c=a.length,d=b.length;c>=0&&d>=0;--c,--d)if(a.charAt(c)!=b.charAt(d))break;return d+1}function K(a){J.innerText=J.textContent=a;return J.innerHTML}function I(a){return{line:a.line,ch:a.ch}}function H(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function G(a,b){return a.line==b.line&&a.ch==b.ch}function F(a){return a.textContent||a.innerText||a.nodeValue||""}function E(a,b){var c=a.ownerDocument.body,d=0,e=0,f=!1;for(var g=a;g;g=g.offsetParent)d+=g.offsetLeft,e+=g.offsetTop,b&&D(g).position=="fixed"&&(f=!0);var h=b&&!f?null:c;for(var g=a.parentNode;g!=h;g=g.parentNode)g.scrollLeft!=null&&(d-=g.scrollLeft,e-=g.scrollTop);return{left:d,top:e}}function D(a){if(a.currentStyle)return a.currentStyle;return window.getComputedStyle(a,null)}function C(a,b){b==null&&(b=a.search(/[^\s\u00a0]/),b==-1&&(b=a.length));for(var c=0,d=0;c<b;++c)a.charAt(c)=="\t"?d+=y-d%y:++d;return d}function s(){this.id=null}function r(a,b,c,d){function e(a){c(a||window.event)}if(typeof a.addEventListener=="function"){a.addEventListener(b,e,!1);if(d)return function(){a.removeEventListener(b,e,!1)}}else{a.attachEvent("on"+b,e);if(d)return function(){a.detachEvent("on"+b,e)}}}function q(a){if(a.which)return a.which;if(a.button&1)return 1;if(a.button&2)return 3;if(a.button&4)return 2}function p(a){return a.target||a.srcElement}function o(a){m(a),n(a)}function n(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function m(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function l(a){a.stop||(a.stop=k);return a}function k(){o(this)}function j(){this.time=0,this.done=[],this.undone=[]}function i(a,b,c,d){for(var e=0,f=0,g=0;f<b;e+=2){var h=c[e],i=f+h.length;g==0?(i>a&&d.push(h.slice(a-f,Math.min(h.length,b-f)),c[e+1]),i>=a&&(g=1)):g==1&&(i>b?d.push(h.slice(0,b-f),c[e+1]):d.push(h,c[e+1])),f=i}}function h(a,b){this.styles=b||[a,null],this.stateAfter=null,this.text=a,this.marked=this.gutterMarker=this.className=null}function g(a){this.pos=this.start=0,this.string=a}function f(a,b,c){return a.startState?a.startState(b,c):!0}function e(a,b){if(b===!0)return b;if(a.copyState)return a.copyState(b);var c={};for(var d in b){var e=b[d];e instanceof Array&&(e=e.concat([])),c[d]=e}return c}function a(b,c){function cV(a,b,c){this.atOccurrence=!1,c==null&&(c=typeof a=="string"&&a==a.toLowerCase()),b&&typeof b=="object"?b=ci(b):b={line:0,ch:0},this.pos={from:b,to:b};if(typeof a!="string")this.matches=function(b,c){if(b){var d=$[c.line].text.slice(0,c.ch),e=d.match(a),f=0;while(e){var g=d.indexOf(e[0]);f+=g,d=d.slice(g+1);var h=d.match(a);if(h)e=h;else break;f++}}else var d=$[c.line].text.slice(c.ch),e=d.match(a),f=e&&c.ch+d.indexOf(e[0]);if(e)return{from:{line:c.line,ch:f},to:{line:c.line,ch:f+e[0].length},match:e}};else{c&&(a=a.toLowerCase());var d=c?function(a){return a.toLowerCase()}:function(a){return a},e=a.split("\n");e.length==1?this.matches=function(b,c){var e=d($[c.line].text),f=a.length,g;if(b?c.ch>=f&&(g=e.lastIndexOf(a,c.ch-f))!=-1:(g=e.indexOf(a,c.ch))!=-1)return{from:{line:c.line,ch:g},to:{line:c.line,ch:g+f}}}:this.matches=function(a,b){var c=b.line,f=a?e.length-1:0,g=e[f],h=d($[c].text),i=a?h.indexOf(g)+g.length:h.lastIndexOf(g);if(!(a?i>=b.ch||i!=g.length:i<=b.ch||i!=h.length-g.length))for(;;){if(a?!c:c==$.length-1)return;h=d($[c+=a?-1:1].text),g=e[a?--f:++f];if(f>0&&f<e.length-1){if(h!=g)return;continue}var j=a?h.lastIndexOf(g):h.indexOf(g)+g.length;if(a?j!=h.length-g.length:j!=g.length)return;var k={line:b.line,ch:i},l={line:c,ch:j};return{from:a?l:k,to:a?k:l}}}}}function cU(a){return function(){cT++||cR();try{var b=a.apply(this,arguments)}finally{--cT||cS()}return b}}function cS(){var a=!1;bj&&(a=!bY()),bh.length?b_(bh):bj&&cd(),a&&bY(),bj&&(bX(),cJ()),bb&&!bk&&(bg===!0||bg!==!1&&bj)&&bV(),bj&&g.matchBrackets&&setTimeout(cU(function(){bq&&(bq(),bq=null),cL(!1)}),20);var b=bi;bj&&g.onCursorActivity&&g.onCursorActivity(bw,b),b&&g.onChange&&bw&&g.onChange(bw,b)}function cR(){bg=null,bh=[],bi=bj=!1}function cQ(a){_.length&&X.set(a,cU(cP))}function cP(){var a=+(new Date)+g.workTime,b=_.length;while(_.length){if($[bl].stateAfter)var c=_.pop();else var c=bl;if(c>=$.length)continue;var d=cM(c),h=d&&$[d-1].stateAfter;h?h=e(Z,h):h=f(Z);var i=0,j=Z.compareStates,k=!1;for(var l=d,m=$.length;l<m;++l){var n=$[l],o=n.stateAfter;if(+(new Date)>a){_.push(l),cQ(g.workDelay),k&&bh.push({from:c,to:l+1});return}var p=n.highlight(Z,h);p&&(k=!0),n.stateAfter=e(Z,h);if(j){if(o&&j(o,h))break}else if(p===!1&&o){if(++i>3)break}else i=0}k&&bh.push({from:c,to:l+1})}b&&g.onHighlightComplete&&g.onHighlightComplete(bw)}function cO(a,b){var c=cN(a);for(var d=a;d<b;++d){var f=$[d];f.highlight(Z,c),f.stateAfter=e(Z,c)}}function cN(a){var b=cM(a),c=b&&$[b-1].stateAfter;c?c=e(Z,c):c=f(Z);for(var d=b;d<a;++d){var g=$[d];g.highlight(Z,c),g.stateAfter=e(Z,c)}a<$.length&&!$[a].stateAfter&&_.push(a);return c}function cM(a){var b,c;for(var d=a,e=a-40;d>e;--d){if(d==0)return 0;var f=$[d-1];if(f.stateAfter)return d;var g=f.indentation();if(c==null||b>g)c=d-1,b=g}return c}function cL(a){function p(a,b,c){if(a.text){var d=a.styles,e=g?0:a.text.length-1,f;for(var i=g?0:d.length-2,j=g?d.length:-2;i!=j;i+=2*h){var k=d[i];if(d[i+1]!=null&&d[i+1]!=m){e+=h*k.length;continue}for(var l=g?0:k.length-1,p=g?k.length:-1;l!=p;l+=h,e+=h)if(e>=b&&e<c&&o.test(f=k.charAt(l))){var q=cK[f];if(q.charAt(1)==">"==g)n.push(f);else{if(n.pop()!=q.charAt(0))return{pos:e,match:!1};if(!n.length)return{pos:e,match:!0}}}}}}var b=bc.inverted?bc.from:bc.to,c=$[b.line],d=b.ch-1,e=d>=0&&cK[c.text.charAt(d)]||cK[c.text.charAt(++d)];if(e){var f=e.charAt(0),g=e.charAt(1)==">",h=g?1:-1,i=c.styles;for(var j=d+1,k=0,l=i.length;k<l;k+=2)if((j-=i[k].length)<=0){var m=i[k+1];break}var n=[c.text.charAt(d)],o=/[(){}[\]]/;for(var k=b.line,l=g?Math.min(k+100,$.length):Math.max(-1,k-100);k!=l;k+=h){var c=$[k],q=k==b.line,r=p(c,q&&g?d+1:0,q&&!g?d:c.text.length);if(r)break}r||(r={pos:null,match:!1});var m=r.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",s=cu({line:b.line,ch:d},{line:b.line,ch:d+1},m),t=r.pos!=null?cu({line:k,ch:r.pos},{line:k,ch:r.pos+1},m):function(){},u=cU(function(){s(),t()});a?setTimeout(u,800):bq=u}}function cJ(){clearInterval(Y);var a=!0;U.style.visibility=!0}function cI(a){function e(){var a=N(C.value).join("\n");a!=d&&cU(bN)(a,"end"),B.style.position="relative",C.style.cssText=c,bk=!1,bV(),bS()}var b=cH(a);if(b&&!window.opera){(G(bc.from,bc.to)||H(b,bc.from)||!H(b,bc.to))&&cU(cg)(b.line,b.ch);var c=C.style.cssText;B.style.position="absolute",C.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(a.clientY-5)+"px; left: "+(a.clientX-5)+"px; z-index: 1000; background: white; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",bk=!0;var d=C.value=bQ();bW(),P(C,0,C.value.length);if(u){o(a);var f=r(window,"mouseup",function(){f(),setTimeout(e,20)},!0)}else setTimeout(e,50)}}function cH(a,b){var c=E(D,!0),d,e;try{d=a.clientX,e=a.clientY}catch(a){return null}if(!b&&(d-c.left>D.clientWidth||e-c.top>D.clientHeight))return null;var f=E(T,!0),g=bl+Math.floor((e-f.top)/cE());return ci({line:g,ch:cB(ch(g),d-f.left)})}function cG(){return T.offsetLeft}function cF(){return T.offsetTop}function cE(){var a=V.childNodes.length;if(a)return V.offsetHeight/a||1;K.innerHTML="<pre>x</pre>";return K.firstChild.offsetHeight||1}function cD(a){var b=cC(a,!0),c=E(T);return{x:c.left+b.x,y:c.top+b.y,yBot:c.top+b.yBot}}function cC(a,b){var c=cE(),d=a.line-(b?bl:0);return{x:cA(a.line,a.ch),y:d*c,yBot:(d+1)*c}}function cB(a,b){function e(a){K.innerHTML="<pre><span>"+c.getHTML(null,null,!1,a)+"</span></pre>";return K.firstChild.firstChild.offsetWidth}if(b<=0)return 0;var c=$[a],d=c.text,f=0,g=0,h=d.length,i,j=Math.min(h,Math.ceil(b/cz("x")));for(;;){var k=e(j);if(k<=b&&j<h)j=Math.min(h,Math.ceil(j*1.2));else{i=k,h=j;break}}if(b>i)return h;j=Math.floor(h*.8),k=e(j),k<b&&(f=j,g=k);for(;;){if(h-f<=1)return i-b>b-g?f:h;var l=Math.ceil((f+h)/2),m=e(l);m>b?(h=l,i=m):(f=l,g=m)}}function cA(a,b){if(b==0)return 0;K.innerHTML="<pre><span>"+$[a].getHTML(null,null,!1,b)+"</span></pre>";return K.firstChild.firstChild.offsetWidth}function cz(a){K.innerHTML="<pre><span>x</span></pre>",K.firstChild.firstChild.firstChild.nodeValue=a;return K.firstChild.firstChild.offsetWidth||10}function cy(a){if(typeof a=="number"){var b=a;a=$[a];if(!a)return null}else{var b=M($,a);if(b==-1)return null}var c=a.gutterMarker;return{line:b,text:a.text,markerText:c&&c.text,markerClass:c&&c.style}}function cx(a,b){if(typeof a=="number"){var c=a;a=$[ch(a)]}else{var c=M($,a);if(c==-1)return null}a.className!=b&&(a.className=b,bh.push({from:c,to:c+1}));return a}function cw(a){typeof a=="number"&&(a=$[ch(a)]),a.gutterMarker=null,cc()}function cv(a,b,c){typeof a=="number"&&(a=$[ch(a)]),a.gutterMarker={text:b,style:c},cc();return a}function cu(a,b,c){function e(a,b,c,e){var a=$[a],f=a.addMark(b,c,e);f.line=a,d.push(f)}a=ci(a),b=ci(b);var d=[];if(a.line==b.line)e(a.line,a.ch,b.ch,c);else{e(a.line,a.ch,null,c);for(var f=a.line+1,g=b.line;f<g;++f)e(f,0,null,c);e(b.line,0,b.ch,c)}bh.push({from:a.line,to:b.line+1});return function(){var a,b;for(var c=0;c<d.length;++c){var e=d[c],f=M($,e.line);e.line.removeMark(e),f>-1&&(a==null&&(a=f),b=f)}a!=null&&bh.push({from:a,to:b+1})}}function ct(){var a=g.gutter||g.lineNumbers;R.style.display=a?"":"none",a?cc():V.parentNode.style.marginLeft=0}function cs(){Z=a.getMode(g,g.mode);for(var b=0,c=$.length;b<c;++b)$[b].stateAfter=null;_=[0],cQ()}function cr(a,b){if(b=="smart")if(Z.indent)var c=cN(a);else b="prev";var d=$[a],e=d.indentation(),f=d.text.match(/^\s*/)[0],h;b=="prev"?a?h=$[a-1].indentation():h=0:b=="smart"?h=Z.indent(c,d.text.slice(f.length)):b=="add"?h=e+g.indentUnit:b=="subtract"&&(h=e-g.indentUnit),h=Math.max(0,h);var i=h-e;if(i){var j="",k=0;if(g.indentWithTabs)for(var l=Math.floor(h/y);l;--l)k+=y,j+="\t";while(k<h)++k,j+=" "}else{if(bc.from.line!=a&&bc.to.line!=a)return;var j=f}bM(j,{line:a,ch:0},{line:a,ch:f.length})}function cq(){var a=Math.max(0,$[bc.from.line].text.search(/\S/));cg(bc.from.line,bc.from.ch<=a&&bc.from.ch?0:a,!0)}function cp(a){function b(a){if(G(bc.from,bc.to))return cr(bc.from.line,a);var b=bc.to.line-(bc.to.ch?0:1);for(var c=bc.from.line;c<=b;++c)cr(c,a)}bd=null;switch(g.tabMode){case"default":return!1;case"indent":b("smart");break;case"classic":if(G(bc.from,bc.to)){a?cr(bc.from.line,"smart"):bN("\t","end");break};case"shift":b(a?"subtract":"add")}return!0}function co(){bN("\n","end"),g.enterMode!="flat"&&cr(bc.from.line,g.enterMode=="keep"?"prev":"smart")}function cn(a){ce({line:a,ch:0},{line:a,ch:$[a].text.length})}function cm(a){var b=$[a.line].text,c=a.ch,d=a.ch;while(c>0&&/\w/.test(b.charAt(c-1)))--c;while(d<b.length&&/\w/.test(b.charAt(d)))++d;ce({line:a.line,ch:c},{line:a.line,ch:d})}function cl(){var a=$.length-1;cf({line:0,ch:0},{line:a,ch:$[a].text.length})}function ck(a){var b=a?{line:0,ch:0}:{line:$.length-1,ch:$[$.length-1].text.length};ce(b,b)}function cj(a){var b=Math.floor(D.clientHeight/cE()),c=bc.inverted?bc.from:bc.to;cg(c.line+Math.max(b-1,1)*(a?1:-1),c.ch,!0)}function ci(a){if(a.line<0)return{line:0,ch:0};if(a.line>=$.length)return{line:$.length-1,ch:$[$.length-1].text.length};var b=a.ch,c=$[a.line].text.length;return b==null||b>c?{line:a.line,ch:c}:b<0?{line:a.line,ch:0}:a}function ch(a){return Math.max(0,Math.min(a,$.length-1))}function cg(a,b,c){var d=ci({line:a,ch:b||0});(c?ce:cf)(d,d)}function cf(a,b,c,d){if(!G(bc.from,a)||!G(bc.to,b)){if(H(b,a)){var e=b;b=a,a=e}G(a,b)?bc.inverted=!1:G(a,bc.to)?bc.inverted=!1:G(b,bc.from)&&(bc.inverted=!0),c==null&&(c=bc.from.line,d=bc.to.line),G(a,b)?G(bc.from,bc.to)||bh.push({from:c,to:d+1}):G(bc.from,bc.to)?bh.push({from:a.line,to:b.line+1}):(G(a,bc.from)||(a.line<c?bh.push({from:a.line,to:Math.min(b.line,c)+1}):bh.push({from:c,to:Math.min(d,a.line)+1})),G(b,bc.to)||(b.line<d?bh.push({from:Math.max(c,a.line),to:d+1}):bh.push({from:Math.max(a.line,d),to:b.line+1}))),bc.from=a,bc.to=b,bj=!0}}function ce(a,b){var c=bd&&ci(bd);c&&(H(c,a)?a=c:H(b,c)&&(b=c)),cf(a,b)}function cd(){var a=bc.inverted?bc.from:bc.to,b=cE(),c=cA(a.line,a.ch);B.style.top=a.line*b-D.scrollTop+"px",B.style.left=c-D.scrollLeft+"px",G(bc.from,bc.to)?(U.style.top=(a.line-bl)*b+"px",U.style.left=c+"px",U.style.display=""):U.style.display="none"}function cc(){if(g.gutter||g.lineNumbers){var a=Q.offsetHeight,b=D.clientHeight;R.style.height=(a-b<2?b:a)+"px";var c=[];for(var d=bl;d<Math.max(bm,bl+1);++d){var e=$[d].gutterMarker,f=g.lineNumbers?d+g.firstLineNumber:null;e&&e.text?f=e.text.replace("%N%",f!=null?f:""):f==null&&(f=""),c.push(e&&e.style?'<pre class="'+e.style+'">':"<pre>",f,"</pre>")}R.style.display="none",S.innerHTML=c.join("");var h=String($.length).length,i=S.firstChild,j=F(i),k="";while(j.length+k.length<h)k+="";k&&i.insertBefore(n.createTextNode(k),i.firstChild),R.style.display="",T.style.marginLeft=R.offsetWidth+"px"}}function cb(a){var b=bc.from.line,c=bc.to.line,d=0,e=t&&n.createElement("div");for(var f=0,g=a.length;f<g;++f){var h=a[f],i=h.to-h.from-h.domSize,j=V.childNodes[h.domStart+h.domSize+d]||null;if(t)for(var k=Math.max(-i,h.domSize);k>0;--k)V.removeChild(j?j.previousSibling:V.lastChild);else if(i){for(var k=Math.max(0,i);k>0;--k)V.insertBefore(n.createElement("pre"),j);for(var k=Math.max(0,-i);k>0;--k)V.removeChild(j?j.previousSibling:V.lastChild)}var l=V.childNodes[h.domStart+d],m=b<h.from&&c>=h.from;for(var k=h.from;k<h.to;++k){var o=null,p=null;m?(o=0,c==k&&(m=!1,p=bc.to.ch)):b==k&&(c==k?(o=bc.from.ch,p=bc.to.ch):(m=!0,o=bc.from.ch)),t?(e.innerHTML=$[k].getHTML(o,p,!0),V.insertBefore(e.firstChild,j)):(l.innerHTML=$[k].getHTML(o,p,!1),l.className=$[k].className||"",l=l.nextSibling)}d+=i}}function ca(a,b){var c=[],d={line:a,ch:0},e=H(bc.from,d)&&!H(bc.to,d);for(var f=a;f<b;++f){var g=null,h=null;e?(g=0,bc.to.line==f&&(e=!1,h=bc.to.ch)):bc.from.line==f&&(bc.to.line==f?(g=bc.from.ch,h=bc.to.ch):(e=!0,g=bc.from.ch)),c.push($[f].getHTML(g,h,!0))}V.innerHTML=c.join("")}function b_(a){if(D.clientWidth){var b=a===!0?[]:[{from:bl,to:bm,domStart:0}];for(var c=0,d=a.length||0;c<d;++c){var e=a[c],f=[],g=e.diff||0;for(var h=0,i=b.length;h<i;++h){var j=b[h];e.to>j.from?j.to>e.from?(e.from>j.from&&f.push({from:j.from,to:e.from,domStart:j.domStart}),e.to<j.to&&f.push({from:e.to+g,to:j.to+g,domStart:j.domStart+(e.to-j.from)})):f.push(j):f.push({from:j.from+g,to:j.to+g,domStart:j.domStart})}b=f}var k=b$(),l=Math.min(bl,Math.max(k.from-3,0)),m=Math.min($.length,Math.max(bm,k.to+3)),n=[],o=0,p=bm-bl,q=l,r=0;for(var c=0,d=b.length;c<d;++c){var j=b[c];if(j.to<=l)continue;if(j.from>=m)break;if(j.domStart>o||j.from>q)n.push({from:q,to:j.from,domSize:j.domStart-o,domStart:o}),r+=j.from-q;q=j.to,o=j.domStart+(j.to-j.from)}if(o!=p||q!=m)r+=Math.abs(m-q),n.push({from:q,to:m,domSize:p-o,domStart:o});if(!n.length)return;V.style.display="none",r>(k.to-k.from)*.3?ca(l=Math.max(k.from-10,0),m=Math.min(k.to+7,$.length)):cb(n),V.style.display="";var s=l!=bl||m!=bm||bn!=D.clientHeight;bl=l,bm=m,Q.style.top=l*cE()+"px",s&&(bn=D.clientHeight,J.style.height=$.length*cE()+2*cF()+"px"),(s||n.length)&&cc(),bs==null&&(bs=cz(br)),bs>D.clientWidth?(T.style.width=bs+"px",J.style.width="",J.style.width=D.scrollWidth+"px"):T.style.width=J.style.width="";if(V.childNodes.length!=bm-bl)throw new Error("BAD PATCH! "+JSON.stringify(n)+" size="+(bm-bl)+" nodes="+V.childNodes.length);cd()}else bl=bm=0}function b$(){var a=cE(),b=D.scrollTop-cF();return{from:Math.min($.length,Math.max(0,Math.floor(b/a))),to:Math.min($.length,Math.ceil((b+D.clientHeight)/a))}}function bZ(a,b,c,d){var e=cG(),f=cF(),h=cE();b+=f,d+=f,a+=e,c+=e;var i=D.clientHeight,j=D.scrollTop,k=!1,l=!0;b<j?(D.scrollTop=Math.max(0,b-2*h),k=!0):d>j+i&&(D.scrollTop=d+h-i,k=!0);var m=D.clientWidth,n=D.scrollLeft,o=g.fixedGutter?R.clientWidth:0;a<n+o?(a<50&&(a=0),D.scrollLeft=Math.max(0,a-10-o),k=!0):c>m+n&&(D.scrollLeft=c+10-m,k=!0,c>J.clientWidth&&(l=!1)),k&&g.onScroll&&g.onScroll(bw);return l}function bY(){var a=cC(bc.inverted?bc.from:bc.to);return bZ(a.x,a.y,a.x,a.yBot)}function bX(){if(U.getBoundingClientRect){var a=U.getBoundingClientRect(),b=window.innerHeight||document.body.offsetHeight||document.documentElement.offsetHeight;(a.top<0||a.bottom>b)&&U.scrollIntoView()}}function bW(){g.readOnly!="nocursor"&&C.focus()}function bV(){var a=[],b=Math.max(0,bc.from.line-1),c=Math.min($.length,bc.to.line+2);for(var d=b;d<c;++d)a.push($[d].text);a=C.value=a.join(x);var e=bc.from.ch,f=bc.to.ch;for(var d=b;d<bc.from.line;++d)e+=x.length+$[d].text.length;for(var d=b;d<bc.to.line;++d)f+=x.length+$[d].text.length;bp={text:a,from:b,to:c,start:e,end:f},P(C,e,be?e:f)}function bU(){function f(a,c){var d=0;for(;;){var e=b.indexOf("\n",d);if(e==-1||(b.charAt(e-1)=="\r"?e-1:e)>=a)return{line:c,ch:a-d};++c,d=e+1}}if(!bk&&bb){var a=!1,b=C.value,c=O(C);if(!c)return!1;var a=bp.text!=b,d=be,e=a||c.start!=bp.start||c.end!=(d?bp.start:bp.end);if(!e&&!d)return!1;if(a){bd=be=null;if(g.readOnly){bg=!0;return"changed"}}var h=f(c.start,bp.from),i=f(c.end,bp.from);if(d){var j=c.start==d.anchor?i:h,k=bd?bc.to:c.start==d.anchor?h:i;(bc.inverted=H(j,k))?(h=j,i=k):(be=null,h=k,i=j)}h.line==i.line&&h.line==bc.from.line&&h.line==bc.to.line&&!bd&&(bg=!1);if(a){var l=0,m=b.length,n=Math.min(m,bp.text.length),o,p=bp.from,q=-1;while(l<n&&(o=b.charAt(l))==bp.text.charAt(l))++l,o=="\n"&&(p++,q=l);var r=q>-1?l-q:l,s=bp.to-1,t=bp.text.length;for(;;){o=bp.text.charAt(t);if(b.charAt(m)!=o){++m,++t;break}o=="\n"&&s--;if(t<=l||m<=l)break;--m,--t}var q=bp.text.lastIndexOf("\n",t-1),u=q==-1?t:t-q-1;bH({line:p,ch:r},{line:s,ch:u},N(b.slice(l,m)),h,i);if(p!=s||h.line!=p)bg=!0}else cf(h,i);bp.text=b,bp.start=c.start,bp.end=c.end;return a?"changed":e?"moved":!1}}function bT(a){function c(){cR();var d=bU();d&&a&&(d=="moved"&&A[a]==null&&(A[a]=!0),d=="changed"&&(A[a]=!1)),d||b?(bR=!1,bS()):(b=!0,W.set(80,c)),cS()}var b=!1;bR=!0,W.set(20,c)}function bS(){bR||W.set(2e3,function(){cR(),bU(),bb&&bS(),cS()})}function bQ(){return bP(bc.from,bc.to)}function bP(a,b){var c=a.line,d=b.line;if(c==d)return $[c].text.slice(a.ch,b.ch);var e=[$[c].text.slice(a.ch)];for(var f=c+1;f<d;++f)e.push($[f].text);e.push($[d].text.slice(0,b.ch));return e.join("\n")}function bO(a,b,c,d){var e=a.length==1?a[0].length+b.ch:a[a.length-1].length,f=d({line:b.line+a.length-1,ch:e});bH(b,c,a,f.from,f.to)}function bN(a,b){bO(N(a),bc.from,bc.to,function(a){return b=="end"?{from:a,to:a}:b=="start"?{from:bc.from,to:bc.from}:{from:bc.from,to:a}})}function bM(a,b,c){function d(d){if(H(d,b))return d;if(!H(c,d))return e;var f=d.line+a.length-(c.line-b.line)-1,g=d.ch;d.line==c.line&&(g+=a[a.length-1].length-(c.ch-(c.line==b.line?b.ch:0)));return{line:f,ch:g}}b=ci(b),c?c=ci(c):c=b,a=N(a);var e;bO(a,b,c,function(a){e=a;return{from:d(bc.from),to:d(bc.to)}});return e}function bL(a,b,c,d,e){function s(a){return a<=Math.min(b.line,b.line+q)?a:a+q}var f=!1,g=br.length;for(var i=a.line;i<=b.line;++i)if($[i].text.length==g){f=!0;break}var j=b.line-a.line,k=$[a.line],l=$[b.line];if(k==l)if(c.length==1)k.replace(a.ch,b.ch,c[0]);else{l=k.split(b.ch,c[c.length-1]);var m=[a.line+1,j];k.replace(a.ch,k.text.length,c[0]);for(var i=1,n=c.length-1;i<n;++i)m.push(new h(c[i]));m.push(l),$.splice.apply($,m)}else if(c.length==1)k.replace(a.ch,k.text.length,c[0]+l.text.slice(b.ch)),$.splice(a.line+1,j);else{var m=[a.line+1,j-1];k.replace(a.ch,k.text.length,c[0]),l.replace(0,b.ch,c[c.length-1]);for(var i=1,n=c.length-1;i<n;++i)m.push(new h(c[i]));$.splice.apply($,m)}for(var i=a.line,n=i+c.length;i<n;++i){var o=$[i].text;o.length>g&&(br=o,g=o.length,bs=null,f=!1)}if(f){g=0,br="",bs=null;for(var i=0,n=$.length;i<n;++i){var o=$[i].text;o.length>g&&(g=o.length,br=o)}}var p=[],q=c.length-j-1;for(var i=0,o=_.length;i<o;++i){var r=_[i];r<a.line?p.push(r):r>b.line&&p.push(r+q)}c.length<5?(cO(a.line,a.line+c.length),p.push(a.line+c.length)):p.push(a.line),_=p,cQ(100),bh.push({from:a.line,to:b.line+1,diff:q}),bi={from:a,to:b,text:c},cf(d,e,s(bc.from.line),s(bc.to.line)),J.style.height=$.length*cE()+2*cF()+"px"}function bK(){bI(ba.undone,ba.done)}function bJ(){bI(ba.done,ba.undone)}function bI(a,b){var c=a.pop();if(c){var d=[],e=c.start+c.added;for(var f=c.start;f<e;++f)d.push($[f].text);b.push({start:c.start,added:c.old.length,old:d});var g=ci({line:c.start+c.old.length-1,ch:L(d[d.length-1],c.old[c.old.length-1])});bL({line:c.start,ch:0},{line:e-1,ch:$[e-1].text.length},c.old,g,g),bg=!0}}function bH(a,b,c,d,e){if(ba){var f=[];for(var h=a.line,i=b.line+1;h<i;++h)f.push($[h].text);ba.addChange(a.line,c.length,f);while(ba.done.length>g.undoDepth)ba.done.shift()}bL(a,b,c,d,e)}function bG(){bb&&(g.onBlur&&g.onBlur(bw),bb=!1,w.className=w.className.replace(" CodeMirror-focused","")),clearInterval(Y),setTimeout(function(){bb||(bd=null)},150)}function bF(){g.readOnly!="nocursor"&&(bb||(g.onFocus&&g.onFocus(bw),bb=!0,w.className.search(/\bCodeMirror-focused\b/)==-1&&(w.className+=" CodeMirror-focused"),bk||bV()),bS(),cJ())}function bE(a){if(!g.onKeyEvent||!g.onKeyEvent(bw,l(a))){if(g.electricChars&&Z.electricChars){var b=String.fromCharCode(a.charCode==null?a.keyCode:a.charCode);Z.electricChars.indexOf(b)>-1&&setTimeout(cU(function(){cr(bc.to.line,"smart")}),50)}var c=a.keyCode;c==13?(g.readOnly||co(),m(a)):a.ctrlKey||a.altKey||a.metaKey||c!=9||g.tabMode=="default"?bT(bo):m(a)}}function bD(a){if(!g.onKeyEvent||!g.onKeyEvent(bw,l(a)))be&&(be=null,bg=!0),a.keyCode==16&&(bd=null)}function bC(a){bb||bF();var b=a.keyCode;v&&b==27&&(a.returnValue=!1);var c=(z?a.metaKey:a.ctrlKey)&&!a.altKey,d=a.ctrlKey||a.altKey||a.metaKey;b==16||a.shiftKey?bd=bd||(bc.inverted?bc.to:bc.from):bd=null;if(!g.onKeyEvent||!g.onKeyEvent(bw,l(a))){if(b==33||b==34){cj(b==34);return m(a)}if(c&&(b==36||b==35||z&&(b==38||b==40))){ck(b==36||b==38);return m(a)}if(c&&b==65){cl();return m(a)}if(!g.readOnly){if(!d&&b==13)return;if(!d&&b==9&&cp(a.shiftKey))return m(a);if(c&&b==90){bJ();return m(a)}if(c&&(a.shiftKey&&b==90||b==89)){bK();return m(a)}}if(b==36)if(g.smartHome){cq();return m(a)}bo=(c?"c":"")+(a.altKey?"a":"")+b;if(bc.inverted&&A[bo]===!0){var e=O(C);e&&(be={anchor:e.start},P(C,e.start,e.start))}!c&&!a.altKey&&(bo=null),bT(bo)}}function bB(a){a.preventDefault();var b=cH(a,!0),c=a.dataTransfer.files;if(b&&!g.readOnly)if(c&&c.length&&window.FileReader&&window.File){function d(a,c){var d=new FileReader;d.onload=function(){f[c]=d.result,++h==e&&bM(f.join(""),ci(b),ci(b))},d.readAsText(a)}var e=c.length,f=Array(e),h=0;for(var i=0;i<e;++i)d(c[i],i)}else try{var f=a.dataTransfer.getData("Text");f&&bM(f,b,b)}catch(a){}}function bA(a){var b=cH(a);b&&(cm(b),m(a),bf=+(new Date))}function bz(a){function i(a){var b=cH(a,!0);if(b&&!G(b,e)){bb||bF(),e=b,ce(d,b),bg=!1;var c=b$();if(b.line>=c.to||b.line<c.from)f=setTimeout(cU(function(){i(a)}),150)}}function h(){bW(),bg=!0,j(),k()}for(var b=p(a);b!=w;b=b.parentNode)if(b.parentNode==J&&b!=Q)return;var c=bf;bf=null;for(var b=p(a);b!=w;b=b.parentNode)if(b.parentNode==S){g.onGutterClick&&g.onGutterClick(bw,M(S.childNodes,b)+bl,a);return m(a)}var d=cH(a);switch(q(a)){case 3:u&&!z&&cI(a);return;case 2:d&&cg(d.line,d.ch,!0);return}if(d){bb||bF(),m(a);if(c&&+(new Date)-c<400)return cn(d.line);cg(d.line,d.ch,!0);var e=d,f,j=r(n,"mousemove",cU(function(a){clearTimeout(f),m(a),i(a)}),!0),k=r(n,"mouseup",cU(function(a){clearTimeout(f);var b=cH(a);b&&ce(d,b),m(a),h()}),!0)}else p(a)==D&&m(a)}function by(a){var b=[];for(var c=0,d=$.length;c<d;++c)b.push($[c].text);return b.join("\n")}function bx(a){ba=null;var b={line:0,ch:0};bH(b,{line:$.length-1,ch:$[$.length-1].text.length},N(a),b,b),ba=new j,bg=!0}function bv(a){return a>=0&&a<$.length}var g={},i=a.defaults;for(var k in i)i.hasOwnProperty(k)&&(g[k]=(c&&c.hasOwnProperty(k)?c:i)[k]);var n=g.document,w=n.createElement("div");w.className="CodeMirror",w.innerHTML='<div style="overflow: hidden; position: relative; width: 1px; height: 0px;"><textarea style="position: absolute; width: 2px;" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-'+g.theme+'"><div style="position: relative"><div style="position: absolute; height: 0; width: 0; overflow: hidden;"></div><div style="position: relative"><div class="CodeMirror-gutter"><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative"><pre class="CodeMirror-cursor">&#160;</pre><div></div></div></div></div></div></div>',b.appendChild?b.appendChild(w):b(w);var B=w.firstChild,C=B.firstChild,D=w.lastChild,J=D.firstChild,K=J.firstChild,Q=K.nextSibling,R=Q.firstChild,S=R.firstChild,T=R.nextSibling.firstChild,U=T.firstChild,V=U.nextSibling;g.tabindex!=null&&(C.tabindex=g.tabindex),!g.gutter&&!g.lineNumbers&&(R.style.display="none");var W=new s,X=new s,Y,Z,$=[new h("")],_,ba=new j,bb;cs();var bc={from:{line:0,ch:0},to:{line:0,ch:0},inverted:!1},bd,be,bf,bg,bh,bi,bj,bk,bl=0,bm=0,bn=0,bo=null,bp,bq,br="",bs;cU(function(){bx(g.value||""),bg=!1})(),r(D,"mousedown",cU(bz)),u||r(D,"contextmenu",cI),r(J,"dblclick",cU(bA)),r(D,"scroll",function(){b_([]),g.fixedGutter&&(R.style.left=D.scrollLeft+"px"),g.onScroll&&g.onScroll(bw)}),r(window,"resize",function(){b_(!0)}),r(C,"keyup",cU(bD)),r(C,"keydown",cU(bC)),r(C,"keypress",cU(bE)),r(C,"focus",bF),r(C,"blur",bG),r(D,"dragenter",o),r(D,"dragover",o),r(D,"drop",cU(bB)),r(D,"paste",function(){bW(),bT()}),r(C,"paste",function(){bT()}),r(C,"cut",function(){bT()});var bt;try{bt=n.activeElement==C}catch(bu){}bt?setTimeout(bF,20):bG();var bw=w.CodeMirror={getValue:by,setValue:cU(bx),getSelection:bQ,replaceSelection:cU(bN),focus:function(){bW(),bF(),bT()},setOption:function(a,b){g[a]=b,a=="lineNumbers"||a=="gutter"||a=="firstLineNumber"?ct():a=="mode"||a=="indentUnit"?cs():a=="readOnly"&&b=="nocursor"?C.blur():a=="theme"&&(D.className=D.className.replace(/cm-s-\w+/,"cm-s-"+b))},getOption:function(a){return g[a]},undo:cU(bJ),redo:cU(bK),indentLine:cU(function(a,b){bv(a)&&cr(a,b==null?"smart":b?"add":"subtract")}),historySize:function(){return{undo:ba.done.length,redo:ba.undone.length}},matchBrackets:cU(function(){cL(!0)}),getTokenAt:function(a){a=ci(a);return $[a.line].getTokenAt(Z,cN(a.line),a.ch)},getStateAfter:function(a){a=ch(a==null?$.length-1:a);return cN(a+1)},cursorCoords:function(a){a==null&&(a=bc.inverted);return cD(a?bc.from:bc.to)},charCoords:function(a){return cD(ci(a))},coordsChar:function(a){var b=E(T),c=ch(Math.min($.length-1,bl+Math.floor((a.y-b.top)/cE())));return ci({line:c,ch:cB(ch(c),a.x-b.left)})},getSearchCursor:function(a,b,c){return new cV(a,b,c)},markText:cU(function(a,b,c){return cU(cu(a,b,c))}),setMarker:cv,clearMarker:cw,setLineClass:cU(cx),lineInfo:cy,addWidget:function(a,b,c,d,e){a=cC(ci(a));var f=a.yBot,g=a.x;b.style.position="absolute",J.appendChild(b);if(d=="over")f=a.y;else if(d=="near"){var h=Math.max(D.offsetHeight,$.length*cE()),i=Math.max(J.clientWidth,T.clientWidth)-cG();a.yBot+b.offsetHeight>h&&a.y>b.offsetHeight&&(f=a.y-b.offsetHeight),g+b.offsetWidth>i&&(g=i-b.offsetWidth)}b.style.top=f+cF()+"px",b.style.left=b.style.right="",e=="right"?(g=J.clientWidth-b.offsetWidth,b.style.right="0px"):(e=="left"?g=0:e=="middle"&&(g=(J.clientWidth-b.offsetWidth)/2),b.style.left=g+cG()+"px"),c&&bZ(g,f,g+b.offsetWidth,f+b.offsetHeight)},lineCount:function(){return $.length},getCursor:function(a){return I(a?bc.from:bc.to)},getCursorRange:function(){return{from:I(bc.from),to:I(bc.to)}},somethingSelected:function(){return!G(bc.from,bc.to)},setCursor:cU(function(a,b){b==null&&typeof a.line=="number"?cg(a.line,a.ch):cg(a,b)}),setSelection:cU(function(a,b){cf(ci(a),ci(b||a))}),getLine:function(a){if(bv(a))return $[a].text},setLine:cU(function(a,b){bv(a)&&bM(b,{line:a,ch:0},{line:a,ch:$[a].text.length})}),removeLine:cU(function(a){bv(a)&&bM("",{line:a,ch:0},ci({line:a+1,ch:0}))}),replaceRange:cU(bM),getRange:function(a,b){return bP(ci(a),ci(b))},operation:function(a){return cU(a)()},refresh:function(){b_(!0)},getInputField:function(){return C},getWrapperElement:function(){return w},getScrollerElement:function(){return D},getGutterElement:function(){return R}},bR=!1,cK={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},cT=0;cV.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(a){function d(a){var c={line:a,ch:0};b.pos={from:c,to:c},b.atOccurrence=!1;return!1}var b=this,c=ci(a?this.pos.from:this.pos.to);for(;;){if(this.pos=this.matches(a,c)){this.atOccurrence=!0;return this.pos.match||!0}if(a){if(!c.line)return d(0);c={line:c.line-1,ch:$[c.line-1].text.length}}else{if(c.line==$.length-1)return d($.length);c={line:c.line+1,ch:0}}}},from:function(){if(this.atOccurrence)return I(this.pos.from)},to:function(){if(this.atOccurrence)return I(this.pos.to)},replace:function(a){var b=this;this.atOccurrence&&cU(function(){b.pos.to=bM(a,b.pos.from,b.pos.to)})()}};for(var cW in d)d.propertyIsEnumerable(cW)&&!bw.propertyIsEnumerable(cW)&&(bw[cW]=d[cW]);return bw}a.defaults={value:"",mode:null,theme:"default",indentUnit:2,indentWithTabs:!1,tabMode:"classic",enterMode:"indent",electricChars:!0,onKeyEvent:null,lineNumbers:!1,gutter:!1,fixedGutter:!1,firstLineNumber:1,readOnly:!1,smartHome:!0,onChange:null,onCursorActivity:null,onGutterClick:null,onHighlightComplete:null,onFocus:null,onBlur:null,onScroll:null,matchBrackets:!1,workTime:100,workDelay:200,undoDepth:40,tabindex:null,document:window.document};var b={},c={};a.defineMode=function(c,d){!a.defaults.mode&&c!="null"&&(a.defaults.mode=c),b[c]=d},a.defineMIME=function(a,b){c[a]=b},a.getMode=function(d,e){typeof e=="string"&&c.hasOwnProperty(e)&&(e=c[e]);if(typeof e=="string")var f=e,g={};else if(e!=null)var f=e.name,g=e;var h=b[f];if(!h){window.console&&console.warn("No mode "+f+" found, falling back to plain text.");return a.getMode(d,"text/plain")}return h(d,g||{})},a.listModes=function(){var a=[];for(var c in b)b.propertyIsEnumerable(c)&&a.push(c);return a},a.listMIMEs=function(){var a=[];for(var b in c)c.propertyIsEnumerable(b)&&a.push(b);return a};var d={};a.defineExtension=function(a,b){d[a]=b},a.fromTextArea=function(b,c){function d(){b.value=h.getValue()}c||(c={}),c.value=b.value,!c.tabindex&&b.tabindex&&(c.tabindex=b.tabindex);if(b.form){var e=r(b.form,"submit",d,!0);if(typeof b.form.submit=="function"){var f=b.form.submit;function g(){d(),b.form.submit=f,b.form.submit(),b.form.submit=g}b.form.submit=g}}b.style.display="none";var h=a(function(a){b.parentNode.insertBefore(a,b.nextSibling)},c);h.save=d,h.toTextArea=function(){d(),b.parentNode.removeChild(h.getWrapperElement()),b.style.display="",b.form&&(e(),typeof b.form.submit=="function"&&(b.form.submit=f))};return h},a.startState=f,a.copyState=e,g.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(a){var b=this.string.charAt(this.pos);if(typeof a=="string")var c=b==a;else var c=b&&(a.test?a.test(b):a(b));if(c){++this.pos;return b}},eatWhile:function(a){var b=this.pos;while(this.eat(a)){}return this.pos>b},eatSpace:function(){var a=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>a},skipToEnd:function(){this.pos=this.string.length},skipTo:function(a){var b=this.string.indexOf(a,this.pos);if(b>-1){this.pos=b;return!0}},backUp:function(a){this.pos-=a},column:function(){return C(this.string,this.start)},indentation:function(){return C(this.string)},match:function(a,b,c){if(typeof a!="string"){var e=this.string.slice(this.pos).match(a);e&&b!==!1&&(this.pos+=e[0].length);return e}function d(a){return c?a.toLowerCase():a}if(d(this.string).indexOf(d(a),this.pos)==this.pos){b!==!1&&(this.pos+=a.length);return!0}},current:function(){return this.string.slice(this.start,this.pos)}},a.StringStream=g,h.prototype={replace:function(a,b,c){var d=[],e=this.marked;i(0,a,this.styles,d),c&&d.push(c,null),i(b,this.text.length,this.styles,d),this.styles=d,this.text=this.text.slice(0,a)+c+this.text.slice(b),this.stateAfter=null;if(e){var f=c.length-(b-a),g=this.text.length;function h(a){return a<=Math.min(b,b+f)?a:a+f}for(var j=0;j<e.length;++j){var k=e[j],l=!1;k.from<g?(k.from=h(k.from),k.to!=null&&(k.to=h(k.to))):l=!0;if(l||k.from>=k.to)e.splice(j,1),j--}}},split:function(a,b){var c=[b,null];i(a,this.text.length,this.styles,c);return new h(b+this.text.slice(a),c)},addMark:function(a,b,c){var d=this.marked,e={from:a,to:b,style:c};this.marked==null&&(this.marked=[]),this.marked.push(e),this.marked.sort(function(a,b){return a.from-b.from});return e},removeMark:function(a){var b=this.marked;if(b)for(var c=0;c<b.length;++c)if(b[c]==a){b.splice(c,1);break}},highlight:function(a,b){var c=new g(this.text),d=this.styles,e=0,f=!1,h=d[0],i;this.text==""&&a.blankLine&&a.blankLine(b);while(!c.eol()){var j=a.token(c,b),k=this.text.slice(c.start,c.pos);c.start=c.pos,e&&d[e-1]==j?d[e-2]+=k:k&&(!f&&(d[e+1]!=j||e&&d[e-2]!=i)&&(f=!0),d[e++]=k,d[e++]=j,i=h,h=d[e]);if(c.pos>5e3){d[e++]=this.text.slice(c.pos),d[e++]=null;break}}d.length!=e&&(d.length=e,f=!0),e&&d[e-2]!=i&&(f=!0);return f||(d.length<5&&this.text.length<10?null:!1)},getTokenAt:function(a,b,c){var d=this.text,e=new g(d);while(e.pos<c&&!e.eol()){e.start=e.pos;var f=a.token(e,b)}return{start:e.start,end:e.pos,string:e.current(),className:f||null,state:b}},indentation:function(){return C(this.text)},getHTML:function(a,b,c,d){function f(a,b){a&&(b?e.push('<span class="',b,'">',K(a),"</span>"):e.push(K(a)))}var e=[];c&&e.push(this.className?'<pre class="'+this.className+'">':"<pre>");var g=this.styles,h=this.text,i=this.marked;a==b&&(a=null);var j=h.length;d!=null&&(j=Math.min(d,j));if(h||d!=null)if(i||a!=null){var o=0,k=0,p="",q,r=0,s=-1,t=null;function u(){i&&(s+=1,t=s<i.length?i[s]:null)}u();while(o<j){var v=j,w="";if(a!=null)if(a>o)v=a;else if(b==null||b>o)w=" CodeMirror-selected",b!=null&&(v=Math.min(v,b));while(t&&t.to!=null&&t.to<=o)u();t&&(t.from>o?v=Math.min(v,t.from):(w+=" "+t.style,t.to!=null&&(v=Math.min(v,t.to))));for(;;){var x=o+p.length,y=q;w&&(y=q?q+w:w),f(x>v?p.slice(0,v-o):p,y);if(x>=v){p=p.slice(v-o),o=v;break}o=x,p=g[k++],q="cm-"+g[k++]}}a!=null&&b==null&&f(" ","CodeMirror-selected")}else for(var k=0,l=0;l<j;k+=2){var m=g[k],n=m.length;l+n>j&&(m=m.slice(0,j-l)),l+=n,f(m,"cm-"+g[k+1])}else f(" ",a!=null&&b==null?"CodeMirror-selected":null);c&&e.push("</pre>");return e.join("")}},j.prototype={addChange:function(a,b,c){this.undone.length=0;var d=+(new Date),e=this.done[this.done.length-1];if(d-this.time>400||!e||e.start>a+b||e.start+e.added<a-e.added+e.old.length)this.done.push({start:a,added:b,old:c});else{var f=0;if(a<e.start){for(var g=e.start-a-1;g>=0;--g)e.old.unshift(c[g]);e.added+=e.start-a,e.start=a}else e.start<a&&(f=a-e.start,b+=f);for(var g=e.added-f,h=c.length;g<h;++g)e.old.push(c[g]);e.added<b&&(e.added=b)}this.time=d}},s.prototype={set:function(a,b){clearTimeout(this.id),this.id=setTimeout(b,a)}};var t=function(){var a=document.createElement("pre");a.innerHTML=" ";return!a.innerHTML}(),u=/gecko\/\d{7}/i.test(navigator.userAgent),v=/MSIE \d/.test(navigator.userAgent),w=/Apple Computer/.test(navigator.vendor),x="\n";(function(){var a=document.createElement("textarea");a.value="foo\nbar",a.value.indexOf("\r")>-1&&(x="\r\n")})();var y=8,z=/Mac/.test(navigator.platform),A={};for(var B=35;B<=40;++B)A[B]=A["c"+B]=!0;var J=document.createElement("div");a.htmlEscape=K;var N,O,P;"\n\nb".split(/\n/).length!=3?N=function(a){var b=0,c,d=[];while((c=a.indexOf("\n",b))>-1)d.push(a.slice(b,a.charAt(c-1)=="\r"?c-1:c)),b=c+1;d.push(a.slice(b));return d}:N=function(a){return a.split(/\r?\n/)},a.splitLines=N,window.getSelection?(O=function(a){try{return{start:a.selectionStart,end:a.selectionEnd}}catch(b){return null}},w?P=function(a,b,c){b==c?a.setSelectionRange(b,c):(a.setSelectionRange(b,c-1),window.getSelection().modify("extend","forward","character"))}:P=function(a,b,c){try{a.setSelectionRange(b,c)}catch(d){}}):(O=function(a){try{var b=a.ownerDocument.selection.createRange()}catch(c){return null}if(!b||b.parentElement()!=a)return null;var d=a.value,e=d.length,f=a.createTextRange();f.moveToBookmark(b.getBookmark());var g=a.createTextRange();g.collapse(!1);if(f.compareEndPoints("StartToEnd",g)>-1)return{start:e,end:e};var h=-f.moveStart("character",-e);for(var i=d.indexOf("\r");i>-1&&i<h;i=d.indexOf("\r",i+1),h++){}if(f.compareEndPoints("EndToEnd",g)>-1)return{start:h,end:e};var j=-f.moveEnd("character",-e);for(var i=d.indexOf("\r");i>-1&&i<j;i=d.indexOf("\r",i+1),j++){}return{start:h,end:j}},P=function(a,b,c){var d=a.createTextRange();d.collapse(!0);var e=d.duplicate(),f=0,g=a.value;for(var h=g.indexOf("\n");h>-1&&h<b;h=g.indexOf("\n",h+1))++f;d.move("character",b-f);for(;h>-1&&h<c;h=g.indexOf("\n",h+1))++f;e.move("character",c-f),d.setEndPoint("EndToEnd",e),d.select()}),a.defineMode("null",function(){return{token:function(a){a.skipToEnd()}}}),a.defineMIME("text/plain","null");return a}();define("lib/codemirror2/codemirror",function(){});var XRegExp;if(XRegExp)throw Error("can't load XRegExp twice in the same frame");(function(){function o(a,b,c){if(Array.prototype.indexOf)return a.indexOf(b,c);for(var d=c||0;d<a.length;d++)if(a[d]===b)return d;return-1}function n(a,b,c,f){var g=e.length,h,i,j;d=!0;try{while(g--){j=e[g];if(c&j.scope&&(!j.trigger||j.trigger.call(f))){j.pattern.lastIndex=b,i=j.pattern.exec(a);if(i&&i.index===b){h={output:j.handler.call(f,i,c),match:i};break}}}}catch(k){throw k}finally{d=!1}return h}function m(a){return(a.global?"g":"")+(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.extended?"x":"")+(a.sticky?"y":"")}function l(a,b){if(!XRegExp.isRegExp(a))throw TypeError("type RegExp expected");var c=a._xregexp;a=XRegExp(a.source,m(a)+(b||"")),c&&(a._xregexp={source:c.source,captureNames:c.captureNames?c.captureNames.slice(0):null});return a}XRegExp=function(a,c){var e=[],g=XRegExp.OUTSIDE_CLASS,h=0,i,j,m,o,p;if(XRegExp.isRegExp(a)){if(c!==undefined)throw TypeError("can't supply flags when constructing one RegExp from another");return l(a)}if(d)throw Error("can't call the XRegExp constructor within token definition functions");c=c||"",i={hasNamedCapture:!1,captureNames:[],hasFlag:function(a){return c.indexOf(a)>-1},setFlag:function(a){c+=a}};while(h<a.length)j=n(a,h,g,i),j?(e.push(j.output),h+=j.match[0].length||1):(m=f.exec.call(k[g],a.slice(h)))?(e.push(m[0]),h+=m[0].length):(o=a.charAt(h),o==="["?g=XRegExp.INSIDE_CLASS:o==="]"&&(g=XRegExp.OUTSIDE_CLASS),e.push(o),h++);p=RegExp(e.join(""),f.replace.call(c,b,"")),p._xregexp={source:a,captureNames:i.hasNamedCapture?i.captureNames:null};return p},XRegExp.version="1.5.0",XRegExp.INSIDE_CLASS=1,XRegExp.OUTSIDE_CLASS=2;var a=/\$(?:(\d\d?|[$&`'])|{([$\w]+)})/g,b=/[^gimy]+|([\s\S])(?=[\s\S]*\1)/g,c=/^(?:[?*+]|{\d+(?:,\d*)?})\??/,d=!1,e=[],f={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},g=f.exec.call(/()??/,"")[1]===undefined,h=function(){var a=/^/g;f.test.call(a,"");return!a.lastIndex}(),i=function(){var a=/x/g;f.replace.call("x",a,"");return!a.lastIndex}(),j=RegExp.prototype.sticky!==undefined,k={};k[XRegExp.INSIDE_CLASS]=/^(?:\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S]))/,k[XRegExp.OUTSIDE_CLASS]=/^(?:\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S])|\(\?[:=!]|[?*+]\?|{\d+(?:,\d*)?}\??)/,XRegExp.addToken=function(a,b,c,d){e.push({pattern:l(a,"g"+(j?"y":"")),handler:b,scope:c||XRegExp.OUTSIDE_CLASS,trigger:d||null})},XRegExp.cache=function(a,b){var c=a+"/"+(b||"");return XRegExp.cache[c]||(XRegExp.cache[c]=XRegExp(a,b))},XRegExp.copyAsGlobal=function(a){return l(a,"g")},XRegExp.escape=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},XRegExp.execAt=function(a,b,c,d){b=l(b,"g"+(d&&j?"y":"")),b.lastIndex=c=c||0;var e=b.exec(a);return d?e&&e.index===c?e:null:e},XRegExp.freezeTokens=function(){XRegExp.addToken=function(){throw Error("can't run addToken after freezeTokens")}},XRegExp.isRegExp=function(a){return Object.prototype.toString.call(a)==="[object RegExp]"},XRegExp.iterate=function(a,b,c,d){var e=l(b,"g"),f=-1,g;while(g=e.exec(a))c.call(d,g,++f,a,e),e.lastIndex===g.index&&e.lastIndex++;b.global&&(b.lastIndex=0)},XRegExp.matchChain=function(a,b){return function c(a,d){var e=b[d].regex?b[d]:{regex:b[d]},f=l(e.regex,"g"),g=[],h;for(h=0;h<a.length;h++)XRegExp.iterate(a[h],f,function(a){g.push(e.backref?a[e.backref]||"":a[0])});return d===b.length-1||!g.length?g:c(g,d+1)}([a],0)},RegExp.prototype.apply=function(a,b){return this.exec(b[0])},RegExp.prototype.call=function(a,b){return this.exec(b)},RegExp.prototype.exec=function(a){var b=f.exec.apply(this,arguments),c,d;if(b){!g&&b.length>1&&o(b,"")>-1&&(d=RegExp(this.source,f.replace.call(m(this),"g","")),f.replace.call(a.slice(b.index),d,function(){for(var a=1;a<arguments.length-2;a++)arguments[a]===undefined&&(b[a]=undefined)}));if(this._xregexp&&this._xregexp.captureNames)for(var e=1;e<b.length;e++)c=this._xregexp.captureNames[e-1],c&&(b[c]=b[e]);!h&&this.global&&!b[0].length&&this.lastIndex>b.index&&this.lastIndex--}return b},h||(RegExp.prototype.test=function(a){var b=f.exec.call(this,a);b&&this.global&&!b[0].length&&this.lastIndex>b.index&&this.lastIndex--;return!!b}),String.prototype.match=function(a){XRegExp.isRegExp(a)||(a=RegExp(a));if(a.global){var b=f.match.apply(this,arguments);a.lastIndex=0;return b}return a.exec(this)},String.prototype.replace=function(b,c){var d=XRegExp.isRegExp(b),e,g,h;if(d&&typeof c.valueOf()==="string"&&c.indexOf("${")===-1&&i)return f.replace.apply(this,arguments);d?b._xregexp&&(e=b._xregexp.captureNames):b=b+"",typeof c==="function"?g=f.replace.call(this,b,function(){if(e){arguments[0]=new String(arguments[0]);for(var a=0;a<e.length;a++)e[a]&&(arguments[0][e[a]]=arguments[a+1])}d&&b.global&&(b.lastIndex=arguments[arguments.length-2]+arguments[0].length);return c.apply(null,arguments)}):(h=this+"",g=f.replace.call(h,b,function(){var b=arguments;return f.replace.call(c,a,function(a,c,d){if(!c){var g=+d;if(g<=b.length-3)return b[g];g=e?o(e,d):-1;return g>-1?b[g+1]:a}switch(c){case"$":return"$";case"&":return b[0];case"`":return b[b.length-1].slice(0,b[b.length-2]);case"'":return b[b.length-1].slice(b[b.length-2]+b[0].length);default:var f="";c=+c;if(!c)return a;while(c>b.length-3)f=String.prototype.slice.call(c,-1)+f,c=Math.floor(c/10);return(c?b[c]||"":"$")+f}})})),d&&b.global&&(b.lastIndex=0);return g},String.prototype.split=function(a,b){if(!XRegExp.isRegExp(a))return f.split.apply(this,arguments);var c=this+"",d=[],e=0,g,h;if(b===undefined||+b<0)b=Infinity;else{b=Math.floor(+b);if(!b)return[]}a=XRegExp.copyAsGlobal(a);while(g=a.exec(c)){if(a.lastIndex>e){d.push(c.slice(e,g.index)),g.length>1&&g.index<c.length&&Array.prototype.push.apply(d,g.slice(1)),h=g[0].length,e=a.lastIndex;if(d.length>=b)break}a.lastIndex===g.index&&a.lastIndex++}e===c.length?(!f.test.call(a,"")||h)&&d.push(""):d.push(c.slice(e));return d.length>b?d.slice(0,b):d},XRegExp.addToken(/\(\?#[^)]*\)/,function(a){return f.test.call(c,a.input.slice(a.index+a[0].length))?"":"(?:)"}),XRegExp.addToken(/\((?!\?)/,function(){this.captureNames.push(null);return"("}),XRegExp.addToken(/\(\?<([$\w]+)>/,function(a){this.captureNames.push(a[1]),this.hasNamedCapture=!0;return"("}),XRegExp.addToken(/\\k<([\w$]+)>/,function(a){var b=o(this.captureNames,a[1]);return b>-1?"\\"+(b+1)+(isNaN(a.input.charAt(a.index+a[0].length))?"":"(?:)"):a[0]}),XRegExp.addToken(/\[\^?]/,function(a){return a[0]==="[]"?"\\b\\B":"[\\s\\S]"}),XRegExp.addToken(/^\(\?([imsx]+)\)/,function(a){this.setFlag(a[1]);return""}),XRegExp.addToken(/(?:\s+|#.*)+/,function(a){return f.test.call(c,a.input.slice(a.index+a[0].length))?"":"(?:)"},XRegExp.OUTSIDE_CLASS,function(){return this.hasFlag("x")}),XRegExp.addToken(/\./,function(){return"[\\s\\S]"},XRegExp.OUTSIDE_CLASS,function(){return this.hasFlag("s")})})(),define("lib/tools/xregexp",function(){}),Math.sinh=function(a){return(Math.exp(a)-Math.exp(-a))/2},function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");Math.uuid=function(b,c){var d=a,e=[];c=c||d.length;if(b)for(var f=0;f<b;f++)e[f]=d[0|Math.random()*c];else{var g;e[8]=e[13]=e[18]=e[23]="-",e[14]="4";for(var f=0;f<36;f++)e[f]||(g=0|Math.random()*16,e[f]=d[f==19?g&3|8:g])}return e.join("")},Math.uuidFast=function(){var b=a,c=Array(36),d=0,e;for(var f=0;f<36;f++)f==8||f==13||f==18||f==23?c[f]="-":f==14?c[f]="4":(d<=2&&(d=33554432+Math.random()*16777216|0),e=d&15,d=d>>4,c[f]=b[f==19?e&3|8:e]);return c.join("")},Math.uuidCompact=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)}).toUpperCase()}}(),define("lib/tools/math",function(){}),function(a,b){a.fn.serializeObject=function(){var c={};a.each(this.serializeArray(),function(d,e){var f=e.name,g=e.value;c[f]=c[f]===b?g:a.isArray(c[f])?c[f].concat(g):[c[f],g]});return c}}(jQuery),define("lib/jquery/jquery.serialobj",function(){}),function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function g(){!a&&this.init&&this.init.apply(this,arguments)}var d=this.prototype;a=!0;var e=new this;a=!1;for(var f in c)e[f]=typeof c[f]=="function"&&typeof d[f]=="function"&&b.test(c[f])?function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);this._super=c;return e}}(f,c[f]):c[f];g.prototype=e,g.constructor=g,g.extend=arguments.callee;return g}}(),define("lib/jquery/jquery.class",function(){});var CHARS="0123456789abcdefghijklmnopqrstuvwxyz".split("");Math.uuidFast=function(){var a=CHARS,b=Array(36),c=0,d;for(var e=0;e<36;e++)e==8||e==13||e==18||e==23?b[e]="-":e==14?b[e]="4":(c<=2&&(c=33554432+Math.random()*16777216|0),d=c&15,c=c>>4,b[e]=a[e==19?d&3|8:d]);return b.join("")},function(a){a.extend({websocketSettings:{open:function(){},close:function(){},message:function(){},error:function(){},options:{},methods:{},message_cb:function(){}},websocket:function(b,c){if("WebSocket"in window){var d=WebSocket?new WebSocket(b):{send:function(a){return!1},close:function(){},open:function(){},error:function(){}};d.remote_callback={}}else{if(!("MozWebSocket"in window)){a(document).trigger("BAD_BROWSER",["NO_WEBSOCKET"]);return!1}var d=MozWebSocket?new MozWebSocket(b):{send:function(a){return!1},close:function(){},open:function(){},error:function(){}};d.remote_callback={}}d._settings=a.extend(a.websocketSettings,c),d.redirect=null,a(d).bind("open",a.websocketSettings.open).bind("close",a.websocketSettings.close).bind("error",a.websocketSettings.error).bind("message",function(b){var c=JSON.parse(b.originalEvent.data);if(c instanceof Array&&typeof c[0]=="string"){var e=!1;a.each(a.websocketSettings.methods,function(b,f){var g=c[0].match(f[0]),h={};if(g!=null){e=!0;for(key in g)isNaN(key)&&key!="index"&&key!="input"&&(h[key]=g[key]);if(c[1]instanceof Array)h.params=c[1];else for(key in c[1])h[key]=c[1][key];"status"in c[1]&&(a("#notify-container").notify("create",d.tt[c[1].status.type],{i18n:c[1].status.i18n}),"state"in c[1].status&&history.pushState(null,null,c[1].status.state)),f[1](h)}}),"status"in c[1]&&e==!1&&a("#notify-container").notify("create",d.tt[c[1].status.type],{i18n:c[1].status.i18n})}else c[0]!=!1?(a.each(d.remote_callback[c[1]],function(a,b){a==c[2]&&(b(c[0]),delete d.remote_callback[c[1]][a],c[0].data!=undefined&&("plasmoids"in c[0].data&&d._settings.message_cb("plasmoids",c[0].data.plasmoids)))}),"status"in c[0]&&("i18n"in c[0].status&&a("#notify-container").notify("create",d.tt[c[0].status.type],{i18n:c[0].status.i18n}),"state"in c[0].status&&history.pushState(null,null,c[0].status.state))):(application.settings.user.is_authenticated||application.route_uri_to_mod("/data/profiles/login/access_denied/",!1),console.log("Access to resource denied..."))}),d.remote=function(a,b,c){d.remote_callback.hasOwnProperty(a)||(d.remote_callback[a]={});var e=Math.uuidFast();d.remote_callback[a][e]=c;return d.send(JSON.stringify([a,b,e]))},d.method=function(b,c){var d=XRegExp(b);b in a.websocketSettings.methods||(a.websocketSettings.methods[b]=[d,c])},a(window).unload(function(){d.close(),d=null});return d}})}(jQuery),define("lib/jquery/jquery.ws",function(){}),function(a){function b(c){var d=this;d.name=c.id,d.opts=c,d.setup_context=function(b){if(a("#"+d.opts.id).length==0){a("body").append("<div id="+d.opts.id+' class="context-menu"></div>');var c=a("#"+d.opts.id);c.html(b),c.unbind().bind("mouseleave",function(b){c.find("div[data-ctx]").each(function(b,c){a(this).addClass("ui-state-disabled")}),c.find("div[data-ctx-showid]").each(function(b,c){a(this).addClass("ui-state-hidden")}),a(".context-menu").hide()}),c.find(".context-menu-option").die().live("click",function(b){a(this).hasClass("ui-state-disabled")||a(".context-menu").css("left",-1e3)}),a(d.opts.anchor).delegate(d.opts.delegate+" div","contextmenu",d.process_context)}},b.prototype.load_context=function(){d.opts.uri!==undefined?application.ws.remote(d.opts.uri,{},function(a){d.setup_context(a.data.dom.context)}):d.opts.data!==undefined&&d.setup_context(d.opts.data)},d.process_context=function(b){var c=a("#"+d.opts.id+" > .context-menu-option");if(c.size()>0){var e=a(this).data(),f=a("#"+d.opts.id);f.find(".context-menu-option").each(function(b,c){"id"in e&&a(this).data("id",e.id)}),"ctxmatch"in e&&(typeof e.ctxmatch=="object"?a.each(e.ctxmatch,function(b,c){f.find(".context-menu-option").each(function(b,d){var e=a(this).data();"ctx"in e&&(e.ctx==c&&a(this).removeClass("ui-state-disabled"))})}):typeof e.ctxmatch=="string"&&(console.log(e.ctxmatch),f.find(".context-menu-option").each(function(b,c){var d=a(this).data();"ctx"in d&&(d.ctx==e.ctxmatch&&a(this).removeClass("ui-state-disabled"))}))),a.each(a("#"+d.opts.id+" > .context-menu-option"),function(b,c){var d=a(this).data();"ctxShowid"in d&&"ctxShowid"in e?d.ctxShowid==e.ctxShowid?a(this).removeClass("ui-state-hidden"):a(this).addClass("ui-state-hidden"):"ctxHideid"in d&&"ctxHideid"in e&&(d.ctxHideid==e.ctxHideid?a(this).addClass("ui-state-hidden"):a(this).removeClass("ui-state-hidden"))}),a(c).filter(":not(.ui-state-hidden)").length>0&&(f.css("left",b.pageX-10),f.css("top",b.pageY-10),f.css("cursor","default"),f.show(),b.preventDefault())}},d.reload_context=function(b){b.length>0?(a("#"+d.opts.id).empty(),a("#"+d.opts.id).html(b),a(d.opts.anchor).undelegate(d.opts.delegate+" div").delegate(d.opts.delegate+" div","contextmenu",d.process_context)):(a(d.opts.anchor).undelegate(d.opts.delegate+" div","contextmenu",d.process_context),a("#"+d.opts.id).empty())},d.reload=function(a){a!==undefined?d.reload_context(a):d.opts.uri!==undefined?application.ws.remote(d.opts.uri,{},function(a){d.reload_context(a.data.dom.context)}):console.warn("Invalid reload options")},d.load_context()}a.extend({context:function(c){return new b(a.extend({},a.ctx_defaults,c))}})}(jQuery),define("lib/jquery/jquery.context",function(){});var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;diff_match_patch.prototype.diff_main=function(a,b,c){if(a==b)return[[DIFF_EQUAL,a]];typeof c=="undefined"&&(c=!0);var d=c,e=this.diff_commonPrefix(a,b),f=a.substring(0,e);a=a.substring(e),b=b.substring(e),e=this.diff_commonSuffix(a,b);var g=a.substring(a.length-e);a=a.substring(0,a.length-e),b=b.substring(0,b.length-e);var h=this.diff_compute(a,b,d);f&&h.unshift([DIFF_EQUAL,f]),g&&h.push([DIFF_EQUAL,g]),this.diff_cleanupMerge(h);return h},diff_match_patch.prototype.diff_compute=function(a,b,c){var d;if(!a)return[[DIFF_INSERT,b]];if(!b)return[[DIFF_DELETE,a]];var e=a.length>b.length?a:b,f=a.length>b.length?b:a,g=e.indexOf(f);if(g!=-1){d=[[DIFF_INSERT,e.substring(0,g)],[DIFF_EQUAL,f],[DIFF_INSERT,e.substring(g+f.length)]],a.length>b.length&&(d[0][0]=d[2][0]=DIFF_DELETE);return d}e=f=null;var h=this.diff_halfMatch(a,b);if(h){var i=h[0],j=h[1],k=h[2],l=h[3],m=h[4],n=this.diff_main(i,k,c),o=this.diff_main(j,l,c);return n.concat([[DIFF_EQUAL,m]],o)}c&&(a.length<100||b.length<100)&&(c=!1);var p;if(c){var q=this.diff_linesToChars(a,b);a=q[0],b=q[1],p=q[2]}d=this.diff_map(a,b),d||(d=[[DIFF_DELETE,a],[DIFF_INSERT,b]]);if(c){this.diff_charsToLines(d,p),this.diff_cleanupSemantic(d),d.push([DIFF_EQUAL,""]);var r=0,s=0,t=0,u="",v="";while(r<d.length){switch(d[r][0]){case DIFF_INSERT:t++,v+=d[r][1];break;case DIFF_DELETE:s++,u+=d[r][1];break;case DIFF_EQUAL:if(s>=1&&t>=1){var q=this.diff_main(u,v,!1);d.splice(r-s-t,s+t),r=r-s-t;for(var w=q.length-1;w>=0;w--)d.splice(r,0,q[w]);r=r+q.length}t=0,s=0,u="",v=""}r++}d.pop()}return d},diff_match_patch.prototype.diff_linesToChars=function(a,b){function e(a){var b="",e=0,f=-1,g=c.length;while(f<a.length-1){f=a.indexOf("\n",e),f==-1&&(f=a.length-1);var h=a.substring(e,f+1);e=f+1,(d.hasOwnProperty?d.hasOwnProperty(h):d[h]!==undefined)?b+=String.fromCharCode(d[h]):(b+=String.fromCharCode(g),d[h]=g,c[g++]=h)}return b}var c=[],d={};c[0]="";var f=e(a),g=e(b);return[f,g,c]},diff_match_patch.prototype.diff_charsToLines=function(a,b){for(var c=0;c<a.length;c++){var d=a[c][1],e=[];for(var f=0;f<d.length;f++)e[f]=b[d.charCodeAt(f)];a[c][1]=e.join("")}},diff_match_patch.prototype.diff_map=function(a,b){var c=(new Date).getTime()+this.Diff_Timeout*1e3,d=a.length+b.length-1,e=this.Diff_DualThreshold*2<d,f=[],g=[],h={},i={};h[1]=0,i[1]=0;var j,k,l,m={},n=!1,o=!!m.hasOwnProperty,p=(a.length+b.length)%2;for(var q=0;q<d;q++){if(this.Diff_Timeout>0&&(new Date).getTime()>c)return null;f[q]={};for(var r=-q;r<=q;r+=2){r==-q||r!=q&&h[r-1]<h[r+1]?j=h[r+1]:j=h[r-1]+1,k=j-r,e&&(l=j+","+k,p&&(o?m.hasOwnProperty(l):m[l]!==undefined)&&(n=!0),p||(m[l]=q));while(!n&&j<a.length&&k<b.length&&a.charAt(j)==b.charAt(k))j++,k++,e&&(l=j+","+k,p&&(o?m.hasOwnProperty(l):m[l]!==undefined)&&(n=!0),p||(m[l]=q));h[r]=j,f[q][j+","+k]=!0;if(j==a.length&&k==b.length)return this.diff_path1(f,a,b);if(n){g=g.slice(0,m[l]+1);var s=this.diff_path1(f,a.substring(0,j),b.substring(0,k));return s.concat(this.diff_path2(g,a.substring(j),b.substring(k)))}}if(e){g[q]={};for(var r=-q;r<=q;r+=2){r==-q||r!=q&&i[r-1]<i[r+1]?j=i[r+1]:j=i[r-1]+1,k=j-r,l=a.length-j+","+(b.length-k),!p&&(o?m.hasOwnProperty(l):m[l]!==undefined)&&(n=!0),p&&(m[l]=q);while(!n&&j<a.length&&k<b.length&&a.charAt(a.length-j-1)==b.charAt(b.length-k-1))j++,k++,l=a.length-j+","+(b.length-k),!p&&(o?m.hasOwnProperty(l):m[l]!==undefined)&&(n=!0),p&&(m[l]=q);i[r]=j,g[q][j+","+k]=!0;if(n){f=f.slice(0,m[l]+1);var s=this.diff_path1(f,a.substring(0,a.length-j),b.substring(0,b.length-k));return s.concat(this.diff_path2(g,a.substring(a.length-j),b.substring(b.length-k)))}}}}return null},diff_match_patch.prototype.diff_path1=function(a,b,c){var d=[],e=b.length,f=c.length,g=null;for(var h=a.length-2;h>=0;h--)while(1){if(a[h].hasOwnProperty?a[h].hasOwnProperty(e-1+","+f):a[h][e-1+","+f]!==undefined){e--,g===DIFF_DELETE?d[0][1]=b.charAt(e)+d[0][1]:d.unshift([DIFF_DELETE,b.charAt(e)]),g=DIFF_DELETE;break}if(a[h].hasOwnProperty?a[h].hasOwnProperty(e+","+(f-1)):a[h][e+","+(f-1)]!==undefined){f--,g===DIFF_INSERT?d[0][1]=c.charAt(f)+d[0][1]:d.unshift([DIFF_INSERT,c.charAt(f)]),g=DIFF_INSERT;break}e--,f--,g===DIFF_EQUAL?d[0][1]=b.charAt(e)+d[0][1]:d.unshift([DIFF_EQUAL,b.charAt(e)]),g=DIFF_EQUAL}return d},diff_match_patch.prototype.diff_path2=function(a,b,c){var d=[],e=0,f=b.length,g=c.length,h=null;for(var i=a.length-2;i>=0;i--)while(1){if(a[i].hasOwnProperty?a[i].hasOwnProperty(f-1+","+g):a[i][f-1+","+g]!==undefined){f--,h===DIFF_DELETE?d[e-1][1]+=b.charAt(b.length-f-1):d[e++]=[DIFF_DELETE,b.charAt(b.length-f-1)],h=DIFF_DELETE;break}if(a[i].hasOwnProperty?a[i].hasOwnProperty(f+","+(g-1)):a[i][f+","+(g-1)]!==undefined){g--,h===DIFF_INSERT?d[e-1][1]+=c.charAt(c.length-g-1):d[e++]=[DIFF_INSERT,c.charAt(c.length-g-1)],h=DIFF_INSERT;break}f--,g--,h===DIFF_EQUAL?d[e-1][1]+=b.charAt(b.length-f-1):d[e++]=[DIFF_EQUAL,b.charAt(b.length-f-1)],h=DIFF_EQUAL}return d},diff_match_patch.prototype.diff_commonPrefix=function(a,b){if(!a||!b||a.charCodeAt(0)!==b.charCodeAt(0))return 0;var c=0,d=Math.min(a.length,b.length),e=d,f=0;while(c<e)a.substring(f,e)==b.substring(f,e)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e},diff_match_patch.prototype.diff_commonSuffix=function(a,b){if(!a||!b||a.charCodeAt(a.length-1)!==b.charCodeAt(b.length-1))return 0;var c=0,d=Math.min(a.length,b.length),e=d,f=0;while(c<e)a.substring(a.length-e,a.length-f)==b.substring(b.length-e,b.length-f)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e},diff_match_patch.prototype.diff_halfMatch=function(a,b){function f(a,b,c){var d=a.substring(c,c+Math.floor(a.length/4)),f=-1,g="",h,i,j,k;while((f=b.indexOf(d,f+1))!=-1){var l=e.diff_commonPrefix(a.substring(c),b.substring(f)),m=e.diff_commonSuffix(a.substring(0,c),b.substring(0,f));g.length<m+l&&(g=b.substring(f-m,f)+b.substring(f,f+l),h=a.substring(0,c-m),i=a.substring(c+l),j=b.substring(0,f-m),k=b.substring(f+l))}return g.length<a.length/2?null:[h,i,j,k,g]}var c=a.length>b.length?a:b,d=a.length>b.length?b:a;if(c.length<10||d.length<1)return null;var e=this,g=f(c,d,Math.ceil(c.length/4)),h=f(c,d,Math.ceil(c.length/2)),i;if(g||h)h?g?i=g[4].length>h[4].length?g:h:i=h:i=g;else return null;var j,k,l,m;a.length>b.length?(j=i[0],k=i[1],l=i[2],m=i[3]):(l=i[0],m=i[1],j=i[2],k=i[3]);var n=i[4];return[j,k,l,m,n]},diff_match_patch.prototype.diff_cleanupSemantic=function(a){var b=!1,c=[],d=0,e=null,f=0,g=0,h=0;while(f<a.length)a[f][0]==DIFF_EQUAL?(c[d++]=f,g=h,h=0,e=a[f][1]):(h+=a[f][1].length,e!==null&&e.length<=g&&e.length<=h&&(a.splice(c[d-1],0,[DIFF_DELETE,e]),a[c[d-1]+1][0]=DIFF_INSERT,d--,d--,f=d>0?c[d-1]:-1,g=0,h=0,e=null,b=!0)),f++;b&&this.diff_cleanupMerge(a),this.diff_cleanupSemanticLossless(a)},diff_match_patch.prototype.diff_cleanupSemanticLossless=function(a){function g(a,g){if(!a||!g)return 5;var h=0;if(a.charAt(a.length-1).match(b)||g.charAt(0).match(b)){h++;if(a.charAt(a.length-1).match(c)||g.charAt(0).match(c)){h++;if(a.charAt(a.length-1).match(d)||g.charAt(0).match(d))h++,(a.match(e)||g.match(f))&&h++}}return h}var b=/[^a-zA-Z0-9]/,c=/\s/,d=/[\r\n]/,e=/\n\r?\n$/,f=/^\r?\n\r?\n/,h=1;while(h<a.length-1){if(a[h-1][0]==DIFF_EQUAL&&a[h+1][0]==DIFF_EQUAL){var i=a[h-1][1],j=a[h][1],k=a[h+1][1],l=this.diff_commonSuffix(i,j);if(l){var m=j.substring(j.length-l);i=i.substring(0,i.length-l),j=m+j.substring(0,j.length-l),k=m+k}var n=i,o=j,p=k,q=g(i,j)+g(j,k);while(j.charAt(0)===k.charAt(0)){i+=j.charAt(0),j=j.substring(1)+k.charAt(0),k=k.substring(1);var r=g(i,j)+g(j,k);r>=q&&(q=r,n=i,o=j,p=k)}a[h-1][1]!=n&&(n?a[h-1][1]=n:(a.splice(h-1,1),h--),a[h][1]=o,p?a[h+1][1]=p:(a.splice(h+1,1),h--))}h++}},diff_match_patch.prototype.diff_cleanupEfficiency=function(a){var b=!1,c=[],d=0,e="",f=0,g=!1,h=!1,i=!1,j=!1;while(f<a.length)a[f][0]==DIFF_EQUAL?(a[f][1].length<this.Diff_EditCost&&(i||j)?(c[d++]=f,g=i,h=j,e=a[f][1]):(d=0,e=""),i=j=!1):(a[f][0]==DIFF_DELETE?j=!0:i=!0,e&&(g&&h&&i&&j||e.length<this.Diff_EditCost/2&&g+h+i+j==3)&&(a.splice(c[d-1],0,[DIFF_DELETE,e]),a[c[d-1]+1][0]=DIFF_INSERT,d--,e="",g&&h?(i=j=!0,d=0):(d--,f=d>0?c[d-1]:-1,i=j=!1),b=!0)),f++;b&&this.diff_cleanupMerge(a)},diff_match_patch.prototype.diff_cleanupMerge=function(a){a.push([DIFF_EQUAL,""]);var b=0,c=0,d=0,e="",f="",g;while(b<a.length)switch(a[b][0]){case DIFF_INSERT:d++,f+=a[b][1],b++;break;case DIFF_DELETE:c++,e+=a[b][1],b++;break;case DIFF_EQUAL:c!==0||d!==0?(c!==0&&d!==0&&(g=this.diff_commonPrefix(f,e),g!==0&&(b-c-d>0&&a[b-c-d-1][0]==DIFF_EQUAL?a[b-c-d-1][1]+=f.substring(0,g):(a.splice(0,0,[DIFF_EQUAL,f.substring(0,g)]),b++),f=f.substring(g),e=e.substring(g)),g=this.diff_commonSuffix(f,e),g!==0&&(a[b][1]=f.substring(f.length-g)+a[b][1],f=f.substring(0,f.length-g),e=e.substring(0,e.length-g))),c===0?a.splice(b-c-d,c+d,[DIFF_INSERT,f]):d===0?a.splice(b-c-d,c+d,[DIFF_DELETE,e]):a.splice(b-c-d,c+d,[DIFF_DELETE,e],[DIFF_INSERT,f]),b=b-c-d+(c?1:0)+(d?1:0)+1):b!==0&&a[b-1][0]==DIFF_EQUAL?(a[b-1][1]+=a[b][1],a.splice(b,1)):b++,d=0,c=0,e="",f=""}a[a.length-1][1]===""&&a.pop();var h=!1;b=1;while(b<a.length-1)a[b-1][0]==DIFF_EQUAL&&a[b+1][0]==DIFF_EQUAL&&(a[b][1].substring(a[b][1].length-a[b-1][1].length)==a[b-1][1]?(a[b][1]=a[b-1][1]+a[b][1].substring(0,a[b][1].length-a[b-1][1].length),a[b+1][1]=a[b-1][1]+a[b+1][1],a.splice(b-1,1),h=!0):a[b][1].substring(0,a[b+1][1].length)==a[b+1][1]&&(a[b-1][1]+=a[b+1][1],a[b][1]=a[b][1].substring(a[b+1][1].length)+a[b+1][1],a.splice(b+1,1),h=!0)),b++;h&&this.diff_cleanupMerge(a)},diff_match_patch.prototype.diff_xIndex=function(a,b){var c=0,d=0,e=0,f=0,g;for(g=0;g<a.length;g++){a[g][0]!==DIFF_INSERT&&(c+=a[g][1].length),a[g][0]!==DIFF_DELETE&&(d+=a[g][1].length);if(c>b)break;e=c,f=d}if(a.length!=g&&a[g][0]===DIFF_DELETE)return f;return f+(b-e)},diff_match_patch.prototype.diff_prettyHtml=function(a){var b=[],c=0;for(var d=0;d<a.length;d++){var e=a[d][0],f=a[d][1],g=f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"&para;<BR>");switch(e){case DIFF_INSERT:b[d]='<INS STYLE="background:#E6FFE6;" TITLE="i='+c+'">'+g+"</INS>";break;case DIFF_DELETE:b[d]='<DEL STYLE="background:#FFE6E6;" TITLE="i='+c+'">'+g+"</DEL>";break;case DIFF_EQUAL:b[d]='<SPAN TITLE="i='+c+'">'+g+"</SPAN>"}e!==DIFF_DELETE&&(c+=f.length)}return b.join("")},diff_match_patch.prototype.diff_text1=function(a){var b=[];for(var c=0;c<a.length;c++)a[c][0]!==DIFF_INSERT&&(b[c]=a[c][1]);return b.join("")},diff_match_patch.prototype.diff_text2=function(a){var b=[];for(var c=0;c<a.length;c++)a[c][0]!==DIFF_DELETE&&(b[c]=a[c][1]);return b.join("")},diff_match_patch.prototype.diff_levenshtein=function(a){var b=0,c=0,d=0;for(var e=0;e<a.length;e++){var f=a[e][0],g=a[e][1];switch(f){case DIFF_INSERT:c+=g.length;break;case DIFF_DELETE:d+=g.length;break;case DIFF_EQUAL:b+=Math.max(c,d),c=0,d=0}}b+=Math.max(c,d);return b},diff_match_patch.prototype.diff_toDelta=function(a){var b=[];for(var c=0;c<a.length;c++)switch(a[c][0]){case DIFF_INSERT:b[c]="+"+encodeURI(a[c][1]);break;case DIFF_DELETE:b[c]="-"+a[c][1].length;break;case DIFF_EQUAL:b[c]="="+a[c][1].length}return b.join("\t").replace(/\x00/g,"%00").replace(/%20/g," ")},diff_match_patch.prototype.diff_fromDelta=function(a,b){var c=[],d=0,e=0;b=b.replace(/%00/g," ");var f=b.split(/\t/g);for(var g=0;g<f.length;g++){var h=f[g].substring(1);switch(f[g].charAt(0)){case"+":try{c[d++]=[DIFF_INSERT,decodeURI(h)]}catch(i){throw new Error("Illegal escape in diff_fromDelta: "+h)}break;case"-":case"=":var j=parseInt(h,10);if(isNaN(j)||j<0)throw new Error("Invalid number in diff_fromDelta: "+h);var k=a.substring(e,e+=j);f[g].charAt(0)=="="?c[d++]=[DIFF_EQUAL,k]:c[d++]=[DIFF_DELETE,k];break;default:if(f[g])throw new Error("Invalid diff operation in diff_fromDelta: "+f[g])}}if(e!=a.length)throw new Error("Delta length ("+e+") does not equal source text length ("+a.length+").");return c},diff_match_patch.prototype.match_main=function(a,b,c){c=Math.max(0,Math.min(c,a.length-b.length));return a==b?0:a.length===0?-1:a.substring(c,c+b.length)==b?c:this.match_bitap(a,b,c)},diff_match_patch.prototype.match_bitap=function(a,b,c){function g(a,d){var g=Math.abs(c-d);return a/b.length/f.Match_Balance+g/e/(1-f.Match_Balance)}if(b.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var d=this.match_alphabet(b),e=a.length;e=Math.max(e,this.Match_MinLength),e=Math.min(e,this.Match_MaxLength);var f=this,h=this.Match_Threshold,i=a.indexOf(b,c);i!=-1&&(h=Math.min(g(0,i),h)),i=a.lastIndexOf(b,c+b.length),i!=-1&&(h=Math.min(g(0,i),h));var j=1<<b.length-1;i=-1;var k,l,m=Math.max(c+c,a.length),n;for(var o=0;o<b.length;o++){var p=Array(a.length);k=c,l=m;while(k<l)g(o,l)<h?k=l:m=l,l=Math.floor((m-k)/2+k);m=l;var q=Math.max(0,c-(l-c)-1),r=Math.min(a.length-1,b.length+l);a.charAt(r)==b.charAt(b.length-1)?p[r]=(1<<o+1)-1:p[r]=(1<<o)-1;for(var s=r-1;s>=q;s--){o===0?p[s]=(p[s+1]<<1|1)&d[a.charAt(s)]:p[s]=(p[s+1]<<1|1)&d[a.charAt(s)]|(n[s+1]<<1|1)|(n[s]<<1|1)|n[s+1];if(p[s]&j){var t=g(o,s);if(t<=h){h=t,i=s;if(s>c)q=Math.max(0,c-(s-c));else break}}}if(g(o+1,c)>h)break;n=p}return i},diff_match_patch.prototype.match_alphabet=function(a){var b={};for(var c=0;c<a.length;c++)b[a.charAt(c)]=0;for(var c=0;c<a.length;c++)b[a.charAt(c)]|=1<<a.length-c-1;return b},diff_match_patch.prototype.patch_addContext=function(a,b){var c=b.substring(a.start2,a.start2+a.length1),d=0;while(b.indexOf(c)!=b.lastIndexOf(c)&&c.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin)d+=this.Patch_Margin,c=b.substring(a.start2-d,a.start2+a.length1+d);d+=this.Patch_Margin;var e=b.substring(a.start2-d,a.start2);e!==""&&a.diffs.unshift([DIFF_EQUAL,e]);var f=b.substring(a.start2+a.length1,a.start2+a.length1+d);f!==""&&a.diffs.push([DIFF_EQUAL,f]),a.start1-=e.length,a.start2-=e.length,a.length1+=e.length+f.length,a.length2+=e.length+f.length},diff_match_patch.prototype.patch_make=function(a,b,c){var d,e;if(typeof a=="string"&&typeof b=="string"&&typeof c=="undefined")d=a,e=this.diff_main(d,b,!0),e.length>2&&(this.diff_cleanupSemantic(e),this.diff_cleanupEfficiency(e));else if(typeof a=="object"&&typeof b=="undefined"&&typeof c=="undefined")e=a,d=this.diff_text1(e);else if(typeof a=="string"&&typeof b=="object"&&typeof c=="undefined")d=a,e=b;else if(typeof a=="string"&&typeof b=="string"&&typeof c=="object")d=a,e=c;else throw new Error("Unknown call format to patch_make.");if(e.length===0)return[];var f=[],g=new patch_obj,h=0,i=0,j=0,k=d,l=d;for(var m=0;m<e.length;m++){var n=e[m][0],o=e[m][1];!h&&n!==DIFF_EQUAL&&(g.start1=i,g.start2=j);switch(n){case DIFF_INSERT:g.diffs[h++]=e[m],g.length2+=o.length,l=l.substring(0,j)+o+l.substring(j);break;case DIFF_DELETE:g.length1+=o.length,g.diffs[h++]=e[m],l=l.substring(0,j)+l.substring(j+o.length);break;case DIFF_EQUAL:o.length<=2*this.Patch_Margin&&h&&e.length!=m+1?(g.diffs[h++]=e[m],g.length1+=o.length,g.length2+=o.length):o.length>=2*this.Patch_Margin&&(h&&(this.patch_addContext(g,k),f.push(g),g=new patch_obj,h=0,k=l,i=j))}n!==DIFF_INSERT&&(i+=o.length),n!==DIFF_DELETE&&(j+=o.length)}h&&(this.patch_addContext(g,k),f.push(g));return f},diff_match_patch.prototype.patch_deepCopy=function(a){var b=[];for(var c=0;c<a.length;c++){var d=a[c],e=new patch_obj;e.diffs=[];for(var f=0;f<d.diffs.length;f++)e.diffs[f]=d.diffs[f].slice();e.start1=d.start1,e.start2=d.start2,e.length1=d.length1,e.length2=d.length2,b[c]=e}return b},diff_match_patch.prototype.patch_apply=function(a,b){if(a.length==0)return[b,[]];a=this.patch_deepCopy(a);var c=this.patch_addPadding(a);b=c+b+c,this.patch_splitMax(a);var d=0,e=[];for(var f=0;f<a.length;f++){var g=a[f].start2+d,h=this.diff_text1(a[f].diffs),i=this.match_main(b,h,g);if(i==-1)e[f]=!1;else{e[f]=!0,d=i-g;var j=b.substring(i,i+h.length);if(h==j)b=b.substring(0,i)+this.diff_text2(a[f].diffs)+b.substring(i+h.length);else{var k=this.diff_main(h,j,!1);this.diff_cleanupSemanticLossless(k);var l=0,m;for(var n=0;n<a[f].diffs.length;n++){var o=a[f].diffs[n];o[0]!==DIFF_EQUAL&&(m=this.diff_xIndex(k,l)),o[0]===DIFF_INSERT?b=b.substring(0,i+m)+o[1]+b.substring(i+m):o[0]===DIFF_DELETE&&(b=b.substring(0,i+m)+b.substring(i+this.diff_xIndex(k,l+o[1].length))),o[0]!==DIFF_DELETE&&(l+=o[1].length)}}}}b=b.substring(c.length,b.length-c.length);return[b,e]},diff_match_patch.prototype.patch_addPadding=function(a){var b="";for(var c=0;c<this.Patch_Margin;c++)b+=String.fromCharCode(c);for(var c=0;c<a.length;c++)a[c].start1+=b.length,a[c].start2+=b.length;var d=a[0],e=d.diffs;if(e.length==0||e[0][0]!=DIFF_EQUAL)e.unshift([DIFF_EQUAL,b]),d.start1-=b.length,d.start2-=b.length,d.length1+=b.length,d.length2+=b.length;else if(b.length>e[0][1].length){var f=b.length-e[0][1].length;e[0][1]=b.substring(e[0][1].length)+e[0][1],d.start1-=f,d.start2-=f,d.length1+=f,d.length2+=f}d=a[a.length-1],e=d.diffs;if(e.length==0||e[e.length-1][0]!=DIFF_EQUAL)e.push([DIFF_EQUAL,b]),d.length1+=b.length,d.length2+=b.length;else if(b.length>e[e.length-1][1].length){var f=b.length-e[e.length-1][1].length;e[e.length-1][1]+=b.substring(0,f),d.length1+=f,d.length2+=f}return b},diff_match_patch.prototype.patch_splitMax=function(a){for(var b=0;b<a.length;b++)if(a[b].length1>this.Match_MaxBits){var c=a[b];a.splice(b--,1);var d=this.Match_MaxBits,e=c.start1,f=c.start2,g="";while(c.diffs.length!==0){var h=new patch_obj,i=!0;h.start1=e-g.length,h.start2=f-g.length,g!==""&&(h.length1=h.length2=g.length,h.diffs.push([DIFF_EQUAL,g]));while(c.diffs.length!==0&&h.length1<d-this.Patch_Margin){var j=c.diffs[0][0],k=c.diffs[0][1];j===DIFF_INSERT?(h.length2+=k.length,f+=k.length,h.diffs.push(c.diffs.shift()),i=!1):(k=k.substring(0,d-h.length1-this.Patch_Margin),h.length1+=k.length,e+=k.length,j===DIFF_EQUAL?(h.length2+=k.length,f+=k.length):i=!1,h.diffs.push([j,k]),k==c.diffs[0][1]?c.diffs.shift():c.diffs[0][1]=c.diffs[0][1].substring(k.length))}g=this.diff_text2(h.diffs),g=g.substring(g.length-this.Patch_Margin);var l=this.diff_text1(c.diffs).substring(0,this.Patch_Margin);l!==""&&(h.length1+=l.length,h.length2+=l.length,h.diffs.length!==0&&h.diffs[h.diffs.length-1][0]===DIFF_EQUAL?h.diffs[h.diffs.length-1][1]+=l:h.diffs.push([DIFF_EQUAL,l])),i||a.splice(++b,0,h)}}},diff_match_patch.prototype.patch_toText=function(a){var b=[];for(var c=0;c<a.length;c++)b[c]=a[c];return b.join("")},diff_match_patch.prototype.patch_fromText=function(a){var b=[];if(!a)return b;a=a.replace(/%00/g," ");var c=a.split("\n"),d=0;while(d<c.length){var e=c[d].match(/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/);if(!e)throw new Error("Invalid patch string: "+c[d]);var f=new patch_obj;b.push(f),f.start1=parseInt(e[1],10),e[2]===""?(f.start1--,f.length1=1):e[2]=="0"?f.length1=0:(f.start1--,f.length1=parseInt(e[2],10)),f.start2=parseInt(e[3],10),e[4]===""?(f.start2--,f.length2=1):e[4]=="0"?f.length2=0:(f.start2--,f.length2=parseInt(e[4],10)),d++;while(d<c.length){var g=c[d].charAt(0);try{var h=decodeURI(c[d].substring(1))}catch(i){throw new Error("Illegal escape in patch_fromText: "+h)}if(g=="-")f.diffs.push([DIFF_DELETE,h]);else if(g=="+")f.diffs.push([DIFF_INSERT,h]);else if(g==" ")f.diffs.push([DIFF_EQUAL,h]);else{if(g=="@")break;if(g!=="")throw new Error('Invalid patch mode "'+g+'" in: '+h)}d++}}return b},patch_obj.prototype.toString=function(){var a,b;this.length1===0?a=this.start1+",0":this.length1==1?a=this.start1+1:a=this.start1+1+","+this.length1,this.length2===0?b=this.start2+",0":this.length2==1?b=this.start2+1:b=this.start2+1+","+this.length2;var c=["@@ -"+a+" +"+b+" @@\n"],d;for(var e=0;e<this.diffs.length;e++){switch(this.diffs[e][0]){case DIFF_INSERT:d="+";break;case DIFF_DELETE:d="-";break;case DIFF_EQUAL:d=" "}c[e+1]=d+encodeURI(this.diffs[e][1])+"\n"}return c.join("").replace(/\x00/g,"%00").replace(/%20/g," ")},define("lib/tools/diff_match_patch",function(){}),CodeMirror.defineMode("xml",function(a,b){function w(a){return a=="string"?o(w):n()}function v(a){if(a=="word"&&d.allowUnquoted){m="string";return o()}if(a=="string")return o(w);return n()}function u(a){if(a=="word"){m="attribute";return o(u)}if(a=="equals")return o(v,u);return n()}function t(a){return function(b){a&&(m="error");if(b=="endTag"){q();return o()}m="error";return o(arguments.callee)}}function s(a){return function(b){if(b=="selfcloseTag"||b=="endTag"&&d.autoSelfClosers.hasOwnProperty(l.tagName.toLowerCase()))return o();if(b=="endTag"){p(l.tagName,a);return o()}return o()}}function r(a){if(a=="openTag"){l.tagName=f;return o(u,s(l.startOfLine))}if(a=="closeTag"){var b=!1;l.context?b=l.context.tagName!=f:b=!0,b&&(m="error");return o(t(b))}if(a=="string"){(!l.context||l.context.name!="!cdata")&&p("!cdata"),l.tokenize==h&&q();return o()}return o()}function q(){l.context&&(l.context=l.context.prev)}function p(a,b){var c=d.doNotIndent.hasOwnProperty(a)||l.context&&l.context.noIndent;l.context={prev:l.context,tagName:a,indent:l.indented,startOfLine:b,noIndent:c}}function o(){n.apply(null,arguments);return!0}function n(){for(var a=arguments.length-1;a>=0;a--)l.cc.push(arguments[a])}function k(a,b){return function(c,d){while(!c.eol()){if(c.match(b)){d.tokenize=h;break}c.next()}return a}}function j(a){return function(b,c){while(!b.eol())if(b.next()==a){c.tokenize=i;break}return"string"}}function i(a,b){var c=a.next();if(c==">"||c=="/"&&a.eat(">")){b.tokenize=h,g=c==">"?"endTag":"selfcloseTag";return"tag"}if(c=="="){g="equals";return null}if(/[\'\"]/.test(c)){b.tokenize=j(c);return b.tokenize(a,b)}a.eatWhile(/[^\s\u00a0=<>\"\'\/?]/);return"word"}function h(a,b){function c(c){b.tokenize=c;return c(a,b)}var d=a.next();if(d=="<"){if(a.eat("!")){if(a.eat("["))return a.match("CDATA[")?c(k("atom","]]>")):null;if(a.match("--"))return c(k("comment","-->"));if(a.match("DOCTYPE",!0,!0)){a.eatWhile(/[\w\._\-]/);return c(k("meta",">"))}return null}if(a.eat("?")){a.eatWhile(/[\w\._\-]/),b.tokenize=k("meta","?>");return"meta"}g=a.eat("/")?"closeTag":"openTag",a.eatSpace(),f="";var e;while(e=a.eat(/[^\s\u00a0=<>\"\'\/?]/))f+=e;b.tokenize=i;return"tag"}if(d=="&"){a.eatWhile(/[^;]/),a.eat(";");return"atom"}a.eatWhile(/[^&<]/);return null}var c=a.indentUnit,d=b.htmlMode?{autoSelfClosers:{br:!0,img:!0,hr:!0,link:!0,input:!0,meta:!0,col:!0,frame:!0,base:!0,area:!0},doNotIndent:{pre:!0,"!cdata":!0},allowUnquoted:!0}:{autoSelfClosers:{},doNotIndent:{"!cdata":!0},allowUnquoted:!1},e=b.alignCDATA,f,g,l,m;return{startState:function(){return{tokenize:h,cc:[],indented:0,startOfLine:!0,tagName:null,context:null}},token:function(a,b){a.sol()&&(b.startOfLine=!0,b.indented=a.indentation());if(a.eatSpace())return null;m=g=f=null;var c=b.tokenize(a,b);if((c||g)&&c!="comment"){l=b;while(!0){var d=b.cc.pop()||r;if(d(g||c))break}}b.startOfLine=!1;return m||c},indent:function(a,b){var d=a.context;if(d&&d.noIndent)return 0;if(e&&/<!\[CDATA\[/.test(b))return 0;d&&/^<\//.test(b)&&(d=d.prev);while(d&&!d.startOfLine)d=d.prev;return d?d.indent+c:0},compareStates:function(a,b){if(a.indented!=b.indented)return!1;for(var c=a.context,d=b.context;;c=c.prev,d=d.prev){if(!c||!d)return c==d;if(c.tagName!=d.tagName)return!1}},electricChars:"/"}}),CodeMirror.defineMIME("application/xml","xml"),CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:!0}),define("lib/codemirror2/mode/xml/xml",function(){}),CodeMirror.defineMode("javascript",function(a,b){function R(a,b){if(a=="variable"){v(b);return u()}}function Q(a,b){if(a=="variable"){v(b);return u(Q)}if(a=="(")return u(z(")"),x,I(R,")"),A,C,y)}function P(a){a!=")"&&u(D)}function O(a,b){if(a==";")return u(P);if(b=="in")return u(D);return u(D,B(";"),P)}function N(a,b){if(b=="in")return u(D);return u(E,O)}function M(a){if(a=="var")return u(K,O);if(a==";")return t(O);if(a=="variable")return u(N);return t(O)}function L(a,b){if(b=="=")return u(D,L);if(a==",")return u(K)}function K(a,b){if(a=="variable"){v(b);return u(L)}return u()}function J(a){if(a=="}")return u();return t(C,J)}function I(a,b){function c(d){if(d==",")return u(a,c);if(d==b)return u();return u(B(b))}return function d(d){return d==b?u():t(a,c)}}function H(a){a=="variable"&&(s.marked="property");if(o.hasOwnProperty(a))return u(B(":"),D)}function G(a){if(a=="variable"){s.marked="property";return u()}}function F(a){if(a==":")return u(A,C);return t(E,B(";"),A)}function E(a,b){if(a=="operator"&&/\+\+|--/.test(b))return u(E);if(a=="operator")return u(D);if(a!=";"){if(a=="(")return u(z(")"),I(D,")"),A,E);if(a==".")return u(G,E);if(a=="[")return u(z("]"),D,B("]"),A,E)}}function D(a){if(o.hasOwnProperty(a))return u(E);if(a=="function")return u(Q);if(a=="keyword c")return u(D);if(a=="(")return u(z(")"),D,B(")"),A,E);if(a=="operator")return u(D);if(a=="[")return u(z("]"),I(D,"]"),A,E);if(a=="{")return u(z("}"),I(H,"}"),A,E);return u()}function C(a){if(a=="var")return u(z("vardef"),K,B(";"),A);if(a=="keyword a")return u(z("form"),D,C,A);if(a=="keyword b")return u(z("form"),C,A);if(a=="{")return u(z("}"),J,A);if(a==";")return u();if(a=="function")return u(Q);if(a=="for")return u(z("form"),B("("),z(")"),M,B(")"),A,C,A);if(a=="variable")return u(z("stat"),F);if(a=="switch")return u(z("form"),D,z("}","switch"),B("{"),J,A,A);if(a=="case")return u(D,B(":"));if(a=="default")return u(B(":"));if(a=="catch")return u(z("form"),x,B("("),R,B(")"),C,A,y);return t(z("stat"),D,B(";"),A)}function B(a){return function b(b){return b==a?u():a==";"?t():u(arguments.callee)}}function A(){var a=s.state;a.lexical.prev&&(a.lexical.type==")"&&(a.indented=a.lexical.indented),a.lexical=a.lexical.prev)}function z(a,b){var c=function(){var c=s.state;c.lexical=new p(c.indented,s.stream.column(),a,null,c.lexical,b)};c.lex=!0;return c}function y(){s.state.localVars=s.state.context.vars,s.state.context=s.state.context.prev}function x(){s.state.context||(s.state.localVars=w),s.state.context={prev:s.state.context,vars:s.state.localVars}}function v(a){var b=s.state;if(b.context){s.marked="def";for(var c=b.localVars;c;c=c.next)if(c.name==a)return;b.localVars={name:a,next:b.localVars}}}function u(){t.apply(null,arguments);return!0}function t(){for(var a=arguments.length-1;a>=0;a--)s.cc.push(arguments[a])}function r(a,b,c,e,f){var g=a.cc;s.state=a,s.stream=f,s.marked=null,s.cc=g,a.lexical.hasOwnProperty("align")||(a.lexical.align=!0);while(!0){var h=g.length?g.pop():d?D:C;if(h(c,e)){while(g.length&&g[g.length-1].lex)g.pop()();if(s.marked)return s.marked;if(c=="variable"&&q(a,e))return"variable-2";return b}}}function q(a,b){for(var c=a.localVars;c;c=c.next)if(c.name==b)return!0}function p(a,b,c,d,e,f){this.indented=a,this.column=b,this.type=c,this.prev=e,this.info=f,d!=null&&(this.align=d)}function n(a,b){var c=!1,d;while(d=a.next()){if(d=="/"&&c){b.tokenize=l;break}c=d=="*"}return k("comment","comment")}function m(a){return function(b,c){h(b,a)||(c.tokenize=l);return k("string","string")}}function l(a,b){var c=a.next();if(c=='"'||c=="'")return g(a,b,m(c));if(/[\[\]{}\(\),;\:\.]/.test(c))return k(c);if(c=="0"&&a.eat(/x/i)){a.eatWhile(/[\da-f]/i);return k("number","number")}if(/\d/.test(c)){a.match(/^\d*(?:\.\d*)?(?:e[+\-]?\d+)?/);return k("number","number")}if(c=="/"){if(a.eat("*"))return g(a,b,n);if(a.eat("/")){a.skipToEnd();return k("comment","comment")}if(b.reAllowed){h(a,"/"),a.eatWhile(/[gimy]/);return k("regexp","string")}a.eatWhile(f);return k("operator",null,a.current())}if(c=="#"){a.skipToEnd();return k("error","error")}if(f.test(c)){a.eatWhile(f);return k("operator",null,a.current())}a.eatWhile(/[\w\$_]/);var d=a.current(),i=e.propertyIsEnumerable(d)&&e[d];return i?k(i.type,i.style,d):k("variable","variable",d)}function k(a,b,c){i=a,j=c;return b}function h(a,b){var c=!1,d;while((d=a.next())!=null){if(d==b&&!c)return!1;c=!c&&d=="\\"}return c}function g(a,b,c){b.tokenize=c;return c(a,b)}var c=a.indentUnit,d=b.json,e=function(){function a(a){return{type:a,style:"keyword"}}var b=a("keyword a"),c=a("keyword b"),d=a("keyword c"),e=a("operator"),f={type:"atom",style:"atom"};return{"if":b,"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":d,"break":d,"continue":d,"new":d,"delete":d,"throw":d,"var":a("var"),"function":a("function"),"catch":a("catch"),"for":a("for"),"switch":a("switch"),"case":a("case"),"default":a("default"),"in":e,"typeof":e,"instanceof":e,"true":f,"false":f,"null":f,"undefined":f,NaN:f,Infinity:f}}(),f=/[+\-*&%=<>!?|]/,i,j,o={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},s={state:null,column:null,marked:null,cc:null},w={name:"this",next:{name:"arguments"}};A.lex=!0;return{startState:function(a){return{tokenize:l,reAllowed:!0,cc:[],lexical:new p((a||0)-c,0,"block",!1),localVars:null,context:null,indented:0}},token:function(a,b){a.sol()&&(b.lexical.hasOwnProperty("align")||(b.lexical.align=!1),b.indented=a.indentation());if(a.eatSpace())return null;var c=b.tokenize(a,b);if(i=="comment")return c;b.reAllowed=i=="operator"||i=="keyword c"||i.match(/^[\[{}\(,;:]$/);return r(b,c,i,j,a)},indent:function(a,b){if(a.tokenize!=l)return 0;var d=b&&b.charAt(0),e=a.lexical,f=e.type,g=d==f;return f=="vardef"?e.indented+4:f=="form"&&d=="{"?e.indented:f=="stat"||f=="form"?e.indented+c:e.info!="switch"||g?e.align?e.column+(g?0:1):e.indented+(g?0:c):e.indented+(/^(?:case|default)\b/.test(b)?c:2*c)},electricChars:":{}"}}),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),define("lib/codemirror2/mode/javascript/javascript",function(){}),CodeMirror.defineMode("markdown",function(a,b){function C(a,b,c){c=c||x;return function(d,e){while(!d.eol()){var f=d.next();f==="\\"&&d.next();if(f===b){e.inline=e.f=c;return a}}return a}}function B(a,b){a.eatSpace(),a.match(/^[^\s]+/,!0),b.f=b.inline=x;return j}function A(a,b){if(a.match(/^[^\]]*\]:/,!0)){b.f=B;return i}return t(a,b,x)}function z(a,b){a.eatSpace();var c=a.next();if(c==="("||c==="[")return t(a,b,C(j,c==="("?")":"]"));return"error"}function y(a,b){while(!a.eol()){var c=a.next();c==="\\"&&a.next();if(c==="]"){b.inline=b.f=z;return i}}return i}function x(a,b){function c(){return b.strong?b.em?m:l:b.em?k:null}if(a.match(s,!0))return c();var d=a.next();if(d==="\\"){a.next();return c()}if(d==="`")return t(a,b,C(e,"`"));if(d==="<")return t(a,b,C(i,">"));if(d==="[")return t(a,b,y);var f=c();if(d==="*"||d==="_"){if(a.eat(d))return(b.strong=!b.strong)?c():f;return(b.em=!b.em)?c():f}return c()}function w(a,b){var d=c.token(a,b.htmlState);a.eol()&&!b.htmlState.context&&(b.block=v);return d}function v(a,b){if(a.match(r)){a.skipToEnd();return e}if(a.eatSpace())return null;if(a.peek()==="#"||a.match(q)){a.skipToEnd();return d}if(a.eat(">")){b.indentation++;return f}if(a.peek()==="<")return u(a,b,w);if(a.peek()==="[")return t(a,b,A);if(n.test(a.peek())){var c=new RegExp("(?:s*["+a.peek()+"]){3,}$");if(a.match(c,!0))return h}var i;if(i=a.match(o,!0)||a.match(p,!0)){b.indentation+=i[0].length;return g}return t(a,b,b.inline)}function u(a,b,c){b.f=b.block=c;return c(a,b)}function t(a,b,c){b.f=b.inline=c;return c(a,b)}var c=CodeMirror.getMode(a,{name:"xml",htmlMode:!0}),d="header",e="code",f="quote",g="list",h="hr",i="linktext",j="linkhref",k="em",l="strong",m="emstrong",n=/^[*-=_]/,o=/^[*-+]\s+/,p=/^[0-9]\.\s+/,q=/^(?:\={3,}|-{3,})$/,r=/^(k:\t|\s{4,})/,s=/^[^\[*_\\<>`]+/;return{startState:function(){return{f:v,block:v,htmlState:c.startState(),indentation:0,inline:x,em:!1,strong:!1}},copyState:function(a){return{f:a.f,block:a.block,htmlState:CodeMirror.copyState(c,a.htmlState),indentation:a.indentation,inline:a.inline,em:a.em,strong:a.strong}},token:function(a,b){if(a.sol()){b.f=b.block;var c=b.indentation,d=0;while(c>0)if(a.eat(" "))c--,d++;else if(c>=4&&a.eat("\t"))c-=4,d+=4;else break;b.indentation=d;if(d>0)return null}return b.f(a,b)}}}),CodeMirror.defineMIME("text/x-markdown","markdown"),define("lib/codemirror2/mode/markdown/markdown",function(){}),Operations={},Operations.NoOp=function(){},Operations.NoOp.prototype.requiresCID=!1,Operations.NoOp.prototype.toString=function(){return"NoOp()"},Operations.NoOp.prototype.toHTML=Operations.NoOp.prototype.toString,Operations.NoOp.prototype.apply=function(a){},Operations.NoOp.prototype.transform=function(a){return new Operations.NoOp},Operations.NoOp.prototype.mirror=function(){return new Operations.NoOp},Operations.Insert=function(a,b){this.position=a,this.text=b.copy()},Operations.Insert.prototype.requiresCID=!0,Operations.Insert.prototype.toString=function(){return"Insert("+this.position+", "+this.text+")"},Operations.Insert.prototype.toHTML=function(){return"Insert("+this.position+", "+this.text.toHTML()+")"},Operations.Insert.prototype.apply=function(a){a.splice(this.position,0,this.text)},Operations.Insert.prototype.cid=function(a){if(this.position<a.position)return a;if(this.position>a.position)return this},Operations.Insert.prototype.getLength=function(){return this.text.getLength()},Operations.Insert.prototype.transform=function(a,b){if(a instanceof Operations.NoOp)return new Operations.Insert(this.position,this.text);if(a instanceof Operations.Split){var c=this.transform(a.first,b==this?this:a.first),d=a.second.transform(a.first),e=c.transform(d,b==this?c:d);return e}var f=this.position,g=this.text,h=a.position;if(a instanceof Operations.Insert){var i=a.text;if(f<h||f==h&&b==a)return new Operations.Insert(f,g);if(f>h||f==h&&b==this)return new Operations.Insert(f+i.getLength(),g)}else if(a instanceof Operations.Delete){var j=a.getLength();if(f>=h+j)return new Operations.Insert(f-j,g);if(f<h)return new Operations.Insert(f,g);if(f>=h&&f<h+j)return new Operations.Insert(h,g)}},Operations.Insert.prototype.mirror=function(){return new Operations.Delete(this.position,this.text.copy())},Operations.Delete=function(a,b,c){this.position=a,b instanceof Buffer?this.what=b.copy():this.what=b,c?this.recon=c:this.recon=new Recon},Operations.Delete.prototype.requiresCID=!1,Operations.Delete.prototype.toString=function(){return"Delete("+this.position+", "+this.what+")"},Operations.Delete.prototype.toHTML=function(){return"Delete("+this.position+", "+(this.what instanceof Buffer?this.what.toHTML():this.what)+")"},Operations.Delete.prototype.isReversible=function(){return this.what instanceof Buffer},Operations.Delete.prototype.apply=function(a){a.splice(this.position,this.getLength())},Operations.Delete.prototype.cid=function(a){},Operations.Delete.prototype.getLength=function(){return this.isReversible()?this.what.getLength():this.what},Operations.Delete.prototype.split=function(a){if(this.isReversible()){console.log(a);return new Operations.Split(new Operations.Delete(this.position,this.what.slice(0,a)),new Operations.Delete(this.position+a,this.what.slice(a)))}var b=new Recon,c=new Recon;for(index in this.recon.segments)this.recon.segments[index].offset<a?b.segments.push(this.recon.segments[index]):c.segments.push(new ReconSegment(this.recon.segments[index].offset-a,this.recon.segments[index].buffer));return new Operations.Split(new Operations.Delete(this.position,a,b),new Operations.Delete(this.position+a,this.what-a,c))},Operations.Delete.getAffectedString=function(a,b){if(a instanceof Operations.Split){var c=Operations.Delete.getAffectedString(a.first,b),d=Operations.Delete.getAffectedString(a.second,b);d.splice(0,0,c);return d}if(a instanceof Operations.Delete){var e=b.slice(a.position,a.position+a.getLength());a.recon.restore(e);return e}},Operations.Delete.prototype.makeReversible=function(a,b){return this.what instanceof Buffer?new Operations.Delete(this.position,this.what):new Operations.Delete(this.position,Operations.Delete.getAffectedString(a,b.buffer))},Operations.Delete.prototype.merge=function(a){if(this.isReversible()){if(!a.isReversible())throw"Cannot merge reversible operations with non-reversible ones";var b=this.what.copy();b.splice(b.getLength(),0,a.what);return new Operations.Delete(this.position,b)}var c=this.getLength()+a.getLength();return new Operations.Delete(this.position,c)},Operations.Delete.prototype.transform=function(a,b){if(a instanceof Operations.NoOp)return new Operations.Delete(this.position,this.what,this.recon);if(a instanceof Operations.Split){var c=this.transform(a.first,b==this?this:a.first),d=a.second.transform(a.first),e=c.transform(d,b==this?c:d);return e}var f=this.position,g=this.getLength(),h=a.position,i=a.getLength();if(a instanceof Operations.Insert){if(h>=f+g)return new Operations.Delete(f,this.what,this.recon);if(h<=f)return new Operations.Delete(f+i,this.what,this.recon);if(h>f&&h<f+g){var j=this.split(h-f);j.second.position+=i;return j}}else if(a instanceof Operations.Delete){if(f+g<=h)return new Operations.Delete(f,this.what,this.recon);if(f>=h+i)return new Operations.Delete(f-i,this.what,this.recon);if(h<=f&&h+i>=f+g){var k=this.isReversible()?new Buffer:0,l=this.recon.update(0,a.what.slice(f-h,f-h+g));return new Operations.Delete(h,k,l)}if(h<=f&&h+i<f+g){var j=this.split(h+i-f);j.second.position=h,j.second.recon=this.recon.update(0,a.what.slice(f-h));return j.second}if(h>f&&h+i>=f+g){var j=this.split(h-f);j.first.recon=this.recon.update(j.first.getLength(),a.what.slice(0,f+g-h));return j.first}if(h>f&&h+i<f+g){var m=this.split(h-f),n=m.second.split(i),j=m.first.merge(n.second);j.recon=this.recon.update(h-f,a.what);return j}}},Operations.Delete.prototype.mirror=function(){if(this.isReversible())return new Operations.Insert(this.position,this.what.copy())},Operations.Split=function(a,b){console.log("split"),this.first=a,this.second=b},Operations.Split.prototype.requiresCID=!0,Operations.Split.prototype.toString=function(){return"Split("+this.first+", "+this.second+")"},Operations.Split.prototype.toHTML=function(){return"Split("+this.first.toHTML()+", "+this.second.toHTML()+")"},Operations.Split.prototype.apply=function(a){this.first.apply(a);var b=this.second.transform(this.first);b.apply(a)},Operations.Split.prototype.cid=function(){},Operations.Split.prototype.transform=function(a,b){return b==this||b==a?new Operations.Split(this.first.transform(a,b==this?this.first:a),this.second.transform(a,b==this?this.second:a)):new Operations.Split(this.first.transform(a),this.second.transform(a))},Operations.Split.prototype.mirror=function(){var a=this.second.transform(this.first);return new Operations.Split(this.first.mirror(),a.mirror())},Recon.prototype.toString=function(){return"Recon("+this.segments+")"},Recon.prototype.update=function(a,b){var c=new Recon(this);b instanceof Buffer&&c.segments.push(new ReconSegment(a,b));return c},Recon.prototype.restore=function(a){for(var b in this.segments){var c=this.segments[b];a.splice(c.offset,0,c.buffer)}},ReconSegment.prototype.toString=function(){return"("+this.offset+", "+this.buffer+")"},DoRequest.prototype.toString=function(){return"DoRequest("+[this.user,this.vector,this.operation].join(", ")+")"},DoRequest.prototype.toHTML=function(){return"DoRequest("+[this.user,this.vector.toHTML(),this.operation.toHTML()].join(", ")+")"},DoRequest.prototype.copy=function(){return new DoRequest(this.user,this.vector,this.operation)},DoRequest.prototype.execute=function(a){this.operation.apply(a.buffer),a.vector=a.vector.incr(this.user,1);return this},DoRequest.prototype.transform=function(a,b){if(this.operation instanceof Operations.NoOp)var c=new Operations.NoOp;else{var d;b==this&&(d=this.operation),b==a&&(d=a.operation);var c=this.operation.transform(a.operation,d)}return new DoRequest(this.user,this.vector.incr(a.user),c)},DoRequest.prototype.mirror=function(a){typeof a!="number"&&(a=1);return new DoRequest(this.user,this.vector.incr(this.user,a),this.operation.mirror())},DoRequest.prototype.fold=function(a,b){if(b%2==1)throw"Fold amounts must be multiples of 2.";return new DoRequest(this.user,this.vector.incr(a,b),this.operation)},DoRequest.prototype.makeReversible=function(a,b){var c=this.copy();this.operation instanceof Operations.Delete&&(c.operation=this.operation.makeReversible(a.operation,b));return c},UndoRequest.prototype.toString=function(){return"UndoRequest("+[this.user,this.vector].join(", ")+")"},UndoRequest.prototype.toHTML=function(){return"UndoRequest("+[this.user,this.vector.toHTML()].join(", ")+")"},UndoRequest.prototype.copy=function(){return new UndoRequest(this.user,this.vector)},UndoRequest.prototype.associatedRequest=function(a){var b=1,c=_indexOf(a,this);c==-1&&(c=a.length-1);for(;c>=0;c--){if(a[c]===this||a[c].user!=this.user)continue;if(a[c].vector.get(this.user)>this.vector.get(this.user))continue;a[c]instanceof UndoRequest?b+=1:b-=1;if(b==0)return a[c]}},RedoRequest.prototype.toString=function(){return"RedoRequest("+[this.user,this.vector].join(", ")+")"},RedoRequest.prototype.toHTML=function(){return"RedoRequest("+[this.user,this.vector.toHTML()].join(", ")+")"},RedoRequest.prototype.copy=function(){return new RedoRequest(this.user,this.vector)},RedoRequest.prototype.associatedRequest=function(a){var b=1,c=_indexOf(a,this);c==-1&&(c=a.length-1);for(;c>=0;c--){if(a[c]===this||a[c].user!=this.user)continue;if(a[c].vector.get(this.user)>this.vector.get(this.user))continue;a[c]instanceof RedoRequest?b+=1:b-=1;if(b==0)return a[c]}},Vector.user_regex=/\d+/,Vector.timestring_regex=/(\d+):(\d+)/g,Vector.prototype.eachUser=function(a){for(var b in this)if(b.match(Vector.user_regex))if(a(parseInt(b),this[b])==!1)return!1;return!0},Vector.prototype.toString=function(){var a=[];this.eachUser(function(b,c){c>0&&a.push(b+":"+c)}),a.sort();return a.join(";")},Vector.prototype.toHTML=Vector.prototype.toString,Vector.prototype.add=function(a){var b=new Vector(this);a.eachUser(function(a,c){b[a]=b.get(a)+c});return b},Vector.prototype.copy=function(){return new Vector(this)},Vector.prototype.get=function(a){return this[a]!=undefined?this[a]:0},Vector.prototype.causallyBefore=function(a){return this.eachUser(function(b,c){return c<=a.get(b)})},Vector.prototype.equals=function(a){var b=this.eachUser(function(b,c){return a.get(b)==c}),c=this,d=a.eachUser(function(a,b){return c.get(a)==b});return b&&d},Vector.prototype.incr=function(a,b){var c=new Vector(this);b==undefined&&(b=1),c[a]=c.get(a)+b;return c},Vector.leastCommonSuccessor=function(a,b){var c=a.copy();b.eachUser(function(d,e){var f=a.get(d),g=b.get(d);f<g&&(c[d]=g)});return c},State.prototype.translate=function(a,b,c){if(a instanceof DoRequest&&a.vector.equals(b))return a.copy();var d=[a,b].toString();if(this.cache!=undefined&&!c){this.cache[d]||(this.cache[d]=this.translate(a,b,!0));return this.cache[d]}if(a instanceof UndoRequest||a instanceof RedoRequest){var e=a.associatedRequest(this.log),f=b.copy();f[a.user]=e.vector.get(a.user);if(this.reachable(f)){var g=this.translate(e,f),h=b.get(a.user)-f.get(a.user),i=g.mirror(h);return i}}for(var j in this.vector){if(!j.match(Vector.user_regex))continue;var k=parseInt(j);if(k==a.user)continue;if(b.get(k)<=a.vector.get(k))continue;var l=this.requestByUser(k,b.get(k)-1);if(l instanceof UndoRequest||l instanceof RedoRequest){var m=b.get(k)-l.associatedRequest(this.log).vector.get(k);if(b.get(k)>=m){var n=b.incr(k,-m);if(this.reachable(n)&&a.vector.causallyBefore(n)){var g=this.translate(a,n),o=g.fold(k,m);return o}}}var p=b.incr(k,-1);if(p.get(k)>=0&&this.reachable(p)){var l=this.requestByUser(k,p.get(k)),q=this.translate(a,p),r=this.translate(l,p),s;if(q.operation.requiresCID){var t=q.operation.cid(r.operation);if(!t){var u=Vector.leastCommonSuccessor(a.vector,l.vector);if(this.reachable(u)){var v=this.translate(a,u),w=this.translate(l,u),x=v.operation.cid(w.operation);x==v.operation?t=q.operation:x==w.operation&&(t=r.operation)}t||(q.user<r.user&&(t=q.operation),q.user>r.user&&(t=r.operation))}t==q.operation&&(s=q),t==r.operation&&(s=r)}return q.transform(r,s)}}throw"Could not find a translation path"},State.prototype.queue=function(a){this.request_queue.push(a)},State.prototype.canExecute=function(a){if(a==undefined)return!1;return a instanceof UndoRequest||a instanceof RedoRequest?a.associatedRequest(this.log)!=undefined:a.vector.causallyBefore(this.vector)},State.prototype.execute=function(a){if(a==undefined)for(var b=0;b<this.request_queue.length;b++){a=this.request_queue[b];if(this.canExecute(a)){this.request_queue.splice(b,1);break}}{if(this.canExecute(a)){if(a.vector.get(a.user)<this.vector.get(a.user)){this.log.push(a);return}a=a.copy();if(a instanceof UndoRequest||a instanceof RedoRequest){var c=a.associatedRequest(this.log),d=new Vector(c.vector);d[a.user]=a.vector.get(a.user),a.vector=d}var e=this.translate(a,this.vector);a instanceof DoRequest&&a.operation instanceof Operations.Delete?this.log.push(a.makeReversible(e,this)):this.log.push(a),e.execute(this),this.onexecute&&this.onexecute(e);return e}a!=undefined&&this.queue(a)}},State.prototype.executeAll=function(){do var a=this.execute();while(a)},State.prototype.reachable=function(a){var b=this;return this.vector.eachUser(function(c,d){return b.reachableUser(a,c)})},State.prototype.reachableUser=function(a,b){var c=a.get(b),d=this.firstRequestByUser(b),e=d?d.vector.get(b):this.vector.get(b);while(!0){if(c==e)return!0;var f=this.requestByUser(b,c-1);if(f==undefined)return!1;if(f instanceof DoRequest){var g=f.vector;return g.incr(f.user).causallyBefore(a)}var h=f.associatedRequest(this.log);c=h.vector.get(b)}},State.prototype.requestByUser=function(a,b){for(var c in this.log){var d=this.log[c];if(d.user==a&&d.vector.get(a)==b)return d}},State.prototype.firstRequestByUser=function(a){var b;for(var c in this.log){var d=this.log[c];d.user==a&&(!b||b.vector.get(a)>d.vector.get(a))&&(b=d)}return b},Segment.prototype.toString=function(){return this.text},Segment.prototype.toHTML=function(){var a=this.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return'<span class="segment user-'+this.user+'">'+a+"</span>"},Segment.prototype.copy=function(){return new Segment(this.user,this.text)},Buffer.prototype.toString=function(){return this.segments.join("")},Buffer.prototype.toHTML=function(){var a='<span class="buffer">';for(var b=0;b<this.segments.length;b++)a+=this.segments[b].toHTML();a+="</span>";return a},Buffer.prototype.copy=function(){return this.slice(0)},Buffer.prototype.compact=function(){var a=0;while(a<this.segments.length){if(this.segments[a].text.length==0){this.segments.splice(a,1);continue}if(a<this.segments.length-1&&this.segments[a].user==this.segments[a+1].user){this.segments[a].text+=this.segments[a+1].text,this.segments.splice(a+1,1);continue}a+=1}},Buffer.prototype.getLength=function(){var a=0;for(var b=0;b<this.segments.length;b++)a+=this.segments[b].text.length;return a},Buffer.prototype.slice=function(a,b){var c=new Buffer,d=0,e=0,f=a,g=b;g==undefined&&(g=Number.MAX_VALUE);while(d<this.segments.length&&g>=e){var h=this.segments[d];if(f-e<h.text.length&&g-e>0){var i=h.text.slice(f-e,g-e),j=new Segment(h.user,i);c.segments.push(j),f+=i.length}e+=h.text.length,d+=1}c.compact();return c},Buffer.prototype.splice=function(a,b,c){if(a>this.getLength())throw"Buffer splice operation out of bounds";var d=0,e=0,f=a,g=b,h=undefined;while(d<this.segments.length){var i=this.segments[d];if(f>=0&&f<i.text.length){var j=i.text.slice(f,f+g);if(f==0)f+g<i.text.length?(h==undefined&&(h=d),i.text=i.text.slice(f+g)):(h==undefined&&(h=d),i.text="",this.segments.splice(d,1),d-=1);else{h==undefined&&(h=d+1);if(f+g<i.text.length){var k=new Segment(i.user,i.text.slice(f+g));i.text=i.text.slice(0,f),this.segments.splice(d+1,0,k)}else i.text=i.text.slice(0,f)}g-=j.length}if(f<i.text.length&&g==0){h==undefined&&(h=f);break}f-=i.text.length,d+=1}if(c instanceof Buffer){h==undefined&&(h=this.segments.length);for(var l=0;l<c.segments.length;l++)this.segments.splice(h+l,0,c.segments[l].copy())}this.compact()},define("lib/jinfinote/jinfinote",function(){}),function(a){function c(c){b=this,b.remote_cursors={},b.editor_colors={},b.suppress_change=!1,b.opts=c,b._initialized=!1,b.log=[],b.cursor_history=[],b._state=new State,b.opts.ws_handler.remote(b.opts.ws_connect,{},function(c){if(!("data"in c))return!1;b._localUser=parseInt(c.data.uid),a.each(c.data.online,function(a,c){c.id==b._localUser&&(b._localColor=c.color)});if("log"in c.data.page)b._state.buffer=new Buffer([new Segment(0,c.data.page.state[1])]),b._state.vector=new Vector(c.data.page.state[0]),b.sync_log(c.data.page.log[1],function(){var a=b.opts.init(c.data);"mode"in b.opts?b.init_code_editor(a,c.data):b.init_code_listener(a,c.data)}),"mode"in b.opts&&b.update_online(c.data.online);else{b.opts.init(c.data,null);return!1}b._prevValue=b._state.buffer.toString();if(isNaN(this._localUser)&&b.opts.mode=="edit")return!1;b._initialized=!0,a(document).trigger("infinote_synced",[b._state.log.length,,b._textarea])});return!0}var b;c.prototype.sync_log=function(c,d){a.each(c,function(a,c){switch(c[0]){case"i":var c=c[1],d=new Buffer([new Segment(c[0],c[3])]),e=new Operations.Insert(c[2],d),f=new DoRequest(c[0],new Vector(c[1]),e),g=b._state.execute(f);break;case"d":var c=c[1],e=new Operations.Delete(c[2],c[3]),f=new DoRequest(c[0],new Vector(c[1]),e),g=b._state.execute(f);break;case"u":var c=c[1],f=new UndoRequest(c[0],new Vector(c[1])),g=b._state.execute(f);break;default:}}),d()},c.prototype.update_online=function(c){a(".infinote-online").empty(),a.each(c,function(c,d){b.editor_colors[d.id]=d.color,b._set_cursor_color(d.id,d.color);var e;d.id==application.settings.user.id?e='<div id="infinote-participant-'+d.id+'" data-id="'+d.id+'" class="infinote-participant"><div class="infinote-participant-color"></div><div class="infinote-participant-name">'+d.name+" ("+gettext("You")+")</div></div>":e='<div id="infinote-participant-'+d.id+'" data-id="'+d.id+'" class="infinote-participant"><div class="infinote-participant-color"></div><div class="infinote-participant-name">'+d.name+"</div></div>",a(".infinote-online").append(e),a("#infinote-participant-"+d.id+" > .infinote-participant-color").css("background-color",d.color)});var d=!1;a.each(b.remote_cursors,function(e,f){a.each(c,function(a,b){b.id==e&&(d=!0)}),d||b.delete_remote_cursor(e)}),b.update_cursors()},c.prototype.disconnect=function(){this.opts.ws_handler.remote(this.opts.ws_disconnect,{},function(a){})},c.prototype.init_code_listener=function(a,b){},c.prototype.init_code_editor=function(c,d){b.dmp=new diff_match_patch,b._container=a(c.editor_element),a(b._container).append('<div class="infinote-online"></div><div id="infinote-textarea"><textarea></textarea></div>'),b.editor=CodeMirror.fromTextArea(a("#infinote-textarea textarea").get(0),{lineNumbers:!0,theme:"default",mode:b.opts.mode,smartHome:!1,enterMode:"flat",onCursorActivity:function(c,d){if(d==!1){var e={id:b._localUser,cursor:c.getCursorRange()};a("span.CodeMirror-selected").css("background-color",b.editor_colors[b._localUser]),b.opts.ws_handler.remote(b.opts.ws_caret,{params:e},function(a){})}},onChange:this._handle_local_operation,onFocus:function(a){var c={id:b._localUser,cursor:a.getCursorRange()};c.cursor.focus=!0,b.opts.ws_handler.remote(b.opts.ws_caret,{params:c},function(a){})},onBlur:function(a){var c={id:b._localUser,cursor:a.getCursorRange()};c.cursor.blur=!0,b.opts.ws_handler.remote(b.opts.ws_caret,{params:c},function(a){})},onKeyEvent:function(a,c){c.type=="keydown"&&(c.ctrlKey?c.keyCode==90&&(b.suppress_change=!0,c.preventDefault(),b._handle_local_undo()):(b.suppress_change=!1,b.early_selection=a.getSelection(),b.early_cursor=a.getCursor()))}}),a(".CodeMirror-cursor").css("border-left","3px solid "+b._localColor),b.suppress_change=!0,this.editor.setValue(b._state.buffer.toString()),b._prevValue=b._state.buffer.toString(),b.suppress_change=!1},c.prototype._handle_local_undo=function(){b.suppress_change=!0;var c=new UndoRequest(b._localUser,b._state.vector);if(b._state.canExecute(c)){var d=b._state.execute(c);b.opts.ws_handler.remote(b.opts.ws_undo,[b._localUser,c.vector.toString()],function(a){}),b.editor.setValue(b._state.buffer.toString()),b.editor.setCursor(b.early_cursor),b.opts.ws_handler.remote(b.opts.ws_caret,{params:{id:b._localUser,cursor:b.early_cursor}},function(a){}),b._prevValue=b._state.buffer.toString(),a(document).trigger("infinote_update",[])}},c.prototype._handle_local_operation=function(c,d){if(b.suppress_change!=!0){b.suppress_change==!0;var e=b.dmp.diff_main(b._prevValue,b.editor.getValue()),f=0;for(var g=0;g<e.length;g++){var h=e[g],i=h[0],j=h[1];if(i==1){var k=new Buffer([new Segment(b._localUser,j)]),l=new Operations.Insert(f,k),m=new DoRequest(b._localUser,b._state.vector,l),n={from:b.early_cursor,to:b.editor.getCursor()},o=[b._localUser,m.vector.toString(),f,j,n],p=b._state.execute(m);b._state.canExecute(m)&&b.opts.ws_handler.remote(b.opts.ws_insert,o,function(a){b.update_cursors()}),f+=j.length}else if(i==-1){var k=b._state.buffer.slice(f,f+j.length),l=new Operations.Delete(f,k),m=new DoRequest(b._localUser,b._state.vector,l),n={from:d.from,to:d.to},o=[b._localUser,m.vector.toString(),f,j.length,n],p=b._state.execute(m);b._state.canExecute(m)&&b.opts.ws_handler.remote(b.opts.ws_delete,o,function(a){})}else f+=j.length}b._prevValue=b._state.buffer.toString(),a(document).trigger("infinote_update",[]),b._check_state()}},c.prototype._hide_remote_cursor=function(c){a("#rc_"+c).removeClass("remote-cursor-focused"),c in b.remote_cursors&&("rsc"in b.remote_cursors[c]&&b.remote_cursors[c].rsc())},c.prototype._show_remote_cursor=function(b){a("#rc_"+b).addClass("remote-cursor-focused")},c.prototype._set_cursor_color=function(b,c){a("#rc_"+b).css("border-left","3px solid "+c)},c.prototype._set_remote_cursor=function(c,d,e){c in b.remote_cursors?(b.remote_cursors[c].from.line=d.from.line,b.remote_cursors[c].from.ch=d.from.ch,b.remote_cursors[c].to.line=d.to.line,b.remote_cursors[c].to.ch=d.to.ch):(b.remote_cursors[c]=d,a("body").append("<span id='rc_"+c+"' class='remote-cursor'></span>"),b._set_cursor_color(c,b.editor_colors[c]),b.remote_cursors[c].node=a("#rc_"+c).get(0)),e!==undefined?b.remote_cursors[c].fc=e:delete b.remote_cursors[c].fc,b.update_cursors()},c.prototype.delete_remote_cursor=function(c){a(b.remote_cursors[c].node).remove(),"rsc"in b.remote_cursors[c]&&b.remote_cursors[c].rsc(),delete b.remote_cursors[c],b.update_cursors()},c.prototype.update_cursors=function(){a.each(b.remote_cursors,function(c,d){"rsc"in d&&b.remote_cursors[c].rsc(),d.from.line==d.to.line&&d.from.ch==d.to.ch?b.editor.addWidget(d.from,d.node,!1):"fc"in d?b.editor.addWidget(d.fc,d.node,!1):(b.remote_cursors[c].rsc=b.editor.markText(d.from,d.to,"remote-selection-"+c),a(".remote-selection-"+c).css("background-color",b.editor_colors[c]).addClass("remote-selection"))})},c.prototype.textpos_to_linepos=function(b){var c=this.editor.getValue().split("\n"),d=0;a.each(c,function(a,c){if(b<=c.length){d=a;return!1}b-=c.length+1,d=a});return{line:d,ch:b}},c.prototype._check_state=function(a){var c,d,e;c=b.editor.getValue(),d=b._state.buffer.toString();if(c!=d){b.suppress_change=!0;var f=b.editor.getCursor();b.editor.setValue(b._state.buffer.toString()),console.warn("Editor state differs from ot-state(ot-length:"+d.length+",ce-length:"+c.length+"). Updating editor from state buffer!"),b.editor.setCursor(f),b.suppress_change=!1}},c.prototype._handle_remote_insert=function(c){b.suppress_change=!0;var d=new Buffer([new Segment(c[0],c[3])]),e=new Operations.Insert(c[2],d),f=new DoRequest(c[0],new Vector(c[1]),e);if(b._state.canExecute(f)){var g=b._state.execute(f);b.editor!==undefined&&(b.editor.replaceRange(c[3],c[4].from,c[4].from),b._set_remote_cursor(c[0],c[4],c[4].to))}a(document).trigger("infinote_update",[]),b._prevValue=b._state.buffer.toString(),b.suppress_change=!1},c.prototype._handle_remote_delete=function(c){b.suppress_change=!0;var d=new Operations.Delete(c[2],c[3]),e=new DoRequest(c[0],new Vector(c[1]),d);if(b._state.canExecute(e)){var f=b._state.execute(e);b.editor!==undefined&&(b.editor.replaceRange("",c[4].from,c[4].to),b._set_remote_cursor(c[0],c[4],c[4].from))}b._prevValue=b._state.buffer.toString(),a(document).trigger("infinote_update",[]),b.suppress_change=!1},c.prototype._handle_remote_undo=function(c){b.suppress_change=!0;var d=new UndoRequest(c[0],new Vector(c[1]));if(b._state.canExecute(d)){var e=b._state.execute(d);b.editor.setValue(b._state.buffer.toString())}a(document).trigger("infinote_update",[]),b.suppress_change=!1},a.extend({infinoteSettings:{ws_connect:"",ws_disconnect:"",ws_insert:"",ws_delete:"",ws_undo:"",ws_caret:"",cb_insert:"",cb_delete:"",cb_undo:"",cb_caret:"",editor:"code",init:""},jinfinote:function(d,e){opts=a.extend(a.infinoteSettings,e),opts.ws_handler=d,b=new c(opts),opts.ws_handler.method(opts.cb_insert,function(a){b._handle_remote_insert(a.params),b.editor!==undefined&&b._check_state()}),opts.ws_handler.method(opts.cb_delete,function(a){b._handle_remote_delete(a.params),b.editor!==undefined&&b._check_state()}),opts.ws_handler.method(opts.cb_undo,function(a){b._handle_remote_undo(a.params),b.editor!==undefined&&b._check_state()}),opts.ws_handler.method(opts.cb_caret,function(a){b._set_remote_cursor(a.id,a.cursor),"blur"in a.cursor?b._hide_remote_cursor(a.id):"focus"in a.cursor&&b._show_remote_cursor(a.id)});return b}})}(jQuery),define("lib/jquery/jquery.jinfinote",function(){}),require.packaged=!0;var application={functions:{},modules:{},plasmoids:{}};define("app",["lib/tools/maps","modules/ui","lib/codemirror2/codemirror","lib/tools/xregexp","lib/tools/math","lib/jquery/jquery.serialobj","lib/jquery/jquery.class","lib/jquery/jquery.ws","lib/jquery/jquery.context","lib/tools/diff_match_patch","order!lib/codemirror2/mode/xml/xml","order!lib/codemirror2/mode/javascript/javascript","order!lib/codemirror2/mode/markdown/markdown","order!lib/jinfinote/jinfinote","order!lib/jquery/jquery.jinfinote"],function(maps){function init_websocket(){$(document).bind("BAD_BROWSER",function(a,b){b=="NO_WEBSOCKET"&&$.post("/misc/bad_browser/",{code:b},function(a){$("body").html('<div id="bad-browser"></div>');var b={};b[gettext("Get a real browser")]=function(){window.open("http://build.chromium.org/f/chromium/snapshots/","mywindow")},$login=$(a.data.dom.dialog).dialog({dialogClass:"badbrowser-dialog",autoOpen:!0,position:"center",width:450,title:'<span class="ui-icon ui-icon-cancel"></span><span>'+gettext("Bad Browser!")+"</span>",resizable:!1,draggable:!0,modal:!0,buttons:b,zIndex:1e6,close:function(){window.open("/","_self")}})},"json")});var a=application.settings.services.web_ui.uri,b=application.settings.services.web_ui.ssl;if(b)var c="wss://"+a+"/ws";else var c="ws://"+a+"/ws";application.ws=$.websocket(c,{open:function(){application.cache.load.context={},$(".activity-loading").remove(),this.tt=optimize_tt(application.settings.tt);if(application.modloader===undefined)application.modloader=load_modules(_modules);else{$(document).trigger("WS_ONLINE");if(application.redirect!=null)application.route_uri_to_mod(application.redirect,!0),application.redirect=null;else{var a=window.location.pathname+document.location.hash;a=="/"&&(a="/blog/"),application.route_uri_to_mod(a,!0)}}$('div[class*="hwios-plasmoid"]').remove(),console.log("Websocket open...")},close:function(){application.cache.load.context={},console.log("Websocket closed..."),offline_trigger==!1&&($(document).trigger("WS_OFFLINE"),offline_trigger=!0),setTimeout(function(){init_websocket()},500)},message_cb:function(a,b){a=="plasmoids"&&$.each(b,function(a,b){console.log('Loading plasmoid "'+b.slug+'"...'),application.load_plasmoid(b)})}})}function load_modules(a){require(a,function(a,b,c){var d=a.init();b.init(),c.init(),$(document).trigger("WS_ONLINE");if(application.redirect!=null)application.route_uri_to_mod(application.redirect,!0),application.redirect=null;else{var e=window.location.pathname+document.location.hash;e=="/"&&(e="/blog/"),application.route_uri_to_mod(e,!0)}});return!0}function optimize_tt(a){var b={};$.each(a,function(a,c){b[c]=a});return b}application.maps=maps,_modules=[];var offline_trigger,ssl=!1,ready=!1;application.uri_back=function(a){a===undefined?a=1:a=a,window.history.back(a)},application.route_uri_to_mod=function(a,b){var c,d=a.split("/");a.indexOf("data")!=-1?c=d[2]:d.length==2?(a="/blog/",c="blog"):c=d[1],application.params.cb_selected=0,application.mod_execute!=c&&application.mod_execute!==undefined&&application.modules[application.mod_execute].clean_up(),c in application.modules?(application.modules[c].load(a,b),application.mod_execute=c):require(["modules/"+c],function(c){var d=c.init(a,b);application.modules[d]=c,application.mod_execute=d});return c},application.route_uri_to_mod_function=function(a,b,c){a.indexOf("#")!=-1&&(a=a.split("#")[0]),$.each(b,function(b,d){var e=a.match(d[0]),f={};if(e!=null){for(key in e)isNaN(key)&&key!="index"&&key!="input"&&(f[key]=e[key]);d[1](f),c&&(location.pathname!=a&&("pushState"in history&&(history.pushState(f,null,a),application.functions.ui.mark_menu())));return!1}})},application.route_button=function(a){var b=a.data();if("uri"in b)b.uri.indexOf("data")==-1?application.route_uri_to_mod(b.uri,!0):application.route_uri_to_mod(b.uri,!1);else if("function"in b){try{var c=b["function"].split(".")}catch(d){console.warn('data-function format should be "module.function". Input was "'+b["function"]+'"');return}typeof application.functions[c[0]][c[1]]==="function"?application.functions[c[0]][c[1]](b):(console.warn('"'+b["function"]+"\" doesn't route to an existing module function. Available module functions are:"),console.log(application.functions))}else if("uripart"in b){if(!("uriflag"in b)){console.warn("uri-holder needs a data-flag!");return}switch(b.uriflag){case"cb-cid":var e=a.data("uripart"),f=$(".datatable :checkbox:checked:visible")[0],g=$(f).attr("id");b.uri=e.replaceKeys({id:g});break;case"random-cid":var e=a.data("uripart"),g=Math.uuid();b.uri=e.replaceKeys({id:g});break;case"id":var e=a.data("uripart");b.uri=e.replaceKeys({id:a.data("id")})}application.route_uri_to_mod(b.uri,!0),a.removeData("uri")}},application.set_plasmoid_widget=function(a,b){$("#widget_"+b.uuid).length==0&&$(a).append("<div id=widget_"+b.uuid+' class="hwios-widget hwios-plasmoid">\n                                    <div class="ui-widget-header ui-corner-top"></div>\n                                    <div id="plasmoid_'+b.uuid+'" class="ui-widget-content plasmoid-container"></div></div>');return $("#widget_"+b.uuid)},application.load_plasmoid=function(plasmoid){widget=application.set_plasmoid_widget(".sidebar",plasmoid);if(plasmoid.type==1)try{eval(plasmoid.script)}catch(error){console.log(error)}},application.prepare_form=function(a){var b=$(a).serializeObject();$.each(b,function(b,c){var d=$(a).find("#"+b);d.length>0&&$("#id_"+b).val(d.html())}),b=$(a).serializeObject();return b},application.merge_objects=function(a,b){for(var c in b)a.hasOwnProperty(c)||(a[c]=b[c]);return a},application.il8n={notify:{0:"Error",1:"Warning",2:"Info"}};return{init:function(a,b){String.prototype.replaceKeys=function(a){return this.replace(/\{(\w+)\}/,function(b,c){return a.hasOwnProperty(c)?a[c]:c})},_modules=b,application.settings=a.settings,application.cache={load:{context:{}}},application.params={},init_websocket()}}})